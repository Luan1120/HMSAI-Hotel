{"ast":null,"code":"var _jsxFileName = \"D:\\\\Git\\\\HMSAI-Hotel\\\\client\\\\src\\\\RoomsBrowse.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { isLoggedIn } from './auth';\nimport './RoomsBrowse.css';\nimport showToast from './toast';\n\n/* Public rooms browsing page\r\n   Features:\r\n   - Filters: keyword (room number / type), hotel, room type\r\n   - Uses /api/admin/rooms for richer data if user is Admin/Staff (auth header) else falls back to room types + derived rooms not available => we attempt public-like fetch.\r\n   NOTE: Currently there is no public rooms endpoint returning individual rooms; we will call /api/admin/rooms without auth -> backend will 401.\r\n   Fallback strategy: fetch room types (/api/room-types) + display them as pseudo-room rows with aggregate info.\r\n*/\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function RoomsBrowse({\n  inline = false,\n  onClose,\n  restoredDraft = null,\n  incomingBooking = null\n}) {\n  _s();\n  var _detailFull$price, _detailFull$images, _reviewsData$reviews, _reviewsData$reviews2;\n  // Helper to normalize status strings into canonical tokens\n  const canonicalStatus = s => {\n    const v = String(s || '').trim().toLowerCase();\n    if (!v) return 'available';\n    if (v.includes('book')) return 'booked';\n    if (v.includes('occup')) return 'occupied';\n    if (v.includes('clean')) return 'cleaning';\n    if (v.includes('maint')) return 'maintenance';\n    if (v.includes('unavail') || v.includes('unavailable')) return 'unavailable';\n    if (v === 'available' || v === 'trống' || v === 'trong') return 'available';\n    return v;\n  };\n  const isDisabledStatus = s => {\n    const st = canonicalStatus(s);\n    return ['booked', 'maintenance', 'unavailable', 'occupied', 'cleaning'].includes(st);\n  };\n  // Helper to normalize image paths returned from API (may be stored without leading slash or uploads prefix)\n  const normalizeImage = p => {\n    if (!p) return null;\n    try {\n      // Already absolute (http/https/data) or starts with /uploads or /static\n      if (/^https?:\\/\\//i.test(p) || /^data:/i.test(p)) return p;\n      if (p.startsWith('/')) return p; // assume valid root-relative\n      // If filename only, prepend uploads path\n      return '/uploads/' + p.replace(/^\\/+/, '');\n    } catch {\n      return p;\n    }\n  };\n  const [q, setQ] = useState('');\n  const [hotelId, setHotelId] = useState('');\n  const [typeId, setTypeId] = useState('');\n  const [hotels, setHotels] = useState([]);\n  const [types, setTypes] = useState([]);\n  const [rooms, setRooms] = useState([]); // unified view\n  const [detail, setDetail] = useState(null); // basic selected row (list data)\n  const [detailFull, setDetailFull] = useState(null); // full fetched room detail\n  const [detailLoading, setDetailLoading] = useState(false);\n  const [reviewsModal, setReviewsModal] = useState(null); // { roomId, loading, data }\n  const [reviewsLoading, setReviewsLoading] = useState(false);\n  const [reviewsData, setReviewsData] = useState(null); // { reviews, avgRating }\n  const [reviewsError, setReviewsError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [bookingOpen, setBookingOpen] = useState(false);\n  const [bookingRoom, setBookingRoom] = useState(null);\n  const [pendingBooking, setPendingBooking] = useState(null);\n  const lastIncomingRef = useRef(null);\n  const [bkCheckIn, setBkCheckIn] = useState('');\n  const [bkCheckOut, setBkCheckOut] = useState('');\n  const [bkAdults, setBkAdults] = useState(1);\n  const [bkChildren, setBkChildren] = useState(0);\n  const [bkPayMethod, setBkPayMethod] = useState('MOMO');\n  const [bkAgree, setBkAgree] = useState(false);\n  const [bkLoading, setBkLoading] = useState(false);\n  const [bkMsg, setBkMsg] = useState('');\n  const [bkAvailable, setBkAvailable] = useState(true);\n  // local ISO date string (yyyy-mm-dd) to avoid UTC timezone issues from toISOString()\n  const localISODate = (() => {\n    const d = new Date();\n    const y = d.getFullYear();\n    const m = String(d.getMonth() + 1).padStart(2, '0');\n    const day = String(d.getDate()).padStart(2, '0');\n    return `${y}-${m}-${day}`;\n  })();\n  // Prevent duplicate rapid submissions / re-init after success redirect\n  const [bkSubmitted, setBkSubmitted] = useState(false);\n  // Promotions removed\n  const [promoCode, setPromoCode] = useState('');\n  const [availablePromos, setAvailablePromos] = useState([]);\n  const [showPromosList, setShowPromosList] = useState(false);\n  const [appliedPromo, setAppliedPromo] = useState(null);\n  const [promoLoading, setPromoLoading] = useState(false);\n  const [promoLoadError, setPromoLoadError] = useState('');\n  const flashTotalRef = useRef(null);\n  const bkFirstFieldRef = useRef(null);\n  const authEmail = (() => {\n    try {\n      const u = JSON.parse(localStorage.getItem('hmsUser') || 'null');\n      return (u === null || u === void 0 ? void 0 : u.email) || '';\n    } catch {\n      return '';\n    }\n  })();\n  const nights = useMemo(() => {\n    if (!bkCheckIn || !bkCheckOut) return 0;\n    const inD = new Date(bkCheckIn);\n    const outD = new Date(bkCheckOut);\n    const ms = outD - inD;\n    return ms > 0 ? Math.round(ms / 86400000) : 0;\n  }, [bkCheckIn, bkCheckOut]);\n  const totalPrice = useMemo(() => nights * Number((bookingRoom === null || bookingRoom === void 0 ? void 0 : bookingRoom.price) || 0), [nights, bookingRoom]);\n  const finalPrice = useMemo(() => {\n    try {\n      if (appliedPromo && typeof appliedPromo.final !== 'undefined' && appliedPromo.final !== null) return Number(appliedPromo.final);\n      if (appliedPromo && typeof appliedPromo.discount === 'number') return Math.max(0, Number(totalPrice) - Number(appliedPromo.discount));\n    } catch (e) {/* ignore */}\n    return Number(totalPrice);\n  }, [totalPrice, appliedPromo]);\n  const dateError = useMemo(() => {\n    if (!bkCheckIn || !bkCheckOut) return '';\n    const inD = new Date(bkCheckIn);\n    const outD = new Date(bkCheckOut);\n    if (!(outD > inD)) return 'Ngày trả phải sau ngày nhận';\n    return '';\n  }, [bkCheckIn, bkCheckOut]);\n  const submitEnabled = !!authEmail && !bkLoading && !bkSubmitted && bookingRoom && bkCheckIn && bkCheckOut && !dateError && bkAdults >= 1 && nights > 0 && bkAgree && !isDisabledStatus(bookingRoom === null || bookingRoom === void 0 ? void 0 : bookingRoom.status) && bkAvailable;\n  const isPrivileged = useMemo(() => {\n    try {\n      const u = JSON.parse(localStorage.getItem('hmsUser') || 'null');\n      return ['admin', 'staff'].includes(String((u === null || u === void 0 ? void 0 : u.role) || '').toLowerCase());\n    } catch {\n      return false;\n    }\n  }, []);\n  const isAdmin = useMemo(() => {\n    try {\n      const u = JSON.parse(localStorage.getItem('hmsUser') || 'null');\n      return String((u === null || u === void 0 ? void 0 : u.role) || '').toLowerCase().includes('admin');\n    } catch {\n      return false;\n    }\n  }, []);\n  const loadHotels = async () => {\n    try {\n      const res = await fetch('/api/hotels');\n      if (!res.ok) throw new Error();\n      const list = await res.json();\n      setHotels(Array.isArray(list) ? list : []);\n    } catch {\n      setHotels([]);\n    }\n  };\n  const loadTypes = async hid => {\n    try {\n      const url = new URL('/api/room-types', window.location.origin);\n      if (hid) url.searchParams.set('hotelId', hid);\n      const res = await fetch(url);\n      if (!res.ok) throw new Error();\n      const list = await res.json();\n      setTypes(Array.isArray(list) ? list : []);\n    } catch {\n      setTypes([]);\n    }\n  };\n  const loadRooms = async () => {\n    setLoading(true);\n    setError('');\n    try {\n      const origin = window.location.origin;\n      const url = new URL('/api/rooms', origin);\n      if (q) url.searchParams.set('q', q);\n      if (hotelId) url.searchParams.set('hotelId', hotelId);\n      if (typeId) url.searchParams.set('typeId', typeId);\n      // Removed debug log for rooms fetch URL\n      const res = await fetch(url, {\n        headers: {\n          'Accept': 'application/json'\n        }\n      });\n      if (!res.ok) {\n        const text = await res.text().catch(() => '');\n        throw new Error('Không tải được phòng' + (text ? ' - ' + text.substring(0, 120) : ''));\n      }\n      const j = await res.json();\n      if (!j || typeof j !== 'object') throw new Error('Phản hồi không hợp lệ');\n      const list = Array.isArray(j.items) ? j.items : Array.isArray(j.rooms) ? j.rooms : [];\n      // Removed debug log for count of received rooms\n      setRooms(list.map(r => {\n        const imgsRaw = Array.isArray(r.images) ? r.images : [];\n        const imgs = imgsRaw.map(im => normalizeImage(im)).filter(Boolean);\n        const first = imgs.length ? imgs[0] : null;\n        return {\n          id: r.id,\n          roomNumber: r.roomNumber || '-',\n          floor: r.floor || null,\n          hotelName: r.hotelName,\n          roomType: r.roomType,\n          price: r.price,\n          status: r.status || 'Available',\n          description: r.description || '',\n          image: first,\n          images: imgs\n        };\n      }));\n      // After loading rooms, fetch availability for the near-term (today->tomorrow) so UI disables booked rooms on initial render\n      try {\n        const today = localISODate;\n        const tomorrow = (() => {\n          const d = new Date();\n          d.setDate(d.getDate() + 1);\n          const y = d.getFullYear();\n          const m = String(d.getMonth() + 1).padStart(2, '0');\n          const day = String(d.getDate()).padStart(2, '0');\n          return `${y}-${m}-${day}`;\n        })();\n        const url = new URL('/api/rooms/availability', window.location.origin);\n        url.searchParams.set('checkIn', today);\n        url.searchParams.set('checkOut', tomorrow);\n        if (hotelId) url.searchParams.set('hotelId', hotelId);\n        const ares = await fetch(url.toString());\n        if (ares.ok) {\n          const aj = await ares.json();\n          const map = new Map((aj.items || []).map(x => [Number(x.roomId), !!x.available]));\n          setRooms(prev => prev.map(r => ({\n            ...r,\n            available: map.has(Number(r.id)) ? map.get(Number(r.id)) : true\n          })));\n        }\n      } catch (e) {/* ignore availability fetch errors */}\n    } catch (e) {\n      console.error('[RoomsBrowse] loadRooms error', e);\n      setError(e.message || 'Lỗi tải dữ liệu');\n      setRooms([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    loadHotels();\n    loadTypes();\n  }, []);\n  useEffect(() => {\n    loadTypes(hotelId);\n  }, [hotelId]);\n  useEffect(() => {\n    loadRooms();\n  }, [q, hotelId, typeId]);\n\n  // Khi có restoredDraft từ HomePage (quay lại từ PaymentConfirm) -> tự động mở booking modal với dữ liệu cũ\n  useEffect(() => {\n    if (restoredDraft && restoredDraft.rooms && Array.isArray(restoredDraft.rooms) && restoredDraft.rooms.length === 1 && !bookingOpen) {\n      // Chỉ hỗ trợ khôi phục 1 phòng (trường hợp đặt nhanh) hiện tại\n      const r0 = restoredDraft.rooms[0];\n      // Tìm phòng tương ứng trong danh sách đã load (nếu room id có trong restored draft)\n      const found = rooms.find(r => Number(r.id) === Number(r0.id));\n      if (found) {\n        // Mở booking modal với room found\n        setBookingRoom(found);\n        setBkCheckIn(restoredDraft.checkIn || '');\n        setBkCheckOut(restoredDraft.checkOut || '');\n        setBkAdults(Number(restoredDraft.adults || 1));\n        setBkChildren(Number(restoredDraft.children || 0));\n        setBookingOpen(true);\n        // Áp dụng lại promo nếu có (để user chủ động re-apply; thực tế cần validate lại)\n        if (restoredDraft.promo && restoredDraft.promo.code) {\n          try {\n            setPromoCode(String(restoredDraft.promo.code).toUpperCase());\n          } catch {}\n        }\n        // Xóa draft trong sessionStorage sau khi dùng để tránh lặp\n        try {\n          sessionStorage.removeItem('hmsReturnBookingDraft');\n        } catch {}\n      }\n    }\n  }, [restoredDraft, rooms, bookingOpen]);\n  const statusLabel = s => {\n    const v = String(s || '').toLowerCase();\n    if (v === 'available') return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"rb-badge available\",\n      children: \"Tr\\u1ED1ng\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 32\n    }, this);\n    if (v === 'occupied') return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"rb-badge booked\",\n      children: \"\\u0110ang \\u1EDF\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 31\n    }, this);\n    if (v === 'cleaning') return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"rb-badge maintenance\",\n      children: \"D\\u1ECDn d\\u1EB9p\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 31\n    }, this);\n    if (v === 'maintenance') return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"rb-badge maintenance\",\n      children: \"B\\u1EA3o tr\\xEC\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 34\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"rb-badge available\",\n      children: \"Tr\\u1ED1ng\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 12\n    }, this);\n  };\n  const openDetail = async r => {\n    setDetail(r);\n    setDetailFull(null);\n    if (!(r !== null && r !== void 0 && r.id)) return;\n    setDetailLoading(true);\n    try {\n      const res = await fetch(`/api/rooms/${r.id}`);\n      if (!res.ok) throw new Error('Không tải được chi tiết');\n      const j = await res.json();\n      setDetailFull(j.room || null);\n    } catch (e) {\n      console.error('detail fetch error', e);\n    } finally {\n      setDetailLoading(false);\n    }\n  };\n  const closeDetail = () => {\n    setDetail(null);\n    setDetailFull(null);\n  };\n\n  // Open booking modal for a room but refresh latest room detail first to avoid duplicate bookings\n  const openBookingForRoom = async r => {\n    try {\n      const uRole = (() => {\n        try {\n          const u = JSON.parse(localStorage.getItem('hmsUser') || 'null');\n          return (u === null || u === void 0 ? void 0 : u.role) || 'Customer';\n        } catch {\n          return 'Customer';\n        }\n      })();\n      if (String(uRole).toLowerCase().includes('admin')) {\n        setBkMsg('Tài khoản Admin không được phép đặt phòng');\n        setBookingOpen(true);\n        setBookingRoom(null);\n        return;\n      }\n    } catch {}\n    if (!(r !== null && r !== void 0 && r.id)) return;\n    setBkMsg('');\n    try {\n      // Try to fetch the latest room detail from server\n      const res = await fetch(`/api/rooms/${r.id}`);\n      if (!res.ok) throw new Error('Không tải được trạng thái phòng');\n      const j = await res.json();\n      const rf = j.room || null;\n      const imgsRaw = Array.isArray((rf === null || rf === void 0 ? void 0 : rf.images) || r.images) ? (rf === null || rf === void 0 ? void 0 : rf.images) || r.images : [];\n      const imgs = imgsRaw.map(im => normalizeImage(im)).filter(Boolean);\n      const merged = {\n        ...r,\n        ...rf,\n        images: imgs,\n        image: imgs[0] || r.image,\n        // ensure status field exists and use server-provided status if present\n        status: rf && (rf.status || rf.Status) || r.status || 'Available'\n      };\n      // If user selected dates already, call availability endpoint to verify\n      let available = true;\n      if (bkCheckIn && bkCheckOut) {\n        try {\n          const avRes = await fetch(`/api/rooms/${r.id}/availability?checkIn=${encodeURIComponent(bkCheckIn)}&checkOut=${encodeURIComponent(bkCheckOut)}`);\n          if (avRes.ok) {\n            const av = await avRes.json();\n            available = !!av.available;\n          }\n        } catch (e) {/* ignore availability check failure */}\n      }\n      setBkAvailable(available);\n      setBookingRoom(merged);\n      // If the room is already in disabled status, show a message but still open modal so user can see details\n      if (isDisabledStatus(merged.status) || available === false) {\n        setBkMsg('Phòng hiện không khả dụng (đã được đặt hoặc đang bảo trì). Không thể đặt.');\n      }\n      setBookingOpen(true);\n      setBkCheckIn('');\n      setBkCheckOut('');\n      setBkAdults(1);\n      setBkChildren(0);\n      setBkSubmitted(false);\n    } catch (e) {\n      console.error('openBookingForRoom error', e);\n      // fallback to original object if fetch failed\n      setBookingRoom(r);\n      setBookingOpen(true);\n      setBkMsg('Không thể kiểm tra trạng thái phòng, vui lòng thử lại.');\n    }\n  };\n  const openReviews = async r => {\n    if (!(r !== null && r !== void 0 && r.id)) return;\n    setReviewsModal(r);\n    setReviewsLoading(true);\n    setReviewsError('');\n    setReviewsData(null);\n    try {\n      const res = await fetch(`/api/rooms/${r.id}/reviews`);\n      if (!res.ok) throw new Error('Không tải được đánh giá');\n      const j = await res.json();\n      setReviewsData({\n        reviews: j.reviews || [],\n        avgRating: j.avgRating || 0\n      });\n    } catch (e) {\n      setReviewsError(e.message || 'Lỗi tải đánh giá');\n    } finally {\n      setReviewsLoading(false);\n    }\n  };\n  const closeReviews = () => {\n    setReviewsModal(null);\n    setReviewsData(null);\n  };\n  useEffect(() => {\n    if (!pendingBooking) return;\n    const detail = pendingBooking.detail ? pendingBooking.detail : pendingBooking;\n    if (!detail) {\n      setPendingBooking(null);\n      return;\n    }\n    const roomId = detail.roomId ? Number(detail.roomId) : null;\n    if (roomId) {\n      openBookingForRoom({\n        id: roomId\n      });\n      setPendingBooking(null);\n      return;\n    }\n    if (detail.name) {\n      const targetName = String(detail.name).toLowerCase();\n      const match = rooms.find(r => String(r.roomType || r.name || '').toLowerCase() === targetName);\n      if (match) {\n        openBookingForRoom(match);\n        setPendingBooking(null);\n        return;\n      }\n      if (!q || q.toLowerCase() !== targetName) {\n        setQ(detail.name);\n      }\n    }\n    setPendingBooking(null);\n  }, [pendingBooking, rooms, openBookingForRoom, q]);\n\n  // ESC key to close detail modal\n  useEffect(() => {\n    const handler = e => {\n      if (e.key === 'Escape') {\n        if (bookingOpen) {\n          setBookingOpen(false);\n          setBookingRoom(null);\n        } else if (detail) closeDetail();else if (onClose && inline) onClose();\n      }\n    };\n    window.addEventListener('keydown', handler);\n    return () => window.removeEventListener('keydown', handler);\n  }, [detail, inline, onClose, bookingOpen]);\n  useEffect(() => {\n    if (bookingOpen && bkFirstFieldRef.current) {\n      try {\n        bkFirstFieldRef.current.focus();\n      } catch {}\n    }\n  }, [bookingOpen]);\n\n  // Single horizontal scrollbar (top) refs\n  const topScrollRef = useRef(null);\n  const bodyScrollRef = useRef(null);\n  const syncScrolling = (source, target) => {\n    if (!source || !target) return;\n    if (target.scrollLeft !== source.scrollLeft) target.scrollLeft = source.scrollLeft;\n  };\n  useEffect(() => {\n    const topEl = topScrollRef.current;\n    const botEl = bodyScrollRef.current;\n    if (!topEl || !botEl) return;\n    const onTop = () => syncScrolling(topEl, botEl);\n    const onBot = () => syncScrolling(botEl, topEl);\n    topEl.addEventListener('scroll', onTop);\n    botEl.addEventListener('scroll', onBot);\n    const resizeHandler = () => {\n      // keep width track by forcing reflow\n      if (topEl && botEl) {\n        // match scrollLeft after resize\n        syncScrolling(botEl, topEl);\n      }\n    };\n    window.addEventListener('resize', resizeHandler);\n    return () => {\n      topEl.removeEventListener('scroll', onTop);\n      botEl.removeEventListener('scroll', onBot);\n      window.removeEventListener('resize', resizeHandler);\n    };\n  }, [rooms.length]);\n  const loggedIn = isLoggedIn();\n  useEffect(() => {\n    if (!incomingBooking) return;\n    if (lastIncomingRef.current === incomingBooking) return;\n    lastIncomingRef.current = incomingBooking;\n    setPendingBooking(incomingBooking);\n  }, [incomingBooking]);\n  // Helper: validate promo code with server and return normalized promo object\n  const validatePromoServer = async code => {\n    if (!code) throw new Error('Thiếu mã');\n    try {\n      var _ref, _promo$discountValue;\n      const q = new URL('/api/promotions/validate', window.location.origin);\n      q.searchParams.set('code', String(code).trim());\n      q.searchParams.set('amount', String(totalPrice || 0));\n      if (bookingRoom !== null && bookingRoom !== void 0 && bookingRoom.hotelId) q.searchParams.set('hotelId', String(bookingRoom.hotelId));\n      if (bookingRoom !== null && bookingRoom !== void 0 && bookingRoom.id) q.searchParams.set('roomIds', String(bookingRoom.id));\n      const r = await fetch(q.toString());\n      if (!r.ok) {\n        const t = await r.json().catch(() => ({}));\n        throw new Error(t.message || 'Mã không hợp lệ');\n      }\n      const j = await r.json();\n      // Removed debug log for promo validation response\n      // Prefer server-provided numbers. Local fields are fallback only.\n      const promo = j.promo || {};\n      const serverDiscount = typeof j.discount !== 'undefined' ? Number(j.discount) : null;\n      const serverFinal = typeof j.final !== 'undefined' ? Number(j.final) : null;\n      const dType = promo.discountType || j.discountType || null;\n      const dVal = Number((_ref = (_promo$discountValue = promo.discountValue) !== null && _promo$discountValue !== void 0 ? _promo$discountValue : j.discount) !== null && _ref !== void 0 ? _ref : 0);\n      // Enforce hotel mismatch RIGHT HERE (defensive, though server should already reject)\n      if (promo && promo.hotelId && bookingRoom !== null && bookingRoom !== void 0 && bookingRoom.hotelId && Number(promo.hotelId) !== Number(bookingRoom.hotelId)) {\n        throw new Error('Mã ưu đãi không áp dụng cho khách sạn này');\n      }\n      return {\n        code: (j.code || promo.code || String(code)).toString().toUpperCase(),\n        discount: serverDiscount !== null ? serverDiscount : Number(0),\n        discountType: dType,\n        discountValue: Number(dVal || 0),\n        final: serverFinal !== null ? serverFinal : Number(0),\n        raw: promo || null,\n        serverRaw: j\n      };\n    } catch (e) {\n      throw e;\n    }\n  };\n\n  // Auto-drop promo if user switches sang phòng khách sạn khác (phòng khác hotel) sau khi áp dụng\n  useEffect(() => {\n    if (!appliedPromo || !appliedPromo.raw) return;\n    const promoHotel = appliedPromo.raw.hotelId || appliedPromo.raw.HotelId || appliedPromo.raw.hotelID || appliedPromo.raw.HotelID || appliedPromo.raw.hotel || null;\n    if (promoHotel && bookingRoom !== null && bookingRoom !== void 0 && bookingRoom.hotelId && Number(promoHotel) !== Number(bookingRoom.hotelId)) {\n      setAppliedPromo(null);\n      showToast('Đã gỡ mã ưu đãi không thuộc khách sạn hiện tại', {\n        type: 'warning',\n        duration: 2600\n      });\n    }\n  }, [bookingRoom === null || bookingRoom === void 0 ? void 0 : bookingRoom.hotelId]);\n  function flashTotal() {\n    try {\n      const els = [];\n      const a = document.querySelectorAll('.rb-booking-summary span:last-child, .rb-booking-summary strong');\n      a.forEach(x => els.push(x));\n      if (!els.length) return;\n      els.forEach(el => {\n        el.classList.add('total-highlight');\n        el.classList.add('apply');\n      });\n      clearTimeout(flashTotalRef.current);\n      flashTotalRef.current = setTimeout(() => {\n        els.forEach(el => el.classList.remove('apply'));\n      }, 600);\n    } catch (e) {/* ignore */}\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: inline ? '' : 'home-root',\n    style: {\n      paddingTop: inline ? 0 : 80\n    },\n    children: [!inline && /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"home-header\",\n      style: {\n        position: 'sticky',\n        top: 0\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"home-header-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/logo.png\",\n          alt: \"logo\",\n          className: \"home-header-logo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          className: \"home-header-title home-header-home-btn\",\n          children: \"TRANG CH\\u1EE6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"home-header-icons\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/login\",\n          className: \"home-header-icon\",\n          title: \"\\u0110\\u0103ng nh\\u1EADp\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/icon-user.png\",\n            alt: \"user\",\n            className: \"home-header-icon-img\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: inline ? '8px 14px 24px' : '24px 24px 40px'\n      },\n      children: [inline && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"rb-btn gradient\",\n        style: {\n          marginBottom: 14,\n          borderRadius: 28\n        },\n        onClick: () => onClose && onClose(),\n        children: \"\\u2190 Quay l\\u1EA1i\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 11\n      }, this), showPromosList && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"qr-overlay\",\n        onClick: () => setShowPromosList(false),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"qr-box\",\n          onClick: e => e.stopPropagation(),\n          style: {\n            width: 620,\n            maxWidth: '96%'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"qr-title\",\n            style: {\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n              gap: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Danh s\\xE1ch \\u01AFu \\u0111\\xE3i\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"qr-close\",\n              onClick: () => setShowPromosList(false),\n              children: \"\\u0110\\xF3ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 444,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              maxHeight: 420,\n              overflowY: 'auto',\n              padding: 8\n            },\n            children: availablePromos.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: 12,\n                color: '#666'\n              },\n              children: \"Kh\\xF4ng c\\xF3 \\u01B0u \\u0111\\xE3i n\\xE0o.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 19\n            }, this) : availablePromos.map(p => /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                borderBottom: '1px solid #eee',\n                padding: 10,\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'space-between'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontWeight: 700\n                  },\n                  children: [p.code, \" \", p.description ? `— ${p.description}` : '']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 453,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    color: '#555',\n                    fontSize: 13\n                  },\n                  children: [p.discountType === 'PERCENT' ? `Giảm ${p.discountValue}%${p.maxDiscount ? ` (tối đa ${Number(p.maxDiscount).toLocaleString('vi-VN')}đ)` : ''}` : `Giảm ${Number(p.discountValue || 0).toLocaleString('vi-VN')}đ`, p.minOrderAmount ? ` • Điều kiện: tối thiểu ${Number(p.minOrderAmount).toLocaleString('vi-VN')}đ` : '']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 454,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  gap: 8\n                },\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn\",\n                  onClick: async () => {\n                    try {\n                      const normalized = await validatePromoServer(p.code);\n                      setAppliedPromo(normalized);\n                      setPromoCode(normalized.code);\n                      setShowPromosList(false);\n                      flashTotal();\n                      showToast('Đã chọn ưu đãi: ' + normalized.code + ' • Giảm ' + normalized.discount.toLocaleString('vi-VN') + 'đ', {\n                        duration: 2000,\n                        type: 'success'\n                      });\n                    } catch (e) {\n                      showToast(e.message || 'Không áp dụng được ưu đãi này', {\n                        duration: 2400,\n                        type: 'error'\n                      });\n                    }\n                  },\n                  children: \"Ch\\u1ECDn\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 460,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 459,\n                columnNumber: 23\n              }, this)]\n            }, p.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rb-overlay-animate rb-panel\",\n        onMouseDown: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rb-heading-wrap\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"rb-heading\",\n            children: \"Danh s\\xE1ch ph\\xF2ng\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-total-count\",\n            \"aria-live\": \"polite\",\n            children: [\"T\\u1ED5ng: \", rooms.length, \" \", loading && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"rb-muted\",\n              style: {\n                fontWeight: 400\n              },\n              children: \"(\\u0110ang t\\u1EA3i...)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 97\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 483,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rb-filters\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"T\\u1EEB kh\\xF3a\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"rb-input\",\n              value: q,\n              onChange: e => setQ(e.target.value),\n              placeholder: \"S\\u1ED1 ph\\xF2ng / lo\\u1EA1i / kh\\xE1ch s\\u1EA1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Kh\\xE1ch s\\u1EA1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-select-wrap\",\n              children: /*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"rb-select\",\n                value: hotelId,\n                onChange: e => setHotelId(e.target.value),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"T\\u1EA5t c\\u1EA3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 19\n                }, this), hotels.map(h => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: h.id,\n                  children: h.name\n                }, h.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 495,\n                  columnNumber: 35\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 493,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"H\\u1EA1ng ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-select-wrap\",\n              children: /*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"rb-select\",\n                value: typeId,\n                onChange: e => setTypeId(e.target.value),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"T\\u1EA5t c\\u1EA3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 503,\n                  columnNumber: 19\n                }, this), types.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: t.id,\n                  children: t.name\n                }, t.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 504,\n                  columnNumber: 34\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rb-table-shell\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-table-head\",\n            style: {\n              gridTemplateColumns: '150px 130px 1.1fr 1.1fr 120px 120px 2fr 200px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"\\u1EA2nh\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"Ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"Kh\\xE1ch s\\u1EA1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"Lo\\u1EA1i ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"Gi\\xE1/\\u0111\\xEAm\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"Tr\\u1EA1ng th\\xE1i\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 516,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"M\\xF4 t\\u1EA3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 517,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-cell\",\n              children: \"H\\xE0nh \\u0111\\u1ED9ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 518,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: bodyScrollRef,\n            className: \"rb-table-body\",\n            children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-row\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-cell\",\n                children: \"\\u0110ang t\\u1EA3i...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 50\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 521,\n              columnNumber: 26\n            }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-row\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-cell\",\n                style: {\n                  color: '#b42318'\n                },\n                children: error\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 133\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 521,\n              columnNumber: 109\n            }, this) : rooms.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-row\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-cell\",\n                children: \"Kh\\xF4ng c\\xF3 ph\\xF2ng ph\\xF9 h\\u1EE3p.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 251\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 521,\n              columnNumber: 227\n            }, this) : rooms.map((r, idx) => {\n              const roomLabel = r.roomNumber === '-' ? '-' : `${r.roomNumber}${r.floor ? ' - T' + r.floor : ''}`;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-row\",\n                style: {\n                  gridTemplateColumns: '150px 130px 1.1fr 1.1fr 120px 120px 2fr 200px',\n                  animationDelay: `${Math.min(idx, 12) * 30}ms`\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell image-cell\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rb-img-wrap\",\n                    children: r.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: r.image,\n                      alt: \"img\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 527,\n                      columnNumber: 36\n                    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        width: '100%',\n                        height: '100%',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        fontSize: 10,\n                        color: '#777'\n                      },\n                      children: \"No image\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 527,\n                      columnNumber: 70\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 526,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 525,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell\",\n                  title: roomLabel,\n                  children: roomLabel\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 530,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell\",\n                  children: r.hotelName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 531,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell\",\n                  children: r.roomType\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 532,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell\",\n                  style: {\n                    fontSize: 13\n                  },\n                  children: [Number(r.price || 0).toLocaleString('vi-VN'), \" VND\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 533,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell\",\n                  children: statusLabel(r.status)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 534,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell rb-desc\",\n                  title: r.description,\n                  children: r.description || '—'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 535,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-cell rb-actions\",\n                  style: {\n                    gap: 8\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"rb-btn primary\",\n                    type: \"button\",\n                    disabled: isDisabledStatus(r.status) || r.available === false || isAdmin,\n                    onClick: () => {\n                      if (isAdmin) {\n                        showToast('Tài khoản Admin không được phép đặt phòng', {\n                          duration: 2200,\n                          type: 'warn'\n                        });\n                        return;\n                      }\n                      if (isDisabledStatus(r.status) || r.available === false) return;\n                      openBookingForRoom(r);\n                    },\n                    children: isDisabledStatus(r.status) || r.available === false ? 'ĐÃ ĐƯỢC ĐẶT' : 'Đặt phòng'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 537,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"rb-btn outline\",\n                    type: \"button\",\n                    onClick: () => openReviews(r),\n                    children: \"\\u0110\\xE1nh gi\\xE1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 549,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"rb-btn outline\",\n                    type: \"button\",\n                    onClick: () => openDetail(r),\n                    children: \"Chi ti\\u1EBFt\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 550,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 536,\n                  columnNumber: 21\n                }, this)]\n              }, r.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 524,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 509,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 3\n      }, this), detail && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rb-modal-backdrop\",\n        onMouseDown: e => {\n          if (e.target === e.currentTarget) closeDetail();\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rb-modal\",\n          onMouseDown: e => e.stopPropagation(),\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"rb-modal-close\",\n            onClick: closeDetail,\n            \"aria-label\": \"\\u0110\\xF3ng\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 561,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            style: {\n              marginTop: 0,\n              marginBottom: 14,\n              fontSize: '1.15rem'\n            },\n            children: detailFull !== null && detailFull !== void 0 && detailFull.roomNumber ? `${detailFull.roomNumber}${detailFull.floor ? ' - T' + detailFull.floor : ''}` : detail.roomType\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 15\n          }, this), detailLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-muted\",\n            style: {\n              fontSize: '.75rem'\n            },\n            children: \"\\u0110ang t\\u1EA3i chi ti\\u1EBFt...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 565,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: 24,\n              flexWrap: 'wrap',\n              opacity: detailLoading ? .6 : 1\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                flex: '0 0 260px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-img-wrap\",\n                style: {\n                  width: '100%',\n                  height: 180\n                },\n                children: detailFull !== null && detailFull !== void 0 && detailFull.images && detailFull.images[0] ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: normalizeImage(detailFull.images[0]),\n                  alt: \"\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 569,\n                  columnNumber: 70\n                }, this) : detail.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: detail.image,\n                  alt: \"\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 569,\n                  columnNumber: 146\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '100%',\n                    height: '100%',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: 12,\n                    color: '#666'\n                  },\n                  children: \"No image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 569,\n                  columnNumber: 182\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 568,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginTop: 10,\n                  fontSize: '.75rem',\n                  lineHeight: 1.3\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Lo\\u1EA1i:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 572,\n                    columnNumber: 26\n                  }, this), \" \", (detailFull === null || detailFull === void 0 ? void 0 : detailFull.roomType) || detail.roomType]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 572,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Gi\\xE1:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 573,\n                    columnNumber: 26\n                  }, this), \" \", Number(((_detailFull$price = detailFull === null || detailFull === void 0 ? void 0 : detailFull.price) !== null && _detailFull$price !== void 0 ? _detailFull$price : detail.price) || 0).toLocaleString('vi-VN'), \" VND/\\u0111\\xEAm\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 573,\n                  columnNumber: 21\n                }, this), (detailFull === null || detailFull === void 0 ? void 0 : detailFull.maxAdults) != null && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Ng\\u01B0\\u1EDDi l\\u1EDBn t\\u1ED1i \\u0111a:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 574,\n                    columnNumber: 60\n                  }, this), \" \", detailFull.maxAdults]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 574,\n                  columnNumber: 55\n                }, this), (detailFull === null || detailFull === void 0 ? void 0 : detailFull.maxChildren) != null && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Tr\\u1EBB em t\\u1ED1i \\u0111a:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 575,\n                    columnNumber: 62\n                  }, this), \" \", detailFull.maxChildren]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 575,\n                  columnNumber: 57\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Tr\\u1EA1ng th\\xE1i:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 576,\n                    columnNumber: 26\n                  }, this), \" \", statusLabel((detailFull === null || detailFull === void 0 ? void 0 : detailFull.status) || detail.status)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 576,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 571,\n                columnNumber: 19\n              }, this), (detailFull === null || detailFull === void 0 ? void 0 : (_detailFull$images = detailFull.images) === null || _detailFull$images === void 0 ? void 0 : _detailFull$images.length) > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  gap: 6,\n                  flexWrap: 'wrap',\n                  marginTop: 10\n                },\n                children: detailFull.images.slice(1, 6).map((im, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-img-wrap\",\n                  style: {\n                    width: 54,\n                    height: 40\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: normalizeImage(im),\n                    alt: \"thumb\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 582,\n                    columnNumber: 27\n                  }, this)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 581,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 579,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 567,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                flex: '1 1 300px',\n                minWidth: 240\n              },\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                style: {\n                  whiteSpace: 'pre-wrap',\n                  lineHeight: 1.45,\n                  fontSize: '.78rem'\n                },\n                children: (detailFull === null || detailFull === void 0 ? void 0 : detailFull.description) || detail.description || 'Không có mô tả.'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 589,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 588,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 566,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 22,\n              display: 'flex',\n              gap: 10,\n              justifyContent: 'flex-end'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"rb-btn primary\",\n              disabled: isDisabledStatus((detailFull === null || detailFull === void 0 ? void 0 : detailFull.status) || detail.status || '') || (detailFull === null || detailFull === void 0 ? void 0 : detailFull.available) === false || (detail === null || detail === void 0 ? void 0 : detail.available) === false,\n              onClick: () => {\n                if (isDisabledStatus((detailFull === null || detailFull === void 0 ? void 0 : detailFull.status) || detail.status || '') || (detailFull === null || detailFull === void 0 ? void 0 : detailFull.available) === false || (detail === null || detail === void 0 ? void 0 : detail.available) === false) return;\n                openBookingForRoom(detailFull || detail);\n              },\n              children: isDisabledStatus((detailFull === null || detailFull === void 0 ? void 0 : detailFull.status) || detail.status || '') || (detailFull === null || detailFull === void 0 ? void 0 : detailFull.available) === false || (detail === null || detail === void 0 ? void 0 : detail.available) === false ? 'ĐÃ ĐƯỢC ĐẶT' : 'Đặt phòng'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 593,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"rb-btn outline\",\n              onClick: closeDetail,\n              children: \"\\u0110\\xF3ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 596,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 592,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 559,\n        columnNumber: 11\n      }, this), bookingOpen && bookingRoom && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rb-modal-backdrop\",\n        onMouseDown: e => {\n          if (e.target === e.currentTarget) {\n            setBookingOpen(false);\n            setBookingRoom(null);\n          }\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rb-modal rb-booking-fast-animate\",\n          role: \"dialog\",\n          \"aria-modal\": \"true\",\n          \"aria-label\": \"\\u0110\\u1EB7t ph\\xF2ng nhanh\",\n          onMouseDown: e => e.stopPropagation(),\n          style: {\n            maxWidth: 600\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"rb-modal-close\",\n            onClick: () => {\n              setBookingOpen(false);\n              setBookingRoom(null);\n            },\n            \"aria-label\": \"\\u0110\\xF3ng\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 605,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-booking-fast\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"\\u0110\\u1EB7t ph\\xF2ng nhanh\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 607,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-booking-room-image\",\n              style: {\n                marginBottom: 14\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-img-wrap\",\n                style: {\n                  width: '100%',\n                  height: 160,\n                  borderRadius: 14,\n                  overflow: 'hidden',\n                  boxShadow: '0 2px 6px rgba(0,0,0,0.15)'\n                },\n                children: bookingRoom.images && bookingRoom.images[0] ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: bookingRoom.images[0],\n                  alt: \"Ph\\xF2ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 610,\n                  columnNumber: 71\n                }, this) : bookingRoom.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: bookingRoom.image,\n                  alt: \"Ph\\xF2ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 610,\n                  columnNumber: 142\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: '100%',\n                    height: '100%',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    fontSize: 12,\n                    color: '#666'\n                  },\n                  children: \"Kh\\xF4ng c\\xF3 \\u1EA3nh\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 610,\n                  columnNumber: 188\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 609,\n                columnNumber: 19\n              }, this), bookingRoom.images && bookingRoom.images.length > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  gap: 6,\n                  marginTop: 8,\n                  flexWrap: 'wrap'\n                },\n                children: bookingRoom.images.slice(1, 6).map((im, i) => /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => {\n                    const copy = [...bookingRoom.images];\n                    const main = copy[0];\n                    copy[0] = copy[i + 1];\n                    copy[i + 1] = main;\n                    setBookingRoom({\n                      ...bookingRoom,\n                      images: copy,\n                      image: copy[0]\n                    });\n                  },\n                  className: \"rb-img-wrap\",\n                  style: {\n                    width: 54,\n                    height: 40,\n                    cursor: 'pointer',\n                    opacity: .9\n                  },\n                  title: \"Xem \\u1EA3nh\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: im,\n                    alt: \"thumb\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 616,\n                    columnNumber: 27\n                  }, this)\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 615,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 613,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 608,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-booking-meta\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Ph\\xF2ng:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 623,\n                columnNumber: 19\n              }, this), \" \", bookingRoom.roomNumber === '-' ? bookingRoom.roomType : bookingRoom.roomNumber, bookingRoom.floor ? ` • Tầng ${bookingRoom.floor}` : '', /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 623,\n                columnNumber: 177\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Lo\\u1EA1i:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 624,\n                columnNumber: 19\n              }, this), \" \", bookingRoom.roomType, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 624,\n                columnNumber: 64\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Gi\\xE1:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 625,\n                columnNumber: 19\n              }, this), \" \", Number(bookingRoom.price || 0).toLocaleString('vi-VN'), \" VND/\\u0111\\xEAm\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 622,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: async e => {\n                e.preventDefault();\n                setBkMsg('');\n                if (!authEmail) {\n                  setBkMsg('Vui lòng đăng nhập để đặt phòng.');\n                  return;\n                }\n                // final server-side availability check to avoid race conditions\n                if (!submitEnabled) {\n                  return;\n                }\n                try {\n                  if (bookingRoom && bookingRoom.id) {\n                    const avUrl = `/api/rooms/${bookingRoom.id}/availability?checkIn=${encodeURIComponent(bkCheckIn)}&checkOut=${encodeURIComponent(bkCheckOut)}`;\n                    const chkRes = await fetch(avUrl);\n                    if (chkRes.ok) {\n                      const chk = await chkRes.json();\n                      if (chk && chk.available === false) {\n                        setBkMsg('Phòng không còn khả dụng cho khoảng ngày chọn. Vui lòng chọn phòng khác.');\n                        return;\n                      }\n                    }\n                  }\n                } catch (err) {/* ignore check failure, proceed with caution */}\n                try {\n                  setBkLoading(true);\n                  setBkSubmitted(true);\n                  // Tạo token và summary tương tự RoomTypeInline flow để chuyển sang trang thanh toán\n                  const token = Math.random().toString(36).slice(2) + Date.now().toString(36);\n                  const pad2 = n => String(n).padStart(2, '0');\n                  const nowD = new Date();\n                  const bookingCode = `HMS${nowD.getFullYear()}${pad2(nowD.getMonth() + 1)}${pad2(nowD.getDate())}`;\n                  const roomNames = `Phòng ${bookingRoom.roomNumber}${bookingRoom.floor ? ` • Tầng ${bookingRoom.floor}` : ''}`;\n                  const summary = {\n                    token,\n                    code: bookingCode,\n                    hotelId: bookingRoom.hotelId || null,\n                    hotel: bookingRoom.hotelName || '',\n                    roomType: bookingRoom.roomType || '',\n                    roomNames,\n                    checkIn: bkCheckIn,\n                    checkOut: bkCheckOut,\n                    checkInTime: '14:00',\n                    checkOutTime: '12:00',\n                    payMethod: bkPayMethod || 'MOMO',\n                    userEmail: authEmail,\n                    adults: bkAdults,\n                    children: bkChildren,\n                    rooms: [{\n                      id: bookingRoom.id,\n                      number: bookingRoom.roomNumber,\n                      floor: bookingRoom.floor,\n                      price: bookingRoom.price,\n                      name: bookingRoom.roomNumber,\n                      adults: bkAdults,\n                      children: bkChildren\n                    }],\n                    amount: Number(bookingRoom.price || 0) * nights || 0\n                  };\n                  // attach promo data if applied (server-validated normalized object)\n                  if (appliedPromo && appliedPromo.code) {\n                    summary.promo = {\n                      code: appliedPromo.code,\n                      discount: Number(appliedPromo.discount || 0),\n                      discountType: appliedPromo.discountType || appliedPromo.raw && appliedPromo.raw.discountType || null,\n                      discountValue: Number(appliedPromo.discountValue || 0),\n                      final: appliedPromo.final || null,\n                      raw: appliedPromo.raw || null\n                    };\n                  }\n                  // promotions removed\n                  try {\n                    localStorage.setItem('hmsBooking:' + token, JSON.stringify(summary));\n                  } catch {}\n                  const q = [`token=${encodeURIComponent(token)}`, `code=${encodeURIComponent(summary.code)}`,\n                  // pass gross amount; discount is read from summary on PaymentConfirm\n                  `amount=${encodeURIComponent(summary.amount)}`, `hid=${encodeURIComponent(summary.hotelId || '')}`, `rn=${encodeURIComponent(roomNames)}`, `rt=${encodeURIComponent(summary.roomType || '')}`, `ci=${encodeURIComponent(summary.checkIn || '')}`, `co=${encodeURIComponent(summary.checkOut || '')}`, `ad=${encodeURIComponent(summary.adults)}`, `ch=${encodeURIComponent(summary.children)}`].join('&');\n                  // Lưu draft vào sessionStorage để nếu user quay lại có thể khôi phục\n                  try {\n                    sessionStorage.setItem('hmsReturnBookingDraft', JSON.stringify(summary));\n                  } catch {}\n                  const originPayload = encodeURIComponent(JSON.stringify({\n                    __roomsBookingDraft: summary\n                  }));\n                  window.location.href = '/payment/confirm?' + q + `&origin=${originPayload}`;\n                } catch (err) {\n                  setBkMsg(err.message || 'Lỗi khởi tạo thanh toán');\n                  setBkSubmitted(false);\n                } finally {\n                  setBkLoading(false);\n                }\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-booking-grid\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-booking-row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rb-booking-field\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      children: \"Ng\\xE0y nh\\u1EADn\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 705,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      ref: bkFirstFieldRef,\n                      type: \"date\",\n                      min: localISODate,\n                      value: bkCheckIn,\n                      onChange: e => {\n                        const v = e.target.value;\n                        setBkCheckIn(v);\n                        // If check-out is before/equals new check-in, reset check-out\n                        if (bkCheckOut && bkCheckOut <= v) {\n                          setBkCheckOut('');\n                        }\n                      },\n                      required: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 706,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 704,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rb-booking-field\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      children: \"Ng\\xE0y tr\\u1EA3\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 723,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"date\",\n                      min: bkCheckIn ? (() => {\n                        const d = new Date(bkCheckIn);\n                        d.setDate(d.getDate() + 1);\n                        const y = d.getFullYear();\n                        const m = String(d.getMonth() + 1).padStart(2, '0');\n                        const day = String(d.getDate()).padStart(2, '0');\n                        return `${y}-${m}-${day}`;\n                      })() : (() => {\n                        const d = new Date();\n                        d.setDate(d.getDate() + 1);\n                        const y = d.getFullYear();\n                        const m = String(d.getMonth() + 1).padStart(2, '0');\n                        const day = String(d.getDate()).padStart(2, '0');\n                        return `${y}-${m}-${day}`;\n                      })(),\n                      value: bkCheckOut,\n                      onChange: e => setBkCheckOut(e.target.value),\n                      disabled: !bkCheckIn,\n                      required: true\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 724,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 722,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 703,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-booking-row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rb-booking-field\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      children: \"Ng\\u01B0\\u1EDDi l\\u1EDBn\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 736,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                      value: bkAdults,\n                      onChange: e => setBkAdults(Number(e.target.value)),\n                      children: Array.from({\n                        length: bookingRoom.maxAdults || 2\n                      }, (_, i) => i + 1).map(v => /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: v,\n                        children: v\n                      }, v, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 742,\n                        columnNumber: 29\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 737,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 735,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rb-booking-field\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      children: \"Tr\\u1EBB em\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 747,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                      value: bkChildren,\n                      onChange: e => setBkChildren(Number(e.target.value)),\n                      children: Array.from({\n                        length: (bookingRoom.maxChildren || 0) + 1\n                      }, (_, i) => i).map(v => /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: v,\n                        children: v\n                      }, v, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 753,\n                        columnNumber: 29\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 748,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 746,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 734,\n                  columnNumber: 21\n                }, this), dateError && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-msg error\",\n                  role: \"alert\",\n                  children: dateError\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 758,\n                  columnNumber: 35\n                }, this), !dateError && bkCheckIn && bkCheckOut && bkAvailable === false && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-msg error\",\n                  role: \"alert\",\n                  children: \"Ph\\xF2ng kh\\xF4ng kh\\u1EA3 d\\u1EE5ng cho kho\\u1EA3ng ng\\xE0y \\u0111\\xE3 ch\\u1ECDn.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 759,\n                  columnNumber: 88\n                }, this), nights > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-booking-summary\",\n                  \"aria-live\": \"polite\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: nights\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 762,\n                      columnNumber: 31\n                    }, this), \" \\u0111\\xEAm x \", Number(bookingRoom.price || 0).toLocaleString('vi-VN'), \" VND\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 762,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      fontWeight: 800\n                    },\n                    children: appliedPromo ? /*#__PURE__*/_jsxDEV(\"span\", {\n                      style: {\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'flex-end'\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        style: {\n                          fontSize: 12,\n                          color: '#6b7280',\n                          textDecoration: 'line-through'\n                        },\n                        children: [Number(totalPrice).toLocaleString('vi-VN'), \" VND\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 766,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        style: {\n                          fontWeight: 900,\n                          color: '#111'\n                        },\n                        children: [Number(finalPrice).toLocaleString('vi-VN'), \" VND\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 767,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 765,\n                      columnNumber: 29\n                    }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: [Number(totalPrice).toLocaleString('vi-VN'), \" VND\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 770,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 763,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 761,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-booking-promo\",\n                  style: {\n                    marginTop: 8\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: 'flex',\n                      gap: 8,\n                      alignItems: 'center',\n                      flexWrap: 'wrap'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      placeholder: \"Nh\\u1EADp m\\xE3 \\u01B0u \\u0111\\xE3i\",\n                      value: promoCode,\n                      onChange: e => setPromoCode(e.target.value.toUpperCase()),\n                      style: {\n                        padding: '8px 10px',\n                        borderRadius: 8,\n                        border: '1px solid #ddd'\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 777,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      className: \"ph-btn\",\n                      disabled: !(totalPrice > 0),\n                      onClick: async () => {\n                        if (!(totalPrice > 0)) {\n                          showToast('Vui lòng chọn phòng và ngày để áp dụng mã ưu đãi', {\n                            duration: 2000,\n                            type: 'warn'\n                          });\n                          return;\n                        }\n                        try {\n                          const normalized = await validatePromoServer(promoCode.trim());\n                          setAppliedPromo(normalized);\n                          setPromoCode(normalized.code);\n                          flashTotal();\n                          showToast('Áp dụng mã: ' + normalized.code + ' • Giảm ' + normalized.discount.toLocaleString('vi-VN') + 'đ', {\n                            duration: 2000,\n                            type: 'success'\n                          });\n                        } catch (e) {\n                          setAppliedPromo(null);\n                          showToast(e.message || 'Lỗi kiểm tra mã', {\n                            duration: 2400,\n                            type: 'error'\n                          });\n                        }\n                      },\n                      children: \"\\xC1p d\\u1EE5ng\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 778,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      className: \"ph-btn ph-btn--secondary\",\n                      disabled: !(totalPrice > 0),\n                      onClick: async () => {\n                        if (!(totalPrice > 0)) {\n                          showToast('Vui lòng chọn phòng và ngày để xem ưu đãi', {\n                            duration: 2000,\n                            type: 'warn'\n                          });\n                          return;\n                        }\n                        try {\n                          setPromoLoading(true);\n                          setPromoLoadError('');\n                          const listUrl = new URL('/api/promotions', window.location.origin);\n                          if (bookingRoom !== null && bookingRoom !== void 0 && bookingRoom.hotelId) listUrl.searchParams.set('hotelId', String(bookingRoom.hotelId));\n                          if (bookingRoom !== null && bookingRoom !== void 0 && bookingRoom.id) listUrl.searchParams.set('roomIds', String(bookingRoom.id));\n                          const r = await fetch(listUrl.toString());\n                          if (!r.ok) {\n                            const txt = await r.text().catch(() => null);\n                            throw new Error(txt || 'Không lấy được danh sách');\n                          }\n                          const j = await r.json();\n                          setAvailablePromos(Array.isArray(j.items) ? j.items : []);\n                          setShowPromosList(true);\n                        } catch (e) {\n                          setPromoLoadError(e.message || 'Lỗi tải ưu đãi');\n                          showToast(e.message || 'Lỗi tải ưu đãi', {\n                            duration: 2600,\n                            type: 'error'\n                          });\n                        } finally {\n                          setPromoLoading(false);\n                        }\n                      },\n                      children: \"Ch\\u1ECDn\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 791,\n                      columnNumber: 25\n                    }, this), appliedPromo && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontWeight: 800\n                      },\n                      children: [appliedPromo.code, \" \\u2022 \", appliedPromo.discountType === 'PERCENT' ? `Giảm ${Number(appliedPromo.discount || 0).toLocaleString('vi-VN')} (- ${appliedPromo.discountValue}%)` : `Giảm ${Number(appliedPromo.discount || 0).toLocaleString('vi-VN')}đ`]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 805,\n                      columnNumber: 27\n                    }, this), promoLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: '#2563eb',\n                        fontSize: 13\n                      },\n                      children: \"\\u0110ang t\\u1EA3i \\u01B0u \\u0111\\xE3i...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 813,\n                      columnNumber: 42\n                    }, this), promoLoadError && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: '#b42318',\n                        fontSize: 13\n                      },\n                      children: promoLoadError\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 814,\n                      columnNumber: 44\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 776,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 775,\n                  columnNumber: 21\n                }, this), !authEmail && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-msg error\",\n                  children: \"Vui l\\xF2ng \\u0111\\u0103ng nh\\u1EADp \\u0111\\u1EC3 \\u0111\\u1EB7t ph\\xF2ng.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 817,\n                  columnNumber: 38\n                }, this), bkMsg && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `rb-msg ${bkMsg.includes('thành công') ? 'success' : 'error'}`,\n                  children: bkMsg\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 818,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-booking-row\",\n                  style: {\n                    marginTop: 4\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"rb-booking-field\",\n                    style: {\n                      flex: '1 1 100%'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      children: \"Ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 821,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                      value: bkPayMethod,\n                      onChange: e => setBkPayMethod(e.target.value),\n                      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"MOMO\",\n                        children: \"V\\xED \\u0111i\\u1EC7n t\\u1EED MOMO\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 823,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"ZALOPAY\",\n                        children: \"ZaloPay\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 824,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"VNPAY\",\n                        children: \"VNPay\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 825,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"CARD\",\n                        children: \"Th\\u1EBB t\\xEDn d\\u1EE5ng/ghi n\\u1EE3\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 826,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 822,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 820,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 819,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"rb-terms\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"checkbox\",\n                    style: {\n                      marginTop: 2\n                    },\n                    checked: bkAgree,\n                    onChange: e => setBkAgree(e.target.checked)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 831,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Vui l\\xF2ng \\u0111\\u1ECDc k\\u0129 v\\xE0 \\u0111\\u1ED3ng \\xFD v\\u1EDBi \\u0111i\\u1EC1u kho\\u1EA3n b\\u1EB1ng c\\xE1ch \\u0111\\xE1nh d\\u1EA5u v\\xE0o \\xF4 b\\xEAn c\\u1EA1nh\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 832,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 830,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"rb-booking-actions\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    className: \"rb-btn outline\",\n                    onClick: () => {\n                      setBookingOpen(false);\n                      setBookingRoom(null);\n                    },\n                    children: \"H\\u1EE7y\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 835,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"submit\",\n                    className: \"rb-btn primary\",\n                    disabled: !submitEnabled || isDisabledStatus(bookingRoom === null || bookingRoom === void 0 ? void 0 : bookingRoom.status) || (bookingRoom === null || bookingRoom === void 0 ? void 0 : bookingRoom.available) === false,\n                    children: isDisabledStatus(bookingRoom === null || bookingRoom === void 0 ? void 0 : bookingRoom.status) || (bookingRoom === null || bookingRoom === void 0 ? void 0 : bookingRoom.available) === false ? 'ĐÃ ĐƯỢC ĐẶT' : bkLoading ? 'Đang xử lý...' : 'Thanh toán'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 836,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 834,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 702,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 627,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"rb-booking-note\",\n              children: \"C\\u1EA7n nhi\\u1EC1u ph\\xF2ng ho\\u1EB7c t\\xF9y ch\\u1ECDn n\\xE2ng cao? V\\xE0o giao di\\u1EC7n h\\u1EA1ng ph\\xF2ng \\u0111\\u1EC3 ch\\u1ECDn nhi\\u1EC1u ph\\xF2ng v\\xE0 ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 842,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 606,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 603,\n        columnNumber: 11\n      }, this), reviewsModal && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rb-modal-backdrop\",\n        onMouseDown: e => {\n          if (e.target === e.currentTarget) closeReviews();\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rb-modal\",\n          onMouseDown: e => e.stopPropagation(),\n          style: {\n            maxWidth: 860\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"rb-modal-close\",\n            onClick: closeReviews,\n            \"aria-label\": \"\\u0110\\xF3ng\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 851,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            style: {\n              marginTop: 0,\n              marginBottom: 10,\n              fontSize: '1.05rem'\n            },\n            children: [\"\\u0110\\xE1nh gi\\xE1 ph\\xF2ng \", reviewsModal.roomNumber || reviewsModal.roomType]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 852,\n            columnNumber: 15\n          }, this), reviewsLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rb-muted\",\n            style: {\n              fontSize: '.75rem'\n            },\n            children: \"\\u0110ang t\\u1EA3i \\u0111\\xE1nh gi\\xE1...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 853,\n            columnNumber: 34\n          }, this), reviewsError && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#b42318',\n              fontSize: '.75rem'\n            },\n            children: reviewsError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 854,\n            columnNumber: 32\n          }, this), !reviewsLoading && !reviewsError && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 6\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '.8rem',\n                marginBottom: 10\n              },\n              children: [\"Trung b\\xECnh: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: ((reviewsData === null || reviewsData === void 0 ? void 0 : reviewsData.avgRating) || 0).toFixed(1)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 858,\n                columnNumber: 33\n              }, this), \"/5 \\u2B50\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 857,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maxHeight: 380,\n                overflow: 'auto',\n                paddingRight: 4,\n                border: '1px solid #e5e7eb',\n                borderRadius: 8\n              },\n              children: [(!reviewsData || !((_reviewsData$reviews = reviewsData.reviews) !== null && _reviewsData$reviews !== void 0 && _reviewsData$reviews.length)) && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"rb-muted\",\n                style: {\n                  padding: 12,\n                  fontSize: '.75rem'\n                },\n                children: \"Ch\\u01B0a c\\xF3 \\u0111\\xE1nh gi\\xE1.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 861,\n                columnNumber: 72\n              }, this), reviewsData === null || reviewsData === void 0 ? void 0 : (_reviewsData$reviews2 = reviewsData.reviews) === null || _reviewsData$reviews2 === void 0 ? void 0 : _reviewsData$reviews2.map(rv => /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  padding: '10px 12px',\n                  borderBottom: '1px solid #eef2f6',\n                  fontSize: '.75rem',\n                  lineHeight: 1.35\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    gap: 12\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: rv.customer\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 865,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      color: '#f59e0b',\n                      fontWeight: 600\n                    },\n                    children: [rv.rating.toFixed(1), \"\\u2B50\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 866,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 864,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginTop: 4\n                  },\n                  children: rv.comment || /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"rb-muted\",\n                    children: \"(Kh\\xF4ng c\\xF3 n\\u1ED9i dung)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 868,\n                    columnNumber: 69\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 868,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginTop: 4,\n                    fontSize: '.65rem',\n                    color: '#64748b'\n                  },\n                  children: new Date(rv.createdAt).toLocaleString('vi-VN')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 869,\n                  columnNumber: 25\n                }, this)]\n              }, rv.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 863,\n                columnNumber: 23\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 860,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 856,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 18,\n              textAlign: 'right'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"rb-btn outline\",\n              onClick: closeReviews,\n              children: \"\\u0110\\xF3ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 876,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 875,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 850,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 849,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 420,\n    columnNumber: 5\n  }, this);\n}\n_s(RoomsBrowse, \"eDKOVtbjlz5n6cpECEMlv6sMUkw=\");\n_c = RoomsBrowse;\nvar _c;\n$RefreshReg$(_c, \"RoomsBrowse\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","Link","isLoggedIn","showToast","jsxDEV","_jsxDEV","RoomsBrowse","inline","onClose","restoredDraft","incomingBooking","_s","_detailFull$price","_detailFull$images","_reviewsData$reviews","_reviewsData$reviews2","canonicalStatus","s","v","String","trim","toLowerCase","includes","isDisabledStatus","st","normalizeImage","p","test","startsWith","replace","q","setQ","hotelId","setHotelId","typeId","setTypeId","hotels","setHotels","types","setTypes","rooms","setRooms","detail","setDetail","detailFull","setDetailFull","detailLoading","setDetailLoading","reviewsModal","setReviewsModal","reviewsLoading","setReviewsLoading","reviewsData","setReviewsData","reviewsError","setReviewsError","loading","setLoading","error","setError","bookingOpen","setBookingOpen","bookingRoom","setBookingRoom","pendingBooking","setPendingBooking","lastIncomingRef","bkCheckIn","setBkCheckIn","bkCheckOut","setBkCheckOut","bkAdults","setBkAdults","bkChildren","setBkChildren","bkPayMethod","setBkPayMethod","bkAgree","setBkAgree","bkLoading","setBkLoading","bkMsg","setBkMsg","bkAvailable","setBkAvailable","localISODate","d","Date","y","getFullYear","m","getMonth","padStart","day","getDate","bkSubmitted","setBkSubmitted","promoCode","setPromoCode","availablePromos","setAvailablePromos","showPromosList","setShowPromosList","appliedPromo","setAppliedPromo","promoLoading","setPromoLoading","promoLoadError","setPromoLoadError","flashTotalRef","bkFirstFieldRef","authEmail","u","JSON","parse","localStorage","getItem","email","nights","inD","outD","ms","Math","round","totalPrice","Number","price","finalPrice","final","discount","max","e","dateError","submitEnabled","status","isPrivileged","role","isAdmin","loadHotels","res","fetch","ok","Error","list","json","Array","isArray","loadTypes","hid","url","URL","window","location","origin","searchParams","set","loadRooms","headers","text","catch","substring","j","items","map","r","imgsRaw","images","imgs","im","filter","Boolean","first","length","id","roomNumber","floor","hotelName","roomType","description","image","today","tomorrow","setDate","ares","toString","aj","Map","x","roomId","available","prev","has","get","console","message","r0","found","find","checkIn","checkOut","adults","children","promo","code","toUpperCase","sessionStorage","removeItem","statusLabel","className","fileName","_jsxFileName","lineNumber","columnNumber","openDetail","room","closeDetail","openBookingForRoom","uRole","rf","merged","Status","avRes","encodeURIComponent","av","openReviews","reviews","avgRating","closeReviews","name","targetName","match","handler","key","addEventListener","removeEventListener","current","focus","topScrollRef","bodyScrollRef","syncScrolling","source","target","scrollLeft","topEl","botEl","onTop","onBot","resizeHandler","loggedIn","validatePromoServer","_ref","_promo$discountValue","t","serverDiscount","serverFinal","dType","discountType","dVal","discountValue","raw","serverRaw","promoHotel","HotelId","hotelID","HotelID","hotel","type","duration","flashTotal","els","a","document","querySelectorAll","forEach","push","el","classList","add","clearTimeout","setTimeout","remove","style","paddingTop","position","top","src","alt","to","title","padding","marginBottom","borderRadius","onClick","stopPropagation","width","maxWidth","display","justifyContent","alignItems","gap","maxHeight","overflowY","color","borderBottom","fontWeight","fontSize","maxDiscount","toLocaleString","minOrderAmount","normalized","onMouseDown","value","onChange","placeholder","h","gridTemplateColumns","ref","idx","roomLabel","animationDelay","min","height","disabled","currentTarget","marginTop","flexWrap","opacity","flex","lineHeight","maxAdults","maxChildren","slice","i","minWidth","whiteSpace","overflow","boxShadow","copy","main","cursor","onSubmit","preventDefault","avUrl","chkRes","chk","err","token","random","now","pad2","n","nowD","bookingCode","roomNames","summary","checkInTime","checkOutTime","payMethod","userEmail","number","amount","setItem","stringify","join","originPayload","__roomsBookingDraft","href","required","from","_","flexDirection","textDecoration","border","listUrl","txt","checked","toFixed","paddingRight","rv","customer","rating","comment","createdAt","textAlign","_c","$RefreshReg$"],"sources":["D:/Git/HMSAI-Hotel/client/src/RoomsBrowse.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { isLoggedIn } from './auth';\r\nimport './RoomsBrowse.css';\r\nimport showToast from './toast';\r\n\r\n/* Public rooms browsing page\r\n   Features:\r\n   - Filters: keyword (room number / type), hotel, room type\r\n   - Uses /api/admin/rooms for richer data if user is Admin/Staff (auth header) else falls back to room types + derived rooms not available => we attempt public-like fetch.\r\n   NOTE: Currently there is no public rooms endpoint returning individual rooms; we will call /api/admin/rooms without auth -> backend will 401.\r\n   Fallback strategy: fetch room types (/api/room-types) + display them as pseudo-room rows with aggregate info.\r\n*/\r\nexport default function RoomsBrowse({ inline=false, onClose, restoredDraft=null, incomingBooking=null }){\r\n  // Helper to normalize status strings into canonical tokens\r\n  const canonicalStatus = (s) => {\r\n    const v = String(s||'').trim().toLowerCase();\r\n    if(!v) return 'available';\r\n    if(v.includes('book')) return 'booked';\r\n    if(v.includes('occup')) return 'occupied';\r\n    if(v.includes('clean')) return 'cleaning';\r\n    if(v.includes('maint')) return 'maintenance';\r\n    if(v.includes('unavail') || v.includes('unavailable')) return 'unavailable';\r\n    if(v==='available' || v==='trống' || v==='trong') return 'available';\r\n    return v;\r\n  };\r\n\r\n  const isDisabledStatus = (s) => {\r\n    const st = canonicalStatus(s);\r\n    return ['booked','maintenance','unavailable','occupied','cleaning'].includes(st);\r\n  };\r\n  // Helper to normalize image paths returned from API (may be stored without leading slash or uploads prefix)\r\n  const normalizeImage = (p) => {\r\n    if(!p) return null;\r\n    try {\r\n      // Already absolute (http/https/data) or starts with /uploads or /static\r\n      if(/^https?:\\/\\//i.test(p) || /^data:/i.test(p)) return p;\r\n      if(p.startsWith('/')) return p; // assume valid root-relative\r\n      // If filename only, prepend uploads path\r\n      return '/uploads/' + p.replace(/^\\/+/, '');\r\n    } catch { return p; }\r\n  };\r\n  const [q, setQ] = useState('');\r\n  const [hotelId, setHotelId] = useState('');\r\n  const [typeId, setTypeId] = useState('');\r\n  const [hotels, setHotels] = useState([]);\r\n  const [types, setTypes] = useState([]);\r\n  const [rooms, setRooms] = useState([]); // unified view\r\n  const [detail, setDetail] = useState(null); // basic selected row (list data)\r\n  const [detailFull, setDetailFull] = useState(null); // full fetched room detail\r\n  const [detailLoading, setDetailLoading] = useState(false);\r\n  const [reviewsModal, setReviewsModal] = useState(null); // { roomId, loading, data }\r\n  const [reviewsLoading, setReviewsLoading] = useState(false);\r\n  const [reviewsData, setReviewsData] = useState(null); // { reviews, avgRating }\r\n  const [reviewsError, setReviewsError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [bookingOpen, setBookingOpen] = useState(false);\r\n  const [bookingRoom, setBookingRoom] = useState(null);\r\n  const [pendingBooking, setPendingBooking] = useState(null);\r\n  const lastIncomingRef = useRef(null);\r\n  const [bkCheckIn, setBkCheckIn] = useState('');\r\n  const [bkCheckOut, setBkCheckOut] = useState('');\r\n  const [bkAdults, setBkAdults] = useState(1);\r\n  const [bkChildren, setBkChildren] = useState(0);\r\n  const [bkPayMethod, setBkPayMethod] = useState('MOMO');\r\n  const [bkAgree, setBkAgree] = useState(false);\r\n  const [bkLoading, setBkLoading] = useState(false);\r\n  const [bkMsg, setBkMsg] = useState('');\r\n  const [bkAvailable, setBkAvailable] = useState(true);\r\n  // local ISO date string (yyyy-mm-dd) to avoid UTC timezone issues from toISOString()\r\n  const localISODate = (() => {\r\n    const d = new Date();\r\n    const y = d.getFullYear();\r\n    const m = String(d.getMonth() + 1).padStart(2, '0');\r\n    const day = String(d.getDate()).padStart(2, '0');\r\n    return `${y}-${m}-${day}`;\r\n  })();\r\n  // Prevent duplicate rapid submissions / re-init after success redirect\r\n  const [bkSubmitted, setBkSubmitted] = useState(false);\r\n  // Promotions removed\r\n  const [promoCode, setPromoCode] = useState('');\r\n  const [availablePromos, setAvailablePromos] = useState([]);\r\n  const [showPromosList, setShowPromosList] = useState(false);\r\n  const [appliedPromo, setAppliedPromo] = useState(null);\r\n  const [promoLoading, setPromoLoading] = useState(false);\r\n  const [promoLoadError, setPromoLoadError] = useState('');\r\n  const flashTotalRef = useRef(null);\r\n  const bkFirstFieldRef = useRef(null);\r\n  const authEmail = (()=>{ try { const u = JSON.parse(localStorage.getItem('hmsUser')||'null'); return u?.email || ''; } catch { return ''; } })();\r\n  const nights = useMemo(()=>{ if(!bkCheckIn || !bkCheckOut) return 0; const inD=new Date(bkCheckIn); const outD=new Date(bkCheckOut); const ms= outD - inD; return ms>0? Math.round(ms/86400000):0; }, [bkCheckIn, bkCheckOut]);\r\n  const totalPrice = useMemo(()=> nights * Number(bookingRoom?.price||0), [nights, bookingRoom]);\r\n  const finalPrice = useMemo(() => {\r\n    try {\r\n      if (appliedPromo && (typeof appliedPromo.final !== 'undefined') && appliedPromo.final !== null) return Number(appliedPromo.final);\r\n      if (appliedPromo && typeof appliedPromo.discount === 'number') return Math.max(0, Number(totalPrice) - Number(appliedPromo.discount));\r\n    } catch (e) { /* ignore */ }\r\n    return Number(totalPrice);\r\n  }, [totalPrice, appliedPromo]);\r\n  const dateError = useMemo(()=>{ if(!bkCheckIn || !bkCheckOut) return ''; const inD=new Date(bkCheckIn); const outD=new Date(bkCheckOut); if(!(outD>inD)) return 'Ngày trả phải sau ngày nhận'; return ''; }, [bkCheckIn, bkCheckOut]);\r\n  const submitEnabled = !!authEmail && !bkLoading && !bkSubmitted && bookingRoom && bkCheckIn && bkCheckOut && !dateError && bkAdults>=1 && nights>0 && bkAgree && !isDisabledStatus(bookingRoom?.status) && bkAvailable;\r\n\r\n  const isPrivileged = useMemo(()=>{ try { const u = JSON.parse(localStorage.getItem('hmsUser')||'null'); return ['admin','staff'].includes(String(u?.role||'').toLowerCase()); } catch { return false; } }, []);\r\n  const isAdmin = useMemo(()=>{ try { const u = JSON.parse(localStorage.getItem('hmsUser')||'null'); return String(u?.role||'').toLowerCase().includes('admin'); } catch { return false; } }, []);\r\n\r\n  const loadHotels = async () => {\r\n    try {\r\n      const res = await fetch('/api/hotels');\r\n      if(!res.ok) throw new Error();\r\n      const list = await res.json();\r\n      setHotels(Array.isArray(list)? list: []);\r\n    } catch { setHotels([]); }\r\n  };\r\n  const loadTypes = async (hid) => {\r\n    try {\r\n      const url = new URL('/api/room-types', window.location.origin);\r\n      if(hid) url.searchParams.set('hotelId', hid);\r\n      const res = await fetch(url);\r\n      if(!res.ok) throw new Error();\r\n      const list = await res.json();\r\n      setTypes(Array.isArray(list)? list: []);\r\n    } catch { setTypes([]); }\r\n  };\r\n\r\n  const loadRooms = async () => {\r\n    setLoading(true); setError('');\r\n    try {\r\n      const origin = window.location.origin;\r\n      const url = new URL('/api/rooms', origin);\r\n      if(q) url.searchParams.set('q', q);\r\n      if(hotelId) url.searchParams.set('hotelId', hotelId);\r\n  if(typeId) url.searchParams.set('typeId', typeId);\r\n  // Removed debug log for rooms fetch URL\r\n      const res = await fetch(url, { headers:{ 'Accept':'application/json' } });\r\n      if(!res.ok){\r\n        const text = await res.text().catch(()=> '');\r\n        throw new Error('Không tải được phòng' + (text? ' - ' + text.substring(0,120): '')); }\r\n      const j = await res.json();\r\n      if(!j || typeof j !== 'object') throw new Error('Phản hồi không hợp lệ');\r\n  const list = Array.isArray(j.items)? j.items: (Array.isArray(j.rooms)? j.rooms: []);\r\n  // Removed debug log for count of received rooms\r\n      setRooms(list.map(r => {\r\n        const imgsRaw = Array.isArray(r.images)? r.images : [];\r\n        const imgs = imgsRaw.map(im=> normalizeImage(im)).filter(Boolean);\r\n        const first = imgs.length? imgs[0] : null;\r\n        return {\r\n          id: r.id,\r\n          roomNumber: r.roomNumber || '-',\r\n            floor: r.floor || null,\r\n            hotelName: r.hotelName,\r\n            roomType: r.roomType,\r\n            price: r.price,\r\n            status: r.status || 'Available',\r\n            description: r.description || '',\r\n            image: first,\r\n            images: imgs\r\n        };\r\n      }));\r\n      // After loading rooms, fetch availability for the near-term (today->tomorrow) so UI disables booked rooms on initial render\r\n      try {\r\n  const today = localISODate;\r\n  const tomorrow = (()=>{ const d=new Date(); d.setDate(d.getDate()+1); const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${day}`; })();\r\n        const url = new URL('/api/rooms/availability', window.location.origin);\r\n        url.searchParams.set('checkIn', today);\r\n        url.searchParams.set('checkOut', tomorrow);\r\n        if(hotelId) url.searchParams.set('hotelId', hotelId);\r\n        const ares = await fetch(url.toString());\r\n        if(ares.ok){ const aj = await ares.json(); const map = new Map((aj.items||[]).map(x=> [Number(x.roomId), !!x.available]));\r\n          setRooms(prev => prev.map(r => ({ ...r, available: map.has(Number(r.id)) ? map.get(Number(r.id)) : true })));\r\n        }\r\n      } catch(e){ /* ignore availability fetch errors */ }\r\n    } catch(e){ console.error('[RoomsBrowse] loadRooms error', e); setError(e.message||'Lỗi tải dữ liệu'); setRooms([]);} finally { setLoading(false); }\r\n  };\r\n\r\n  useEffect(()=>{ loadHotels(); loadTypes(); }, []);\r\n  useEffect(()=>{ loadTypes(hotelId); }, [hotelId]);\r\n  useEffect(()=>{ loadRooms(); }, [q, hotelId, typeId]);\r\n\r\n  // Khi có restoredDraft từ HomePage (quay lại từ PaymentConfirm) -> tự động mở booking modal với dữ liệu cũ\r\n  useEffect(()=>{\r\n    if(restoredDraft && restoredDraft.rooms && Array.isArray(restoredDraft.rooms) && restoredDraft.rooms.length === 1 && !bookingOpen){\r\n      // Chỉ hỗ trợ khôi phục 1 phòng (trường hợp đặt nhanh) hiện tại\r\n      const r0 = restoredDraft.rooms[0];\r\n      // Tìm phòng tương ứng trong danh sách đã load (nếu room id có trong restored draft)\r\n      const found = rooms.find(r => Number(r.id) === Number(r0.id));\r\n      if(found){\r\n        // Mở booking modal với room found\r\n        setBookingRoom(found);\r\n        setBkCheckIn(restoredDraft.checkIn || '');\r\n        setBkCheckOut(restoredDraft.checkOut || '');\r\n        setBkAdults(Number(restoredDraft.adults||1));\r\n        setBkChildren(Number(restoredDraft.children||0));\r\n        setBookingOpen(true);\r\n        // Áp dụng lại promo nếu có (để user chủ động re-apply; thực tế cần validate lại)\r\n        if(restoredDraft.promo && restoredDraft.promo.code){\r\n          try { setPromoCode(String(restoredDraft.promo.code).toUpperCase()); } catch {}\r\n        }\r\n        // Xóa draft trong sessionStorage sau khi dùng để tránh lặp\r\n        try { sessionStorage.removeItem('hmsReturnBookingDraft'); } catch {}\r\n      }\r\n    }\r\n  }, [restoredDraft, rooms, bookingOpen]);\r\n\r\n  const statusLabel = (s) => {\r\n    const v = String(s||'').toLowerCase();\r\n    if(v==='available') return <span className=\"rb-badge available\">Trống</span>;\r\n    if(v==='occupied') return <span className=\"rb-badge booked\">Đang ở</span>;\r\n    if(v==='cleaning') return <span className=\"rb-badge maintenance\">Dọn dẹp</span>;\r\n    if(v==='maintenance') return <span className=\"rb-badge maintenance\">Bảo trì</span>;\r\n    return <span className=\"rb-badge available\">Trống</span>;\r\n  };\r\n\r\n  const openDetail = async (r) => {\r\n    setDetail(r);\r\n    setDetailFull(null);\r\n    if(!r?.id) return;\r\n    setDetailLoading(true);\r\n    try {\r\n      const res = await fetch(`/api/rooms/${r.id}`);\r\n      if(!res.ok) throw new Error('Không tải được chi tiết');\r\n      const j = await res.json();\r\n      setDetailFull(j.room || null);\r\n    } catch(e){ console.error('detail fetch error', e); } finally { setDetailLoading(false); }\r\n  };\r\n  const closeDetail = () => { setDetail(null); setDetailFull(null); };\r\n\r\n  // Open booking modal for a room but refresh latest room detail first to avoid duplicate bookings\r\n  const openBookingForRoom = async (r) => {\r\n    try { const uRole = (()=>{ try { const u = JSON.parse(localStorage.getItem('hmsUser')||'null'); return u?.role || 'Customer'; } catch { return 'Customer'; } })(); if(String(uRole).toLowerCase().includes('admin')) { setBkMsg('Tài khoản Admin không được phép đặt phòng'); setBookingOpen(true); setBookingRoom(null); return; } } catch {}\r\n    if(!r?.id) return;\r\n    setBkMsg('');\r\n    try {\r\n      // Try to fetch the latest room detail from server\r\n      const res = await fetch(`/api/rooms/${r.id}`);\r\n      if(!res.ok) throw new Error('Không tải được trạng thái phòng');\r\n      const j = await res.json();\r\n      const rf = j.room || null;\r\n      const imgsRaw = Array.isArray(rf?.images || r.images)? (rf?.images || r.images) : [];\r\n      const imgs = imgsRaw.map(im=> normalizeImage(im)).filter(Boolean);\r\n      const merged = {\r\n        ...r,\r\n        ...rf,\r\n        images: imgs,\r\n        image: imgs[0] || r.image,\r\n        // ensure status field exists and use server-provided status if present\r\n        status: (rf && (rf.status || rf.Status)) || r.status || 'Available'\r\n      };\r\n      // If user selected dates already, call availability endpoint to verify\r\n      let available = true;\r\n      if(bkCheckIn && bkCheckOut){\r\n        try {\r\n          const avRes = await fetch(`/api/rooms/${r.id}/availability?checkIn=${encodeURIComponent(bkCheckIn)}&checkOut=${encodeURIComponent(bkCheckOut)}`);\r\n          if(avRes.ok){ const av = await avRes.json(); available = !!av.available; }\r\n        } catch(e){ /* ignore availability check failure */ }\r\n      }\r\n      setBkAvailable(available);\r\n      setBookingRoom(merged);\r\n      // If the room is already in disabled status, show a message but still open modal so user can see details\r\n      if(isDisabledStatus(merged.status) || available === false){\r\n        setBkMsg('Phòng hiện không khả dụng (đã được đặt hoặc đang bảo trì). Không thể đặt.');\r\n      }\r\n      setBookingOpen(true);\r\n      setBkCheckIn(''); setBkCheckOut(''); setBkAdults(1); setBkChildren(0); setBkSubmitted(false);\r\n    } catch(e){\r\n      console.error('openBookingForRoom error', e);\r\n      // fallback to original object if fetch failed\r\n      setBookingRoom(r);\r\n      setBookingOpen(true);\r\n      setBkMsg('Không thể kiểm tra trạng thái phòng, vui lòng thử lại.');\r\n    }\r\n  };\r\n\r\n  const openReviews = async (r) => {\r\n    if(!r?.id) return;\r\n    setReviewsModal(r);\r\n    setReviewsLoading(true); setReviewsError(''); setReviewsData(null);\r\n    try {\r\n      const res = await fetch(`/api/rooms/${r.id}/reviews`);\r\n      if(!res.ok) throw new Error('Không tải được đánh giá');\r\n      const j = await res.json();\r\n      setReviewsData({ reviews: j.reviews||[], avgRating: j.avgRating||0 });\r\n    } catch(e){ setReviewsError(e.message||'Lỗi tải đánh giá'); } finally { setReviewsLoading(false); }\r\n  };\r\n  const closeReviews = () => { setReviewsModal(null); setReviewsData(null); };\r\n\r\n  useEffect(() => {\r\n    if (!pendingBooking) return;\r\n    const detail = pendingBooking.detail ? pendingBooking.detail : pendingBooking;\r\n    if (!detail) {\r\n      setPendingBooking(null);\r\n      return;\r\n    }\r\n    const roomId = detail.roomId ? Number(detail.roomId) : null;\r\n    if (roomId) {\r\n      openBookingForRoom({ id: roomId });\r\n      setPendingBooking(null);\r\n      return;\r\n    }\r\n    if (detail.name) {\r\n      const targetName = String(detail.name).toLowerCase();\r\n      const match = rooms.find(r => String(r.roomType || r.name || '').toLowerCase() === targetName);\r\n      if (match) {\r\n        openBookingForRoom(match);\r\n        setPendingBooking(null);\r\n        return;\r\n      }\r\n      if (!q || q.toLowerCase() !== targetName) {\r\n        setQ(detail.name);\r\n      }\r\n    }\r\n    setPendingBooking(null);\r\n  }, [pendingBooking, rooms, openBookingForRoom, q]);\r\n\r\n  // ESC key to close detail modal\r\n  useEffect(()=>{\r\n    const handler = (e) => {\r\n      if(e.key === 'Escape') {\r\n        if(bookingOpen){ setBookingOpen(false); setBookingRoom(null); }\r\n        else if(detail) closeDetail();\r\n        else if(onClose && inline) onClose();\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handler);\r\n    return ()=> window.removeEventListener('keydown', handler);\r\n  }, [detail, inline, onClose, bookingOpen]);\r\n\r\n  useEffect(()=>{ if(bookingOpen && bkFirstFieldRef.current){ try { bkFirstFieldRef.current.focus(); } catch {} } }, [bookingOpen]);\r\n\r\n  // Single horizontal scrollbar (top) refs\r\n  const topScrollRef = useRef(null);\r\n  const bodyScrollRef = useRef(null);\r\n  const syncScrolling = (source, target) => {\r\n    if(!source || !target) return;\r\n    if(target.scrollLeft !== source.scrollLeft) target.scrollLeft = source.scrollLeft;\r\n  };\r\n  useEffect(()=>{\r\n  const topEl = topScrollRef.current;\r\n  const botEl = bodyScrollRef.current;\r\n  if(!topEl || !botEl) return;\r\n  const onTop = () => syncScrolling(topEl, botEl);\r\n  const onBot = () => syncScrolling(botEl, topEl);\r\n  topEl.addEventListener('scroll', onTop);\r\n  botEl.addEventListener('scroll', onBot);\r\n    const resizeHandler = () => { // keep width track by forcing reflow\r\n      if(topEl && botEl) {\r\n        // match scrollLeft after resize\r\n        syncScrolling(botEl, topEl);\r\n      }\r\n    };\r\n    window.addEventListener('resize', resizeHandler);\r\n    return ()=>{ topEl.removeEventListener('scroll', onTop); botEl.removeEventListener('scroll', onBot); window.removeEventListener('resize', resizeHandler); };\r\n  }, [rooms.length]);\r\n\r\n  const loggedIn = isLoggedIn();\r\n\r\n  useEffect(() => {\r\n    if (!incomingBooking) return;\r\n    if (lastIncomingRef.current === incomingBooking) return;\r\n    lastIncomingRef.current = incomingBooking;\r\n    setPendingBooking(incomingBooking);\r\n  }, [incomingBooking]);\r\n  // Helper: validate promo code with server and return normalized promo object\r\n  const validatePromoServer = async (code) => {\r\n    if (!code) throw new Error('Thiếu mã');\r\n    try {\r\n  const q = new URL('/api/promotions/validate', window.location.origin);\r\n  q.searchParams.set('code', String(code).trim());\r\n  q.searchParams.set('amount', String(totalPrice || 0));\r\n  if (bookingRoom?.hotelId) q.searchParams.set('hotelId', String(bookingRoom.hotelId));\r\n  if (bookingRoom?.id) q.searchParams.set('roomIds', String(bookingRoom.id));\r\n      const r = await fetch(q.toString());\r\n      if (!r.ok) { const t = await r.json().catch(()=>({})); throw new Error(t.message || 'Mã không hợp lệ'); }\r\n  const j = await r.json();\r\n  // Removed debug log for promo validation response\r\n      // Prefer server-provided numbers. Local fields are fallback only.\r\n      const promo = j.promo || {};\r\n      const serverDiscount = typeof j.discount !== 'undefined' ? Number(j.discount) : null;\r\n      const serverFinal = typeof j.final !== 'undefined' ? Number(j.final) : null;\r\n      const dType = promo.discountType || j.discountType || null;\r\n      const dVal = Number(promo.discountValue ?? j.discount ?? 0);\r\n      // Enforce hotel mismatch RIGHT HERE (defensive, though server should already reject)\r\n      if (promo && promo.hotelId && bookingRoom?.hotelId && Number(promo.hotelId) !== Number(bookingRoom.hotelId)) {\r\n        throw new Error('Mã ưu đãi không áp dụng cho khách sạn này');\r\n      }\r\n      return {\r\n        code: (j.code || promo.code || String(code)).toString().toUpperCase(),\r\n        discount: serverDiscount !== null ? serverDiscount : Number(0),\r\n        discountType: dType,\r\n        discountValue: Number(dVal || 0),\r\n        final: serverFinal !== null ? serverFinal : Number(0),\r\n        raw: promo || null,\r\n        serverRaw: j\r\n      };\r\n    } catch (e) { throw e; }\r\n  };\r\n\r\n  // Auto-drop promo if user switches sang phòng khách sạn khác (phòng khác hotel) sau khi áp dụng\r\n  useEffect(() => {\r\n    if (!appliedPromo || !appliedPromo.raw) return;\r\n    const promoHotel = appliedPromo.raw.hotelId || appliedPromo.raw.HotelId || appliedPromo.raw.hotelID || appliedPromo.raw.HotelID || appliedPromo.raw.hotel || null;\r\n    if (promoHotel && bookingRoom?.hotelId && Number(promoHotel) !== Number(bookingRoom.hotelId)) {\r\n      setAppliedPromo(null);\r\n      showToast('Đã gỡ mã ưu đãi không thuộc khách sạn hiện tại', { type: 'warning', duration: 2600 });\r\n    }\r\n  }, [bookingRoom?.hotelId]);\r\n\r\n  function flashTotal() {\r\n    try {\r\n      const els = [];\r\n      const a = document.querySelectorAll('.rb-booking-summary span:last-child, .rb-booking-summary strong');\r\n      a.forEach(x => els.push(x));\r\n      if (!els.length) return;\r\n      els.forEach(el => { el.classList.add('total-highlight'); el.classList.add('apply'); });\r\n      clearTimeout(flashTotalRef.current);\r\n      flashTotalRef.current = setTimeout(() => { els.forEach(el => el.classList.remove('apply')); }, 600);\r\n    } catch (e) { /* ignore */ }\r\n  }\r\n\r\n  return (\r\n    <div className={inline? '' : 'home-root'} style={{ paddingTop: inline? 0 : 80 }}>\r\n      {!inline && (\r\n        <header className=\"home-header\" style={{ position:'sticky', top:0 }}>\r\n          <div className=\"home-header-left\">\r\n            <img src=\"/logo.png\" alt=\"logo\" className=\"home-header-logo\" />\r\n            <Link to=\"/\" className=\"home-header-title home-header-home-btn\">TRANG CHỦ</Link>\r\n          </div>\r\n          <div className=\"home-header-icons\">\r\n            <Link to=\"/login\" className=\"home-header-icon\" title=\"Đăng nhập\">\r\n              <img src=\"/icon-user.png\" alt=\"user\" className=\"home-header-icon-img\" />\r\n            </Link>\r\n          </div>\r\n        </header>\r\n      )}\r\n      <div style={{ padding: inline? '8px 14px 24px' : '24px 24px 40px' }}>\r\n        {inline && (\r\n          <button className=\"rb-btn gradient\" style={{ marginBottom:14, borderRadius:28 }} onClick={()=>onClose && onClose()}>&larr; Quay lại</button>\r\n        )}\r\n        {/* Promos list modal (quick booking) */}\r\n        {showPromosList && (\r\n          <div className=\"qr-overlay\" onClick={() => setShowPromosList(false)}>\r\n            <div className=\"qr-box\" onClick={(e) => e.stopPropagation()} style={{ width: 620, maxWidth: '96%' }}>\r\n              <div className=\"qr-title\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', gap: 8 }}>\r\n                <span>Danh sách Ưu đãi</span>\r\n                <button className=\"qr-close\" onClick={() => setShowPromosList(false)}>Đóng</button>\r\n              </div>\r\n              <div style={{ maxHeight: 420, overflowY: 'auto', padding: 8 }}>\r\n                {availablePromos.length === 0 ? (\r\n                  <div style={{ padding: 12, color: '#666' }}>Không có ưu đãi nào.</div>\r\n                ) : (\r\n                  availablePromos.map(p => (\r\n                    <div key={p.id} style={{ borderBottom: '1px solid #eee', padding: 10, display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n                      <div>\r\n                        <div style={{ fontWeight: 700 }}>{p.code} {p.description ? `— ${p.description}` : ''}</div>\r\n                        <div style={{ color: '#555', fontSize: 13 }}>\r\n                          {p.discountType === 'PERCENT' ? (`Giảm ${p.discountValue}%${p.maxDiscount ? ` (tối đa ${Number(p.maxDiscount).toLocaleString('vi-VN')}đ)` : ''}`) : (`Giảm ${Number(p.discountValue||0).toLocaleString('vi-VN')}đ`)}\r\n                          {p.minOrderAmount ? ` • Điều kiện: tối thiểu ${Number(p.minOrderAmount).toLocaleString('vi-VN')}đ` : ''}\r\n                        </div>\r\n                      </div>\r\n                      <div style={{ display: 'flex', gap: 8 }}>\r\n                        <button className=\"ph-btn\" onClick={async () => {\r\n                          try {\r\n                            const normalized = await validatePromoServer(p.code);\r\n                            setAppliedPromo(normalized);\r\n                            setPromoCode(normalized.code);\r\n                            setShowPromosList(false);\r\n                            flashTotal();\r\n                            showToast('Đã chọn ưu đãi: ' + normalized.code + ' • Giảm ' + normalized.discount.toLocaleString('vi-VN') + 'đ', { duration: 2000, type: 'success' });\r\n                          } catch (e) {\r\n                            showToast(e.message || 'Không áp dụng được ưu đãi này', { duration: 2400, type: 'error' });\r\n                          }\r\n                        }}>Chọn</button>\r\n                      </div>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n  <div className=\"rb-overlay-animate rb-panel\" onMouseDown={e=>e.stopPropagation()}>\r\n          <div className=\"rb-heading-wrap\">\r\n            <h2 className=\"rb-heading\">Danh sách phòng</h2>\r\n            <div className=\"rb-total-count\" aria-live=\"polite\">Tổng: {rooms.length} {loading && <span className=\"rb-muted\" style={{ fontWeight:400 }}>(Đang tải...)</span>}</div>\r\n          </div>\r\n          <div className=\"rb-filters\">\r\n            <div className=\"rb-field\">\r\n              <label>Từ khóa</label>\r\n              <input className=\"rb-input\" value={q} onChange={e=>setQ(e.target.value)} placeholder=\"Số phòng / loại / khách sạn\" />\r\n            </div>\r\n            <div className=\"rb-field\">\r\n              <label>Khách sạn</label>\r\n              <div className=\"rb-select-wrap\">\r\n                <select className=\"rb-select\" value={hotelId} onChange={e=>setHotelId(e.target.value)}>\r\n                  <option value=\"\">Tất cả</option>\r\n                  {hotels.map(h=> <option key={h.id} value={h.id}>{h.name}</option>)}\r\n                </select>\r\n              </div>\r\n            </div>\r\n            <div className=\"rb-field\">\r\n              <label>Hạng phòng</label>\r\n              <div className=\"rb-select-wrap\">\r\n                <select className=\"rb-select\" value={typeId} onChange={e=>setTypeId(e.target.value)}>\r\n                  <option value=\"\">Tất cả</option>\r\n                  {types.map(t=> <option key={t.id} value={t.id}>{t.name}</option>)}\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"rb-table-shell\">\r\n            <div className=\"rb-table-head\" style={{ gridTemplateColumns:'150px 130px 1.1fr 1.1fr 120px 120px 2fr 200px' }}>\r\n              <div className=\"rb-cell\">Ảnh</div>\r\n              <div className=\"rb-cell\">Phòng</div>\r\n              <div className=\"rb-cell\">Khách sạn</div>\r\n              <div className=\"rb-cell\">Loại phòng</div>\r\n              <div className=\"rb-cell\">Giá/đêm</div>\r\n              <div className=\"rb-cell\">Trạng thái</div>\r\n              <div className=\"rb-cell\">Mô tả</div>\r\n              <div className=\"rb-cell\">Hành động</div>\r\n            </div>\r\n            <div ref={bodyScrollRef} className=\"rb-table-body\">\r\n              {loading ? <div className=\"rb-row\"><div className=\"rb-cell\">Đang tải...</div></div> : error ? <div className=\"rb-row\"><div className=\"rb-cell\" style={{ color:'#b42318' }}>{error}</div></div> : rooms.length===0 ? <div className=\"rb-row\"><div className=\"rb-cell\">Không có phòng phù hợp.</div></div> : rooms.map((r, idx) => {\r\n                const roomLabel = r.roomNumber === '-' ? '-' : `${r.roomNumber}${r.floor ? ' - T' + r.floor : ''}`;\r\n                return (\r\n                  <div key={r.id} className=\"rb-row\" style={{ gridTemplateColumns:'150px 130px 1.1fr 1.1fr 120px 120px 2fr 200px', animationDelay: `${Math.min(idx, 12)*30}ms` }}>\r\n                    <div className=\"rb-cell image-cell\">\r\n                      <div className=\"rb-img-wrap\">\r\n                        {r.image ? <img src={r.image} alt=\"img\" /> : <div style={{ width:'100%', height:'100%', display:'flex', alignItems:'center', justifyContent:'center', fontSize:10, color:'#777' }}>No image</div>}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"rb-cell\" title={roomLabel}>{roomLabel}</div>\r\n                    <div className=\"rb-cell\">{r.hotelName}</div>\r\n                    <div className=\"rb-cell\">{r.roomType}</div>\r\n                    <div className=\"rb-cell\" style={{ fontSize:13 }}>{Number(r.price||0).toLocaleString('vi-VN')} VND</div>\r\n                    <div className=\"rb-cell\">{statusLabel(r.status)}</div>\r\n                    <div className=\"rb-cell rb-desc\" title={r.description}>{r.description || '—'}</div>\r\n                    <div className=\"rb-cell rb-actions\" style={{ gap:8 }}>\r\n                      <button\r\n                        className=\"rb-btn primary\"\r\n                        type=\"button\"\r\n                        disabled={isDisabledStatus(r.status) || (r.available === false) || isAdmin}\r\n                        onClick={() => {\r\n                          if (isAdmin) { showToast('Tài khoản Admin không được phép đặt phòng', { duration: 2200, type: 'warn' }); return; }\r\n                          if (isDisabledStatus(r.status) || (r.available === false)) return;\r\n                          openBookingForRoom(r);\r\n                        }}\r\n                      >\r\n                        {(isDisabledStatus(r.status) || (r.available === false)) ? 'ĐÃ ĐƯỢC ĐẶT' : 'Đặt phòng'}\r\n                      </button>\r\n                      <button className=\"rb-btn outline\" type=\"button\" onClick={() => openReviews(r)}>Đánh giá</button>\r\n                      <button className=\"rb-btn outline\" type=\"button\" onClick={() => openDetail(r)}>Chi tiết</button>\r\n                    </div>\r\n                  </div>\r\n                  );\r\n              })}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {detail && (\r\n          <div className=\"rb-modal-backdrop\" onMouseDown={(e)=>{ if(e.target===e.currentTarget) closeDetail(); }}>\r\n            <div className=\"rb-modal\" onMouseDown={e=>e.stopPropagation()}>\r\n              <button className=\"rb-modal-close\" onClick={closeDetail} aria-label=\"Đóng\">×</button>\r\n              <h3 style={{ marginTop:0, marginBottom:14, fontSize:'1.15rem' }}>\r\n                {detailFull?.roomNumber ? `${detailFull.roomNumber}${detailFull.floor? ' - T'+detailFull.floor:''}` : (detail.roomType)}\r\n              </h3>\r\n              {detailLoading && <div className=\"rb-muted\" style={{ fontSize:'.75rem' }}>Đang tải chi tiết...</div>}\r\n              <div style={{ display:'flex', gap:24, flexWrap:'wrap', opacity: detailLoading? .6: 1 }}>\r\n                <div style={{ flex:'0 0 260px' }}>\r\n                  <div className=\"rb-img-wrap\" style={{ width:'100%', height:180 }}>\r\n                    { (detailFull?.images && detailFull.images[0]) ? <img src={normalizeImage(detailFull.images[0])} alt=\"\" /> : (detail.image ? <img src={detail.image} alt=\"\" /> : <div style={{ width:'100%', height:'100%', display:'flex', alignItems:'center', justifyContent:'center', fontSize:12, color:'#666' }}>No image</div>) }\r\n                  </div>\r\n                  <div style={{ marginTop:10, fontSize:'.75rem', lineHeight:1.3 }}>\r\n                    <div><strong>Loại:</strong> {detailFull?.roomType || detail.roomType}</div>\r\n                    <div><strong>Giá:</strong> {Number((detailFull?.price ?? detail.price)||0).toLocaleString('vi-VN')} VND/đêm</div>\r\n                    {detailFull?.maxAdults != null && <div><strong>Người lớn tối đa:</strong> {detailFull.maxAdults}</div>}\r\n                    {detailFull?.maxChildren != null && <div><strong>Trẻ em tối đa:</strong> {detailFull.maxChildren}</div>}\r\n                    <div><strong>Trạng thái:</strong> {statusLabel(detailFull?.status || detail.status)}</div>\r\n                  </div>\r\n                  {detailFull?.images?.length > 1 && (\r\n                    <div style={{ display:'flex', gap:6, flexWrap:'wrap', marginTop:10 }}>\r\n                      {detailFull.images.slice(1,6).map((im,i)=>(\r\n                        <div key={i} className=\"rb-img-wrap\" style={{ width:54, height:40 }}>\r\n                          <img src={normalizeImage(im)} alt=\"thumb\" />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div style={{ flex:'1 1 300px', minWidth:240 }}>\r\n                  <p style={{ whiteSpace:'pre-wrap', lineHeight:1.45, fontSize:'.78rem' }}>{detailFull?.description || detail.description || 'Không có mô tả.'}</p>\r\n                </div>\r\n              </div>\r\n              <div style={{ marginTop:22, display:'flex', gap:10, justifyContent:'flex-end' }}>\r\n                <button className=\"rb-btn primary\" disabled={isDisabledStatus((detailFull?.status || detail.status || '')) || (detailFull?.available === false) || (detail?.available === false)} onClick={()=>{ if(isDisabledStatus((detailFull?.status || detail.status || '')) || (detailFull?.available === false) || (detail?.available === false)) return; openBookingForRoom(detailFull || detail); }}>\r\n                  {(isDisabledStatus((detailFull?.status || detail.status || '')) || (detailFull?.available === false) || (detail?.available === false)) ? 'ĐÃ ĐƯỢC ĐẶT' : 'Đặt phòng'}\r\n                </button>\r\n                <button className=\"rb-btn outline\" onClick={closeDetail}>Đóng</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {bookingOpen && bookingRoom && (\r\n          <div className=\"rb-modal-backdrop\" onMouseDown={(e)=>{ if(e.target===e.currentTarget) { setBookingOpen(false); setBookingRoom(null); } }}>\r\n            <div className=\"rb-modal rb-booking-fast-animate\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Đặt phòng nhanh\" onMouseDown={e=>e.stopPropagation()} style={{ maxWidth:600 }}>\r\n              <button className=\"rb-modal-close\" onClick={()=>{ setBookingOpen(false); setBookingRoom(null); }} aria-label=\"Đóng\">×</button>\r\n              <div className=\"rb-booking-fast\">\r\n                <h3>Đặt phòng nhanh</h3>\r\n                <div className=\"rb-booking-room-image\" style={{ marginBottom:14 }}>\r\n                  <div className=\"rb-img-wrap\" style={{ width:'100%', height:160, borderRadius:14, overflow:'hidden', boxShadow:'0 2px 6px rgba(0,0,0,0.15)' }}>\r\n                    { (bookingRoom.images && bookingRoom.images[0]) ? <img src={bookingRoom.images[0]} alt=\"Phòng\" /> : (bookingRoom.image ? <img src={bookingRoom.image} alt=\"Phòng\" /> : <div style={{ width:'100%', height:'100%', display:'flex', alignItems:'center', justifyContent:'center', fontSize:12, color:'#666' }}>Không có ảnh</div>) }\r\n                  </div>\r\n                  {bookingRoom.images && bookingRoom.images.length > 1 && (\r\n                    <div style={{ display:'flex', gap:6, marginTop:8, flexWrap:'wrap' }}>\r\n                      {bookingRoom.images.slice(1,6).map((im,i)=>(\r\n                        <button key={i} type=\"button\" onClick={()=>{ const copy=[...bookingRoom.images]; const main=copy[0]; copy[0]=copy[i+1]; copy[i+1]=main; setBookingRoom({ ...bookingRoom, images: copy, image: copy[0] }); }} className=\"rb-img-wrap\" style={{ width:54, height:40, cursor:'pointer', opacity:.9 }} title=\"Xem ảnh\">\r\n                          <img src={im} alt=\"thumb\" />\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div className=\"rb-booking-meta\">\r\n                  <strong>Phòng:</strong> {bookingRoom.roomNumber === '-' ? bookingRoom.roomType : bookingRoom.roomNumber}{bookingRoom.floor? ` • Tầng ${bookingRoom.floor}`:''}<br />\r\n                  <strong>Loại:</strong> {bookingRoom.roomType}<br />\r\n                  <strong>Giá:</strong> {Number(bookingRoom.price||0).toLocaleString('vi-VN')} VND/đêm\r\n                </div>\r\n                <form onSubmit={async (e)=>{ \r\n                  e.preventDefault(); \r\n                  setBkMsg(''); \r\n                  if(!authEmail){ setBkMsg('Vui lòng đăng nhập để đặt phòng.'); return; }\r\n                  // final server-side availability check to avoid race conditions\r\n                  if(!submitEnabled){ return; }\r\n                  try {\r\n                    if(bookingRoom && bookingRoom.id){\r\n                      const avUrl = `/api/rooms/${bookingRoom.id}/availability?checkIn=${encodeURIComponent(bkCheckIn)}&checkOut=${encodeURIComponent(bkCheckOut)}`;\r\n                      const chkRes = await fetch(avUrl);\r\n                      if(chkRes.ok){ const chk = await chkRes.json(); if(chk && chk.available === false){ setBkMsg('Phòng không còn khả dụng cho khoảng ngày chọn. Vui lòng chọn phòng khác.'); return; } }\r\n                    }\r\n                  } catch(err){ /* ignore check failure, proceed with caution */ }\r\n                  try { \r\n                    setBkLoading(true);\r\n                    setBkSubmitted(true);\r\n                    // Tạo token và summary tương tự RoomTypeInline flow để chuyển sang trang thanh toán\r\n                    const token = Math.random().toString(36).slice(2) + Date.now().toString(36);\r\n                    const pad2 = (n)=> String(n).padStart(2,'0');\r\n                    const nowD = new Date();\r\n                    const bookingCode = `HMS${nowD.getFullYear()}${pad2(nowD.getMonth()+1)}${pad2(nowD.getDate())}`;\r\n                    const roomNames = `Phòng ${bookingRoom.roomNumber}${bookingRoom.floor?` • Tầng ${bookingRoom.floor}`:''}`;\r\n                    const summary = {\r\n                      token,\r\n                      code: bookingCode,\r\n                      hotelId: bookingRoom.hotelId || null,\r\n                      hotel: bookingRoom.hotelName || '',\r\n                      roomType: bookingRoom.roomType || '',\r\n                      roomNames,\r\n                      checkIn: bkCheckIn,\r\n                      checkOut: bkCheckOut,\r\n                      checkInTime: '14:00',\r\n                      checkOutTime: '12:00',\r\n                      payMethod: bkPayMethod || 'MOMO',\r\n                      userEmail: authEmail,\r\n                      adults: bkAdults,\r\n                      children: bkChildren,\r\n                      rooms: [{ id: bookingRoom.id, number: bookingRoom.roomNumber, floor: bookingRoom.floor, price: bookingRoom.price, name: bookingRoom.roomNumber, adults: bkAdults, children: bkChildren }],\r\n                      amount: (Number(bookingRoom.price||0) * nights) || 0,\r\n                    };\r\n                    // attach promo data if applied (server-validated normalized object)\r\n                    if (appliedPromo && appliedPromo.code) {\r\n                      summary.promo = {\r\n                        code: appliedPromo.code,\r\n                        discount: Number(appliedPromo.discount || 0),\r\n                        discountType: appliedPromo.discountType || (appliedPromo.raw && appliedPromo.raw.discountType) || null,\r\n                        discountValue: Number(appliedPromo.discountValue || 0),\r\n                        final: appliedPromo.final || null,\r\n                        raw: appliedPromo.raw || null\r\n                      };\r\n                    }\r\n                    // promotions removed\r\n                    try { localStorage.setItem('hmsBooking:'+token, JSON.stringify(summary)); } catch {}\r\n                    const q = [\r\n                      `token=${encodeURIComponent(token)}`,\r\n                      `code=${encodeURIComponent(summary.code)}`,\r\n                      // pass gross amount; discount is read from summary on PaymentConfirm\r\n                      `amount=${encodeURIComponent(summary.amount)}`,\r\n                      `hid=${encodeURIComponent(summary.hotelId||'')}`,\r\n                      `rn=${encodeURIComponent(roomNames)}`,\r\n                      `rt=${encodeURIComponent(summary.roomType||'')}`,\r\n                      `ci=${encodeURIComponent(summary.checkIn||'')}`,\r\n                      `co=${encodeURIComponent(summary.checkOut||'')}`,\r\n                      `ad=${encodeURIComponent(summary.adults)}`,\r\n                      `ch=${encodeURIComponent(summary.children)}`\r\n                    ].join('&');\r\n                    // Lưu draft vào sessionStorage để nếu user quay lại có thể khôi phục\r\n                    try { sessionStorage.setItem('hmsReturnBookingDraft', JSON.stringify(summary)); } catch {}\r\n                    const originPayload = encodeURIComponent(JSON.stringify({ __roomsBookingDraft: summary }));\r\n                    window.location.href = '/payment/confirm?'+q+`&origin=${originPayload}`;\r\n                  } catch(err){\r\n                    setBkMsg(err.message||'Lỗi khởi tạo thanh toán');\r\n                    setBkSubmitted(false);\r\n                  } finally { setBkLoading(false); }\r\n                }}>\r\n                  <div className=\"rb-booking-grid\">\r\n                    <div className=\"rb-booking-row\">\r\n                      <div className=\"rb-booking-field\">\r\n                        <label>Ngày nhận</label>\r\n                        <input\r\n                          ref={bkFirstFieldRef}\r\n                            type=\"date\"\r\n                            min={localISODate}\r\n                          value={bkCheckIn}\r\n                          onChange={e=>{\r\n                            const v = e.target.value;\r\n                            setBkCheckIn(v);\r\n                            // If check-out is before/equals new check-in, reset check-out\r\n                            if(bkCheckOut && bkCheckOut <= v){\r\n                              setBkCheckOut('');\r\n                            }\r\n                          }}\r\n                          required\r\n                        />\r\n                      </div>\r\n                      <div className=\"rb-booking-field\">\r\n                        <label>Ngày trả</label>\r\n                        <input\r\n                          type=\"date\"\r\n                          min={bkCheckIn ? (()=>{ const d=new Date(bkCheckIn); d.setDate(d.getDate()+1); const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${day}`; })() : (()=>{ const d=new Date(); d.setDate(d.getDate()+1); const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${day}`; })()}\r\n                          value={bkCheckOut}\r\n                          onChange={e=>setBkCheckOut(e.target.value)}\r\n                          disabled={!bkCheckIn}\r\n                          required\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"rb-booking-row\">\r\n                      <div className=\"rb-booking-field\">\r\n                        <label>Người lớn</label>\r\n                        <select\r\n                          value={bkAdults}\r\n                          onChange={e=>setBkAdults(Number(e.target.value))}\r\n                        >\r\n                          {Array.from({ length: (bookingRoom.maxAdults || 2) }, (_,i)=> i+1).map(v=> (\r\n                            <option key={v} value={v}>{v}</option>\r\n                          ))}\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"rb-booking-field\">\r\n                        <label>Trẻ em</label>\r\n                        <select\r\n                          value={bkChildren}\r\n                          onChange={e=>setBkChildren(Number(e.target.value))}\r\n                        >\r\n                          {Array.from({ length: (bookingRoom.maxChildren || 0) + 1 }, (_,i)=> i).map(v=> (\r\n                            <option key={v} value={v}>{v}</option>\r\n                          ))}\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n                    {dateError && <div className=\"rb-msg error\" role=\"alert\">{dateError}</div>}\r\n                    {(!dateError && bkCheckIn && bkCheckOut && bkAvailable===false) && <div className=\"rb-msg error\" role=\"alert\">Phòng không khả dụng cho khoảng ngày đã chọn.</div>}\r\n                    {nights > 0 && (\r\n                      <div className=\"rb-booking-summary\" aria-live=\"polite\">\r\n                        <span><strong>{nights}</strong> đêm x {Number(bookingRoom.price||0).toLocaleString('vi-VN')} VND</span>\r\n                        <span style={{ fontWeight:800 }}>\r\n                          {appliedPromo ? (\r\n                            <span style={{ display:'flex', flexDirection:'column', alignItems:'flex-end' }}>\r\n                              <span style={{ fontSize:12, color:'#6b7280', textDecoration: 'line-through' }}>{Number(totalPrice).toLocaleString('vi-VN')} VND</span>\r\n                              <span style={{ fontWeight:900, color:'#111' }}>{Number(finalPrice).toLocaleString('vi-VN')} VND</span>\r\n                            </span>\r\n                          ) : (\r\n                            <span>{Number(totalPrice).toLocaleString('vi-VN')} VND</span>\r\n                          )}\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                    <div className=\"rb-booking-promo\" style={{ marginTop:8 }}>\r\n                      <div style={{ display: 'flex', gap: 8, alignItems: 'center', flexWrap: 'wrap' }}>\r\n                        <input placeholder=\"Nhập mã ưu đãi\" value={promoCode} onChange={(e)=> setPromoCode(e.target.value.toUpperCase())} style={{ padding: '8px 10px', borderRadius: 8, border: '1px solid #ddd' }} />\r\n                        <button type=\"button\" className=\"ph-btn\" disabled={!(totalPrice>0)} onClick={async ()=>{\r\n                          if (!(totalPrice>0)) { showToast('Vui lòng chọn phòng và ngày để áp dụng mã ưu đãi', { duration: 2000, type: 'warn' }); return; }\r\n                          try {\r\n                            const normalized = await validatePromoServer(promoCode.trim());\r\n                            setAppliedPromo(normalized);\r\n                            setPromoCode(normalized.code);\r\n                            flashTotal();\r\n                            showToast('Áp dụng mã: ' + normalized.code + ' • Giảm ' + normalized.discount.toLocaleString('vi-VN') + 'đ', { duration: 2000, type: 'success' });\r\n                          } catch (e) {\r\n                            setAppliedPromo(null);\r\n                            showToast(e.message || 'Lỗi kiểm tra mã', { duration: 2400, type: 'error' });\r\n                          }\r\n                        }}>Áp dụng</button>\r\n                        <button type=\"button\" className=\"ph-btn ph-btn--secondary\" disabled={!(totalPrice>0)} onClick={async ()=>{\r\n                          if (!(totalPrice>0)) { showToast('Vui lòng chọn phòng và ngày để xem ưu đãi', { duration: 2000, type: 'warn' }); return; }\r\n                          try {\r\n                            setPromoLoading(true); setPromoLoadError('');\r\n                            const listUrl = new URL('/api/promotions', window.location.origin);\r\n                            if (bookingRoom?.hotelId) listUrl.searchParams.set('hotelId', String(bookingRoom.hotelId));\r\n                            if (bookingRoom?.id) listUrl.searchParams.set('roomIds', String(bookingRoom.id));\r\n                            const r = await fetch(listUrl.toString());\r\n                            if(!r.ok) { const txt = await r.text().catch(()=>null); throw new Error(txt || 'Không lấy được danh sách'); }\r\n                            const j = await r.json(); setAvailablePromos(Array.isArray(j.items)? j.items : []); setShowPromosList(true);\r\n                          } catch(e){ setPromoLoadError(e.message || 'Lỗi tải ưu đãi'); showToast(e.message||'Lỗi tải ưu đãi', { duration: 2600, type: 'error' }); }\r\n                          finally { setPromoLoading(false); }\r\n                        }}>Chọn</button>\r\n                        {appliedPromo && (\r\n                          <div style={{ fontWeight:800 }}>\r\n                            {appliedPromo.code} • {appliedPromo.discountType === 'PERCENT' ? (\r\n                              `Giảm ${Number(appliedPromo.discount||0).toLocaleString('vi-VN')} (- ${appliedPromo.discountValue}%)`\r\n                            ) : (\r\n                              `Giảm ${Number(appliedPromo.discount||0).toLocaleString('vi-VN')}đ`\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                        {promoLoading && <div style={{ color:'#2563eb', fontSize:13 }}>Đang tải ưu đãi...</div>}\r\n                        {promoLoadError && <div style={{ color:'#b42318', fontSize:13 }}>{promoLoadError}</div>}\r\n                      </div>\r\n                    </div>\r\n                    {(!authEmail) && <div className=\"rb-msg error\">Vui lòng đăng nhập để đặt phòng.</div>}\r\n                    {bkMsg && <div className={`rb-msg ${bkMsg.includes('thành công')? 'success':'error'}`}>{bkMsg}</div>}\r\n                    <div className=\"rb-booking-row\" style={{ marginTop:4 }}>\r\n                      <div className=\"rb-booking-field\" style={{ flex: '1 1 100%' }}>\r\n                        <label>Phương thức thanh toán</label>\r\n                        <select value={bkPayMethod} onChange={e=>setBkPayMethod(e.target.value)}>\r\n                          <option value=\"MOMO\">Ví điện tử MOMO</option>\r\n                          <option value=\"ZALOPAY\">ZaloPay</option>\r\n                          <option value=\"VNPAY\">VNPay</option>\r\n                          <option value=\"CARD\">Thẻ tín dụng/ghi nợ</option>\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n                    <label className=\"rb-terms\">\r\n                      <input type=\"checkbox\" style={{ marginTop:2 }} checked={bkAgree} onChange={e=>setBkAgree(e.target.checked)} />\r\n                      <span>Vui lòng đọc kĩ và đồng ý với điều khoản bằng cách đánh dấu vào ô bên cạnh</span>\r\n                    </label>\r\n                    <div className=\"rb-booking-actions\">\r\n                      <button type=\"button\" className=\"rb-btn outline\" onClick={()=>{ setBookingOpen(false); setBookingRoom(null); }}>Hủy</button>\r\n                      <button type=\"submit\" className=\"rb-btn primary\" disabled={!submitEnabled || isDisabledStatus(bookingRoom?.status) || (bookingRoom?.available === false)}>\r\n                        {(isDisabledStatus(bookingRoom?.status) || (bookingRoom?.available === false)) ? 'ĐÃ ĐƯỢC ĐẶT' : (bkLoading? 'Đang xử lý...' : 'Thanh toán') }\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n                <div className=\"rb-booking-note\">Cần nhiều phòng hoặc tùy chọn nâng cao? Vào giao diện hạng phòng để chọn nhiều phòng và phương thức thanh toán.</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {reviewsModal && (\r\n          <div className=\"rb-modal-backdrop\" onMouseDown={(e)=>{ if(e.target===e.currentTarget) closeReviews(); }}>\r\n            <div className=\"rb-modal\" onMouseDown={e=>e.stopPropagation()} style={{ maxWidth:860 }}>\r\n              <button className=\"rb-modal-close\" onClick={closeReviews} aria-label=\"Đóng\">×</button>\r\n              <h3 style={{ marginTop:0, marginBottom:10, fontSize:'1.05rem' }}>Đánh giá phòng {reviewsModal.roomNumber || reviewsModal.roomType}</h3>\r\n              {reviewsLoading && <div className=\"rb-muted\" style={{ fontSize:'.75rem' }}>Đang tải đánh giá...</div>}\r\n              {reviewsError && <div style={{ color:'#b42318', fontSize:'.75rem' }}>{reviewsError}</div>}\r\n              {(!reviewsLoading && !reviewsError) && (\r\n                <div style={{ marginTop:6 }}>\r\n                  <div style={{ fontSize:'.8rem', marginBottom:10 }}>\r\n                    Trung bình: <strong>{(reviewsData?.avgRating||0).toFixed(1)}</strong>/5 ⭐\r\n                  </div>\r\n                  <div style={{ maxHeight:380, overflow:'auto', paddingRight:4, border:'1px solid #e5e7eb', borderRadius:8 }}>\r\n                    {(!reviewsData || !reviewsData.reviews?.length) && <div className=\"rb-muted\" style={{ padding:12, fontSize:'.75rem' }}>Chưa có đánh giá.</div>}\r\n                    {reviewsData?.reviews?.map(rv => (\r\n                      <div key={rv.id} style={{ padding:'10px 12px', borderBottom:'1px solid #eef2f6', fontSize:'.75rem', lineHeight:1.35 }}>\r\n                        <div style={{ display:'flex', justifyContent:'space-between', gap:12 }}>\r\n                          <strong>{rv.customer}</strong>\r\n                          <span style={{ color:'#f59e0b', fontWeight:600 }}>{rv.rating.toFixed(1)}⭐</span>\r\n                        </div>\r\n                        <div style={{ marginTop:4 }}>{rv.comment || <span className=\"rb-muted\">(Không có nội dung)</span>}</div>\r\n                        <div style={{ marginTop:4, fontSize:'.65rem', color:'#64748b' }}>{new Date(rv.createdAt).toLocaleString('vi-VN')}</div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <div style={{ marginTop:18, textAlign:'right' }}>\r\n                <button className=\"rb-btn outline\" onClick={closeReviews}>Đóng</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}