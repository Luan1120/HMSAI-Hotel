{"ast":null,"code":"var _jsxFileName = \"D:\\\\Git\\\\HMSAI-Hotel\\\\client\\\\src\\\\PaymentSuccess.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { Link, useSearchParams, useNavigate } from 'react-router-dom';\nimport './HomePage.css';\nimport { jsPDF } from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport { isLoggedIn } from './auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DEPOSIT_RATE = 0.2;\nexport default function PaymentSuccess() {\n  _s();\n  const [params] = useSearchParams();\n  const navigate = useNavigate();\n  const token = params.get('token') || '';\n  const amount = Number(params.get('amount') || 0);\n  const code = params.get('code') || '';\n  const rt = params.get('rt') || '';\n  const rn = params.get('rn') || '';\n  const ci = params.get('ci') || '';\n  const co = params.get('co') || '';\n  const ad = Number(params.get('ad') || 0);\n  const ch = Number(params.get('ch') || 0);\n  const [hotelName, setHotelName] = useState('');\n  const summary = useMemo(() => {\n    try {\n      const raw = token ? localStorage.getItem('hmsBooking:' + token) : null;\n      if (raw) {\n        const parsed = JSON.parse(raw);\n        if (parsed) {\n          if (typeof parsed.depositAmount !== 'undefined') parsed.depositAmount = Number(parsed.depositAmount);\n          if (typeof parsed.finalAmount !== 'undefined') parsed.finalAmount = Number(parsed.finalAmount);\n        }\n        return parsed;\n      }\n    } catch {}\n    return {\n      token,\n      code,\n      amount,\n      roomType: rt,\n      roomNames: rn,\n      checkIn: ci,\n      checkOut: co,\n      adults: ad,\n      children: ch,\n      hotelId: Number(params.get('hid') || 0) || null,\n      hotel: '',\n      checkInTime: '14:00',\n      checkOutTime: '12:00',\n      finalAmount: Number(amount || 0),\n      depositAmount: Math.round(Number(amount || 0) * DEPOSIT_RATE)\n    };\n  }, [token, code, amount, rt, rn, ci, co, ad, ch, params]);\n  const finalTotal = useMemo(() => {\n    const rawTotal = typeof (summary === null || summary === void 0 ? void 0 : summary.finalAmount) === 'number' ? summary.finalAmount : Number((summary === null || summary === void 0 ? void 0 : summary.amount) || amount || 0);\n    return Math.max(0, Math.round(rawTotal || 0));\n  }, [summary, amount]);\n  const depositPaid = useMemo(() => {\n    if (typeof (summary === null || summary === void 0 ? void 0 : summary.depositAmount) === 'number' && !Number.isNaN(summary.depositAmount)) {\n      return Math.max(0, Math.round(summary.depositAmount));\n    }\n    return Math.round(finalTotal * DEPOSIT_RATE);\n  }, [summary, finalTotal]);\n  const remainingBalance = useMemo(() => {\n    const remaining = Math.round(Number(finalTotal || 0) - Number(depositPaid || 0));\n    return remaining > 0 ? remaining : 0;\n  }, [finalTotal, depositPaid]);\n  useEffect(() => {\n    let cancelled = false;\n    const setName = name => {\n      if (!cancelled) setHotelName(name);\n    };\n    const fetchHotel = hid => {\n      if (!hid) return;\n      fetch(`/api/hotels/${hid}`).then(r => r.ok ? r.json() : null).then(j => {\n        if (j && j.name) setName(j.name);\n      }).catch(() => {});\n    };\n    if (!hotelName) {\n      const hidParam = Number(params.get('hid') || 0) || null;\n      if (summary.hotelId) {\n        fetchHotel(summary.hotelId);\n      } else if (hidParam) {\n        fetchHotel(hidParam);\n      } else if (summary.roomType) {\n        fetch(`/api/room-types/${encodeURIComponent(summary.roomType)}/rooms`).then(r => r.ok ? r.json() : null).then(j => {\n          if (j && j.roomType) {\n            if (j.roomType.hotelName && !hotelName) setName(j.roomType.hotelName);\n            if (j.roomType.hotelId) fetchHotel(j.roomType.hotelId);\n          }\n        }).catch(() => {});\n      }\n    }\n    return () => {\n      cancelled = true;\n    };\n  }, [summary.hotelId, summary.roomType, hotelName, params]);\n  const detailsHref = useMemo(() => {\n    const q = new URLSearchParams({\n      amount: String(finalTotal || summary.amount || amount || 0),\n      code: String(summary.code || code || ''),\n      rn: String(summary.roomNames || rn || ''),\n      rt: String(summary.roomType || rt || ''),\n      ci: String(summary.checkIn || ci || ''),\n      co: String(summary.checkOut || co || ''),\n      ad: String(summary.adults || ad || 0),\n      ch: String(summary.children || ch || 0),\n      hid: String(summary.hotelId || params.get('hid') || '')\n    });\n    return `/booking/${token || summary.token || ''}?${q.toString()}`;\n  }, [summary, token, amount, code, rn, ci, co, ad, ch, params, finalTotal]);\n  const toBase64 = buf => {\n    let binary = '';\n    const bytes = new Uint8Array(buf);\n    const len = bytes.byteLength;\n    for (let i = 0; i < len; i++) binary += String.fromCharCode(bytes[i]);\n    return btoa(binary);\n  };\n  const ensurePdfFonts = async () => {\n    const REG_KEY = 'hmsPdfFont:DejaVu-Regular';\n    const BOLD_KEY = 'hmsPdfFont:DejaVu-Bold';\n    let regular = '';\n    let bold = '';\n    try {\n      regular = localStorage.getItem(REG_KEY) || '';\n    } catch {}\n    try {\n      bold = localStorage.getItem(BOLD_KEY) || '';\n    } catch {}\n    const fetchFont = async url => {\n      const res = await fetch(url, {\n        mode: 'cors'\n      });\n      if (!res.ok) throw new Error('Font fetch failed');\n      const buf = await res.arrayBuffer();\n      return toBase64(buf);\n    };\n    if (!regular) {\n      regular = await fetchFont('https://raw.githubusercontent.com/dejavu-fonts/dejavu-fonts/master/ttf/DejaVuSans.ttf');\n      try {\n        localStorage.setItem(REG_KEY, regular);\n      } catch {}\n    }\n    if (!bold) {\n      bold = await fetchFont('https://raw.githubusercontent.com/dejavu-fonts/dejavu-fonts/master/ttf/DejaVuSans-Bold.ttf');\n      try {\n        localStorage.setItem(BOLD_KEY, bold);\n      } catch {}\n    }\n    return {\n      regular,\n      bold\n    };\n  };\n  const printReceipt = async () => {\n    const hotel = hotelName || summary.hotel || '';\n    const file = `${summary.code || token || 'receipt'}.pdf`;\n    const container = document.createElement('div');\n    container.style.position = 'fixed';\n    container.style.left = '-99999px';\n    container.style.top = '0';\n    container.style.width = '560px';\n    container.style.background = '#fff';\n    container.style.padding = '24px 16px';\n    container.style.fontFamily = \"'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'DejaVu Sans', 'Liberation Sans', sans-serif\";\n    container.innerHTML = `\n      <div>\n        <div style=\"font-weight:800;font-size:22px;margin:0 0 10px 0;\">Phiếu xác nhận đặt phòng</div>\n        <div style=\"height:1px;background:#e6e6e6;margin:8px 0 14px 0;\"></div>\n        <div style=\"display:grid;grid-template-columns:180px 1fr;gap:10px 16px;font-size:13px;\">\n          <div style=\"color:#666;font-weight:700;\">Mã đặt phòng</div>\n          <div style=\"font-weight:800;\">${String(summary.code || token)}</div>\n          <div style=\"color:#666;font-weight:700;\">Khách sạn</div>\n          <div style=\"font-weight:800;\">${hotel || '—'}</div>\n          <div style=\"color:#666;font-weight:700;\">Ngày nhận</div>\n          <div style=\"font-weight:800;\">${summary.checkIn} - ${summary.checkInTime}</div>\n          <div style=\"color:#666;font-weight:700;\">Ngày trả</div>\n          <div style=\"font-weight:800;\">${summary.checkOut} - ${summary.checkOutTime}</div>\n          <div style=\"color:#666;font-weight:700;\">Phòng</div>\n          <div style=\"font-weight:800;\">${String(summary.roomNames || summary.roomType || '—')}</div>\n          <div style=\"color:#666;font-weight:700;\">Khách</div>\n          <div style=\"font-weight:800;\">${summary.adults || 0} người lớn${summary.children ? ` • ${summary.children} trẻ em` : ''}</div>\n          <div style=\"color:#666;font-weight:700;\">Tổng cộng</div>\n          <div style=\"font-weight:800;\">${Number(finalTotal || 0).toLocaleString('vi-VN')} VND</div>\n          <div style=\"color:#666;font-weight:700;\">Đặt cọc đã thanh toán</div>\n          <div style=\"font-weight:800;\">${Number(depositPaid || 0).toLocaleString('vi-VN')} VND</div>\n          <div style=\"color:#666;font-weight:700;\">Còn lại</div>\n          <div style=\"font-weight:800;\">${Number(remainingBalance || 0).toLocaleString('vi-VN')} VND</div>\n        </div>\n        <div style=\"margin-top:10px;font-weight:800;\">(ĐÃ THANH TOÁN ĐẶT CỌC 20%)</div>\n        <div style=\"margin-top:8px;font-size:12;color:#475569;\">Vui lòng thanh toán phần còn lại khi nhận phòng.</div>\n      </div>`;\n    document.body.appendChild(container);\n    try {\n      const canvas = await html2canvas(container, {\n        scale: 2,\n        useCORS: true,\n        backgroundColor: '#ffffff'\n      });\n      const imgData = canvas.toDataURL('image/png');\n      const pdf = new jsPDF({\n        unit: 'pt',\n        format: 'a4'\n      });\n      const pageWidth = pdf.internal.pageSize.getWidth();\n      const pageHeight = pdf.internal.pageSize.getHeight();\n      const imgWidth = Math.min(540, pageWidth - 56 * 2);\n      const imgHeight = canvas.height * imgWidth / canvas.width;\n      const x = (pageWidth - imgWidth) / 2;\n      let y = 56;\n      if (imgHeight > pageHeight - 112) {\n        // Multi-page if content longer than one page\n        let remaining = imgHeight;\n        let offset = 0;\n        while (remaining > 0) {\n          pdf.addImage(imgData, 'PNG', x, y - offset, imgWidth, imgHeight);\n          remaining -= pageHeight - 112;\n          offset += pageHeight - 112;\n          if (remaining > 0) {\n            pdf.addPage();\n          }\n        }\n      } else {\n        pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);\n      }\n      pdf.save(file);\n    } finally {\n      document.body.removeChild(container);\n    }\n  };\n\n  // Save to DB on mount (once)\n  useEffect(() => {\n    if (!isLoggedIn()) {\n      try {\n        sessionStorage.setItem('hmsRedirectAfterLogin', window.location.pathname + window.location.search);\n      } catch {}\n      navigate('/login');\n      return; // skip saving\n    }\n    const save = async () => {\n      try {\n        const raw = token ? localStorage.getItem('hmsBooking:' + token) : null;\n        if (!raw) return;\n        const s = JSON.parse(raw);\n        let email = s.userEmail || '';\n        if (!email) {\n          try {\n            const rawUser = localStorage.getItem('hmsUser');\n            if (rawUser) email = JSON.parse(rawUser).email || '';\n          } catch {}\n        }\n        if (!email) return;\n        const body = {\n          token: token || s.token,\n          email,\n          checkIn: s.checkIn,\n          checkOut: s.checkOut,\n          method: s.payMethod || 'MOMO',\n          rooms: (s.rooms || []).map(r => ({\n            id: r.id,\n            adults: r.adults || 1,\n            children: r.children || 0,\n            price: r.price\n          }))\n        };\n        await fetch('/api/payments/complete', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(body)\n        });\n      } catch {}\n    };\n    save();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home-root success-root\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-top\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          className: \"success-home\",\n          children: \"\\u2190 Quay l\\u1EA1i Trang Ch\\u1EE7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-icon\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/success.png\",\n          alt: \"success\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"success-title\",\n        children: \"Thanh To\\xE1n Th\\xE0nh C\\xF4ng!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-sub\",\n        children: \"C\\u1EA3m \\u01A1n b\\u1EA1n \\u0111\\xE3 \\u0111\\u1EB7t ph\\xF2ng t\\u1EA1i HMS Hotel. B\\u1EA1n \\u0111\\xE3 thanh to\\xE1n tr\\u01B0\\u1EDBc 20% gi\\xE1 tr\\u1ECB \\u0111\\u01A1n \\u0111\\u1EB7t ph\\xF2ng.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-code-line\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"label\",\n          children: \"M\\xE3 \\u0110\\u1EB7t Ph\\xF2ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 38\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"value\",\n          children: summary.code || token\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 81\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 3\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-sep\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-grid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"Kh\\xE1ch S\\u1EA1n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: hotelName || summary.hotel || '—'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 49\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"Ng\\xE0y Nh\\u1EADn\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: [summary.checkIn, \" - \", summary.checkInTime]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 49\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"Ng\\xE0y Tr\\u1EA3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: [summary.checkOut, \" - \", summary.checkOutTime]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 48\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"H\\u1EA1ng Ph\\xF2ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: summary.roomType || '—'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 50\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"Ph\\xF2ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value wrap\",\n          children: summary.roomNames || summary.roomType\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 45\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"Kh\\xE1ch\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value\",\n          children: [summary.adults || 0, \" ng\\u01B0\\u1EDDi l\\u1EDBn\", summary.children ? ` • ${summary.children} trẻ em` : '']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 45\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"T\\u1ED5ng C\\u1ED9ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value bold nowrap\",\n          children: [Number(finalTotal || 0).toLocaleString('vi-VN'), \" VND\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 49\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"\\u0110\\xE3 Thanh To\\xE1n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value bold nowrap\",\n          children: [Number(depositPaid || 0).toLocaleString('vi-VN'), \" VND\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 53\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"label\",\n          children: \"C\\xF2n L\\u1EA1i\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"value bold nowrap\",\n          children: [Number(remainingBalance || 0).toLocaleString('vi-VN'), \" VND\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 47\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-paid\",\n        children: \"(\\u0110\\xC3 THANH TO\\xC1N \\u0110\\u1EB6T C\\u1ECCC 20%)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 8,\n          fontSize: 12,\n          color: '#475569'\n        },\n        children: \"Vui l\\xF2ng thanh to\\xE1n ph\\u1EA7n c\\xF2n l\\u1EA1i khi nh\\u1EADn ph\\xF2ng.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-actions\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"checkout-btn success-btn\",\n          onClick: printReceipt,\n          children: \"T\\u1EA3i phi\\u1EBFu x\\xE1c nh\\u1EADn (PDF)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 238,\n    columnNumber: 5\n  }, this);\n}\n_s(PaymentSuccess, \"05Dw7eV9vMDkPBqZjl9lQVdBgLo=\", false, function () {\n  return [useSearchParams, useNavigate];\n});\n_c = PaymentSuccess;\nvar _c;\n$RefreshReg$(_c, \"PaymentSuccess\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","Link","useSearchParams","useNavigate","jsPDF","html2canvas","isLoggedIn","jsxDEV","_jsxDEV","DEPOSIT_RATE","PaymentSuccess","_s","params","navigate","token","get","amount","Number","code","rt","rn","ci","co","ad","ch","hotelName","setHotelName","summary","raw","localStorage","getItem","parsed","JSON","parse","depositAmount","finalAmount","roomType","roomNames","checkIn","checkOut","adults","children","hotelId","hotel","checkInTime","checkOutTime","Math","round","finalTotal","rawTotal","max","depositPaid","isNaN","remainingBalance","remaining","cancelled","setName","name","fetchHotel","hid","fetch","then","r","ok","json","j","catch","hidParam","encodeURIComponent","detailsHref","q","URLSearchParams","String","toString","toBase64","buf","binary","bytes","Uint8Array","len","byteLength","i","fromCharCode","btoa","ensurePdfFonts","REG_KEY","BOLD_KEY","regular","bold","fetchFont","url","res","mode","Error","arrayBuffer","setItem","printReceipt","file","container","document","createElement","style","position","left","top","width","background","padding","fontFamily","innerHTML","toLocaleString","body","appendChild","canvas","scale","useCORS","backgroundColor","imgData","toDataURL","pdf","unit","format","pageWidth","internal","pageSize","getWidth","pageHeight","getHeight","imgWidth","min","imgHeight","height","x","y","offset","addImage","addPage","save","removeChild","sessionStorage","window","location","pathname","search","s","email","userEmail","rawUser","method","payMethod","rooms","map","id","price","headers","stringify","className","to","fileName","_jsxFileName","lineNumber","columnNumber","src","alt","marginTop","fontSize","color","onClick","_c","$RefreshReg$"],"sources":["D:/Git/HMSAI-Hotel/client/src/PaymentSuccess.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { Link, useSearchParams, useNavigate } from 'react-router-dom';\r\nimport './HomePage.css';\r\nimport { jsPDF } from 'jspdf';\r\nimport html2canvas from 'html2canvas';\r\nimport { isLoggedIn } from './auth';\r\n\r\nconst DEPOSIT_RATE = 0.2;\r\n\r\nexport default function PaymentSuccess() {\r\n  const [params] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const token = params.get('token') || '';\r\n  const amount = Number(params.get('amount') || 0);\r\n  const code = params.get('code') || '';\r\n  const rt = params.get('rt') || '';\r\n  const rn = params.get('rn') || '';\r\n  const ci = params.get('ci') || '';\r\n  const co = params.get('co') || '';\r\n  const ad = Number(params.get('ad') || 0);\r\n  const ch = Number(params.get('ch') || 0);\r\n\r\n  const [hotelName, setHotelName] = useState('');\r\n  const summary = useMemo(() => {\r\n    try {\r\n      const raw = token ? localStorage.getItem('hmsBooking:' + token) : null;\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        if (parsed) {\r\n          if (typeof parsed.depositAmount !== 'undefined') parsed.depositAmount = Number(parsed.depositAmount);\r\n          if (typeof parsed.finalAmount !== 'undefined') parsed.finalAmount = Number(parsed.finalAmount);\r\n        }\r\n        return parsed;\r\n      }\r\n    } catch {}\r\n    return {\r\n      token, code, amount, roomType: rt, roomNames: rn, checkIn: ci, checkOut: co, adults: ad, children: ch, hotelId: (Number(params.get('hid')||0)||null),\r\n      hotel: '', checkInTime: '14:00', checkOutTime: '12:00', finalAmount: Number(amount || 0), depositAmount: Math.round(Number(amount || 0) * DEPOSIT_RATE)\r\n    };\r\n  }, [token, code, amount, rt, rn, ci, co, ad, ch, params]);\r\n\r\n  const finalTotal = useMemo(() => {\r\n    const rawTotal = typeof summary?.finalAmount === 'number' ? summary.finalAmount : Number(summary?.amount || amount || 0);\r\n    return Math.max(0, Math.round(rawTotal || 0));\r\n  }, [summary, amount]);\r\n\r\n  const depositPaid = useMemo(() => {\r\n    if (typeof summary?.depositAmount === 'number' && !Number.isNaN(summary.depositAmount)) {\r\n      return Math.max(0, Math.round(summary.depositAmount));\r\n    }\r\n    return Math.round(finalTotal * DEPOSIT_RATE);\r\n  }, [summary, finalTotal]);\r\n\r\n  const remainingBalance = useMemo(() => {\r\n    const remaining = Math.round(Number(finalTotal || 0) - Number(depositPaid || 0));\r\n    return remaining > 0 ? remaining : 0;\r\n  }, [finalTotal, depositPaid]);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    const setName = (name) => { if (!cancelled) setHotelName(name); };\r\n    const fetchHotel = (hid) => {\r\n      if (!hid) return;\r\n      fetch(`/api/hotels/${hid}`).then(r => r.ok ? r.json() : null).then(j => {\r\n        if (j && j.name) setName(j.name);\r\n      }).catch(() => {});\r\n    };\r\n    if (!hotelName) {\r\n      const hidParam = Number(params.get('hid') || 0) || null;\r\n      if (summary.hotelId) {\r\n        fetchHotel(summary.hotelId);\r\n      } else if (hidParam) {\r\n        fetchHotel(hidParam);\r\n      } else if (summary.roomType) {\r\n        fetch(`/api/room-types/${encodeURIComponent(summary.roomType)}/rooms`)\r\n          .then(r => r.ok ? r.json() : null)\r\n          .then(j => {\r\n            if (j && j.roomType) {\r\n              if (j.roomType.hotelName && !hotelName) setName(j.roomType.hotelName);\r\n              if (j.roomType.hotelId) fetchHotel(j.roomType.hotelId);\r\n            }\r\n          })\r\n          .catch(() => {});\r\n      }\r\n    }\r\n    return () => { cancelled = true; };\r\n  }, [summary.hotelId, summary.roomType, hotelName, params]);\r\n\r\n  const detailsHref = useMemo(() => {\r\n    const q = new URLSearchParams({\r\n      amount: String(finalTotal || summary.amount || amount || 0),\r\n      code: String(summary.code || code || ''),\r\n      rn: String(summary.roomNames || rn || ''),\r\n      rt: String(summary.roomType || rt || ''),\r\n      ci: String(summary.checkIn || ci || ''),\r\n      co: String(summary.checkOut || co || ''),\r\n      ad: String(summary.adults || ad || 0),\r\n      ch: String(summary.children || ch || 0),\r\n      hid: String(summary.hotelId || params.get('hid') || ''),\r\n    });\r\n    return `/booking/${token || summary.token || ''}?${q.toString()}`;\r\n  }, [summary, token, amount, code, rn, ci, co, ad, ch, params, finalTotal]);\r\n\r\n  const toBase64 = (buf) => {\r\n    let binary = '';\r\n    const bytes = new Uint8Array(buf);\r\n    const len = bytes.byteLength;\r\n    for (let i = 0; i < len; i++) binary += String.fromCharCode(bytes[i]);\r\n    return btoa(binary);\r\n  };\r\n\r\n  const ensurePdfFonts = async () => {\r\n    const REG_KEY = 'hmsPdfFont:DejaVu-Regular';\r\n    const BOLD_KEY = 'hmsPdfFont:DejaVu-Bold';\r\n    let regular = '';\r\n    let bold = '';\r\n    try { regular = localStorage.getItem(REG_KEY) || ''; } catch {}\r\n    try { bold = localStorage.getItem(BOLD_KEY) || ''; } catch {}\r\n    const fetchFont = async (url) => {\r\n      const res = await fetch(url, { mode: 'cors' });\r\n      if (!res.ok) throw new Error('Font fetch failed');\r\n      const buf = await res.arrayBuffer();\r\n      return toBase64(buf);\r\n    };\r\n    if (!regular) {\r\n      regular = await fetchFont('https://raw.githubusercontent.com/dejavu-fonts/dejavu-fonts/master/ttf/DejaVuSans.ttf');\r\n      try { localStorage.setItem(REG_KEY, regular); } catch {}\r\n    }\r\n    if (!bold) {\r\n      bold = await fetchFont('https://raw.githubusercontent.com/dejavu-fonts/dejavu-fonts/master/ttf/DejaVuSans-Bold.ttf');\r\n      try { localStorage.setItem(BOLD_KEY, bold); } catch {}\r\n    }\r\n    return { regular, bold };\r\n  };\r\n\r\n  const printReceipt = async () => {\r\n    const hotel = hotelName || summary.hotel || '';\r\n    const file = `${summary.code || token || 'receipt'}.pdf`;\r\n    const container = document.createElement('div');\r\n    container.style.position = 'fixed';\r\n    container.style.left = '-99999px';\r\n    container.style.top = '0';\r\n    container.style.width = '560px';\r\n    container.style.background = '#fff';\r\n    container.style.padding = '24px 16px';\r\n    container.style.fontFamily = \"'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'DejaVu Sans', 'Liberation Sans', sans-serif\";\r\n    container.innerHTML = `\r\n      <div>\r\n        <div style=\"font-weight:800;font-size:22px;margin:0 0 10px 0;\">Phiếu xác nhận đặt phòng</div>\r\n        <div style=\"height:1px;background:#e6e6e6;margin:8px 0 14px 0;\"></div>\r\n        <div style=\"display:grid;grid-template-columns:180px 1fr;gap:10px 16px;font-size:13px;\">\r\n          <div style=\"color:#666;font-weight:700;\">Mã đặt phòng</div>\r\n          <div style=\"font-weight:800;\">${String(summary.code || token)}</div>\r\n          <div style=\"color:#666;font-weight:700;\">Khách sạn</div>\r\n          <div style=\"font-weight:800;\">${hotel || '—'}</div>\r\n          <div style=\"color:#666;font-weight:700;\">Ngày nhận</div>\r\n          <div style=\"font-weight:800;\">${summary.checkIn} - ${summary.checkInTime}</div>\r\n          <div style=\"color:#666;font-weight:700;\">Ngày trả</div>\r\n          <div style=\"font-weight:800;\">${summary.checkOut} - ${summary.checkOutTime}</div>\r\n          <div style=\"color:#666;font-weight:700;\">Phòng</div>\r\n          <div style=\"font-weight:800;\">${String(summary.roomNames || summary.roomType || '—')}</div>\r\n          <div style=\"color:#666;font-weight:700;\">Khách</div>\r\n          <div style=\"font-weight:800;\">${summary.adults || 0} người lớn${summary.children ? ` • ${summary.children} trẻ em` : ''}</div>\r\n          <div style=\"color:#666;font-weight:700;\">Tổng cộng</div>\r\n          <div style=\"font-weight:800;\">${Number(finalTotal || 0).toLocaleString('vi-VN')} VND</div>\r\n          <div style=\"color:#666;font-weight:700;\">Đặt cọc đã thanh toán</div>\r\n          <div style=\"font-weight:800;\">${Number(depositPaid || 0).toLocaleString('vi-VN')} VND</div>\r\n          <div style=\"color:#666;font-weight:700;\">Còn lại</div>\r\n          <div style=\"font-weight:800;\">${Number(remainingBalance || 0).toLocaleString('vi-VN')} VND</div>\r\n        </div>\r\n        <div style=\"margin-top:10px;font-weight:800;\">(ĐÃ THANH TOÁN ĐẶT CỌC 20%)</div>\r\n        <div style=\"margin-top:8px;font-size:12;color:#475569;\">Vui lòng thanh toán phần còn lại khi nhận phòng.</div>\r\n      </div>`;\r\n    document.body.appendChild(container);\r\n    try {\r\n      const canvas = await html2canvas(container, { scale: 2, useCORS: true, backgroundColor: '#ffffff' });\r\n      const imgData = canvas.toDataURL('image/png');\r\n      const pdf = new jsPDF({ unit: 'pt', format: 'a4' });\r\n      const pageWidth = pdf.internal.pageSize.getWidth();\r\n      const pageHeight = pdf.internal.pageSize.getHeight();\r\n      const imgWidth = Math.min(540, pageWidth - 56 * 2);\r\n      const imgHeight = (canvas.height * imgWidth) / canvas.width;\r\n      const x = (pageWidth - imgWidth) / 2;\r\n      let y = 56;\r\n      if (imgHeight > pageHeight - 112) {\r\n        // Multi-page if content longer than one page\r\n        let remaining = imgHeight;\r\n        let offset = 0;\r\n        while (remaining > 0) {\r\n          pdf.addImage(imgData, 'PNG', x, y - offset, imgWidth, imgHeight);\r\n          remaining -= (pageHeight - 112);\r\n          offset += (pageHeight - 112);\r\n          if (remaining > 0) {\r\n            pdf.addPage();\r\n          }\r\n        }\r\n      } else {\r\n        pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);\r\n      }\r\n      pdf.save(file);\r\n    } finally {\r\n      document.body.removeChild(container);\r\n    }\r\n  };\r\n\r\n  // Save to DB on mount (once)\r\n  useEffect(() => {\r\n    if (!isLoggedIn()) {\r\n      try { sessionStorage.setItem('hmsRedirectAfterLogin', window.location.pathname + window.location.search); } catch {}\r\n      navigate('/login');\r\n      return; // skip saving\r\n    }\r\n    const save = async () => {\r\n      try {\r\n        const raw = token ? localStorage.getItem('hmsBooking:' + token) : null;\r\n        if (!raw) return;\r\n        const s = JSON.parse(raw);\r\n        let email = s.userEmail || '';\r\n        if (!email) {\r\n          try { const rawUser = localStorage.getItem('hmsUser'); if (rawUser) email = JSON.parse(rawUser).email || ''; } catch {}\r\n        }\r\n        if (!email) return;\r\n        const body = {\r\n          token: token || s.token,\r\n          email,\r\n          checkIn: s.checkIn,\r\n          checkOut: s.checkOut,\r\n          method: s.payMethod || 'MOMO',\r\n          rooms: (s.rooms || []).map(r => ({ id: r.id, adults: r.adults || 1, children: r.children || 0, price: r.price })),\r\n        };\r\n        await fetch('/api/payments/complete', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });\r\n      } catch {}\r\n    };\r\n    save();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"home-root success-root\">\r\n      <div className=\"success-card\">\r\n        <div className=\"success-top\">\r\n          <Link to=\"/\" className=\"success-home\">← Quay lại Trang Chủ</Link>\r\n          <span />\r\n        </div>\r\n        <div className=\"success-icon\">\r\n          <img src=\"/success.png\" alt=\"success\" />\r\n        </div>\r\n        <h2 className=\"success-title\">Thanh Toán Thành Công!</h2>\r\n          <div className=\"success-sub\">Cảm ơn bạn đã đặt phòng tại HMS Hotel. Bạn đã thanh toán trước 20% giá trị đơn đặt phòng.</div>\r\n  <div className=\"success-code-line\"><span className=\"label\">Mã Đặt Phòng</span><span className=\"value\">{summary.code || token}</span></div>\r\n        <div className=\"success-sep\" />\r\n        <div className=\"success-grid\">\r\n          <div className=\"label\">Khách Sạn</div><div className=\"value\">{hotelName || summary.hotel || '—'}</div>\r\n          <div className=\"label\">Ngày Nhận</div><div className=\"value\">{summary.checkIn} - {summary.checkInTime}</div>\r\n          <div className=\"label\">Ngày Trả</div><div className=\"value\">{summary.checkOut} - {summary.checkOutTime}</div>\r\n          <div className=\"label\">Hạng Phòng</div><div className=\"value\">{summary.roomType || '—'}</div>\r\n          <div className=\"label\">Phòng</div><div className=\"value wrap\">{summary.roomNames || summary.roomType}</div>\r\n          <div className=\"label\">Khách</div><div className=\"value\">{summary.adults || 0} người lớn{summary.children ? ` • ${summary.children} trẻ em` : ''}</div>\r\n          <div className=\"label\">Tổng Cộng</div><div className=\"value bold nowrap\">{Number(finalTotal || 0).toLocaleString('vi-VN')} VND</div>\r\n          <div className=\"label\">Đã Thanh Toán</div><div className=\"value bold nowrap\">{Number(depositPaid || 0).toLocaleString('vi-VN')} VND</div>\r\n          <div className=\"label\">Còn Lại</div><div className=\"value bold nowrap\">{Number(remainingBalance || 0).toLocaleString('vi-VN')} VND</div>\r\n        </div>\r\n        <div className=\"success-paid\">(ĐÃ THANH TOÁN ĐẶT CỌC 20%)</div>\r\n        <div style={{ marginTop:8, fontSize:12, color:'#475569' }}>Vui lòng thanh toán phần còn lại khi nhận phòng.</div>\r\n        <div className=\"success-actions\">\r\n          <button className=\"checkout-btn success-btn\" onClick={printReceipt}>Tải phiếu xác nhận (PDF)</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}