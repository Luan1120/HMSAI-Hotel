{"ast":null,"code":"import _objectSpread from\"D:/DA_TichHop/HMS_AI Hotel/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useRef,useState}from'react';import{Link,useNavigate}from'react-router-dom';import RoomTypeInline from'./RoomTypeInline';import RoomsBrowse from'./RoomsBrowse';import ServicesBrowse from'./ServicesBrowse';import AdminUsers from'./AdminUsers';import AdminServices from'./AdminServices';import AdminPromotions from'./AdminPromotions';import AdminAmenities from'./AdminAmenities';import AdminRooms from'./AdminRooms';import AdminBookings from'./AdminBookings';import PaymentHistory from'./PaymentHistory';import Profile from'./Profile';import CheckInOut from'./CheckInOut';import{getUserRole,authHeaders}from'./auth';import CustomerSupport from'./CustomerSupport';import StaffSupport from'./StaffSupport';import'./Auth.css';import'./HomePage.css';import AdminReports from'./AdminReports';import AdminFeedback from'./AdminFeedback';import NotificationsBell from'./NotificationsBell';// Promotions feature removed\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const HomePage=()=>{const[inlineType,setInlineType]=useState('');const[roomTypes,setRoomTypes]=useState([]);const[typesLoading,setTypesLoading]=useState(true);const[typesError,setTypesError]=useState('');const[openProfile,setOpenProfile]=useState(false);const[openHistory,setOpenHistory]=useState(false);const[openAdminUsers,setOpenAdminUsers]=useState(false);const[openAdminServices,setOpenAdminServices]=useState(false);const[openAdminRooms,setOpenAdminRooms]=useState(false);const[openAdminAmenities,setOpenAdminAmenities]=useState(false);const[openAdminBookings,setOpenAdminBookings]=useState(false);const[highlightBookingId,setHighlightBookingId]=useState(null);const[openAdminReports,setOpenAdminReports]=useState(false);const[openAdminFeedback,setOpenAdminFeedback]=useState(false);const[openAdminPromotions,setOpenAdminPromotions]=useState(false);// const [openAdminPromotions, setOpenAdminPromotions] = useState(false); // removed\nconst[openCheckInOut,setOpenCheckInOut]=useState(false);const[openCustomerSupport,setOpenCustomerSupport]=useState(false);const[reviewing,setReviewing]=useState(null);const[showRoomsOverlay,setShowRoomsOverlay]=useState(false);const[showServicesOverlay,setShowServicesOverlay]=useState(false);const scrollerRef=useRef(null);const scrollByViewport=dir=>{const el=scrollerRef.current;if(!el)return;const vw=el.clientWidth;el.scrollBy({left:dir*(vw-40),behavior:'smooth'});};useEffect(()=>{let active=true;setTypesLoading(true);setTypesError('');fetch('/api/room-types').then(async res=>{if(!res.ok){const j=await res.json().catch(()=>({}));throw new Error(j.message||\"HTTP \".concat(res.status));}return res.json();}).then(list=>{if(active)setRoomTypes(Array.isArray(list)?list:[]);}).catch(err=>{if(active)setTypesError(err.message||'Lỗi tải hạng phòng');}).finally(()=>{if(active)setTypesLoading(false);});return()=>{active=false;};},[]);// Listen for requests to open admin bookings from other parts of the app\nuseEffect(()=>{const onOpenAdminBookings=e=>{const bid=e&&e.detail&&e.detail.bookingId?Number(e.detail.bookingId):null;setHighlightBookingId(bid);setOpenAdminBookings(true);};window.addEventListener('open-admin-bookings',onOpenAdminBookings);return()=>window.removeEventListener('open-admin-bookings',onOpenAdminBookings);},[]);const scrollTop=()=>{try{window.scrollTo({top:0,behavior:'smooth'});}catch(_unused){window.scrollTo(0,0);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"home-root\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"home-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-header-left\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"HMS Logo\",className:\"home-header-logo\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:scrollTop,className:\"home-header-title home-header-home-btn\",children:\"TRANG CH\\u1EE6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-header-search\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"home-header-search-input\",placeholder:\"T\\xECm ki\\u1EBFm...\"}),/*#__PURE__*/_jsx(\"img\",{src:\"/icon-search.png\",alt:\"Search\",className:\"home-header-search-img\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-header-icons\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"home-header-icon\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/icon-language.png\",alt:\"Language\",className:\"home-header-icon-img\"})}),/*#__PURE__*/_jsx(NotificationsBell,{}),/*#__PURE__*/_jsx(GridMenu,{onOpenHistory:()=>setOpenHistory(true),onOpenReviews:()=>setReviewing('list'),onOpenServices:()=>setShowServicesOverlay(true),onOpenAdminUsers:()=>setOpenAdminUsers(true),onOpenAdminServices:()=>setOpenAdminServices(true),onOpenAdminRooms:()=>setOpenAdminRooms(true),onOpenAdminAmenities:()=>setOpenAdminAmenities(true),onOpenAdminBookings:()=>setOpenAdminBookings(true),onOpenAdminReports:()=>setOpenAdminReports(true),onOpenAdminFeedback:()=>setOpenAdminFeedback(true),onOpenAdminPromotions:()=>setOpenAdminPromotions(true)// promotions removed\n,onOpenCheckInOut:()=>setOpenCheckInOut(true),onOpenCustomerSupport:()=>setOpenCustomerSupport(true)}),/*#__PURE__*/_jsx(UserMenu,{onOpenProfile:()=>setOpenProfile(true)})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"home-banner\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/HomeBanner/home-banner.png\",alt:\"Hotel Banner\",className:\"home-banner-img\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-banner-content\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"home-banner-title\",children:[\"WELCOME TO\",/*#__PURE__*/_jsx(\"br\",{}),\"HMS-AI\"]}),/*#__PURE__*/_jsxs(\"h2\",{className:\"home-banner-subtitle\",children:[\"H\\u1EC6 TH\\u1ED0NG QU\\u1EA2N L\\xDD KH\\xC1CH S\\u1EA0N \",/*#__PURE__*/_jsx(\"br\",{}),\"TR\\u1EF0C TUY\\u1EBEN\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary home-banner-btn\",onClick:()=>{try{if(getUserRole()==='Admin'){window.alert('Tài khoản admin không được phép đặt phòng');return;}}catch(_unused2){}setShowRoomsOverlay(true);},disabled:getUserRole()==='Admin',children:\"\\u0110\\u1EB6T PH\\xD2NG NGAY\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-chatbot\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/chatbox.png\",alt:\"Chatbot\",className:\"home-chatbot-img\"}),/*#__PURE__*/_jsx(\"div\",{className:\"home-chatbot-label\",children:\"CHATBOT\"})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"home-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-info-text\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-info-title\",children:\"N\\u01A1i ngh\\u1EC9 d\\u01B0\\u1EE1ng \\u0111\\u1EB3ng c\\u1EA5p \\u2013 Ch\\u1EA1m \\u0111\\u1EBFn t\\u1EEBng kho\\u1EA3nh kh\\u1EAFc b\\xECnh y\\xEAn\"}),/*#__PURE__*/_jsx(\"p\",{className:\"home-info-desc\",children:\"Kh\\xE1ch s\\u1EA1n HMS-AI mang \\u0111\\u1EBFn b\\u1EA1n m\\u1ED9t kh\\xF4ng gian ngh\\u1EC9 d\\u01B0\\u1EE1ng sang tr\\u1ECDng v\\xE0 ti\\u1EC7n nghi b\\u1EADc nh\\u1EA5t. V\\u1EDBi h\\u1EC7 th\\u1ED1ng ph\\xF2ng hi\\u1EC7n \\u0111\\u1EA1i, d\\u1ECBch v\\u1EE5 chuy\\xEAn nghi\\u1EC7p c\\xF9ng \\u0111\\u1ED9i ng\\u0169 nh\\xE2n vi\\xEAn th\\xE2n thi\\u1EC7n, ch\\xFAng t\\xF4i cam k\\u1EBFt mang l\\u1EA1i cho b\\u1EA1n nh\\u1EEFng tr\\u1EA3i nghi\\u1EC7m tho\\u1EA3i m\\xE1i v\\xE0 \\u0111\\xE1ng nh\\u1EDB. H\\xE3y \\u0111\\u1EC3 HMS-AI tr\\u1EDF th\\xE0nh \\u0111i\\u1EC3m \\u0111\\u1EBFn l\\xFD t\\u01B0\\u1EDFng cho k\\u1EF3 ngh\\u1EC9 ho\\u1EB7c chuy\\u1EBFn c\\xF4ng t\\xE1c c\\u1EE7a b\\u1EA1n!\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"home-info-img-wrap\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/HomeBanner/home.png\",alt:\"Resort View\",className:\"home-info-img\"})})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"home-rooms\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-rooms-title\",children:\"H\\u1EA1ng Ph\\xF2ng\"}),typesLoading&&/*#__PURE__*/_jsx(\"div\",{children:\"\\u0110ang t\\u1EA3i danh s\\xE1ch h\\u1EA1ng ph\\xF2ng...\"}),typesError&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red'},children:typesError}),!typesLoading&&!typesError&&/*#__PURE__*/_jsxs(\"div\",{className:\"home-rooms-scroller\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"home-rooms-nav left\",\"aria-label\":\"Tr\\u01B0\\u1EDBc\",onClick:()=>scrollByViewport(-1),children:'<'}),/*#__PURE__*/_jsx(\"div\",{className:\"home-rooms-grid\",ref:scrollerRef,children:roomTypes.length===0?/*#__PURE__*/_jsx(\"div\",{children:\"Ch\\u01B0a c\\xF3 h\\u1EA1ng ph\\xF2ng n\\xE0o.\"}):roomTypes.map(rt=>{const img=rt.image||'/khachsan/hp1.jpg';const maxAdults=Number(rt.maxAdults||0);const maxChildren=Number(rt.maxChildren||0);const price=Number(rt.basePrice||0);return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setInlineType(rt.name),className:\"home-room-card\",style:{textAlign:'left'},children:[/*#__PURE__*/_jsx(\"img\",{className:\"home-room-img\",src:img,alt:rt.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-room-meta\",children:[maxAdults,\" ng\\u01B0\\u1EDDi l\\u1EDBn | \",maxChildren,\" tr\\u1EBB em\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"home-room-name\",children:rt.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-room-price\",children:[\"Gi\\xE1 t\\u1EEB \",price.toLocaleString('vi-VN'),\" VN\\u0110/\\u0111\\xEAm\"]})]},rt.id);})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"home-rooms-nav right\",\"aria-label\":\"Sau\",onClick:()=>scrollByViewport(1),children:'>'})]}),inlineType&&/*#__PURE__*/_jsx(RoomTypeInline,{name:inlineType,onClose:()=>setInlineType('')})]}),showRoomsOverlay&&/*#__PURE__*/_jsx(\"div\",{className:\"profile-overlay\",style:{zIndex:1500},onMouseDown:e=>{if(e.target===e.currentTarget)setShowRoomsOverlay(false);},children:/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{width:'95%',maxWidth:1400,padding:0,display:'flex',flexDirection:'column'},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{flex:1,overflow:'auto',padding:'4px 4px 12px'},children:/*#__PURE__*/_jsx(RoomsBrowse,{inline:true,onClose:()=>setShowRoomsOverlay(false)})})})}),showServicesOverlay&&/*#__PURE__*/_jsx(\"div\",{className:\"profile-overlay\",style:{zIndex:1500},onMouseDown:e=>{if(e.target===e.currentTarget)setShowServicesOverlay(false);},children:/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{width:'90%',maxWidth:1200,padding:0,display:'flex',flexDirection:'column'},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{flex:1,overflow:'auto',padding:'4px 4px 12px'},children:/*#__PURE__*/_jsx(ServicesBrowse,{inline:true,onClose:()=>setShowServicesOverlay(false)})})})}),/*#__PURE__*/_jsxs(\"section\",{className:\"home-experience\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-experience-left\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-experience-title\",children:\"Tr\\u1EA3i Nghi\\u1EC7m L\\u01B0u Tr\\xFA\"}),/*#__PURE__*/_jsx(\"p\",{className:\"home-experience-desc\",children:\"Kh\\xE1m ph\\xE1 kh\\xF4ng gian ngh\\u1EC9 d\\u01B0\\u1EE1ng \\u0111\\u1EB3ng c\\u1EA5p v\\u1EDBi h\\u1EA1ng ph\\xF2ng ti\\xEAu bi\\u1EC3u c\\u1EE7a ch\\xFAng t\\xF4i \\u2014 n\\xE9t thi\\u1EBFt k\\u1EBF tinh t\\u1EBF h\\xF2a quy\\u1EC7n c\\xF9ng ti\\u1EC7n nghi hi\\u1EC7n \\u0111\\u1EA1i mang \\u0111\\u1EBFn tr\\u1EA3i nghi\\u1EC7m l\\u01B0u tr\\xFA kh\\xF3 qu\\xEAn. M\\u1ED7i ph\\xF2ng \\u0111\\u1EC1u \\u0111\\u01B0\\u1EE3c trang tr\\xED b\\u1EB1ng nh\\u1EEFng v\\u1EADt li\\u1EC7u cao c\\u1EA5p, t\\u1EA1o n\\xEAn s\\u1EF1 sang tr\\u1ECDng v\\xE0 \\u1EA5m c\\xFAng, khi\\u1EBFn b\\u1EA1n c\\u1EA3m th\\u1EA5y nh\\u01B0 \\u0111ang \\u1EDF trong m\\u1ED9t thi\\xEAn \\u0111\\u01B0\\u1EDDng ri\\xEAng. Kh\\xF4ng ch\\u1EC9 c\\xF3 v\\u1EADy, t\\u1EA7m nh\\xECn h\\u01B0\\u1EDBng ra c\\u1EA3nh quan tuy\\u1EC7t \\u0111\\u1EB9p s\\u1EBD khi\\u1EBFn b\\u1EA1n b\\u1ECB cu\\u1ED1n h\\xFAt, mang l\\u1EA1i c\\u1EA3m gi\\xE1c th\\u01B0 gi\\xE3n tuy\\u1EC7t \\u0111\\u1ED1i. T\\u1EA1i \\u0111\\xE2y, b\\u1EA1n s\\u1EBD \\u0111\\u01B0\\u1EE3c t\\u1EADn h\\u01B0\\u1EDFng nh\\u1EEFng d\\u1ECBch v\\u1EE5 ch\\u0103m s\\xF3c kh\\xE1ch h\\xE0ng t\\u1EADn t\\xECnh, gi\\xFAp cho k\\u1EF3 ngh\\u1EC9 c\\u1EE7a b\\u1EA1n tr\\u1EDF n\\xEAn ho\\xE0n h\\u1EA3o h\\u01A1n bao gi\\u1EDD h\\u1EBFt.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-experience-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"home-frame\",children:/*#__PURE__*/_jsx(\"img\",{className:\"home-frame-img\",src:\"/khachsan/ks10.png\",alt:\"Ph\\xF2ng ngh\\u1EC9\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"home-caption\",children:\"Ph\\xF2ng ngh\\u1EC9 \\u0111\\u1EB3ng c\\u1EA5p, ti\\u1EC7n nghi \\u0111\\u1EA7y \\u0111\\u1EE7 v\\xE0 kh\\xF4ng gian tho\\u1EA3i m\\xE1i, mang \\u0111\\u1EBFn c\\u1EA3m gi\\xE1c th\\u01B0 gi\\xE3n nh\\u01B0 ch\\xEDnh ng\\xF4i nh\\xE0 c\\u1EE7a b\\u1EA1n. M\\u1ED7i chi ti\\u1EBFt trong ph\\xF2ng \\u0111\\u1EC1u \\u0111\\u01B0\\u1EE3c thi\\u1EBFt k\\u1EBF t\\u1EC9 m\\u1EC9, t\\u1EEB n\\u1ED9i th\\u1EA5t sang tr\\u1ECDng \\u0111\\u1EBFn \\xE1nh s\\xE1ng \\u1EA5m \\xE1p, t\\u1EA1o n\\xEAn m\\u1ED9t b\\u1EA7u kh\\xF4ng kh\\xED d\\u1EC5 ch\\u1ECBu v\\xE0 g\\u1EA7n g\\u0169i.\"})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"home-gallery\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-gallery-item\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"home-gallery-img\",src:\"/khachsan/ks11.png\",alt:\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"home-gallery-caption\",children:\"Kh\\xF4ng gian \\u1EA5m \\xE1p, n\\u1ED9i th\\u1EA5t tinh t\\u1EBF \\u2014 l\\u1EF1a ch\\u1ECDn ho\\xE0n h\\u1EA3o cho k\\u1EF3 ngh\\u1EC9 \\u0111\\xE1ng nh\\u1EDB.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-gallery-item\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"home-gallery-img\",src:\"/khachsan/ks12.png\",alt:\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"home-gallery-caption\",children:\"M\\u1ED7i chi ti\\u1EBFt trong c\\u0103n ph\\xF2ng \\u0111\\u1EC1u \\u0111\\u01B0\\u1EE3c ch\\u0103m ch\\xFAt, t\\u1EA1o n\\xEAn s\\u1EF1 tho\\u1EA3i m\\xE1i v\\xE0 \\u0111\\u1EB3ng c\\u1EA5p cho kh\\xE1ch h\\xE0ng.\"})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"home-offers\",id:\"offers-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-offers-title\",children:\"\\u01AFu \\u0111\\xE3i d\\xE0nh cho b\\u1EA1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-offers-grid\",children:[/*#__PURE__*/_jsxs(\"article\",{className:\"home-offer-card\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"home-offer-img\",src:\"/khachsan/ks1.png\",alt:\"\\u0110\\u1EB7t ph\\xF2ng s\\u1EDBm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-offer-body\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"home-offer-card-title\",children:\"\\u0110\\u1EB7t ph\\xF2ng s\\u1EDBm\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"home-offer-list\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u0110\\u1EB7t ph\\xF2ng tr\\u01B0\\u1EDBc 30 ng\\xE0y \\u0111\\u1EC3 nh\\u1EADn ngay gi\\u1EA3m gi\\xE1 20%.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Ti\\u1EBFt ki\\u1EC7m chi ph\\xED, \\u0111\\u1EA3m b\\u1EA3o ch\\u1ED7 ngh\\u1EC9 trong m\\xF9a cao \\u0111i\\u1EC3m.\"})]})]})]}),/*#__PURE__*/_jsxs(\"article\",{className:\"home-offer-card\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"home-offer-img\",src:\"/khachsan/ks2.png\",alt:\"C\\xE2u l\\u1EA1c b\\u1ED9 Wellhall\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-offer-body\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"home-offer-card-title\",children:\"C\\xE2u l\\u1EA1c b\\u1ED9 Wellhall\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"home-offer-list\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Gi\\u1EA3m gi\\xE1 khi \\u0111\\u1EB7t ph\\xF2ng.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"N\\xE2ng h\\u1EA1ng ph\\xF2ng mi\\u1EC5n ph\\xED t\\xF9y t\\xECnh tr\\u1EA1ng.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u0110\\u01B0\\u1EE3c h\\u01B0\\u1EDFng c\\xE1c d\\u1ECBch v\\u1EE5 VIP ri\\xEAng bi\\u1EC7t.\"})]})]})]}),/*#__PURE__*/_jsxs(\"article\",{className:\"home-offer-card\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"home-offer-img\",src:\"/khachsan/ks3.png\",alt:\"\\u1EDE 3 \\u0111\\xEAm t\\u1EB7ng 1 \\u0111\\xEAm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-offer-body\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"home-offer-card-title\",children:\"\\u1EDE 3 \\u0111\\xEAm - T\\u1EB7ng 1 \\u0111\\xEAm mi\\u1EC5n ph\\xED\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"home-offer-list\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u0110\\u1EB7t ph\\xF2ng li\\xEAn ti\\u1EBFp 3 \\u0111\\xEAm, nh\\u1EADn ngay 1 \\u0111\\xEAm mi\\u1EC5n ph\\xED.\"}),/*#__PURE__*/_jsx(\"li\",{children:\"K\\u1EF3 ngh\\u1EC9 d\\xE0i h\\u01A1n m\\xE0 kh\\xF4ng lo v\\u1EC1 chi ph\\xED.\"})]})]})]})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"home-about\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"home-about-overlay\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-about-inner\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-about-title\",children:\"V\\u1EC1 ch\\xFAng t\\xF4i\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-about-grid\",children:[/*#__PURE__*/_jsxs(\"blockquote\",{className:\"home-quote\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Kh\\xE1ch s\\u1EA1n HMS-AI mang \\u0111\\u1EBFn tr\\u1EA3i nghi\\u1EC7m ngh\\u1EC9 d\\u01B0\\u1EE1ng \\u0111\\u1EB3ng c\\u1EA5p, k\\u1EBFt h\\u1EE3p c\\xF4ng ngh\\u1EC7 hi\\u1EC7n \\u0111\\u1EA1i v\\u1EDBi s\\u1EF1 hi\\u1EBFu kh\\xE1ch truy\\u1EC1n th\\u1ED1ng. M\\u1ED9t \\u0111i\\u1EC3m \\u0111\\u1EBFn l\\xFD t\\u01B0\\u1EDFng cho m\\u1ECDi du kh\\xE1ch.\"}),/*#__PURE__*/_jsx(\"cite\",{children:\"Santa Solana Post\"})]}),/*#__PURE__*/_jsxs(\"blockquote\",{className:\"home-quote\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Kh\\xF4ng ch\\u1EC9 l\\xE0 m\\u1ED9t n\\u01A1i l\\u01B0u tr\\xFA, HMS-AI c\\xF2n mang l\\u1EA1i d\\u1ECBch v\\u1EE5 ch\\u0103m s\\xF3c kh\\xE1ch h\\xE0ng t\\u1EADn t\\xE2m. \\u0110\\u1EB7c bi\\u1EC7t, h\\u1EC7 th\\u1ED1ng \\u0111\\u1EB7t ph\\xF2ng th\\xF4ng minh gi\\xFAp ti\\u1EBFt ki\\u1EC7m th\\u1EDDi gian v\\xE0 chi ph\\xED.\"}),/*#__PURE__*/_jsx(\"cite\",{children:\"Marianne\\u2019s Luxe Travels\"})]}),/*#__PURE__*/_jsxs(\"blockquote\",{className:\"home-quote\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"V\\u1EDBi kh\\xF4ng gian sang tr\\u1ECDng, ti\\u1EC7n nghi cao c\\u1EA5p v\\xE0 chatbot AI h\\u1ED7 tr\\u1EE3 24/7, HMS-AI \\u0111ang thay \\u0111\\u1ED5i c\\xE1ch kh\\xE1ch h\\xE0ng tr\\u1EA3i nghi\\u1EC7m d\\u1ECBch v\\u1EE5 kh\\xE1ch s\\u1EA1n tr\\u1EF1c tuy\\u1EBFn.\"}),/*#__PURE__*/_jsx(\"cite\",{children:\"Fairhill Journal\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"footer\",{className:\"home-footer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"home-footer-top\",children:\"HMS\\u2013AI Hotel\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-footer-cols\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-footer-col\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0110\\u1ECBa ch\\u1EC9 li\\xEAn h\\u1EC7\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"home-contact-list\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:\"/icon-location.png\",alt:\"\\u0110\\u1ECBa ch\\u1EC9\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0110\\u1EA1i h\\u1ECDc Duy T\\xE2n\"})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:\"/icon-phone.png\",alt:\"\\u0110i\\u1EC7n tho\\u1EA1i\"}),/*#__PURE__*/_jsx(\"span\",{children:\"0123-456-7890\"})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:\"/icon-mail.png\",alt:\"Email\"}),/*#__PURE__*/_jsx(\"span\",{children:\"HMS_AI_Hotel@gmail.com\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-footer-col\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"K\\u1EBFt n\\u1ED1i v\\u1EDBi ch\\xFAng t\\xF4i\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-social\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"https://www.facebook.com\",target:\"_blank\",rel:\"noreferrer\",className:\"home-social-icon\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/icon-facebook.png\",alt:\"Facebook\"})}),/*#__PURE__*/_jsx(\"a\",{href:\"https://twitter.com\",target:\"_blank\",rel:\"noreferrer\",className:\"home-social-icon\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/icon-twitter.png\",alt:\"Twitter\"})}),/*#__PURE__*/_jsx(\"a\",{href:\"https://www.instagram.com\",target:\"_blank\",rel:\"noreferrer\",className:\"home-social-icon\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/icon-instagram.png\",alt:\"Instagram\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"home-footer-note\",children:\"\\u0110\\u1EEBng qu\\xEAn theo d\\xF5i HMS-AI Hotel \\u0111\\u1EC3 nh\\u1EADn \\u01B0u \\u0111\\xE3i h\\u1EA5p d\\u1EABn.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-footer-col\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0110i\\u1EC1u kho\\u1EA3n & Ch\\u1EC9nh s\\xE1ch\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u0110i\\u1EC1u kho\\u1EA3n s\\u1EED d\\u1EE5ng\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Ch\\xEDnh s\\xE1ch b\\u1EA3o m\\u1EADt\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Ch\\xEDnh s\\xE1ch h\\u1EE7y ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Quy \\u0111\\u1ECBnh & h\\u1ED7 tr\\u1EE3 kh\\xE1ch h\\xE0ng\"})]})]})]})]}),openProfile&&/*#__PURE__*/_jsx(Profile,{isModal:true,onClose:()=>setOpenProfile(false)}),openHistory&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenHistory(false);},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenHistory(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'98%',width:'98%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(PaymentHistory,{inline:true,onReview:it=>setReviewing(it)})})})]}),openAdminUsers&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay profile-overlay--center\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminUsers(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminUsers(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'1100px',width:'98%',marginTop:56,maxHeight:'90vh',overflow:'auto'},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminUsers,{isModal:true,onClose:()=>setOpenAdminUsers(false)})})})]}),openAdminServices&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay profile-overlay--center\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminServices(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminServices(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'100%',width:'100%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminServices,{isModal:true,onClose:()=>setOpenAdminServices(false)})})})]}),openAdminRooms&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay profile-overlay--center\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminRooms(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminRooms(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'100%',width:'100%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminRooms,{isModal:true,onClose:()=>setOpenAdminRooms(false)})})})]}),openAdminAmenities&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay profile-overlay--center\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminAmenities(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminAmenities(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'100%',width:'100%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminAmenities,{isModal:true,onClose:()=>setOpenAdminAmenities(false)})})})]}),openAdminBookings&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay profile-overlay--center\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminBookings(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminBookings(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'100%',width:'100%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminBookings,{isModal:true,onClose:()=>{setOpenAdminBookings(false);setHighlightBookingId(null);},highlightBookingId:highlightBookingId})})})]}),openAdminReports&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminReports(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminReports(false),style:{top:12,left:12},children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'calc(100vw - 24px)',width:'100%',marginTop:56,maxHeight:'90vh',overflow:'auto'},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminReports,{isModal:true,onClose:()=>setOpenAdminReports(false)})})})]}),openAdminFeedback&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminFeedback(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminFeedback(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'calc(100vw - 24px)',width:'100%',marginTop:56,maxHeight:'90vh',overflow:'auto'},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminFeedback,{isModal:true,onClose:()=>setOpenAdminFeedback(false)})})})]}),openAdminPromotions&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay profile-overlay--center\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenAdminPromotions(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenAdminPromotions(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'1100px',width:'98%',marginTop:56,maxHeight:'90vh',overflow:'auto'},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(AdminPromotions,{isModal:true,onClose:()=>setOpenAdminPromotions(false)})})})]}),openCheckInOut&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenCheckInOut(false);},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenCheckInOut(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'100%',width:'100%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:/*#__PURE__*/_jsx(CheckInOut,{isModal:true,onClose:()=>setOpenCheckInOut(false)})})})]}),openCustomerSupport&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay profile-overlay--center\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)setOpenCustomerSupport(false);},style:{alignItems:'flex-start'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:()=>setOpenCustomerSupport(false),children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'100%',width:'100%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"div\",{style:{background:'#fff',borderRadius:12,padding:8},children:getUserRole()==='Staff'?/*#__PURE__*/_jsx(StaffSupport,{isModal:true,onClose:()=>setOpenCustomerSupport(false)}):/*#__PURE__*/_jsx(CustomerSupport,{isModal:true,onClose:()=>setOpenCustomerSupport(false)})})})]}),reviewing&&/*#__PURE__*/_jsx(ReviewModal,{data:typeof reviewing==='object'?reviewing:null,listMode:reviewing==='list',onClose:()=>setReviewing(null),onEditReview:r=>setReviewing({bookingId:r.bookingId,hotelName:r.hotelName,roomName:r.roomName,checkIn:r.checkIn,checkOut:r.checkOut})})]});};export default HomePage;function GridMenu(_ref){let{onOpenHistory,onOpenReviews,onOpenServices,onOpenAdminUsers,onOpenAdminServices,onOpenAdminRooms,onOpenAdminPromotions,onOpenAdminBookings,onOpenCheckInOut,onOpenCustomerSupport,onOpenAdminReports,onOpenAdminFeedback,onOpenAdminAmenities}=_ref;const[open,setOpen]=useState(false);const[active,setActive]=useState('');const ref=useRef(null);const navigate=useNavigate();useEffect(()=>{const onDocClick=e=>{if(ref.current&&!ref.current.contains(e.target))setOpen(false);};const onEsc=e=>{if(e.key==='Escape')setOpen(false);};document.addEventListener('mousedown',onDocClick);document.addEventListener('keydown',onEsc);return()=>{document.removeEventListener('mousedown',onDocClick);document.removeEventListener('keydown',onEsc);};},[]);const role=getUserRole();const isAdmin=role==='Admin';const isStaff=role==='Staff';// Theo yêu cầu: Admin chỉ thấy các chức năng Quản lý + Báo cáo/Thống kê (loại bỏ các mục chung khách hàng)\nlet items;if(isAdmin){items=[{key:'manage-users',label:'QUẢN LÝ NGƯỜI DÙNG'},{key:'manage-services',label:'QUẢN LÝ DỊCH VỤ KHÁCH SẠN'},{key:'manage-rooms',label:'QUẢN LÝ PHÒNG'},{key:'manage-promotions',label:'QUẢN LÝ ƯU ĐÃI'},{key:'manage-amenities',label:'QUẢN LÝ TIỆN NGHI'},{key:'manage-bookings',label:'QUẢN LÝ ĐẶT PHÒNG'},{key:'manage-feedback',label:'QUẢN LÝ PHẢN HỒI'},{key:'reports',label:'BÁO CÁO, THỐNG KÊ'}];}else{// Người dùng thường hoặc Staff vẫn thấy các mục chung\nitems=[{key:'news',label:'TIN TỨC'},{key:'offers',label:'ƯU ĐÃI'},{key:'services',label:'DỊCH VỤ'},{key:'history',label:'LỊCH SỬ GIAO DỊCH',to:'/transactions'},{key:'reviews',label:'ĐÁNH GIÁ',isReview:true},...(isStaff?[{key:'checkinout',label:'QUẢN LÝ CHECK IN - CHECK OUT'},{key:'support',label:'HỖ TRỢ KHÁCH HÀNG'}]:[])];}return/*#__PURE__*/_jsxs(\"div\",{className:\"grid-menu\",ref:ref,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"home-header-icon grid-btn \".concat(open?'is-open':'',\" \").concat(active?'has-active':''),\"aria-haspopup\":\"menu\",\"aria-expanded\":open,onClick:()=>setOpen(v=>!v),children:/*#__PURE__*/_jsx(\"img\",{src:\"/icon-grid.png\",alt:\"Grid\",className:\"home-header-icon-img \".concat(active?'active':'')})}),open&&/*#__PURE__*/_jsx(\"div\",{className:\"grid-menu-dropdown\",role:\"menu\",children:items.map(it=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"grid-item \".concat(active===it.key?'active':''),onClick:()=>{setActive(it.key);setOpen(false);if(it.key==='history'&&typeof onOpenHistory==='function'){onOpenHistory();return;}// Requirement: clicking 'TIN TỨC' scrolls to 'Ưu đãi dành cho bạn'\nif(it.key==='news'){try{const el=document.getElementById('offers-section');if(el){el.scrollIntoView({behavior:'smooth',block:'start'});}}catch(_unused3){}return;}if(it.isReview&&typeof onOpenReviews==='function'){onOpenReviews();return;}if(it.key==='services'&&typeof onOpenServices==='function'){onOpenServices();return;}if(it.key==='manage-users'&&typeof onOpenAdminUsers==='function'){onOpenAdminUsers();return;}if(it.key==='manage-rooms'&&typeof onOpenAdminRooms==='function'){onOpenAdminRooms();return;}if(it.key==='manage-promotions'&&typeof onOpenAdminPromotions==='function'){onOpenAdminPromotions();return;}if(it.key==='manage-amenities'&&typeof onOpenAdminAmenities==='function'){onOpenAdminAmenities();return;}if(it.key==='manage-bookings'&&typeof onOpenAdminBookings==='function'){onOpenAdminBookings();return;}if(it.key==='manage-services'&&typeof onOpenAdminServices==='function'){onOpenAdminServices();return;}if(it.key==='checkinout'&&typeof onOpenCheckInOut==='function'){onOpenCheckInOut();return;}if(it.key==='support'&&typeof onOpenCustomerSupport==='function'){onOpenCustomerSupport();return;}if(it.key==='reports'&&typeof onOpenAdminReports==='function'){onOpenAdminReports();return;}if(it.key==='manage-feedback'&&typeof onOpenAdminFeedback==='function'){onOpenAdminFeedback();return;}// promotions handler removed\nif(it.to)navigate(it.to);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"grid-dot\",\"aria-hidden\":true}),/*#__PURE__*/_jsx(\"span\",{className:\"grid-label\",children:it.label})]},it.key))})]});}function UserMenu(_ref2){let{onOpenProfile}=_ref2;const[open,setOpen]=useState(false);const[active,setActive]=useState('');const[user,setUser]=useState(null);const ref=useRef(null);const navigate=useNavigate();useEffect(()=>{const handleClickOutside=e=>{if(ref.current&&!ref.current.contains(e.target))setOpen(false);};const handleEsc=e=>{if(e.key==='Escape')setOpen(false);};document.addEventListener('mousedown',handleClickOutside);document.addEventListener('keydown',handleEsc);return()=>{document.removeEventListener('mousedown',handleClickOutside);document.removeEventListener('keydown',handleEsc);};},[]);// Load user from localStorage and listen for changes (e.g., after login)\nuseEffect(()=>{const loadUser=()=>{try{const u=localStorage.getItem('hmsUser');const parsed=u?JSON.parse(u):null;if(parsed&&parsed.avatar&&typeof parsed.avatar==='string'&&parsed.avatar.startsWith('/')){// Ensure absolute URL to avoid broken image in some setups\nparsed.avatar=parsed.avatar;// CRA proxy serves /uploads from backend\n}setUser(parsed);}catch(_unused4){setUser(null);}};loadUser();const onStorage=e=>{if(!e||e.key==='hmsUser')loadUser();};window.addEventListener('storage',onStorage);// Custom event for same-tab updates\nwindow.addEventListener('hms-auth-change',loadUser);return()=>{window.removeEventListener('storage',onStorage);window.removeEventListener('hms-auth-change',loadUser);};},[]);// Enrich user with avatar if missing\nuseEffect(()=>{const enrich=async()=>{if(!user||!user.email||user.avatar)return;try{const res=await fetch(\"/api/users/profile?email=\".concat(encodeURIComponent(user.email),\"&_=\").concat(Date.now()));if(!res.ok)return;const j=await res.json();if(j&&j.user){const next=_objectSpread(_objectSpread({},user),{},{name:j.user.name||user.name,avatar:j.user.avatar||user.avatar});setUser(next);try{localStorage.setItem('hmsUser',JSON.stringify(next));}catch(_unused5){}try{window.dispatchEvent(new Event('hms-auth-change'));}catch(_unused6){}}}catch(_unused7){}};enrich();},[user&&user.email,user&&user.avatar]);return/*#__PURE__*/_jsxs(\"div\",{className:\"home-user-menu\",ref:ref,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"home-header-icon home-user-button \".concat(open?'is-open':''),onClick:()=>setOpen(v=>!v),\"aria-haspopup\":\"menu\",\"aria-expanded\":open,children:user!==null&&user!==void 0&&user.avatar?/*#__PURE__*/_jsx(\"span\",{className:\"home-avatar-circle\",children:/*#__PURE__*/_jsx(\"img\",{src:user.avatar,alt:\"avatar\"})}):/*#__PURE__*/_jsx(\"img\",{src:\"/icon-user.png\",alt:\"User\",className:\"home-header-icon-img\"})}),user&&/*#__PURE__*/_jsx(\"span\",{className:\"home-user-name\",style:{marginLeft:8},children:user.name||user.email}),open&&/*#__PURE__*/_jsx(\"div\",{className:\"home-user-dropdown\",role:\"menu\",children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-user-greet\",\"aria-disabled\":true,children:[\"Xin ch\\xE0o, \",user.name||user.email]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"home-user-item\",onClick:()=>{setOpen(false);onOpenProfile&&onOpenProfile();},children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-item-dot\",\"aria-hidden\":true}),/*#__PURE__*/_jsx(\"span\",{className:\"user-item-label\",children:\"TH\\xD4NG TIN C\\xC1 NH\\xC2N\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"home-user-item\",onClick:()=>{try{localStorage.removeItem('hmsUser');}catch(_unused8){}setUser(null);setOpen(false);try{window.dispatchEvent(new Event('hms-auth-change'));}catch(_unused9){}// Navigate to homepage and scroll to top\ntry{navigate('/');}catch(_unused0){}try{setTimeout(()=>window.scrollTo(0,0),0);}catch(_unused1){}},children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-item-dot\",\"aria-hidden\":true}),/*#__PURE__*/_jsx(\"span\",{className:\"user-item-label\",children:\"\\u0110\\u0102NG XU\\u1EA4T\"})]})]}):/*#__PURE__*/_jsxs(Link,{to:\"/login\",className:\"home-user-item \".concat(active==='login'?'active':''),onClick:()=>{setActive('login');setOpen(false);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-item-dot\",\"aria-hidden\":true}),/*#__PURE__*/_jsx(\"span\",{className:\"user-item-label\",children:\"\\u0110\\u0102NG NH\\u1EACP\"})]})})]});}function ReviewModal(_ref3){let{data,onClose,listMode,onEditReview}=_ref3;const[reviewList,setReviewList]=useState([]);const[listLoading,setListLoading]=useState(false);const[user,setUser]=useState(null);// List mode: fetch all reviews for user\nuseEffect(()=>{if(!listMode||!(user!==null&&user!==void 0&&user.email))return;let active=true;setListLoading(true);fetch(\"/api/reviews?email=\".concat(encodeURIComponent(user.email),\"&_=\").concat(Date.now()),{cache:'no-store'}).then(res=>res.ok?res.json():Promise.reject()).then(j=>{if(active)setReviewList(Array.isArray(j.reviews)?j.reviews:[]);}).catch(()=>{if(active)setReviewList([]);}).finally(()=>{if(active)setListLoading(false);});return()=>{active=false;};},[listMode,user===null||user===void 0?void 0:user.email]);const[rating,setRating]=useState(4);const[comment,setComment]=useState('');const[name,setName]=useState('');const[email,setEmail]=useState('');const[submitting,setSubmitting]=useState(false);const[done,setDone]=useState(false);const[errMsg,setErrMsg]=useState('');const[loading,setLoading]=useState(true);useEffect(()=>{try{const u=localStorage.getItem('hmsUser');if(u)setUser(JSON.parse(u));}catch(_unused10){}},[]);useEffect(()=>{if(user){setName(user.name||'');setEmail(user.email||'');}},[user]);useEffect(()=>{if(listMode)return;let active=true;const load=async()=>{if(!(data!==null&&data!==void 0&&data.bookingId)||!(user!==null&&user!==void 0&&user.email)){setLoading(false);return;}try{setLoading(true);const url=new URL('/api/reviews',window.location.origin);url.searchParams.set('email',user.email);url.searchParams.set('bookingId',String(data.bookingId));url.searchParams.set('_',String(Date.now()));const res=await fetch(url.toString(),{cache:'no-store'});if(!active)return;if(res.ok){const j=await res.json();if(j!==null&&j!==void 0&&j.review){setRating(j.review.rating||4);setComment(j.review.comment||'');}else{// No review yet: keep defaults\n}}else{// keep defaults on error\n}}finally{if(active)setLoading(false);}};load();return()=>{active=false;};},[listMode,data===null||data===void 0?void 0:data.bookingId,user===null||user===void 0?void 0:user.email]);const submit=async()=>{setErrMsg('');if(!rating||!email||!(data!==null&&data!==void 0&&data.bookingId)){setErrMsg('Thiếu thông tin bắt buộc');return;}setSubmitting(true);try{const res=await fetch('/api/reviews',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,bookingId:data.bookingId,rating,// 0.5 steps; server converts to integer halves\ncomment})});if(!res.ok){const j=await res.json().catch(()=>({message:'Lỗi gửi đánh giá'}));throw new Error(j.message||'Lỗi gửi đánh giá');}setDone(true);// Reflect new values immediately\ntry{const j=await res.json();}catch(_unused11){}setTimeout(()=>{onClose&&onClose();},900);}catch(e){setErrMsg(e.message||'Không thể gửi đánh giá');}finally{setSubmitting(false);}};// Show only exact room name for display\nconst roomLabel=(data===null||data===void 0?void 0:data.roomName)||'';if(listMode){return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)onClose&&onClose();},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:onClose,children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'720px',width:'96%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsxs(\"div\",{className:\"ph-table\",style:{padding:16},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-rooms-title\",style:{textAlign:'left',marginTop:0},children:\"Danh s\\xE1ch \\u0111\\xE1nh gi\\xE1 c\\u1EE7a b\\u1EA1n\"}),listLoading?/*#__PURE__*/_jsx(\"div\",{style:{color:'#666',fontSize:13},children:\"\\u0110ang t\\u1EA3i...\"}):reviewList.length===0?/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',padding:12},children:\"B\\u1EA1n ch\\u01B0a c\\xF3 \\u0111\\xE1nh gi\\xE1 n\\xE0o.\"}):/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{background:'#f7f7fb'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 6px',textAlign:'left'},children:\"Kh\\xE1ch s\\u1EA1n\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 6px',textAlign:'left'},children:\"Ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 6px',textAlign:'center'},children:\"S\\u1ED1 sao\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 6px',textAlign:'left'},children:\"Nh\\u1EADn x\\xE9t\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 6px',textAlign:'center'},children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:reviewList.map(r=>/*#__PURE__*/_jsxs(\"tr\",{style:{borderTop:'1px solid #eee'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 6px'},children:r.hotelName}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 6px'},children:r.roomName}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'8px 6px',textAlign:'center'},children:[r.rating.toFixed(1),\" / 5.0\"]}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 6px',maxWidth:220,overflowWrap:'anywhere'},children:r.comment}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 6px',textAlign:'center'},children:/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:()=>onEditReview&&onEditReview(r),children:\"S\\u1EEDa\"})})]},r.id))})]})]})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-overlay\",role:\"dialog\",\"aria-modal\":\"true\",onMouseDown:e=>{if(e.target===e.currentTarget)onClose&&onClose();},children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile-back\",type:\"button\",\"aria-label\":\"Quay l\\u1EA1i\",onClick:onClose,children:\"\\u2190 Quay l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",style:{maxWidth:'720px',width:'96%',marginTop:56},onMouseDown:e=>e.stopPropagation(),children:/*#__PURE__*/_jsxs(\"div\",{className:\"ph-table\",style:{padding:16},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-rooms-title\",style:{textAlign:'left',marginTop:0},children:\"\\u0110\\xE1nh gi\\xE1 d\\u1ECBch v\\u1EE5\"}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#444',marginBottom:10},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Kh\\xE1ch s\\u1EA1n: \",/*#__PURE__*/_jsx(\"b\",{children:(data===null||data===void 0?void 0:data.hotelName)||'—'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Ph\\xF2ng: \",/*#__PURE__*/_jsx(\"b\",{children:roomLabel}),\" (\",fmtDate(data===null||data===void 0?void 0:data.checkIn),\" \\u2013 \",fmtDate(data===null||data===void 0?void 0:data.checkOut),\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{margin:'8px 0'},children:\"Ch\\u1ECDn s\\u1ED1 sao c\\u1EE7a b\\u1EA1n:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"rv-stars\",children:[/*#__PURE__*/_jsx(HalfStarRow,{value:rating,onChange:setRating}),/*#__PURE__*/_jsxs(\"span\",{className:\"rv-rating-text\",children:[rating.toFixed(1),\" / 5.0\"]})]}),loading&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#666',fontSize:13},children:\"\\u0110ang t\\u1EA3i \\u0111\\xE1nh gi\\xE1...\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10},children:\"Nh\\u1EADn x\\xE9t c\\u1EE7a b\\u1EA1n:\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"rv-textarea\",rows:6,placeholder:\"Chia s\\u1EBB tr\\u1EA3i nghi\\u1EC7m d\\u1ECBch v\\u1EE5...\",value:comment,onChange:e=>setComment(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"rv-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"T\\xEAn c\\u1EE7a b\\u1EA1n:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:e=>setName(e.target.value),placeholder:\"Nh\\u1EADp t\\xEAn\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rv-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),placeholder:\"Nh\\u1EADp email\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",disabled:submitting||!email||!rating,onClick:submit,children:submitting?'Đang gửi...':'Gửi đánh giá'}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:onClose,children:\"H\\u1EE7y\"}),done&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:6,color:'#0b7a30',fontWeight:700,alignSelf:'center'},children:\"C\\u1EA3m \\u01A1n b\\u1EA1n!\"}),!done&&errMsg&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:6,color:'#b42318',fontWeight:700,alignSelf:'center'},children:errMsg})]})]})})]});}function HalfStarRow(_ref4){let{value,onChange}=_ref4;// Render 5 stars; each supports full and half selection\nconst stars=[1,2,3,4,5];const handleMouseClick=(n,e)=>{const rect=e.currentTarget.getBoundingClientRect();const isLeft=e.clientX-rect.left<rect.width/2;onChange(isLeft?n-0.5:n);};return/*#__PURE__*/_jsx(\"div\",{role:\"radiogroup\",\"aria-label\":\"Ch\\u1ECDn s\\u1ED1 sao (0.5)\",children:stars.map(n=>{const fillRatio=Math.max(0,Math.min(1,value-(n-1)));const widthPct=\"\".concat(Math.round(fillRatio*100),\"%\");return/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"rv-star-wrap\",onClick:e=>handleMouseClick(n,e),\"aria-label\":\"\".concat(Math.max(0.5,Math.min(5,value)).toFixed(1),\" sao\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"rv-star-base\",children:\"\\u2605\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rv-star-fill\",style:{width:widthPct},children:\"\\u2605\"})]},n);})});}function fmtDate(d){if(!d)return'—';const dt=new Date(d);const dd=String(dt.getDate()).padStart(2,'0');const mm=String(dt.getMonth()+1).padStart(2,'0');const yy=dt.getFullYear();return\"\".concat(dd,\"/\").concat(mm,\"/\").concat(yy);}// BellMenu đã được gỡ bỏ theo yêu cầu","map":{"version":3,"names":["React","useEffect","useRef","useState","Link","useNavigate","RoomTypeInline","RoomsBrowse","ServicesBrowse","AdminUsers","AdminServices","AdminPromotions","AdminAmenities","AdminRooms","AdminBookings","PaymentHistory","Profile","CheckInOut","getUserRole","authHeaders","CustomerSupport","StaffSupport","AdminReports","AdminFeedback","NotificationsBell","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","HomePage","inlineType","setInlineType","roomTypes","setRoomTypes","typesLoading","setTypesLoading","typesError","setTypesError","openProfile","setOpenProfile","openHistory","setOpenHistory","openAdminUsers","setOpenAdminUsers","openAdminServices","setOpenAdminServices","openAdminRooms","setOpenAdminRooms","openAdminAmenities","setOpenAdminAmenities","openAdminBookings","setOpenAdminBookings","highlightBookingId","setHighlightBookingId","openAdminReports","setOpenAdminReports","openAdminFeedback","setOpenAdminFeedback","openAdminPromotions","setOpenAdminPromotions","openCheckInOut","setOpenCheckInOut","openCustomerSupport","setOpenCustomerSupport","reviewing","setReviewing","showRoomsOverlay","setShowRoomsOverlay","showServicesOverlay","setShowServicesOverlay","scrollerRef","scrollByViewport","dir","el","current","vw","clientWidth","scrollBy","left","behavior","active","fetch","then","res","ok","j","json","catch","Error","message","concat","status","list","Array","isArray","err","finally","onOpenAdminBookings","e","bid","detail","bookingId","Number","window","addEventListener","removeEventListener","scrollTop","scrollTo","top","_unused","className","children","src","alt","type","onClick","placeholder","GridMenu","onOpenHistory","onOpenReviews","onOpenServices","onOpenAdminUsers","onOpenAdminServices","onOpenAdminRooms","onOpenAdminAmenities","onOpenAdminReports","onOpenAdminFeedback","onOpenAdminPromotions","onOpenCheckInOut","onOpenCustomerSupport","UserMenu","onOpenProfile","alert","_unused2","disabled","style","color","ref","length","map","rt","img","image","maxAdults","maxChildren","price","basePrice","name","textAlign","toLocaleString","id","onClose","zIndex","onMouseDown","target","currentTarget","width","maxWidth","padding","display","flexDirection","stopPropagation","flex","overflow","inline","href","rel","isModal","role","marginTop","background","borderRadius","onReview","it","alignItems","maxHeight","ReviewModal","data","listMode","onEditReview","r","hotelName","roomName","checkIn","checkOut","_ref","open","setOpen","setActive","navigate","onDocClick","contains","onEsc","key","document","isAdmin","isStaff","items","label","to","isReview","v","getElementById","scrollIntoView","block","_unused3","_ref2","user","setUser","handleClickOutside","handleEsc","loadUser","u","localStorage","getItem","parsed","JSON","parse","avatar","startsWith","_unused4","onStorage","enrich","email","encodeURIComponent","Date","now","next","_objectSpread","setItem","stringify","_unused5","dispatchEvent","Event","_unused6","_unused7","marginLeft","removeItem","_unused8","_unused9","_unused0","setTimeout","_unused1","_ref3","reviewList","setReviewList","listLoading","setListLoading","cache","Promise","reject","reviews","rating","setRating","comment","setComment","setName","setEmail","submitting","setSubmitting","done","setDone","errMsg","setErrMsg","loading","setLoading","_unused10","load","url","URL","location","origin","searchParams","set","String","toString","review","submit","method","headers","body","_unused11","roomLabel","fontSize","borderCollapse","borderTop","toFixed","overflowWrap","marginBottom","fmtDate","margin","HalfStarRow","value","onChange","rows","gap","fontWeight","alignSelf","_ref4","stars","handleMouseClick","n","rect","getBoundingClientRect","isLeft","clientX","fillRatio","Math","max","min","widthPct","round","d","dt","dd","getDate","padStart","mm","getMonth","yy","getFullYear"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/HomePage.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport RoomTypeInline from './RoomTypeInline';\r\nimport RoomsBrowse from './RoomsBrowse';\r\nimport ServicesBrowse from './ServicesBrowse';\r\nimport AdminUsers from './AdminUsers';\r\nimport AdminServices from './AdminServices';\r\nimport AdminPromotions from './AdminPromotions';\r\nimport AdminAmenities from './AdminAmenities';\r\nimport AdminRooms from './AdminRooms';\r\nimport AdminBookings from './AdminBookings';\r\nimport PaymentHistory from './PaymentHistory';\r\nimport Profile from './Profile';\r\nimport CheckInOut from './CheckInOut';\r\nimport { getUserRole, authHeaders } from './auth';\r\nimport CustomerSupport from './CustomerSupport';\r\nimport StaffSupport from './StaffSupport';\r\nimport './Auth.css';\r\nimport './HomePage.css';\r\nimport AdminReports from './AdminReports';\r\nimport AdminFeedback from './AdminFeedback';\r\nimport NotificationsBell from './NotificationsBell';\r\n// Promotions feature removed\r\n\r\nconst HomePage = () => {\r\n  const [inlineType, setInlineType] = useState('');\r\n  const [roomTypes, setRoomTypes] = useState([]);\r\n  const [typesLoading, setTypesLoading] = useState(true);\r\n  const [typesError, setTypesError] = useState('');\r\n  const [openProfile, setOpenProfile] = useState(false);\r\n  const [openHistory, setOpenHistory] = useState(false);\r\n  const [openAdminUsers, setOpenAdminUsers] = useState(false);\r\n  const [openAdminServices, setOpenAdminServices] = useState(false);\r\n  const [openAdminRooms, setOpenAdminRooms] = useState(false);\r\n  const [openAdminAmenities, setOpenAdminAmenities] = useState(false);\r\n  const [openAdminBookings, setOpenAdminBookings] = useState(false);\r\n  const [highlightBookingId, setHighlightBookingId] = useState(null);\r\n  const [openAdminReports, setOpenAdminReports] = useState(false);\r\n  const [openAdminFeedback, setOpenAdminFeedback] = useState(false);\r\n  const [openAdminPromotions, setOpenAdminPromotions] = useState(false);\r\n  // const [openAdminPromotions, setOpenAdminPromotions] = useState(false); // removed\r\n  const [openCheckInOut, setOpenCheckInOut] = useState(false);\r\n  const [openCustomerSupport, setOpenCustomerSupport] = useState(false);\r\n  const [reviewing, setReviewing] = useState(null);\r\n  const [showRoomsOverlay, setShowRoomsOverlay] = useState(false);\r\n  const [showServicesOverlay, setShowServicesOverlay] = useState(false);\r\n  const scrollerRef = useRef(null);\r\n\r\n  const scrollByViewport = (dir) => {\r\n    const el = scrollerRef.current;\r\n    if (!el) return;\r\n    const vw = el.clientWidth;\r\n    el.scrollBy({ left: dir * (vw - 40), behavior: 'smooth' });\r\n  };\r\n\r\n\r\n  useEffect(() => {\r\n    let active = true;\r\n    setTypesLoading(true);\r\n    setTypesError('');\r\n    fetch('/api/room-types')\r\n      .then(async (res) => {\r\n        if (!res.ok) {\r\n          const j = await res.json().catch(() => ({}));\r\n          throw new Error(j.message || `HTTP ${res.status}`);\r\n        }\r\n        return res.json();\r\n      })\r\n      .then((list) => { if (active) setRoomTypes(Array.isArray(list) ? list : []); })\r\n      .catch((err) => { if (active) setTypesError(err.message || 'Lỗi tải hạng phòng'); })\r\n      .finally(() => { if (active) setTypesLoading(false); });\r\n    return () => { active = false; };\r\n  }, []);\r\n\r\n  // Listen for requests to open admin bookings from other parts of the app\r\n  useEffect(() => {\r\n    const onOpenAdminBookings = (e) => {\r\n      const bid = e && e.detail && e.detail.bookingId ? Number(e.detail.bookingId) : null;\r\n      setHighlightBookingId(bid);\r\n      setOpenAdminBookings(true);\r\n    };\r\n    window.addEventListener('open-admin-bookings', onOpenAdminBookings);\r\n    return () => window.removeEventListener('open-admin-bookings', onOpenAdminBookings);\r\n  }, []);\r\n\r\n  const scrollTop = () => {\r\n    try {\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    } catch {\r\n      window.scrollTo(0, 0);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"home-root\">\r\n      <header className=\"home-header\">\r\n        <div className=\"home-header-left\">\r\n          <img src=\"/logo.png\" alt=\"HMS Logo\" className=\"home-header-logo\" />\r\n          <button type=\"button\" onClick={scrollTop} className=\"home-header-title home-header-home-btn\">TRANG CHỦ</button>\r\n        </div>\r\n        <div className=\"home-header-search\">\r\n          <input type=\"text\" className=\"home-header-search-input\" placeholder=\"Tìm kiếm...\" />\r\n          <img src=\"/icon-search.png\" alt=\"Search\" className=\"home-header-search-img\" />\r\n        </div>\r\n        <div className=\"home-header-icons\">\r\n          <span className=\"home-header-icon\"><img src=\"/icon-language.png\" alt=\"Language\" className=\"home-header-icon-img\" /></span>\r\n          <NotificationsBell />\r\n          <GridMenu\r\n            onOpenHistory={() => setOpenHistory(true)}\r\n            onOpenReviews={() => setReviewing('list')}\r\n            onOpenServices={() => setShowServicesOverlay(true)}\r\n            onOpenAdminUsers={() => setOpenAdminUsers(true)}\r\n            onOpenAdminServices={() => setOpenAdminServices(true)}\r\n            onOpenAdminRooms={() => setOpenAdminRooms(true)}\r\n            onOpenAdminAmenities={() => setOpenAdminAmenities(true)}\r\n            onOpenAdminBookings={() => setOpenAdminBookings(true)}\r\n            onOpenAdminReports={() => setOpenAdminReports(true)}\r\n            onOpenAdminFeedback={() => setOpenAdminFeedback(true)}\r\n            onOpenAdminPromotions={() => setOpenAdminPromotions(true)}\r\n            // promotions removed\r\n            onOpenCheckInOut={() => setOpenCheckInOut(true)}\r\n            onOpenCustomerSupport={() => setOpenCustomerSupport(true)}\r\n          />\r\n          {/* User menu */}\r\n          <UserMenu onOpenProfile={() => setOpenProfile(true)} />\r\n        </div>\r\n      </header>\r\n      {/* Banner Section */}\r\n      <section className=\"home-banner\">\r\n        <img\r\n          src=\"/HomeBanner/home-banner.png\"\r\n          alt=\"Hotel Banner\"\r\n          className=\"home-banner-img\"\r\n        />\r\n        <div className=\"home-banner-content\">\r\n          <h1 className=\"home-banner-title\">\r\n            WELCOME TO<br />HMS-AI\r\n          </h1>\r\n          <h2 className=\"home-banner-subtitle\">\r\n            HỆ THỐNG QUẢN LÝ KHÁCH SẠN <br />TRỰC TUYẾN\r\n          </h2>\r\n          <button\r\n            className=\"btn-primary home-banner-btn\"\r\n            onClick={() => {\r\n              try {\r\n                if (getUserRole() === 'Admin') { window.alert('Tài khoản admin không được phép đặt phòng'); return; }\r\n              } catch {}\r\n              setShowRoomsOverlay(true);\r\n            }}\r\n            disabled={getUserRole() === 'Admin'}\r\n          >ĐẶT PHÒNG NGAY</button>\r\n        </div>\r\n        {/* Chatbot Icon */}\r\n        <div className=\"home-chatbot\">\r\n          <img src=\"/chatbox.png\" alt=\"Chatbot\" className=\"home-chatbot-img\" />\r\n          <div className=\"home-chatbot-label\">CHATBOT</div>\r\n        </div>\r\n\r\n      </section>\r\n\r\n      {/* Info Section */}\r\n      <section className=\"home-info\">\r\n        <div className=\"home-info-text\">\r\n          <h2 className=\"home-info-title\">\r\n            Nơi nghỉ dưỡng đẳng cấp – Chạm đến từng khoảnh khắc bình yên\r\n          </h2>\r\n          <p className=\"home-info-desc\">\r\n            Khách sạn HMS-AI mang đến bạn một không gian nghỉ dưỡng sang trọng và tiện nghi bậc nhất. Với hệ thống phòng hiện đại, dịch vụ chuyên nghiệp cùng đội ngũ nhân viên thân thiện, chúng tôi cam kết mang lại cho bạn những trải nghiệm thoải mái và đáng nhớ. Hãy để HMS-AI trở thành điểm đến lý tưởng cho kỳ nghỉ hoặc chuyến công tác của bạn!\r\n          </p>\r\n        </div>\r\n        <div className=\"home-info-img-wrap\">\r\n          <img\r\n            src=\"/HomeBanner/home.png\"\r\n            alt=\"Resort View\"\r\n            className=\"home-info-img\"\r\n          />\r\n        </div>\r\n      </section>\r\n\r\n      {/* Rooms Section */}\r\n      <section className=\"home-rooms\">\r\n        <h2 className=\"home-rooms-title\">Hạng Phòng</h2>\r\n        {typesLoading && <div>Đang tải danh sách hạng phòng...</div>}\r\n        {typesError && <div style={{ color: 'red' }}>{typesError}</div>}\r\n        {!typesLoading && !typesError && (\r\n          <div className=\"home-rooms-scroller\">\r\n            <button type=\"button\" className=\"home-rooms-nav left\" aria-label=\"Trước\" onClick={() => scrollByViewport(-1)}>{'<'}</button>\r\n            <div className=\"home-rooms-grid\" ref={scrollerRef}>\r\n              {roomTypes.length === 0 ? (\r\n                <div>Chưa có hạng phòng nào.</div>\r\n              ) : (\r\n                roomTypes.map((rt) => {\r\n                  const img = rt.image || '/khachsan/hp1.jpg';\r\n                  const maxAdults = Number(rt.maxAdults || 0);\r\n                  const maxChildren = Number(rt.maxChildren || 0);\r\n                  const price = Number(rt.basePrice || 0);\r\n                  return (\r\n                    <button\r\n                      key={rt.id}\r\n                      onClick={() => setInlineType(rt.name)}\r\n                      className=\"home-room-card\"\r\n                      style={{ textAlign: 'left' }}\r\n                    >\r\n                      <img className=\"home-room-img\" src={img} alt={rt.name} />\r\n                      <div className=\"home-room-meta\">{maxAdults} người lớn | {maxChildren} trẻ em</div>\r\n                      <div className=\"home-room-name\">{rt.name}</div>\r\n                      <div className=\"home-room-price\">Giá từ {price.toLocaleString('vi-VN')} VNĐ/đêm</div>\r\n                    </button>\r\n                  );\r\n                })\r\n              )}\r\n            </div>\r\n            <button type=\"button\" className=\"home-rooms-nav right\" aria-label=\"Sau\" onClick={() => scrollByViewport(1)}>{'>'}</button>\r\n          </div>\r\n        )}\r\n        {inlineType && (\r\n          <RoomTypeInline name={inlineType} onClose={() => setInlineType('')} />\r\n        )}\r\n      </section>\r\n\r\n      {showRoomsOverlay && (\r\n        <div className=\"profile-overlay\" style={{ zIndex: 1500 }} onMouseDown={(e) => { if (e.target === e.currentTarget) setShowRoomsOverlay(false); }}>\r\n          <div className=\"profile-modal\" style={{ width: '95%', maxWidth: 1400, padding: 0, display: 'flex', flexDirection: 'column' }} onMouseDown={e => e.stopPropagation()}>\r\n            <div style={{ flex: 1, overflow: 'auto', padding: '4px 4px 12px' }}>\r\n              <RoomsBrowse inline onClose={() => setShowRoomsOverlay(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showServicesOverlay && (\r\n        <div className=\"profile-overlay\" style={{ zIndex: 1500 }} onMouseDown={(e) => { if (e.target === e.currentTarget) setShowServicesOverlay(false); }}>\r\n          <div className=\"profile-modal\" style={{ width: '90%', maxWidth: 1200, padding: 0, display: 'flex', flexDirection: 'column' }} onMouseDown={e => e.stopPropagation()}>\r\n            <div style={{ flex: 1, overflow: 'auto', padding: '4px 4px 12px' }}>\r\n              <ServicesBrowse inline onClose={() => setShowServicesOverlay(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Stay Experience Section */}\r\n      <section className=\"home-experience\">\r\n        <div className=\"home-experience-left\">\r\n          <h2 className=\"home-experience-title\">Trải Nghiệm Lưu Trú</h2>\r\n          <p className=\"home-experience-desc\">\r\n            Khám phá không gian nghỉ dưỡng đẳng cấp với hạng phòng tiêu biểu của chúng tôi — nét thiết kế tinh tế hòa quyện cùng tiện nghi hiện đại mang đến trải nghiệm lưu trú khó quên. \r\n            Mỗi phòng đều được trang trí bằng những vật liệu cao cấp, tạo nên sự sang trọng và ấm cúng, khiến bạn cảm thấy như đang ở trong một thiên đường riêng. Không chỉ có vậy, tầm nhìn hướng ra cảnh quan tuyệt đẹp sẽ khiến bạn bị cuốn hút, mang lại cảm giác thư giãn tuyệt đối. \r\n            Tại đây, bạn sẽ được tận hưởng những dịch vụ chăm sóc khách hàng tận tình, giúp cho kỳ nghỉ của bạn trở nên hoàn hảo hơn bao giờ hết.\r\n          </p>\r\n        </div>\r\n        <div className=\"home-experience-right\">\r\n          <div className=\"home-frame\">\r\n            <img className=\"home-frame-img\" src=\"/khachsan/ks10.png\" alt=\"Phòng nghỉ\" />\r\n          </div>\r\n          <div className=\"home-caption\">Phòng nghỉ đẳng cấp, tiện nghi đầy đủ và không gian thoải mái, mang đến cảm giác thư giãn như chính ngôi nhà của bạn. Mỗi chi tiết trong phòng đều được thiết kế tỉ mỉ, từ nội thất sang trọng đến ánh sáng ấm áp, tạo nên một bầu không khí dễ chịu và gần gũi.</div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Experience Gallery */}\r\n      <section className=\"home-gallery\">\r\n        <div className=\"home-gallery-item\">\r\n          <img className=\"home-gallery-img\" src=\"/khachsan/ks11.png\" alt=\"\" />\r\n          <div className=\"home-gallery-caption\">Không gian ấm áp, nội thất tinh tế — lựa chọn hoàn hảo cho kỳ nghỉ đáng nhớ.</div>\r\n        </div>\r\n        <div className=\"home-gallery-item\">\r\n          <img className=\"home-gallery-img\" src=\"/khachsan/ks12.png\" alt=\"\" />\r\n          <div className=\"home-gallery-caption\">Mỗi chi tiết trong căn phòng đều được chăm chút, tạo nên sự thoải mái và đẳng cấp cho khách hàng.</div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Offers Section */}\r\n      <section className=\"home-offers\" id=\"offers-section\">\r\n        <h2 className=\"home-offers-title\">Ưu đãi dành cho bạn</h2>\r\n        <div className=\"home-offers-grid\">\r\n          <article className=\"home-offer-card\">\r\n            <img className=\"home-offer-img\" src=\"/khachsan/ks1.png\" alt=\"Đặt phòng sớm\" />\r\n            <div className=\"home-offer-body\">\r\n              <h3 className=\"home-offer-card-title\">Đặt phòng sớm</h3>\r\n              <ul className=\"home-offer-list\">\r\n                <li>Đặt phòng trước 30 ngày để nhận ngay giảm giá 20%.</li>\r\n                <li>Tiết kiệm chi phí, đảm bảo chỗ nghỉ trong mùa cao điểm.</li>\r\n              </ul>\r\n            </div>\r\n          </article>\r\n          <article className=\"home-offer-card\">\r\n            <img className=\"home-offer-img\" src=\"/khachsan/ks2.png\" alt=\"Câu lạc bộ Wellhall\" />\r\n            <div className=\"home-offer-body\">\r\n              <h3 className=\"home-offer-card-title\">Câu lạc bộ Wellhall</h3>\r\n              <ul className=\"home-offer-list\">\r\n                <li>Giảm giá khi đặt phòng.</li>\r\n                <li>Nâng hạng phòng miễn phí tùy tình trạng.</li>\r\n                <li>Được hưởng các dịch vụ VIP riêng biệt.</li>\r\n              </ul>\r\n            </div>\r\n          </article>\r\n          <article className=\"home-offer-card\">\r\n            <img className=\"home-offer-img\" src=\"/khachsan/ks3.png\" alt=\"Ở 3 đêm tặng 1 đêm\" />\r\n            <div className=\"home-offer-body\">\r\n              <h3 className=\"home-offer-card-title\">Ở 3 đêm - Tặng 1 đêm miễn phí</h3>\r\n              <ul className=\"home-offer-list\">\r\n                <li>Đặt phòng liên tiếp 3 đêm, nhận ngay 1 đêm miễn phí.</li>\r\n                <li>Kỳ nghỉ dài hơn mà không lo về chi phí.</li>\r\n              </ul>\r\n            </div>\r\n          </article>\r\n        </div>\r\n      </section>\r\n\r\n      {/* About band with testimonials */}\r\n      <section className=\"home-about\">\r\n        <div className=\"home-about-overlay\"></div>\r\n        <div className=\"home-about-inner\">\r\n          <h2 className=\"home-about-title\">Về chúng tôi</h2>\r\n          <div className=\"home-about-grid\">\r\n            <blockquote className=\"home-quote\">\r\n              <p>Khách sạn HMS-AI mang đến trải nghiệm nghỉ dưỡng đẳng cấp, kết hợp công nghệ hiện đại với sự hiếu khách truyền thống. Một điểm đến lý tưởng cho mọi du khách.</p>\r\n              <cite>Santa Solana Post</cite>\r\n            </blockquote>\r\n            <blockquote className=\"home-quote\">\r\n              <p>Không chỉ là một nơi lưu trú, HMS-AI còn mang lại dịch vụ chăm sóc khách hàng tận tâm. Đặc biệt, hệ thống đặt phòng thông minh giúp tiết kiệm thời gian và chi phí.</p>\r\n              <cite>Marianne’s Luxe Travels</cite>\r\n            </blockquote>\r\n            <blockquote className=\"home-quote\">\r\n              <p>Với không gian sang trọng, tiện nghi cao cấp và chatbot AI hỗ trợ 24/7, HMS-AI đang thay đổi cách khách hàng trải nghiệm dịch vụ khách sạn trực tuyến.</p>\r\n              <cite>Fairhill Journal</cite>\r\n            </blockquote>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Footer */}\r\n      <footer className=\"home-footer\">\r\n        <div className=\"home-footer-top\">HMS–AI Hotel</div>\r\n        <div className=\"home-footer-cols\">\r\n          <div className=\"home-footer-col\">\r\n            <h4>Địa chỉ liên hệ</h4>\r\n            <ul className=\"home-contact-list\">\r\n              <li>\r\n                <img src=\"/icon-location.png\" alt=\"Địa chỉ\" />\r\n                <span>Đại học Duy Tân</span>\r\n              </li>\r\n              <li>\r\n                <img src=\"/icon-phone.png\" alt=\"Điện thoại\" />\r\n                <span>0123-456-7890</span>\r\n              </li>\r\n              <li>\r\n                <img src=\"/icon-mail.png\" alt=\"Email\" />\r\n                <span>HMS_AI_Hotel@gmail.com</span>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          <div className=\"home-footer-col\">\r\n            <h4>Kết nối với chúng tôi</h4>\r\n            <div className=\"home-social\">\r\n              <a href=\"https://www.facebook.com\" target=\"_blank\" rel=\"noreferrer\" className=\"home-social-icon\">\r\n                <img src=\"/icon-facebook.png\" alt=\"Facebook\" />\r\n              </a>\r\n              <a href=\"https://twitter.com\" target=\"_blank\" rel=\"noreferrer\" className=\"home-social-icon\">\r\n                <img src=\"/icon-twitter.png\" alt=\"Twitter\" />\r\n              </a>\r\n              <a href=\"https://www.instagram.com\" target=\"_blank\" rel=\"noreferrer\" className=\"home-social-icon\">\r\n                <img src=\"/icon-instagram.png\" alt=\"Instagram\" />\r\n              </a>\r\n            </div>\r\n            <div className=\"home-footer-note\">Đừng quên theo dõi HMS-AI Hotel để nhận ưu đãi hấp dẫn.</div>\r\n          </div>\r\n          <div className=\"home-footer-col\">\r\n            <h4>Điều khoản & Chỉnh sách</h4>\r\n            <ul>\r\n              <li>Điều khoản sử dụng</li>\r\n              <li>Chính sách bảo mật</li>\r\n              <li>Chính sách hủy phòng</li>\r\n              <li>Quy định & hỗ trợ khách hàng</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </footer>\r\n      {openProfile && (\r\n        <Profile isModal onClose={() => setOpenProfile(false)} />\r\n      )}\r\n      {openHistory && (\r\n        <div\r\n          className=\"profile-overlay\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenHistory(false); }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenHistory(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '98%', width: '98%', marginTop: 56 }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <PaymentHistory inline onReview={(it) => setReviewing(it)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openAdminUsers && (\r\n        <div\r\n          className=\"profile-overlay profile-overlay--center\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminUsers(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminUsers(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '1100px', width: '98%', marginTop: 56, maxHeight: '90vh', overflow: 'auto' }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminUsers isModal onClose={() => setOpenAdminUsers(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openAdminServices && (\r\n        <div\r\n          className=\"profile-overlay profile-overlay--center\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminServices(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminServices(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '100%', width: '100%', marginTop: 56 }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminServices isModal onClose={() => setOpenAdminServices(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openAdminRooms && (\r\n        <div\r\n          className=\"profile-overlay profile-overlay--center\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminRooms(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminRooms(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '100%', width: '100%', marginTop: 56 }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminRooms isModal onClose={() => setOpenAdminRooms(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openAdminAmenities && (\r\n        <div\r\n          className=\"profile-overlay profile-overlay--center\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminAmenities(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminAmenities(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '100%', width: '100%', marginTop: 56 }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminAmenities isModal onClose={() => setOpenAdminAmenities(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openAdminBookings && (\r\n        <div\r\n          className=\"profile-overlay profile-overlay--center\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminBookings(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminBookings(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '100%', width: '100%', marginTop: 56 }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminBookings isModal onClose={() => { setOpenAdminBookings(false); setHighlightBookingId(null); }} highlightBookingId={highlightBookingId} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openAdminReports && (\r\n        <div\r\n          className=\"profile-overlay\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminReports(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminReports(false)} style={{ top: 12, left: 12 }}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: 'calc(100vw - 24px)', width: '100%', marginTop: 56, maxHeight: '90vh', overflow: 'auto' }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminReports isModal onClose={() => setOpenAdminReports(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openAdminFeedback && (\r\n        <div\r\n          className=\"profile-overlay\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminFeedback(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminFeedback(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: 'calc(100vw - 24px)', width: '100%', marginTop: 56, maxHeight: '90vh', overflow: 'auto' }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminFeedback isModal onClose={() => setOpenAdminFeedback(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* AdminPromotions modal */}\r\n      {openAdminPromotions && (\r\n        <div\r\n          className=\"profile-overlay profile-overlay--center\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenAdminPromotions(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenAdminPromotions(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '1100px', width: '98%', marginTop: 56, maxHeight: '90vh', overflow: 'auto' }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <AdminPromotions isModal onClose={() => setOpenAdminPromotions(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openCheckInOut && (\r\n        <div\r\n          className=\"profile-overlay\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenCheckInOut(false); }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenCheckInOut(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '100%', width: '100%', marginTop: 56 }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              <CheckInOut isModal onClose={() => setOpenCheckInOut(false)} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {openCustomerSupport && (\r\n        <div\r\n          className=\"profile-overlay profile-overlay--center\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          onMouseDown={(e) => { if (e.target === e.currentTarget) setOpenCustomerSupport(false); }}\r\n          style={{ alignItems: 'flex-start' }}\r\n        >\r\n          <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={() => setOpenCustomerSupport(false)}>\r\n            ← Quay lại\r\n          </button>\r\n          <div\r\n            className=\"profile-modal\"\r\n            style={{ maxWidth: '100%', width: '100%', marginTop: 56 }}\r\n            onMouseDown={(e) => e.stopPropagation()}\r\n          >\r\n            <div style={{ background: '#fff', borderRadius: 12, padding: 8 }}>\r\n              {getUserRole() === 'Staff' ? (\r\n                <StaffSupport isModal onClose={() => setOpenCustomerSupport(false)} />\r\n              ) : (\r\n                <CustomerSupport isModal onClose={() => setOpenCustomerSupport(false)} />\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {reviewing && (\r\n        <ReviewModal\r\n          data={typeof reviewing === 'object' ? reviewing : null}\r\n          listMode={reviewing === 'list'}\r\n          onClose={() => setReviewing(null)}\r\n          onEditReview={r => setReviewing({\r\n            bookingId: r.bookingId,\r\n            hotelName: r.hotelName,\r\n            roomName: r.roomName,\r\n            checkIn: r.checkIn,\r\n            checkOut: r.checkOut\r\n          })}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\nexport default HomePage;\r\n\r\nfunction GridMenu({ onOpenHistory, onOpenReviews, onOpenServices, onOpenAdminUsers, onOpenAdminServices, onOpenAdminRooms, onOpenAdminPromotions, onOpenAdminBookings, onOpenCheckInOut, onOpenCustomerSupport, onOpenAdminReports, onOpenAdminFeedback, onOpenAdminAmenities }) {\r\n  const [open, setOpen] = useState(false);\r\n  const [active, setActive] = useState('');\r\n  const ref = useRef(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const onDocClick = (e) => { if (ref.current && !ref.current.contains(e.target)) setOpen(false); };\r\n    const onEsc = (e) => { if (e.key === 'Escape') setOpen(false); };\r\n    document.addEventListener('mousedown', onDocClick);\r\n    document.addEventListener('keydown', onEsc);\r\n    return () => { document.removeEventListener('mousedown', onDocClick); document.removeEventListener('keydown', onEsc); };\r\n  }, []);\r\n\r\n  const role = getUserRole();\r\n  const isAdmin = role === 'Admin';\r\n  const isStaff = role === 'Staff';\r\n  // Theo yêu cầu: Admin chỉ thấy các chức năng Quản lý + Báo cáo/Thống kê (loại bỏ các mục chung khách hàng)\r\n  let items;\r\n  if (isAdmin) {\r\n    items = [\r\n      { key: 'manage-users', label: 'QUẢN LÝ NGƯỜI DÙNG' },\r\n      { key: 'manage-services', label: 'QUẢN LÝ DỊCH VỤ KHÁCH SẠN' },\r\n      { key: 'manage-rooms', label: 'QUẢN LÝ PHÒNG' },\r\n      { key: 'manage-promotions', label: 'QUẢN LÝ ƯU ĐÃI' },\r\n      { key: 'manage-amenities', label: 'QUẢN LÝ TIỆN NGHI' },\r\n      { key: 'manage-bookings', label: 'QUẢN LÝ ĐẶT PHÒNG' },\r\n      { key: 'manage-feedback', label: 'QUẢN LÝ PHẢN HỒI' },\r\n      { key: 'reports', label: 'BÁO CÁO, THỐNG KÊ' },\r\n    ];\r\n  } else {\r\n    // Người dùng thường hoặc Staff vẫn thấy các mục chung\r\n    items = [\r\n      { key: 'news', label: 'TIN TỨC' },\r\n      { key: 'offers', label: 'ƯU ĐÃI' },\r\n      { key: 'services', label: 'DỊCH VỤ' },\r\n      { key: 'history', label: 'LỊCH SỬ GIAO DỊCH', to: '/transactions' },\r\n      { key: 'reviews', label: 'ĐÁNH GIÁ', isReview: true },\r\n      ...(isStaff ? [\r\n        { key: 'checkinout', label: 'QUẢN LÝ CHECK IN - CHECK OUT' },\r\n        { key: 'support', label: 'HỖ TRỢ KHÁCH HÀNG' },\r\n      ] : []),\r\n    ];\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid-menu\" ref={ref}>\r\n      <button\r\n        type=\"button\"\r\n        className={`home-header-icon grid-btn ${open ? 'is-open' : ''} ${active ? 'has-active' : ''}`}\r\n        aria-haspopup=\"menu\"\r\n        aria-expanded={open}\r\n        onClick={() => setOpen((v) => !v)}\r\n      >\r\n        <img src=\"/icon-grid.png\" alt=\"Grid\" className={`home-header-icon-img ${active ? 'active' : ''}`} />\r\n      </button>\r\n      {open && (\r\n        <div className=\"grid-menu-dropdown\" role=\"menu\">\r\n          {items.map((it) => (\r\n            <button\r\n              key={it.key}\r\n              type=\"button\"\r\n              className={`grid-item ${active === it.key ? 'active' : ''}`}\r\n              onClick={() => {\r\n                setActive(it.key);\r\n                setOpen(false);\r\n                if (it.key === 'history' && typeof onOpenHistory === 'function') { onOpenHistory(); return; }\r\n                // Requirement: clicking 'TIN TỨC' scrolls to 'Ưu đãi dành cho bạn'\r\n                if (it.key === 'news') {\r\n                  try {\r\n                    const el = document.getElementById('offers-section');\r\n                    if (el) {\r\n                      el.scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n                    }\r\n                  } catch {}\r\n                  return;\r\n                }\r\n                if (it.isReview && typeof onOpenReviews === 'function') { onOpenReviews(); return; }\r\n                if (it.key === 'services' && typeof onOpenServices === 'function') { onOpenServices(); return; }\r\n                if (it.key === 'manage-users' && typeof onOpenAdminUsers === 'function') { onOpenAdminUsers(); return; }\r\n                if (it.key === 'manage-rooms' && typeof onOpenAdminRooms === 'function') { onOpenAdminRooms(); return; }\r\n                if (it.key === 'manage-promotions' && typeof onOpenAdminPromotions === 'function') { onOpenAdminPromotions(); return; }\r\n                if (it.key === 'manage-amenities' && typeof onOpenAdminAmenities === 'function') { onOpenAdminAmenities(); return; }\r\n                if (it.key === 'manage-bookings' && typeof onOpenAdminBookings === 'function') { onOpenAdminBookings(); return; }\r\n                if (it.key === 'manage-services' && typeof onOpenAdminServices === 'function') { onOpenAdminServices(); return; }\r\n                if (it.key === 'checkinout' && typeof onOpenCheckInOut === 'function') { onOpenCheckInOut(); return; }\r\n                if (it.key === 'support' && typeof onOpenCustomerSupport === 'function') { onOpenCustomerSupport(); return; }\r\n                if (it.key === 'reports' && typeof onOpenAdminReports === 'function') { onOpenAdminReports(); return; }\r\n                if (it.key === 'manage-feedback' && typeof onOpenAdminFeedback === 'function') { onOpenAdminFeedback(); return; }\r\n                // promotions handler removed\r\n                if (it.to) navigate(it.to);\r\n              }}\r\n            >\r\n              <span className=\"grid-dot\" aria-hidden />\r\n              <span className=\"grid-label\">{it.label}</span>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction UserMenu({ onOpenProfile }) {\r\n  const [open, setOpen] = useState(false);\r\n  const [active, setActive] = useState('');\r\n  const [user, setUser] = useState(null);\r\n  const ref = useRef(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (e) => {\r\n      if (ref.current && !ref.current.contains(e.target)) setOpen(false);\r\n    };\r\n    const handleEsc = (e) => {\r\n      if (e.key === 'Escape') setOpen(false);\r\n    };\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    document.addEventListener('keydown', handleEsc);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n      document.removeEventListener('keydown', handleEsc);\r\n    };\r\n  }, []);\r\n\r\n  // Load user from localStorage and listen for changes (e.g., after login)\r\n  useEffect(() => {\r\n    const loadUser = () => {\r\n      try {\r\n        const u = localStorage.getItem('hmsUser');\r\n        const parsed = u ? JSON.parse(u) : null;\r\n        if (parsed && parsed.avatar && typeof parsed.avatar === 'string' && parsed.avatar.startsWith('/')) {\r\n          // Ensure absolute URL to avoid broken image in some setups\r\n          parsed.avatar = parsed.avatar; // CRA proxy serves /uploads from backend\r\n        }\r\n        setUser(parsed);\r\n      } catch {\r\n        setUser(null);\r\n      }\r\n    };\r\n    loadUser();\r\n    const onStorage = (e) => {\r\n      if (!e || e.key === 'hmsUser') loadUser();\r\n    };\r\n    window.addEventListener('storage', onStorage);\r\n    // Custom event for same-tab updates\r\n    window.addEventListener('hms-auth-change', loadUser);\r\n    return () => {\r\n      window.removeEventListener('storage', onStorage);\r\n      window.removeEventListener('hms-auth-change', loadUser);\r\n    };\r\n  }, []);\r\n\r\n  // Enrich user with avatar if missing\r\n  useEffect(() => {\r\n    const enrich = async () => {\r\n      if (!user || !user.email || user.avatar) return;\r\n      try {\r\n        const res = await fetch(`/api/users/profile?email=${encodeURIComponent(user.email)}&_=${Date.now()}`);\r\n        if (!res.ok) return;\r\n        const j = await res.json();\r\n        if (j && j.user) {\r\n          const next = { ...user, name: j.user.name || user.name, avatar: j.user.avatar || user.avatar };\r\n          setUser(next);\r\n          try { localStorage.setItem('hmsUser', JSON.stringify(next)); } catch { }\r\n          try { window.dispatchEvent(new Event('hms-auth-change')); } catch { }\r\n        }\r\n      } catch { }\r\n    };\r\n    enrich();\r\n  }, [user && user.email, user && user.avatar]);\r\n  return (\r\n    <div className=\"home-user-menu\" ref={ref}>\r\n      <button\r\n        type=\"button\"\r\n        className={`home-header-icon home-user-button ${open ? 'is-open' : ''}`}\r\n        onClick={() => setOpen((v) => !v)}\r\n        aria-haspopup=\"menu\"\r\n        aria-expanded={open}\r\n      >\r\n        {user?.avatar ? (\r\n          <span className=\"home-avatar-circle\"><img src={user.avatar} alt=\"avatar\" /></span>\r\n        ) : (\r\n          <img src=\"/icon-user.png\" alt=\"User\" className=\"home-header-icon-img\" />\r\n        )}\r\n      </button>\r\n      {user && (\r\n        <span className=\"home-user-name\" style={{ marginLeft: 8 }}>\r\n          {user.name || user.email}\r\n        </span>\r\n      )}\r\n      {open && (\r\n        <div className=\"home-user-dropdown\" role=\"menu\">\r\n          {user ? (\r\n            <>\r\n              <div className=\"home-user-greet\" aria-disabled>\r\n                Xin chào, {user.name || user.email}\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                className=\"home-user-item\"\r\n                onClick={() => { setOpen(false); onOpenProfile && onOpenProfile(); }}\r\n              >\r\n                <span className=\"user-item-dot\" aria-hidden />\r\n                <span className=\"user-item-label\">THÔNG TIN CÁ NHÂN</span>\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                className=\"home-user-item\"\r\n                onClick={() => {\r\n                  try {\r\n                    localStorage.removeItem('hmsUser');\r\n                  } catch { }\r\n                  setUser(null);\r\n                  setOpen(false);\r\n                  try { window.dispatchEvent(new Event('hms-auth-change')); } catch { }\r\n                  // Navigate to homepage and scroll to top\r\n                  try { navigate('/'); } catch { }\r\n                  try { setTimeout(() => window.scrollTo(0, 0), 0); } catch { }\r\n                }}\r\n              >\r\n                <span className=\"user-item-dot\" aria-hidden />\r\n                <span className=\"user-item-label\">ĐĂNG XUẤT</span>\r\n              </button>\r\n            </>\r\n          ) : (\r\n            <Link\r\n              to=\"/login\"\r\n              className={`home-user-item ${active === 'login' ? 'active' : ''}`}\r\n              onClick={() => {\r\n                setActive('login');\r\n                setOpen(false);\r\n              }}\r\n            >\r\n              <span className=\"user-item-dot\" aria-hidden />\r\n              <span className=\"user-item-label\">ĐĂNG NHẬP</span>\r\n            </Link>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ReviewModal({ data, onClose, listMode, onEditReview }) {\r\n  const [reviewList, setReviewList] = useState([]);\r\n  const [listLoading, setListLoading] = useState(false);\r\n  const [user, setUser] = useState(null);\r\n  // List mode: fetch all reviews for user\r\n  useEffect(() => {\r\n    if (!listMode || !user?.email) return;\r\n    let active = true;\r\n    setListLoading(true);\r\n    fetch(`/api/reviews?email=${encodeURIComponent(user.email)}&_=${Date.now()}`, { cache: 'no-store' })\r\n      .then(res => res.ok ? res.json() : Promise.reject())\r\n      .then(j => { if (active) setReviewList(Array.isArray(j.reviews) ? j.reviews : []); })\r\n      .catch(() => { if (active) setReviewList([]); })\r\n      .finally(() => { if (active) setListLoading(false); });\r\n    return () => { active = false; };\r\n  }, [listMode, user?.email]);\r\n  const [rating, setRating] = useState(4);\r\n  const [comment, setComment] = useState('');\r\n  const [name, setName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [done, setDone] = useState(false);\r\n  const [errMsg, setErrMsg] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    try { const u = localStorage.getItem('hmsUser'); if (u) setUser(JSON.parse(u)); } catch { }\r\n  }, []);\r\n  useEffect(() => {\r\n    if (user) { setName(user.name || ''); setEmail(user.email || ''); }\r\n  }, [user]);\r\n  useEffect(() => {\r\n    if (listMode) return;\r\n    let active = true;\r\n    const load = async () => {\r\n      if (!data?.bookingId || !user?.email) { setLoading(false); return; }\r\n      try {\r\n        setLoading(true);\r\n        const url = new URL('/api/reviews', window.location.origin);\r\n        url.searchParams.set('email', user.email);\r\n        url.searchParams.set('bookingId', String(data.bookingId));\r\n        url.searchParams.set('_', String(Date.now()));\r\n        const res = await fetch(url.toString(), { cache: 'no-store' });\r\n        if (!active) return;\r\n        if (res.ok) {\r\n          const j = await res.json();\r\n          if (j?.review) {\r\n            setRating(j.review.rating || 4);\r\n            setComment(j.review.comment || '');\r\n          } else {\r\n            // No review yet: keep defaults\r\n          }\r\n        } else {\r\n          // keep defaults on error\r\n        }\r\n      } finally {\r\n        if (active) setLoading(false);\r\n      }\r\n    };\r\n    load();\r\n    return () => { active = false; };\r\n  }, [listMode, data?.bookingId, user?.email]);\r\n\r\n  const submit = async () => {\r\n    setErrMsg('');\r\n    if (!rating || !email || !data?.bookingId) { setErrMsg('Thiếu thông tin bắt buộc'); return; }\r\n    setSubmitting(true);\r\n    try {\r\n      const res = await fetch('/api/reviews', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          email,\r\n          bookingId: data.bookingId,\r\n          rating, // 0.5 steps; server converts to integer halves\r\n          comment\r\n        })\r\n      });\r\n      if (!res.ok) {\r\n        const j = await res.json().catch(() => ({ message: 'Lỗi gửi đánh giá' }));\r\n        throw new Error(j.message || 'Lỗi gửi đánh giá');\r\n      }\r\n      setDone(true);\r\n      // Reflect new values immediately\r\n      try { const j = await res.json(); } catch { }\r\n      setTimeout(() => { onClose && onClose(); }, 900);\r\n    } catch (e) {\r\n      setErrMsg(e.message || 'Không thể gửi đánh giá');\r\n    } finally { setSubmitting(false); }\r\n  };\r\n\r\n  // Show only exact room name for display\r\n  const roomLabel = data?.roomName || '';\r\n\r\n  if (listMode) {\r\n    return (\r\n      <div\r\n        className=\"profile-overlay\"\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        onMouseDown={(e) => { if (e.target === e.currentTarget) onClose && onClose(); }}\r\n      >\r\n        <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={onClose}>← Quay lại</button>\r\n        <div\r\n          className=\"profile-modal\"\r\n          style={{ maxWidth: '720px', width: '96%', marginTop: 56 }}\r\n          onMouseDown={(e) => e.stopPropagation()}\r\n        >\r\n          <div className=\"ph-table\" style={{ padding: 16 }}>\r\n            <h2 className=\"home-rooms-title\" style={{ textAlign: 'left', marginTop: 0 }}>Danh sách đánh giá của bạn</h2>\r\n            {listLoading ? <div style={{ color: '#666', fontSize: 13 }}>Đang tải...</div> : (\r\n              reviewList.length === 0 ? <div style={{ color: '#888', padding: 12 }}>Bạn chưa có đánh giá nào.</div> : (\r\n                <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                  <thead>\r\n                    <tr style={{ background: '#f7f7fb' }}>\r\n                      <th style={{ padding: '8px 6px', textAlign: 'left' }}>Khách sạn</th>\r\n                      <th style={{ padding: '8px 6px', textAlign: 'left' }}>Phòng</th>\r\n                      <th style={{ padding: '8px 6px', textAlign: 'center' }}>Số sao</th>\r\n                      <th style={{ padding: '8px 6px', textAlign: 'left' }}>Nhận xét</th>\r\n                      <th style={{ padding: '8px 6px', textAlign: 'center' }}>Thao tác</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {reviewList.map(r => (\r\n                      <tr key={r.id} style={{ borderTop: '1px solid #eee' }}>\r\n                        <td style={{ padding: '8px 6px' }}>{r.hotelName}</td>\r\n                        <td style={{ padding: '8px 6px' }}>{r.roomName}</td>\r\n                        <td style={{ padding: '8px 6px', textAlign: 'center' }}>{r.rating.toFixed(1)} / 5.0</td>\r\n                        <td style={{ padding: '8px 6px', maxWidth: 220, overflowWrap: 'anywhere' }}>{r.comment}</td>\r\n                        <td style={{ padding: '8px 6px', textAlign: 'center' }}>\r\n                          <button className=\"ph-btn ph-btn--secondary\" onClick={() => onEditReview && onEditReview(r)}>Sửa</button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              )\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"profile-overlay\"\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      onMouseDown={(e) => { if (e.target === e.currentTarget) onClose && onClose(); }}\r\n    >\r\n      <button className=\"profile-back\" type=\"button\" aria-label=\"Quay lại\" onClick={onClose}>← Quay lại</button>\r\n      <div\r\n        className=\"profile-modal\"\r\n        style={{ maxWidth: '720px', width: '96%', marginTop: 56 }}\r\n        onMouseDown={(e) => e.stopPropagation()}\r\n      >\r\n        <div className=\"ph-table\" style={{ padding: 16 }}>\r\n          <h2 className=\"home-rooms-title\" style={{ textAlign: 'left', marginTop: 0 }}>Đánh giá dịch vụ</h2>\r\n          <div style={{ color: '#444', marginBottom: 10 }}>\r\n            <div>Khách sạn: <b>{data?.hotelName || '—'}</b></div>\r\n            <div>Phòng: <b>{roomLabel}</b> ({fmtDate(data?.checkIn)} – {fmtDate(data?.checkOut)})</div>\r\n          </div>\r\n\r\n          <div style={{ margin: '8px 0' }}>Chọn số sao của bạn:</div>\r\n          <div className=\"rv-stars\">\r\n            <HalfStarRow value={rating} onChange={setRating} />\r\n            <span className=\"rv-rating-text\">{rating.toFixed(1)} / 5.0</span>\r\n          </div>\r\n          {loading && <div style={{ color: '#666', fontSize: 13 }}>Đang tải đánh giá...</div>}\r\n\r\n          <div style={{ marginTop: 10 }}>Nhận xét của bạn:</div>\r\n          <textarea className=\"rv-textarea\" rows={6} placeholder=\"Chia sẻ trải nghiệm dịch vụ...\" value={comment} onChange={(e) => setComment(e.target.value)} />\r\n\r\n          <div className=\"rv-field\">\r\n            <label>Tên của bạn:</label>\r\n            <input type=\"text\" value={name} onChange={(e) => setName(e.target.value)} placeholder=\"Nhập tên\" />\r\n          </div>\r\n          <div className=\"rv-field\">\r\n            <label>Email:</label>\r\n            <input type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} placeholder=\"Nhập email\" />\r\n          </div>\r\n\r\n          <div style={{ marginTop: 10, display: 'flex', gap: 8 }}>\r\n            <button className=\"ph-btn\" disabled={submitting || !email || !rating} onClick={submit}>\r\n              {submitting ? 'Đang gửi...' : 'Gửi đánh giá'}\r\n            </button>\r\n            <button className=\"ph-btn ph-btn--secondary\" onClick={onClose}>Hủy</button>\r\n            {done && <span style={{ marginLeft: 6, color: '#0b7a30', fontWeight: 700, alignSelf: 'center' }}>Cảm ơn bạn!</span>}\r\n            {!done && errMsg && <span style={{ marginLeft: 6, color: '#b42318', fontWeight: 700, alignSelf: 'center' }}>{errMsg}</span>}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction HalfStarRow({ value, onChange }) {\r\n  // Render 5 stars; each supports full and half selection\r\n  const stars = [1, 2, 3, 4, 5];\r\n  const handleMouseClick = (n, e) => {\r\n    const rect = e.currentTarget.getBoundingClientRect();\r\n    const isLeft = (e.clientX - rect.left) < rect.width / 2;\r\n    onChange(isLeft ? n - 0.5 : n);\r\n  };\r\n  return (\r\n    <div role=\"radiogroup\" aria-label=\"Chọn số sao (0.5)\">\r\n      {stars.map(n => {\r\n        const fillRatio = Math.max(0, Math.min(1, value - (n - 1)));\r\n        const widthPct = `${Math.round(fillRatio * 100)}%`;\r\n        return (\r\n          <button key={n} type=\"button\" className=\"rv-star-wrap\" onClick={(e) => handleMouseClick(n, e)} aria-label={`${Math.max(0.5, Math.min(5, value)).toFixed(1)} sao`}>\r\n            <span className=\"rv-star-base\">★</span>\r\n            <span className=\"rv-star-fill\" style={{ width: widthPct }}>★</span>\r\n          </button>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction fmtDate(d) { if (!d) return '—'; const dt = new Date(d); const dd = String(dt.getDate()).padStart(2, '0'); const mm = String(dt.getMonth() + 1).padStart(2, '0'); const yy = dt.getFullYear(); return `${dd}/${mm}/${yy}`; }\r\n\r\n// BellMenu đã được gỡ bỏ theo yêu cầu\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}