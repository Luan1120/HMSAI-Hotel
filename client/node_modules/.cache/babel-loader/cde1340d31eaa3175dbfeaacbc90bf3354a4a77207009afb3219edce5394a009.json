{"ast":null,"code":"var _jsxFileName = \"D:\\\\DA_TichHop\\\\HMS_AI Hotel\\\\client\\\\src\\\\AdminPromotions.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport './HomePage.css';\nimport { authHeaders, getUserRole } from './auth';\n\n/* Quản lý Ưu đãi / Mã khuyến mãi\r\n   - Danh sách + tìm kiếm + lọc trạng thái\r\n   - Tạo mới / Chỉnh sửa / Bật tắt (isActive)\r\n   - Preview tính giảm theo số tiền đơn hàng nhập thử\r\n   Trạng thái hiển thị:\r\n     Active    => isActive=1 && now within [startDate,endDate]\r\n     Scheduled => isActive=1 && now < startDate\r\n     Expired   => now > endDate\r\n     Disabled  => isActive=0\r\n*/\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function AdminPromotions() {\n  _s();\n  const role = getUserRole();\n  const isAdminOrStaff = ['Admin', 'Staff'].includes(role);\n  const isAdmin = role === 'Admin';\n  const [items, setItems] = useState([]); // promotions\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [q, setQ] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [createOpen, setCreateOpen] = useState(false);\n  const [editing, setEditing] = useState(null); // row object being edited inline modal\n  const [saving, setSaving] = useState(false);\n  const [creating, setCreating] = useState(false);\n  const [previewAmount, setPreviewAmount] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n  const [selectedIds, setSelectedIds] = useState(new Set());\n  const [selectAllOnPage, setSelectAllOnPage] = useState(false);\n  const debounceRef = useRef(null);\n  const now = useMemo(() => new Date(), []);\n  const localToday = useMemo(() => {\n    const d = new Date(Date.now() - new Date().getTimezoneOffset() * 60000);\n    return d.toISOString().slice(0, 10);\n  }, []);\n  const emptyForm = {\n    code: '',\n    description: '',\n    discountType: 'PERCENT',\n    discountValue: '',\n    startDate: '',\n    endDate: '',\n    minOrderAmount: '',\n    maxDiscount: '',\n    isActive: true,\n    hotelId: '' // '' = tất cả (null tại server)\n  };\n  const [form, setForm] = useState(emptyForm);\n  const [hotels, setHotels] = useState([]);\n  const modalScrollRef = useRef(0);\n  const firstFieldRef = useRef(null);\n  const loadHotels = async () => {\n    try {\n      const res = await fetch('/api/hotels', {\n        headers: authHeaders(),\n        cache: 'no-store'\n      });\n      if (!res.ok) throw new Error('Không tải được danh sách khách sạn');\n      const j = await res.json();\n      if (Array.isArray(j)) setHotels(j);else if (Array.isArray(j.items)) setHotels(j.items);else setHotels([]);\n    } catch (e) {\n      console.warn('[AdminPromotions] loadHotels error', e.message);\n      setHotels([]);\n    }\n  };\n  const statusOf = p => {\n    if (!p) return 'Unknown';\n    const s = new Date(p.startDate);\n    const e = new Date(p.endDate);\n    if (!p.isActive) return 'Disabled';\n    if (now < s) return 'Scheduled';\n    if (now > e) return 'Expired';\n    return 'Active';\n  };\n  const filtered = useMemo(() => {\n    const text = q.trim().toLowerCase();\n    return items.filter(p => {\n      const st = statusOf(p);\n      if (statusFilter !== 'all' && st.toLowerCase() !== statusFilter) return false;\n      if (text && !(`${p.code}`.toLowerCase().includes(text) || (p.description || '').toLowerCase().includes(text))) return false;\n      return true;\n    });\n  }, [items, q, statusFilter]);\n  const paged = useMemo(() => {\n    const start = (page - 1) * pageSize;\n    return filtered.slice(start, start + pageSize);\n  }, [filtered, page]);\n  const pageCount = useMemo(() => Math.max(1, Math.ceil(filtered.length / pageSize)), [filtered.length]);\n  const computeDiscount = (promo, orderAmount) => {\n    const amt = Number(orderAmount || 0);\n    if (!promo || !(amt > 0)) return {\n      discount: 0,\n      final: amt\n    };\n    if (promo.discountType === 'PERCENT') {\n      let raw = amt * (Number(promo.discountValue || 0) / 100);\n      if (promo.maxDiscount) raw = Math.min(raw, Number(promo.maxDiscount));\n      return {\n        discount: raw,\n        final: Math.max(0, amt - raw)\n      };\n    }\n    const raw = Number(promo.discountValue || 0);\n    return {\n      discount: Math.min(raw, amt),\n      final: Math.max(0, amt - raw)\n    };\n  };\n  const load = async () => {\n    if (!isAdminOrStaff) return;\n    setLoading(true);\n    setError('');\n    try {\n      // Tạm thời gọi thử endpoint nếu có, nếu 404 → giả lập mock\n      const res = await fetch('/api/admin/promotions', {\n        headers: authHeaders(),\n        cache: 'no-store'\n      });\n      if (!res.ok) throw new Error('Không tải được danh sách ưu đãi');\n      const j = await res.json();\n      const list = Array.isArray(j.items) ? j.items : Array.isArray(j.promotions) ? j.promotions : [];\n      setItems(list.map(r => ({\n        ...r\n      })));\n    } catch (e) {\n      console.warn('[AdminPromotions] load error:', e.message);\n      setError(e.message || 'Lỗi tải dữ liệu');\n      // Không còn tự động tạo mock để tránh nhầm trạng thái thực tế vs giả lập\n      setItems([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    load();\n    loadHotels();\n  }, []);\n\n  // Lock background scroll + focus first input when modal open\n  useEffect(() => {\n    if (createOpen) {\n      modalScrollRef.current = window.scrollY || 0;\n      // Scroll page to top so modal luôn xuất hiện ở đầu\n      try {\n        window.scrollTo(0, 0);\n      } catch {}\n      // lock body at top\n      document.body.style.position = 'fixed';\n      document.body.style.top = '0';\n      document.body.style.left = '0';\n      document.body.style.right = '0';\n      document.body.style.width = '100%';\n      document.body.classList.add('promo-modal-open');\n      // ensure viewport not scrolled weirdly & focus\n      window.requestAnimationFrame(() => {\n        firstFieldRef.current && firstFieldRef.current.focus();\n      });\n    } else {\n      if (document.body.classList.contains('promo-modal-open')) {\n        const restore = modalScrollRef.current || 0;\n        document.body.style.position = '';\n        document.body.style.top = '';\n        document.body.style.left = '';\n        document.body.style.right = '';\n        document.body.style.width = '';\n        document.body.classList.remove('promo-modal-open');\n        window.scrollTo(0, restore);\n      }\n    }\n  }, [createOpen]);\n  useEffect(() => {\n    if (debounceRef.current) clearTimeout(debounceRef.current);\n    debounceRef.current = setTimeout(() => setPage(1), 300);\n    return () => debounceRef.current && clearTimeout(debounceRef.current);\n  }, [q, statusFilter]);\n  const openCreate = () => {\n    setForm(emptyForm);\n    setCreateOpen(true);\n  };\n  const validateForm = data => {\n    if (!data.code.trim()) return 'Nhập mã ưu đãi';\n    if (!/^[-A-Z0-9_]+$/i.test(data.code.trim())) return 'Mã chỉ gồm chữ, số, -, _';\n    if (!data.discountType) return 'Chọn loại giảm';\n    const val = Number(data.discountValue);\n    if (!(val > 0)) return 'Giá trị giảm phải > 0';\n    if (data.discountType === 'PERCENT' && val > 100) return 'Phần trăm ≤ 100';\n    // Normalize to date-only for validation (strip any time component)\n    const sDate = data.startDate ? String(data.startDate).slice(0, 10) : '';\n    const eDate = data.endDate ? String(data.endDate).slice(0, 10) : '';\n    if (!sDate || !eDate) return 'Chọn thời gian hiệu lực';\n    if (new Date(eDate) <= new Date(sDate)) return 'Ngày kết thúc phải sau ngày bắt đầu';\n    if (data.minOrderAmount && !(Number(data.minOrderAmount) >= 0)) return 'Đơn tối thiểu không hợp lệ';\n    if (data.discountType === 'PERCENT' && data.maxDiscount && !(Number(data.maxDiscount) > 0)) return 'Giảm tối đa phải > 0';\n    return '';\n  };\n  const submitCreate = async () => {\n    const err = validateForm(form);\n    if (err) {\n      alert(err);\n      return;\n    }\n    setCreating(true);\n    try {\n      // Strip time component: send date-only (YYYY-MM-DD) to server/DB\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0, 10) : null;\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0, 10) : null;\n      // Force newly created promotions to be active by default\n      const payload = {\n        ...form,\n        isActive: true,\n        hotelId: form.hotelId ? Number(form.hotelId) : null,\n        discountValue: Number(form.discountValue),\n        minOrderAmount: form.minOrderAmount ? Number(form.minOrderAmount) : null,\n        maxDiscount: form.maxDiscount ? Number(form.maxDiscount) : null,\n        startDate: startDateOnly,\n        endDate: endDateOnly\n      };\n      const res = await fetch('/api/admin/promotions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) throw new Error('Tạo ưu đãi thất bại');\n      setCreateOpen(false);\n      setForm(emptyForm);\n      load();\n    } catch (e) {\n      alert(e.message || 'Lỗi tạo');\n    } finally {\n      setCreating(false);\n    }\n  };\n  const openEdit = row => {\n    var _row$startDate, _row$endDate;\n    setEditing(row);\n    setForm({\n      ...emptyForm,\n      ...row,\n      startDate: ((_row$startDate = row.startDate) === null || _row$startDate === void 0 ? void 0 : _row$startDate.slice(0, 16)) || '',\n      endDate: ((_row$endDate = row.endDate) === null || _row$endDate === void 0 ? void 0 : _row$endDate.slice(0, 16)) || ''\n    });\n    setCreateOpen(true);\n  };\n\n  // Normalize edit values to date-only (YYYY-MM-DD)\n  const openEditNormalized = row => {\n    setEditing(row);\n    setForm({\n      ...emptyForm,\n      ...row,\n      startDate: row.startDate ? String(row.startDate).slice(0, 10) : '',\n      endDate: row.endDate ? String(row.endDate).slice(0, 10) : ''\n    });\n    setCreateOpen(true);\n  };\n  const submitEdit = async () => {\n    if (!editing) return;\n    const err = validateForm(form);\n    if (err) {\n      alert(err);\n      return;\n    }\n    setSaving(true);\n    try {\n      // Send date-only values (YYYY-MM-DD) to avoid time components being stored\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0, 10) : null;\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0, 10) : null;\n      const payload = {\n        description: form.description,\n        hotelId: form.hotelId ? Number(form.hotelId) : null,\n        discountType: form.discountType,\n        discountValue: Number(form.discountValue),\n        startDate: startDateOnly,\n        endDate: endDateOnly,\n        minOrderAmount: form.minOrderAmount ? Number(form.minOrderAmount) : null,\n        maxDiscount: form.maxDiscount ? Number(form.maxDiscount) : null,\n        isActive: form.isActive\n      };\n      const res = await fetch(`/api/admin/promotions/${editing.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) throw new Error('Cập nhật thất bại');\n      setCreateOpen(false);\n      setEditing(null);\n      load();\n    } catch (e) {\n      alert(e.message || 'Lỗi cập nhật');\n    } finally {\n      setSaving(false);\n    }\n  };\n  const toggleActive = async row => {\n    // Optimistic\n    setItems(prev => prev.map(p => p.id === row.id ? {\n      ...p,\n      isActive: !p.isActive\n    } : p));\n    try {\n      const res = await fetch(`/api/admin/promotions/${row.id}/activate`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify({\n          isActive: !row.isActive\n        })\n      });\n      if (!res.ok) throw new Error('Cập nhật trạng thái thất bại');\n    } catch (e) {\n      setItems(prev => prev.map(p => p.id === row.id ? {\n        ...p,\n        isActive: row.isActive\n      } : p));\n      alert(e.message || 'Lỗi');\n    }\n  };\n  const del = async row => {\n    if (!window.confirm('Xóa ưu đãi này?')) return;\n    try {\n      const res = await fetch(`/api/admin/promotions/${row.id}`, {\n        method: 'DELETE',\n        headers: authHeaders()\n      });\n      if (!res.ok) throw new Error('Xóa thất bại');\n      load();\n    } catch (e) {\n      alert(e.message || 'Lỗi xóa');\n    }\n  };\n\n  // Bulk actions\n  const toggleSelectOne = id => {\n    setSelectedIds(prev => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id);else next.add(id);\n      return next;\n    });\n  };\n  const toggleSelectAllOnPage = () => {\n    if (selectAllOnPage) {\n      // unselect same page ids\n      setSelectedIds(prev => {\n        const next = new Set(prev);\n        paged.forEach(p => next.delete(p.id));\n        return next;\n      });\n      setSelectAllOnPage(false);\n    } else {\n      setSelectedIds(prev => {\n        const next = new Set(prev);\n        paged.forEach(p => next.add(p.id));\n        return next;\n      });\n      setSelectAllOnPage(true);\n    }\n  };\n  const bulkActivate = async on => {\n    if (selectedIds.size === 0) return alert('Chưa chọn ưu đãi nào');\n    if (!window.confirm(`Bạn có chắc muốn ${on ? 'bật' : 'tắt'} ${selectedIds.size} ưu đãi?`)) return;\n    try {\n      // optimistic update\n      setItems(prev => prev.map(it => selectedIds.has(it.id) ? {\n        ...it,\n        isActive: on\n      } : it));\n      // server call for each id (server may support batch; fallback to per-id)\n      await Promise.all(Array.from(selectedIds).map(id => fetch(`/api/admin/promotions/${id}/activate`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify({\n          isActive: on\n        })\n      }).then(r => {\n        if (!r.ok) throw new Error('Lỗi cập nhật');\n      })));\n      alert('Cập nhật trạng thái thành công');\n      setSelectedIds(new Set());\n      setSelectAllOnPage(false);\n      load();\n    } catch (e) {\n      alert(e.message || 'Lỗi cập nhật');\n      load();\n    }\n  };\n  const copyCode = async code => {\n    try {\n      await navigator.clipboard.writeText(code);\n      alert('Sao chép mã: ' + code);\n    } catch (e) {\n      alert('Không thể sao chép');\n    }\n  };\n  const exportCSV = () => {\n    const rows = filtered.map(p => ({\n      code: p.code,\n      description: p.description || '',\n      type: p.discountType,\n      value: p.discountValue,\n      hotelType: p.hotelType || '',\n      minOrder: p.minOrderAmount || '',\n      maxDiscount: p.maxDiscount || '',\n      start: p.startDate || '',\n      end: p.endDate || '',\n      active: p.isActive ? 1 : 0\n    }));\n    const csv = [Object.keys(rows[0] || {}).join(','), ...rows.map(r => Object.values(r).map(v => '\"' + String(v || '').replace(/\"/g, '\"\"') + '\"').join(','))].join('\\n');\n    const blob = new Blob([csv], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'promotions.csv';\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    URL.revokeObjectURL(url);\n  };\n  if (!isAdminOrStaff) return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 16\n    },\n    children: \"Ch\\u1EE9c n\\u0103ng d\\xE0nh cho qu\\u1EA3n tr\\u1ECB / nh\\xE2n vi\\xEAn.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 285,\n    columnNumber: 30\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"af-container amenities-anim-root\",\n    style: {\n      padding: 12\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"home-rooms-title\",\n      style: {\n        textAlign: 'left',\n        marginTop: 0\n      },\n      children: \"Qu\\u1EA3n l\\xFD \\u01B0u \\u0111\\xE3i / m\\xE3 khuy\\u1EBFn m\\xE3i\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reports-toolbar af-toolbar\",\n      style: {\n        marginBottom: 10,\n        flexWrap: 'wrap',\n        gap: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reports-field af-field-grow\",\n        style: {\n          minWidth: 240\n        },\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"reports-input\",\n          placeholder: \"T\\xECm theo m\\xE3 ho\\u1EB7c m\\xF4 t\\u1EA3...\",\n          value: q,\n          onChange: e => setQ(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reports-field\",\n        style: {\n          minWidth: 200\n        },\n        children: /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"reports-select promo-select-inline\",\n          value: statusFilter,\n          onChange: e => setStatusFilter(e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"all\",\n            children: \"T\\u1EA5t c\\u1EA3 tr\\u1EA1ng th\\xE1i\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"active\",\n            children: \"Active\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"scheduled\",\n            children: \"Scheduled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"expired\",\n            children: \"Expired\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"disabled\",\n            children: \"Disabled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reports-field\",\n        style: {\n          display: 'flex',\n          gap: 8\n        },\n        children: isAdmin && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          onClick: openCreate,\n          children: \"+ Th\\xEAm \\u01B0u \\u0111\\xE3i\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 8,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            fontSize: 13\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: selectAllOnPage,\n            onChange: toggleSelectAllOnPage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this), \" Ch\\u1ECDn trang\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          onClick: () => bulkActivate(true),\n          title: \"B\\u1EADt \\u01B0u \\u0111\\xE3i cho c\\xE1c m\\u1EE5c \\u0111\\xE3 ch\\u1ECDn\",\n          children: \"B\\u1EADt\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          onClick: () => bulkActivate(false),\n          title: \"T\\u1EAFt \\u01B0u \\u0111\\xE3i cho c\\xE1c m\\u1EE5c \\u0111\\xE3 ch\\u1ECDn\",\n          children: \"T\\u1EAFt\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          onClick: exportCSV,\n          title: \"Xu\\u1EA5t CSV c\\u1EE7a danh s\\xE1ch \\u0111ang l\\u1ECDc\",\n          children: \"Xu\\u1EA5t CSV\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: '#666'\n      },\n      children: \"\\u0110ang t\\u1EA3i...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 18\n    }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: '#b42318'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 76\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        overflowX: 'auto'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"ph-table-el af-table\",\n        style: {\n          width: '100%',\n          minWidth: 1080\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                width: 40\n              },\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: selectAllOnPage,\n                onChange: toggleSelectAllOnPage\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 42\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"M\\xE3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"M\\xF4 t\\u1EA3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Lo\\u1EA1i\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Kh\\xE1ch s\\u1EA1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Gi\\xE1 tr\\u1ECB\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Hi\\u1EC7u l\\u1EF1c\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0110i\\u1EC1u ki\\u1EC7n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Tr\\u1EA1ng th\\xE1i\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"H\\xE0nh \\u0111\\u1ED9ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: paged.length === 0 ? /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 10,\n              style: {\n                textAlign: 'center',\n                color: '#666'\n              },\n              children: \"Kh\\xF4ng c\\xF3 \\u01B0u \\u0111\\xE3i.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 39\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 35\n          }, this) : paged.map(p => {\n            var _hotels$find;\n            const st = statusOf(p);\n            const amt = Number(previewAmount || 0);\n            const {\n              discount,\n              final\n            } = computeDiscount(p, amt && (!p.minOrderAmount || amt >= Number(p.minOrderAmount)) ? amt : 0);\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: \"amenity-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                style: {\n                  textAlign: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: selectedIds.has(p.id),\n                  onChange: () => toggleSelectOne(p.id)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 340,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontWeight: 600\n                },\n                title: `ID: ${p.id}`,\n                children: p.code\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  maxWidth: 220\n                },\n                title: p.description,\n                children: p.description || '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                children: p.discountType === 'PERCENT' ? 'Phần trăm' : 'Cố định'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontSize: 12\n                },\n                children: p.hotelId ? /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"promo-hotel-badge\",\n                  \"data-ht\": \"name\",\n                  children: p.hotelName || ((_hotels$find = hotels.find(h => h.id === p.hotelId)) === null || _hotels$find === void 0 ? void 0 : _hotels$find.name) || `#${p.hotelId}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 36\n                }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    opacity: .6\n                  },\n                  children: \"T\\u1EA5t c\\u1EA3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 171\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                children: p.discountType === 'PERCENT' ? `${p.discountValue}%${p.maxDiscount ? ` (tối đa ${Number(p.maxDiscount).toLocaleString('vi-VN')}đ)` : ''}` : `${Number(p.discountValue).toLocaleString('vi-VN')} đ`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 348,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontSize: 12\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: p.startDate ? new Date(p.startDate).toLocaleDateString('vi-VN') : '—'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 350,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    opacity: .8\n                  },\n                  children: p.endDate ? new Date(p.endDate).toLocaleDateString('vi-VN') : '—'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 351,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontSize: 12\n                },\n                children: [p.minOrderAmount ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"T\\u1ED1i thi\\u1EC3u: \", Number(p.minOrderAmount).toLocaleString('vi-VN'), \"\\u0111\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 354,\n                  columnNumber: 43\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: \"\\u2014\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 354,\n                  columnNumber: 119\n                }, this), p.discountType === 'PERCENT' && p.maxDiscount && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Gi\\u1EA3m t\\u1ED1i \\u0111a: \", Number(p.maxDiscount).toLocaleString('vi-VN'), \"\\u0111\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 355,\n                  columnNumber: 71\n                }, this), previewAmount && discount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginTop: 6\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      color: '#047857',\n                      fontWeight: 600\n                    },\n                    children: [\"Gi\\u1EA3m \", Math.round(discount).toLocaleString('vi-VN'), \"\\u0111 \", /*#__PURE__*/_jsxDEV(\"span\", {\n                      style: {\n                        color: '#6b7280',\n                        fontWeight: 400\n                      },\n                      children: [\"(\", p.discountType === 'PERCENT' ? `-${p.discountValue}%` : `- ${Math.round(discount).toLocaleString('vi-VN')}đ`, \")\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 358,\n                      columnNumber: 129\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 358,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      color: '#065f46',\n                      fontWeight: 700\n                    },\n                    children: [\"C\\xF2n: \", Math.round(final).toLocaleString('vi-VN'), \"\\u0111\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 359,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 357,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontWeight: 600\n                },\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `promo-badge promo-${st.toLowerCase()}`,\n                  children: st\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 364,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  whiteSpace: 'nowrap'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn\",\n                  onClick: () => copyCode(p.code),\n                  children: \"Sao ch\\xE9p m\\xE3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn ph-btn--success\",\n                  onClick: () => openEditNormalized(p),\n                  children: \"S\\u1EEDa\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 368,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn ph-btn--warning\",\n                  onClick: () => toggleActive(p),\n                  children: p.isActive ? 'Tắt' : 'Bật'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 369,\n                  columnNumber: 23\n                }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn ph-btn--danger\",\n                  onClick: () => del(p),\n                  children: \"X\\xF3a\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 35\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 21\n              }, this)]\n            }, p.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 10,\n        display: 'flex',\n        gap: 12,\n        alignItems: 'center',\n        flexWrap: 'wrap'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 6,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            fontSize: 13\n          },\n          children: \"Xem th\\u1EED \\u0111\\u01A1n h\\xE0ng (VND):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          style: {\n            width: 140\n          },\n          value: previewAmount,\n          onChange: e => setPreviewAmount(e.target.value),\n          placeholder: \"Nh\\u1EADp s\\u1ED1 ti\\u1EC1n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginLeft: 'auto',\n          display: 'flex',\n          gap: 6,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          disabled: page <= 1,\n          onClick: () => setPage(p => Math.max(1, p - 1)),\n          children: \"\\u25C0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: 13\n          },\n          children: [\"Trang \", page, \"/\", pageCount]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          disabled: page >= pageCount,\n          onClick: () => setPage(p => Math.min(pageCount, p + 1)),\n          children: \"\\u25B6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 7\n    }, this), createOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-overlay promo-overlay\",\n      onMouseDown: e => {\n        if (e.target === e.currentTarget) {\n          setCreateOpen(false);\n          setEditing(null);\n        }\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-modal promo-modal\",\n        onMouseDown: e => e.stopPropagation(),\n        style: {\n          width: 740,\n          maxWidth: '96%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"promo-modal__title\",\n          children: editing ? 'Chỉnh sửa ưu đãi' : 'Tạo ưu đãi mới'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"promo-status-preview\",\n          children: (() => {\n            // Dự kiến trạng thái dựa vào form hiện tại\n            const mock = {\n              ...form,\n              isActive: true\n            };\n            const st = !mock.startDate || !mock.endDate ? 'Chưa đủ dữ liệu' : statusOf({\n              ...mock,\n              startDate: mock.startDate,\n              endDate: mock.endDate,\n              isActive: true\n            });\n            return /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Tr\\u1EA1ng th\\xE1i d\\u1EF1 ki\\u1EBFn: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 26\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `promo-badge promo-${(st || '').toLowerCase().replace(/ /g, '')}`,\n                children: st\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 59\n              }, this)]\n            }, void 0, true);\n          })()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-modal__form promo-form\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"M\\xE3 \\u01B0u \\u0111\\xE3i\", /*#__PURE__*/_jsxDEV(\"input\", {\n              ref: firstFieldRef,\n              className: \"promo-input\",\n              value: form.code,\n              disabled: !!editing,\n              onChange: e => setForm(f => ({\n                ...f,\n                code: e.target.value.toUpperCase()\n              })),\n              placeholder: \"WELCOME10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 406,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"Lo\\u1EA1i gi\\u1EA3m\", /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"promo-select-inline promo-input promo-discount-type\",\n              \"data-type\": form.discountType,\n              value: form.discountType,\n              onChange: e => setForm(f => ({\n                ...f,\n                discountType: e.target.value\n              })),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"PERCENT\",\n                children: \"Ph\\u1EA7n tr\\u0103m\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 410,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"FIXED\",\n                children: \"C\\u1ED1 \\u0111\\u1ECBnh\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 411,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 409,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"Gi\\xE1 tr\\u1ECB gi\\u1EA3m\", /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"promo-input\",\n              type: \"number\",\n              value: form.discountValue,\n              onChange: e => setForm(f => ({\n                ...f,\n                discountValue: e.target.value\n              })),\n              placeholder: \"10 ho\\u1EB7c 100000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"Gi\\u1EA3m t\\u1ED1i \\u0111a (n\\u1EBFu %)\", /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"promo-input\",\n              type: \"number\",\n              value: form.maxDiscount,\n              disabled: form.discountType !== 'PERCENT',\n              onChange: e => setForm(f => ({\n                ...f,\n                maxDiscount: e.target.value\n              })),\n              placeholder: \"200000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"Kh\\xE1ch s\\u1EA1n \\xE1p d\\u1EE5ng\", /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"promo-select-inline promo-input\",\n              value: form.hotelId,\n              onChange: e => setForm(f => ({\n                ...f,\n                hotelId: e.target.value\n              })),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"T\\u1EA5t c\\u1EA3 kh\\xE1ch s\\u1EA1n\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 422,\n                columnNumber: 19\n              }, this), hotels.map(h => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: h.id,\n                children: h.name\n              }, h.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 423,\n                columnNumber: 36\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"\\u0110\\u01A1n t\\u1ED1i thi\\u1EC3u\", /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"promo-input\",\n              type: \"number\",\n              value: form.minOrderAmount,\n              onChange: e => setForm(f => ({\n                ...f,\n                minOrderAmount: e.target.value\n              })),\n              placeholder: \"500000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"Ng\\xE0y b\\u1EAFt \\u0111\\u1EA7u\", /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"promo-input\",\n              type: \"date\",\n              min: localToday,\n              value: form.startDate,\n              onChange: e => setForm(f => ({\n                ...f,\n                startDate: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field\",\n            children: [\"Ng\\xE0y k\\u1EBFt th\\xFAc\", /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"promo-input\",\n              type: \"date\",\n              min: form.startDate || localToday,\n              value: form.endDate,\n              onChange: e => setForm(f => ({\n                ...f,\n                endDate: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"promo-field promo-field--full\",\n            children: [\"M\\xF4 t\\u1EA3\", /*#__PURE__*/_jsxDEV(\"textarea\", {\n              className: \"promo-input\",\n              rows: 3,\n              value: form.description,\n              onChange: e => setForm(f => ({\n                ...f,\n                description: e.target.value\n              })),\n              placeholder: \"M\\xF4 t\\u1EA3 ng\\u1EAFn...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"promo-preview-box\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Xem nhanh:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 15\n          }, this), ' ', (() => {\n            const testAmt = Number(previewAmount || 0);\n            if (!(testAmt > 0)) return /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Nh\\u1EADp s\\u1ED1 ti\\u1EC1n \\u0111\\u01A1n h\\xE0ng \\u1EDF d\\u01B0\\u1EDBi danh s\\xE1ch \\u0111\\u1EC3 xem m\\u1EE9c gi\\u1EA3m.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 41\n            }, this);\n            const mockPromo = {\n              ...form,\n              discountValue: Number(form.discountValue || 0),\n              maxDiscount: form.maxDiscount ? Number(form.maxDiscount) : null\n            };\n            const {\n              discount,\n              final\n            } = computeDiscount(mockPromo, testAmt);\n            if (!discount) return /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Kh\\xF4ng \\xE1p d\\u1EE5ng (ch\\u01B0a \\u0111\\u1EE7 \\u0111i\\u1EC1u ki\\u1EC7n ho\\u1EB7c d\\u1EEF li\\u1EC7u thi\\u1EBFu).\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 38\n            }, this);\n            return /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Gi\\u1EA3m \", Math.round(discount).toLocaleString('vi-VN'), \"\\u0111 c\\xF2n \", Math.round(final).toLocaleString('vi-VN'), \"\\u0111.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 24\n            }, this);\n          })()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"promo-actions\",\n          children: editing ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn promo-action-btn\",\n              onClick: submitEdit,\n              disabled: saving,\n              children: saving ? 'Đang lưu...' : 'Lưu thay đổi'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 453,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn ph-btn--secondary promo-action-btn\",\n              onClick: () => {\n                setCreateOpen(false);\n                setEditing(null);\n              },\n              children: \"H\\u1EE7y\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn promo-action-btn\",\n              onClick: submitCreate,\n              disabled: creating,\n              children: creating ? 'Đang tạo...' : 'Tạo mới'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 458,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn ph-btn--secondary promo-action-btn\",\n              onClick: () => {\n                setCreateOpen(false);\n                setEditing(null);\n              },\n              children: \"H\\u1EE7y\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 459,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n  .promo-badge { display:inline-block; padding:4px 8px; font-size:11px; line-height:1; border-radius:20px; letter-spacing:.3px; }\n        .promo-active { background:#e6f7ec; color:#087443; border:1px solid #b2e7c9; }\n        .promo-scheduled { background:#f0f4ff; color:#1d4ed8; border:1px solid #c7d8ff; }\n        .promo-expired { background:#ffe8e6; color:#b42318; border:1px solid #f5b5ae; }\n        .promo-disabled { background:#f1f5f9; color:#475569; border:1px solid #d3dce4; }\n\n        .af-table { border-collapse: separate; border-spacing: 0 2px; }\n        .af-table thead th { background:#fafbfc; position:sticky; top:0; z-index:5; }\n        .af-table th, .af-table td { padding:8px 10px; vertical-align:middle; }\n        .af-table tbody tr { background:#fff; transition:background .25s, box-shadow .25s; }\n        .af-table tbody tr:nth-child(odd) { background:linear-gradient(180deg,#ffffff,#fdfdfd); }\n        .af-table tbody tr:hover { background:#f5f9ff; box-shadow:0 2px 6px rgba(0,0,0,.05); }\n        .af-table input, .af-table select, .af-table textarea { font-size:14px; border:1px solid #d7dbe0; border-radius:6px; background:#fff; }\n        .af-table input, .af-table select { height:34px; line-height:1.3; padding:5px 10px 8px; }\n        .af-table textarea { padding:6px 8px; }\n\n        /* Inline promotion selects - prevent descender clipping (g,y,p,q) & polish */\n        .promo-select-inline { \n          height:44px; min-height:44px; line-height:1.3; padding:0 44px 0 12px; font-size:14px; \n          border:1px solid #cfd6dd; border-radius:10px; background:#fff; font-weight:500; \n          box-shadow:0 1px 0 rgba(0,0,0,.02); appearance:none; -webkit-appearance:none; -moz-appearance:none; \n          background-image: linear-gradient(#fff,#fff), url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n          background-repeat:no-repeat; background-position:right 12px center, 0 0; background-size:14px 14px, auto; \n          transition:border-color .25s, box-shadow .25s, background-color .35s; cursor:pointer;\n        }\n        .promo-select-inline:focus { border-color:#f59e0b; box-shadow:0 0 0 3px rgba(245,158,11,.28); outline:none; }\n        .promo-select-inline:hover { border-color:#94a3b8; }\n        .promo-select-inline option { line-height:1.35; }\n\n        /* Badge subtle elevation */\n        .promo-badge { position:relative; font-weight:600; box-shadow:0 1px 0 rgba(0,0,0,.06), 0 0 0 1px rgba(0,0,0,.02); }\n        .promo-badge::after { content:\"\"; position:absolute; inset:0; border-radius:inherit; box-shadow:0 2px 4px rgba(0,0,0,.08); opacity:0; transition:opacity .25s; }\n        tr:hover .promo-badge::after { opacity:.4; }\n\n        /* Action buttons spacing */\n        .af-table td button.ph-btn { margin:2px 4px 2px 0; }\n\n  .ph-btn { cursor:pointer; }\n  .profile-overlay { backdrop-filter: blur(3px); background: rgba(15,23,42,0.55); display:flex; align-items:center; justify-content:center; position:fixed; inset:0; z-index:1200; animation:promoOverlayFade .4s ease; }\n  @keyframes promoOverlayFade { from { opacity:0; } to { opacity:1; } }\n  .profile-modal { box-shadow: 0 24px 70px -18px rgba(0,0,0,.35), 0 4px 14px rgba(0,0,0,.14); border: 1px solid rgba(255,255,255,0.25); background: linear-gradient(165deg,#ffffff,#fffdfa); position:relative; }\n  .promo-modal { border-radius:20px; padding:22px 26px 26px; animation:promoModalIn .45s cubic-bezier(.4,.22,.22,1); }\n  /* Đưa modal sát đỉnh: giảm translateY ban đầu để không nằm phần giữa */\n  @keyframes promoModalIn { 0% { opacity:0; transform:translateY(8px) scale(.97); } 60% { opacity:1; transform:translateY(0) scale(1.005);} 100% { opacity:1; transform:translateY(0) scale(1);} }\n  .promo-modal__title { margin:2px 0 6px; text-align:center; font-weight:800; letter-spacing:.5px; }\n  .promo-status-preview { text-align:center; font-size:12px; margin-bottom:14px; color:#475569; animation:fadeUp .5s .15s both; }\n  @keyframes fadeUp { from { opacity:0; transform:translateY(6px);} to { opacity:1; transform:translateY(0);} }\n  .profile-modal__form { grid-template-columns: repeat(2, minmax(200px,1fr)); }\n  .promo-form { display:grid; gap:18px 20px; }\n  .promo-field { display:flex; flex-direction:column; gap:6px; font-size:13px; font-weight:600; color:#0f172a; position:relative; opacity:0; animation:promoFieldIn .55s cubic-bezier(.4,.22,.22,1) forwards; }\n  .promo-field:nth-child(1){ animation-delay:.06s; }\n  .promo-field:nth-child(2){ animation-delay:.10s; }\n  .promo-field:nth-child(3){ animation-delay:.14s; }\n  .promo-field:nth-child(4){ animation-delay:.18s; }\n  .promo-field:nth-child(5){ animation-delay:.22s; }\n  .promo-field:nth-child(6){ animation-delay:.26s; }\n  .promo-field:nth-child(7){ animation-delay:.30s; }\n  .promo-field--full { grid-column:1 / -1; }\n  @keyframes promoFieldIn { 0% { opacity:0; transform:translateY(10px);} 60% { opacity:1; } 100% { opacity:1; transform:translateY(0);} }\n  .promo-input { background:#fff; border:1px solid #d8dee5; border-radius:10px; padding:0 12px; font-size:14px; line-height:1.3; box-shadow:0 1px 0 rgba(0,0,0,.02); transition:border-color .25s, box-shadow .28s, background-color .35s; height:44px; display:flex; align-items:center; width:100%; box-sizing:border-box; }\n  .promo-input:focus { outline:none; border-color:#f59e0b; box-shadow:0 0 0 3px rgba(245,158,11,.28), 0 4px 14px -2px rgba(0,0,0,.15); }\n  .promo-input:disabled { background:#f1f5f9; color:#64748b; }\n  .promo-input:hover:not(:disabled) { border-color:#94a3b8; }\n  textarea.promo-input { resize:vertical; min-height:92px; }\n  .promo-preview-box { margin-top:16px; background:#f8fafc; padding:12px 14px; border-radius:14px; font-size:13px; border:1px solid #eef2f6; animation:fadeUp .6s .25s both; }\n  .promo-actions { margin-top:22px; display:flex; gap:14px; justify-content:center; animation:fadeUp .55s .32s both; }\n  .promo-action-btn { font-weight:700; min-width:140px; position:relative; }\n  .promo-action-btn:not(:disabled) { transition:transform .25s, box-shadow .28s, background .35s; }\n  .promo-action-btn:not(:disabled):hover { transform:translateY(-2px); box-shadow:0 8px 24px -6px rgba(0,0,0,.25); }\n  .promo-action-btn:not(:disabled):active { transform:translateY(0) scale(.97); box-shadow:0 4px 14px -4px rgba(0,0,0,.22); }\n  .promo-action-btn:disabled { opacity:.7; cursor:progress; }\n  @media (max-width:720px){ .profile-modal__form { grid-template-columns: 1fr; } .promo-field { animation-delay:.05s !important; } }\n  @media (prefers-reduced-motion: reduce){\n    .promo-modal, .promo-field, .promo-status-preview, .promo-preview-box, .promo-actions { animation:none !important; }\n  }\n  /* ================= COLORFUL ACCENTS ADDITION ================ */\n  .promo-modal { background: linear-gradient(145deg,#ffffff 0%,#fff9f2 65%); }\n  .promo-modal-open { overflow:hidden; }\n  /* Overlay canh top: giảm padding-top để modal nằm sát hơn phần trên cùng */\n  .promo-overlay { overflow:auto; align-items:flex-start; justify-content:center; padding:8px 0 32px; }\n  .promo-modal__title { position:relative; }\n  .promo-modal__title::after { content:\"\"; position:absolute; left:50%; transform:translateX(-50%); bottom:-6px; width:160px; height:6px; border-radius:4px; background:linear-gradient(90deg,#f59e0b,#fbbf24,#fde047); box-shadow:0 2px 6px -2px rgba(245,158,11,.6); }\n  .promo-form { position:relative; }\n  .promo-form::before { content:\"\"; position:absolute; inset:-12px -18px -12px -18px; background:linear-gradient(135deg,#fff7eb,#ffffff 28%,#ffffff 72%,#fff7eb); border:1px solid #ffe2b9; border-radius:18px; z-index:0; box-shadow:0 4px 18px -6px rgba(245,158,11,.25); }\n  .promo-form .promo-field { z-index:1; }\n  .promo-field { padding:2px 4px 6px; border-radius:12px; transition: background .35s, box-shadow .35s; }\n  .promo-field:hover { background:rgba(255,178,36,0.06); }\n  .promo-input { background:linear-gradient(180deg,#ffffff,#fffdf8); }\n  .promo-input:focus { background:#ffffff; }\n  /* Discount type select dynamic color ring */\n  .promo-discount-type { position:relative; font-weight:700; letter-spacing:.3px; }\n  .promo-discount-type[data-type=\"PERCENT\"] { box-shadow:0 0 0 1px #ffd089, 0 0 0 4px rgba(245,158,11,.25); background:linear-gradient(180deg,#fffaf2,#fff); }\n  .promo-discount-type[data-type=\"FIXED\"] { box-shadow:0 0 0 1px #93c5fd, 0 0 0 4px rgba(59,130,246,.25); background:linear-gradient(180deg,#f1f8ff,#ffffff); }\n  .promo-discount-type:focus { box-shadow:0 0 0 1px #f59e0b,0 0 0 4px rgba(245,158,11,.35); }\n  /* Buttons accent gradient */\n  .promo-action-btn { background:linear-gradient(180deg,#f59e0b,#f59a0b); color:#fff; border:none; }\n  .promo-action-btn:hover { background:linear-gradient(180deg,#f8b13e,#f59a0b); }\n  .promo-action-btn:active { background:linear-gradient(180deg,#e88d04,#d97706); }\n  .promo-action-btn.ph-btn--secondary { background:#fff; color:#374151; border:1px solid #e2e8f0; }\n  .promo-action-btn.ph-btn--secondary:hover { background:#f8fafc; }\n  .promo-hotel-badge { display:inline-block; padding:4px 6px; border-radius:10px; font-size:11px; font-weight:600; letter-spacing:.3px; background:#eef2ff; color:#3730a3; border:1px solid #c7d2fe; }\n  .promo-hotel-badge[data-ht='Resort'] { background:#ecfdf5; color:#065f46; border-color:#a7f3d0; }\n  .promo-hotel-badge[data-ht='Business'] { background:#eff6ff; color:#1e3a8a; border-color:#bfdbfe; }\n  .promo-hotel-badge[data-ht='Boutique'] { background:#fdf2f8; color:#9d174d; border-color:#fbcfe8; }\n  /* Preview box accent border */\n  .promo-preview-box { border:1px solid #ffe2b9; background:linear-gradient(180deg,#fffefb,#fffaf2); }\n  /* Scrollbar subtle theming inside modal (WebKit) */\n  .promo-modal ::-webkit-scrollbar { width:10px; }\n  .promo-modal ::-webkit-scrollbar-track { background:transparent; }\n  .promo-modal ::-webkit-scrollbar-thumb { background:linear-gradient(#f59e0b,#f59a0b); border-radius:20px; border:2px solid #fff; }\n  /* Accessible high-contrast tweak (prefers-contrast more) */\n  @media (prefers-contrast: more){\n    .promo-form::before { box-shadow:none; }\n    .promo-action-btn { box-shadow:none; }\n  }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 288,\n    columnNumber: 5\n  }, this);\n}\n_s(AdminPromotions, \"SgAXivGsqT6QT3c4uPef5znepXw=\");\n_c = AdminPromotions;\nvar _c;\n$RefreshReg$(_c, \"AdminPromotions\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","authHeaders","getUserRole","jsxDEV","_jsxDEV","Fragment","_Fragment","AdminPromotions","_s","role","isAdminOrStaff","includes","isAdmin","items","setItems","loading","setLoading","error","setError","q","setQ","statusFilter","setStatusFilter","createOpen","setCreateOpen","editing","setEditing","saving","setSaving","creating","setCreating","previewAmount","setPreviewAmount","page","setPage","pageSize","selectedIds","setSelectedIds","Set","selectAllOnPage","setSelectAllOnPage","debounceRef","now","Date","localToday","d","getTimezoneOffset","toISOString","slice","emptyForm","code","description","discountType","discountValue","startDate","endDate","minOrderAmount","maxDiscount","isActive","hotelId","form","setForm","hotels","setHotels","modalScrollRef","firstFieldRef","loadHotels","res","fetch","headers","cache","ok","Error","j","json","Array","isArray","e","console","warn","message","statusOf","p","s","filtered","text","trim","toLowerCase","filter","st","paged","start","pageCount","Math","max","ceil","length","computeDiscount","promo","orderAmount","amt","Number","discount","final","raw","min","load","list","promotions","map","r","current","window","scrollY","scrollTo","document","body","style","position","top","left","right","width","classList","add","requestAnimationFrame","focus","contains","restore","remove","clearTimeout","setTimeout","openCreate","validateForm","data","test","val","sDate","String","eDate","submitCreate","err","alert","startDateOnly","endDateOnly","payload","method","JSON","stringify","openEdit","row","_row$startDate","_row$endDate","openEditNormalized","submitEdit","id","toggleActive","prev","del","confirm","toggleSelectOne","next","has","delete","toggleSelectAllOnPage","forEach","bulkActivate","on","size","it","Promise","all","from","then","copyCode","navigator","clipboard","writeText","exportCSV","rows","type","value","hotelType","minOrder","end","active","csv","Object","keys","join","values","v","replace","blob","Blob","url","URL","createObjectURL","a","createElement","href","download","appendChild","click","revokeObjectURL","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","className","textAlign","marginTop","marginBottom","flexWrap","gap","minWidth","placeholder","onChange","target","display","onClick","alignItems","fontSize","checked","title","color","overflowX","colSpan","_hotels$find","fontWeight","maxWidth","hotelName","find","h","name","opacity","toLocaleString","toLocaleDateString","round","whiteSpace","marginLeft","disabled","onMouseDown","currentTarget","stopPropagation","mock","ref","f","toUpperCase","testAmt","mockPromo","_c","$RefreshReg$"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/AdminPromotions.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport './HomePage.css';\r\nimport { authHeaders, getUserRole } from './auth';\r\n\r\n/* Quản lý Ưu đãi / Mã khuyến mãi\r\n   - Danh sách + tìm kiếm + lọc trạng thái\r\n   - Tạo mới / Chỉnh sửa / Bật tắt (isActive)\r\n   - Preview tính giảm theo số tiền đơn hàng nhập thử\r\n   Trạng thái hiển thị:\r\n     Active    => isActive=1 && now within [startDate,endDate]\r\n     Scheduled => isActive=1 && now < startDate\r\n     Expired   => now > endDate\r\n     Disabled  => isActive=0\r\n*/\r\nexport default function AdminPromotions(){\r\n  const role = getUserRole();\r\n  const isAdminOrStaff = ['Admin','Staff'].includes(role);\r\n  const isAdmin = role === 'Admin';\r\n\r\n  const [items, setItems] = useState([]); // promotions\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [q, setQ] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState('all');\r\n  const [createOpen, setCreateOpen] = useState(false);\r\n  const [editing, setEditing] = useState(null); // row object being edited inline modal\r\n  const [saving, setSaving] = useState(false);\r\n  const [creating, setCreating] = useState(false);\r\n  const [previewAmount, setPreviewAmount] = useState('');\r\n  const [page, setPage] = useState(1);\r\n  const pageSize = 20;\r\n  const [selectedIds, setSelectedIds] = useState(new Set());\r\n  const [selectAllOnPage, setSelectAllOnPage] = useState(false);\r\n  const debounceRef = useRef(null);\r\n  const now = useMemo(()=> new Date(), []);\r\n  const localToday = useMemo(()=>{\r\n    const d = new Date(Date.now() - new Date().getTimezoneOffset() * 60000);\r\n    return d.toISOString().slice(0,10);\r\n  }, []);\r\n\r\n  const emptyForm = {\r\n    code: '',\r\n    description: '',\r\n    discountType: 'PERCENT',\r\n    discountValue: '',\r\n    startDate: '',\r\n    endDate: '',\r\n    minOrderAmount: '',\r\n    maxDiscount: '',\r\n    isActive: true,\r\n    hotelId: '' // '' = tất cả (null tại server)\r\n  };\r\n  const [form, setForm] = useState(emptyForm);\r\n  const [hotels, setHotels] = useState([]);\r\n  const modalScrollRef = useRef(0);\r\n  const firstFieldRef = useRef(null);\r\n\r\n  const loadHotels = async () => {\r\n    try {\r\n      const res = await fetch('/api/hotels', { headers: authHeaders(), cache:'no-store' });\r\n      if(!res.ok) throw new Error('Không tải được danh sách khách sạn');\r\n      const j = await res.json();\r\n      if(Array.isArray(j)) setHotels(j); else if(Array.isArray(j.items)) setHotels(j.items); else setHotels([]);\r\n    } catch(e){ console.warn('[AdminPromotions] loadHotels error', e.message); setHotels([]); }\r\n  };\r\n\r\n  const statusOf = (p) => {\r\n    if(!p) return 'Unknown';\r\n    const s = new Date(p.startDate);\r\n    const e = new Date(p.endDate);\r\n    if(!p.isActive) return 'Disabled';\r\n    if(now < s) return 'Scheduled';\r\n    if(now > e) return 'Expired';\r\n    return 'Active';\r\n  };\r\n\r\n  const filtered = useMemo(()=>{\r\n    const text = q.trim().toLowerCase();\r\n    return items.filter(p => {\r\n      const st = statusOf(p);\r\n      if(statusFilter !== 'all' && st.toLowerCase() !== statusFilter) return false;\r\n      if(text && !(`${p.code}`.toLowerCase().includes(text) || (p.description||'').toLowerCase().includes(text))) return false;\r\n      return true;\r\n    });\r\n  }, [items, q, statusFilter]);\r\n\r\n  const paged = useMemo(()=>{\r\n    const start = (page-1)*pageSize;\r\n    return filtered.slice(start, start+pageSize);\r\n  }, [filtered, page]);\r\n\r\n  const pageCount = useMemo(()=> Math.max(1, Math.ceil(filtered.length / pageSize)), [filtered.length]);\r\n\r\n  const computeDiscount = (promo, orderAmount) => {\r\n    const amt = Number(orderAmount||0); if(!promo || !(amt>0)) return { discount:0, final: amt };\r\n    if(promo.discountType === 'PERCENT') {\r\n      let raw = amt * (Number(promo.discountValue||0)/100);\r\n      if(promo.maxDiscount) raw = Math.min(raw, Number(promo.maxDiscount));\r\n      return { discount: raw, final: Math.max(0, amt - raw) };\r\n    }\r\n    const raw = Number(promo.discountValue||0);\r\n    return { discount: Math.min(raw, amt), final: Math.max(0, amt - raw) };\r\n  };\r\n\r\n  const load = async() => {\r\n    if(!isAdminOrStaff) return;\r\n    setLoading(true); setError('');\r\n    try {\r\n      // Tạm thời gọi thử endpoint nếu có, nếu 404 → giả lập mock\r\n      const res = await fetch('/api/admin/promotions', { headers: authHeaders(), cache:'no-store' });\r\n      if(!res.ok) throw new Error('Không tải được danh sách ưu đãi');\r\n      const j = await res.json();\r\n      const list = Array.isArray(j.items)? j.items: Array.isArray(j.promotions)? j.promotions: [];\r\n      setItems(list.map(r=> ({ ...r })));\r\n    } catch(e){\r\n      console.warn('[AdminPromotions] load error:', e.message);\r\n      setError(e.message || 'Lỗi tải dữ liệu');\r\n      // Không còn tự động tạo mock để tránh nhầm trạng thái thực tế vs giả lập\r\n      setItems([]);\r\n    } finally { setLoading(false); }\r\n  };\r\n  useEffect(()=>{ load(); loadHotels(); }, []);\r\n\r\n  // Lock background scroll + focus first input when modal open\r\n  useEffect(()=>{\r\n    if(createOpen){\r\n      modalScrollRef.current = window.scrollY || 0;\r\n      // Scroll page to top so modal luôn xuất hiện ở đầu\r\n      try { window.scrollTo(0,0); } catch {}\r\n      // lock body at top\r\n      document.body.style.position='fixed';\r\n      document.body.style.top = '0';\r\n      document.body.style.left='0';\r\n      document.body.style.right='0';\r\n      document.body.style.width='100%';\r\n      document.body.classList.add('promo-modal-open');\r\n      // ensure viewport not scrolled weirdly & focus\r\n      window.requestAnimationFrame(()=>{ firstFieldRef.current && firstFieldRef.current.focus(); });\r\n    } else {\r\n      if(document.body.classList.contains('promo-modal-open')){\r\n        const restore = modalScrollRef.current || 0;\r\n        document.body.style.position='';\r\n        document.body.style.top='';\r\n        document.body.style.left='';\r\n        document.body.style.right='';\r\n        document.body.style.width='';\r\n        document.body.classList.remove('promo-modal-open');\r\n        window.scrollTo(0, restore);\r\n      }\r\n    }\r\n  }, [createOpen]);\r\n\r\n  useEffect(()=>{ if(debounceRef.current) clearTimeout(debounceRef.current); debounceRef.current = setTimeout(()=> setPage(1), 300); return ()=> debounceRef.current && clearTimeout(debounceRef.current); }, [q, statusFilter]);\r\n\r\n  const openCreate = () => { setForm(emptyForm); setCreateOpen(true); };\r\n\r\n  const validateForm = (data) => {\r\n    if(!data.code.trim()) return 'Nhập mã ưu đãi';\r\n    if(!/^[-A-Z0-9_]+$/i.test(data.code.trim())) return 'Mã chỉ gồm chữ, số, -, _';\r\n    if(!data.discountType) return 'Chọn loại giảm';\r\n    const val = Number(data.discountValue); if(!(val>0)) return 'Giá trị giảm phải > 0';\r\n    if(data.discountType==='PERCENT' && val>100) return 'Phần trăm ≤ 100';\r\n    // Normalize to date-only for validation (strip any time component)\r\n    const sDate = data.startDate ? String(data.startDate).slice(0,10) : '';\r\n    const eDate = data.endDate ? String(data.endDate).slice(0,10) : '';\r\n    if(!sDate || !eDate) return 'Chọn thời gian hiệu lực';\r\n    if(new Date(eDate) <= new Date(sDate)) return 'Ngày kết thúc phải sau ngày bắt đầu';\r\n    if(data.minOrderAmount && !(Number(data.minOrderAmount)>=0)) return 'Đơn tối thiểu không hợp lệ';\r\n    if(data.discountType==='PERCENT' && data.maxDiscount && !(Number(data.maxDiscount)>0)) return 'Giảm tối đa phải > 0';\r\n    return '';\r\n  };\r\n\r\n  const submitCreate = async () => {\r\n    const err = validateForm(form); if(err){ alert(err); return; }\r\n    setCreating(true);\r\n    try {\r\n      // Strip time component: send date-only (YYYY-MM-DD) to server/DB\r\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0,10) : null;\r\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0,10) : null;\r\n  // Force newly created promotions to be active by default\r\n  const payload = { ...form, isActive: true, hotelId: form.hotelId ? Number(form.hotelId) : null, discountValue: Number(form.discountValue), minOrderAmount: form.minOrderAmount? Number(form.minOrderAmount): null, maxDiscount: form.maxDiscount? Number(form.maxDiscount): null, startDate: startDateOnly, endDate: endDateOnly };\r\n      const res = await fetch('/api/admin/promotions', { method:'POST', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if(!res.ok) throw new Error('Tạo ưu đãi thất bại');\r\n      setCreateOpen(false); setForm(emptyForm); load();\r\n    } catch(e){ alert(e.message || 'Lỗi tạo'); } finally { setCreating(false); }\r\n  };\r\n\r\n  const openEdit = (row) => { setEditing(row); setForm({ ...emptyForm, ...row, startDate: row.startDate?.slice(0,16) || '', endDate: row.endDate?.slice(0,16) || '' }); setCreateOpen(true); };\r\n  \r\n  // Normalize edit values to date-only (YYYY-MM-DD)\r\n  const openEditNormalized = (row) => { setEditing(row); setForm({ ...emptyForm, ...row, startDate: row.startDate ? String(row.startDate).slice(0,10) : '', endDate: row.endDate ? String(row.endDate).slice(0,10) : '' }); setCreateOpen(true); };\r\n\r\n  const submitEdit = async () => {\r\n    if(!editing) return; const err = validateForm(form); if(err){ alert(err); return; }\r\n    setSaving(true);\r\n    try {\r\n      // Send date-only values (YYYY-MM-DD) to avoid time components being stored\r\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0,10) : null;\r\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0,10) : null;\r\n  const payload = { description: form.description, hotelId: form.hotelId ? Number(form.hotelId) : null, discountType: form.discountType, discountValue: Number(form.discountValue), startDate: startDateOnly, endDate: endDateOnly, minOrderAmount: form.minOrderAmount? Number(form.minOrderAmount): null, maxDiscount: form.maxDiscount? Number(form.maxDiscount): null, isActive: form.isActive };\r\n      const res = await fetch(`/api/admin/promotions/${editing.id}`, { method:'PUT', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if(!res.ok) throw new Error('Cập nhật thất bại');\r\n      setCreateOpen(false); setEditing(null); load();\r\n    } catch(e){ alert(e.message || 'Lỗi cập nhật'); } finally { setSaving(false); }\r\n  };\r\n\r\n  const toggleActive = async (row) => {\r\n    // Optimistic\r\n    setItems(prev => prev.map(p => p.id===row.id? { ...p, isActive: !p.isActive }: p));\r\n    try {\r\n      const res = await fetch(`/api/admin/promotions/${row.id}/activate`, { method:'PATCH', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify({ isActive: !row.isActive }) });\r\n      if(!res.ok) throw new Error('Cập nhật trạng thái thất bại');\r\n    } catch(e){\r\n      setItems(prev => prev.map(p => p.id===row.id? { ...p, isActive: row.isActive }: p));\r\n      alert(e.message || 'Lỗi');\r\n    }\r\n  };\r\n\r\n  const del = async (row) => {\r\n    if(!window.confirm('Xóa ưu đãi này?')) return;\r\n    try {\r\n      const res = await fetch(`/api/admin/promotions/${row.id}`, { method:'DELETE', headers: authHeaders() });\r\n      if(!res.ok) throw new Error('Xóa thất bại');\r\n      load();\r\n    } catch(e){ alert(e.message || 'Lỗi xóa'); }\r\n  };\r\n\r\n  // Bulk actions\r\n  const toggleSelectOne = (id) => {\r\n    setSelectedIds(prev => {\r\n      const next = new Set(prev);\r\n      if (next.has(id)) next.delete(id); else next.add(id);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const toggleSelectAllOnPage = () => {\r\n    if (selectAllOnPage) {\r\n      // unselect same page ids\r\n      setSelectedIds(prev => {\r\n        const next = new Set(prev);\r\n        paged.forEach(p => next.delete(p.id));\r\n        return next;\r\n      });\r\n      setSelectAllOnPage(false);\r\n    } else {\r\n      setSelectedIds(prev => {\r\n        const next = new Set(prev);\r\n        paged.forEach(p => next.add(p.id));\r\n        return next;\r\n      });\r\n      setSelectAllOnPage(true);\r\n    }\r\n  };\r\n\r\n  const bulkActivate = async (on) => {\r\n    if(selectedIds.size===0) return alert('Chưa chọn ưu đãi nào');\r\n    if(!window.confirm(`Bạn có chắc muốn ${on? 'bật':'tắt'} ${selectedIds.size} ưu đãi?`)) return;\r\n    try {\r\n      // optimistic update\r\n      setItems(prev => prev.map(it => selectedIds.has(it.id) ? { ...it, isActive: on } : it));\r\n      // server call for each id (server may support batch; fallback to per-id)\r\n      await Promise.all(Array.from(selectedIds).map(id => fetch(`/api/admin/promotions/${id}/activate`, { method:'PATCH', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify({ isActive: on }) } ).then(r=>{ if(!r.ok) throw new Error('Lỗi cập nhật'); } )));\r\n      alert('Cập nhật trạng thái thành công');\r\n      setSelectedIds(new Set()); setSelectAllOnPage(false);\r\n      load();\r\n    } catch(e){ alert(e.message||'Lỗi cập nhật'); load(); }\r\n  };\r\n\r\n  const copyCode = async (code) => {\r\n    try {\r\n      await navigator.clipboard.writeText(code);\r\n      alert('Sao chép mã: ' + code);\r\n    } catch(e){ alert('Không thể sao chép'); }\r\n  };\r\n\r\n  const exportCSV = () => {\r\n  const rows = filtered.map(p => ({ code: p.code, description: p.description||'', type: p.discountType, value: p.discountValue, hotelType: p.hotelType || '', minOrder: p.minOrderAmount||'', maxDiscount: p.maxDiscount||'', start: p.startDate||'', end: p.endDate||'', active: p.isActive?1:0 }));\r\n    const csv = [Object.keys(rows[0] || {}).join(','), ...rows.map(r=> Object.values(r).map(v => '\"' + String(v||'').replace(/\"/g,'\"\"') + '\"').join(','))].join('\\n');\r\n    const blob = new Blob([csv], { type:'text/csv;charset=utf-8;' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a'); a.href = url; a.download = 'promotions.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);\r\n  };\r\n\r\n  if(!isAdminOrStaff) return <div style={{ padding:16 }}>Chức năng dành cho quản trị / nhân viên.</div>;\r\n\r\n  return (\r\n    <div className=\"af-container amenities-anim-root\" style={{ padding:12 }}>\r\n      <h2 className=\"home-rooms-title\" style={{ textAlign:'left', marginTop:0 }}>Quản lý ưu đãi / mã khuyến mãi</h2>\r\n      <div className=\"reports-toolbar af-toolbar\" style={{ marginBottom:10, flexWrap:'wrap', gap:8 }}>\r\n        <div className=\"reports-field af-field-grow\" style={{ minWidth:240 }}>\r\n          <input className=\"reports-input\" placeholder=\"Tìm theo mã hoặc mô tả...\" value={q} onChange={e=>setQ(e.target.value)} />\r\n        </div>\r\n        <div className=\"reports-field\" style={{ minWidth:200 }}>\r\n          <select className=\"reports-select promo-select-inline\" value={statusFilter} onChange={e=>setStatusFilter(e.target.value)}>\r\n            <option value=\"all\">Tất cả trạng thái</option>\r\n            <option value=\"active\">Active</option>\r\n            <option value=\"scheduled\">Scheduled</option>\r\n            <option value=\"expired\">Expired</option>\r\n            <option value=\"disabled\">Disabled</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"reports-field\" style={{ display:'flex', gap:8 }}>\r\n          {isAdmin && <button className=\"ph-btn\" onClick={openCreate}>+ Thêm ưu đãi</button>}\r\n        </div>\r\n        <div style={{ display:'flex', gap:8, alignItems:'center' }}>\r\n          <label style={{ display:'flex', alignItems:'center', gap:8, fontSize:13 }}>\r\n            <input type=\"checkbox\" checked={selectAllOnPage} onChange={toggleSelectAllOnPage} /> Chọn trang\r\n          </label>\r\n          <button className=\"ph-btn\" onClick={()=> bulkActivate(true)} title=\"Bật ưu đãi cho các mục đã chọn\">Bật</button>\r\n          <button className=\"ph-btn\" onClick={()=> bulkActivate(false)} title=\"Tắt ưu đãi cho các mục đã chọn\">Tắt</button>\r\n          <button className=\"ph-btn\" onClick={exportCSV} title=\"Xuất CSV của danh sách đang lọc\">Xuất CSV</button>\r\n        </div>\r\n      </div>\r\n      {loading ? <div style={{ color:'#666' }}>Đang tải...</div> : error ? <div style={{ color:'#b42318' }}>{error}</div> : (\r\n        <div style={{ overflowX:'auto' }}>\r\n          <table className=\"ph-table-el af-table\" style={{ width:'100%', minWidth:1080 }}>\r\n            <thead>\r\n              <tr>\r\n                <th style={{ width:40 }}><input type=\"checkbox\" checked={selectAllOnPage} onChange={toggleSelectAllOnPage} /></th>\r\n                <th>Mã</th>\r\n                <th>Mô tả</th>\r\n                <th>Loại</th>\r\n                <th>Khách sạn</th>\r\n                <th>Giá trị</th>\r\n                <th>Hiệu lực</th>\r\n                <th>Điều kiện</th>\r\n                <th>Trạng thái</th>\r\n                <th>Hành động</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {paged.length===0 ? <tr><td colSpan={10} style={{ textAlign:'center', color:'#666' }}>Không có ưu đãi.</td></tr> : paged.map(p => {\r\n                const st = statusOf(p);\r\n                const amt = Number(previewAmount||0);\r\n                const { discount, final } = computeDiscount(p, (amt && (!p.minOrderAmount || amt >= Number(p.minOrderAmount)))? amt: 0);\r\n                return (\r\n                  <tr key={p.id} className=\"amenity-row\">\r\n                    <td style={{ textAlign:'center' }}>\r\n                      <input type=\"checkbox\" checked={selectedIds.has(p.id)} onChange={()=> toggleSelectOne(p.id)} />\r\n                    </td>\r\n                    <td className=\"ph-td\" style={{ fontWeight:600 }} title={`ID: ${p.id}`}>{p.code}</td>\r\n                    <td className=\"ph-td\" style={{ maxWidth:220 }} title={p.description}>{p.description || '—'}</td>\r\n                    <td className=\"ph-td\">{p.discountType === 'PERCENT'? 'Phần trăm':'Cố định'}</td>\r\n                    <td className=\"ph-td\" style={{ fontSize:12 }}>\r\n                      {p.hotelId ? <span className=\"promo-hotel-badge\" data-ht=\"name\">{p.hotelName || (hotels.find(h=>h.id===p.hotelId)?.name)||`#${p.hotelId}`}</span> : <span style={{ opacity:.6 }}>Tất cả</span>}\r\n                    </td>\r\n                    <td className=\"ph-td\">{p.discountType === 'PERCENT'? `${p.discountValue}%${p.maxDiscount? ` (tối đa ${Number(p.maxDiscount).toLocaleString('vi-VN')}đ)` : ''}` : `${Number(p.discountValue).toLocaleString('vi-VN')} đ`}</td>\r\n                    <td className=\"ph-td\" style={{ fontSize:12 }}>\r\n                      <div>{p.startDate ? new Date(p.startDate).toLocaleDateString('vi-VN') : '—'}</div>\r\n                      <div style={{ opacity:.8 }}>{p.endDate ? new Date(p.endDate).toLocaleDateString('vi-VN') : '—'}</div>\r\n                    </td>\r\n                    <td className=\"ph-td\" style={{ fontSize:12 }}>\r\n                      {p.minOrderAmount ? <div>Tối thiểu: {Number(p.minOrderAmount).toLocaleString('vi-VN')}đ</div> : <div>—</div>}\r\n                      {p.discountType==='PERCENT' && p.maxDiscount && <div>Giảm tối đa: {Number(p.maxDiscount).toLocaleString('vi-VN')}đ</div>}\r\n                      {previewAmount && discount>0 && (\r\n                        <div style={{ marginTop:6 }}>\r\n                          <div style={{ color:'#047857', fontWeight:600 }}>Giảm {Math.round(discount).toLocaleString('vi-VN')}đ <span style={{ color:'#6b7280', fontWeight:400 }}>({p.discountType==='PERCENT'? `-${p.discountValue}%` : `- ${Math.round(discount).toLocaleString('vi-VN')}đ`})</span></div>\r\n                          <div style={{ color:'#065f46', fontWeight:700 }}>Còn: {Math.round(final).toLocaleString('vi-VN')}đ</div>\r\n                        </div>\r\n                      )}\r\n                    </td>\r\n                    <td className=\"ph-td\" style={{ fontWeight:600 }}>\r\n                      <span className={`promo-badge promo-${st.toLowerCase()}`}>{st}</span>\r\n                    </td>\r\n                    <td className=\"ph-td\" style={{ whiteSpace:'nowrap' }}>\r\n                      <button className=\"ph-btn\" onClick={()=> copyCode(p.code)}>Sao chép mã</button>\r\n                      <button className=\"ph-btn ph-btn--success\" onClick={()=> openEditNormalized(p)}>Sửa</button>\r\n                      <button className=\"ph-btn ph-btn--warning\" onClick={()=> toggleActive(p)}>{p.isActive? 'Tắt':'Bật'}</button>\r\n                      {isAdmin && <button className=\"ph-btn ph-btn--danger\" onClick={()=> del(p)}>Xóa</button>}\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n\r\n      <div style={{ marginTop:10, display:'flex', gap:12, alignItems:'center', flexWrap:'wrap' }}>\r\n        <div style={{ display:'flex', gap:6, alignItems:'center' }}>\r\n          <label style={{ fontSize:13 }}>Xem thử đơn hàng (VND):</label>\r\n          <input type=\"number\" style={{ width:140 }} value={previewAmount} onChange={e=> setPreviewAmount(e.target.value)} placeholder=\"Nhập số tiền\" />\r\n        </div>\r\n        <div style={{ marginLeft:'auto', display:'flex', gap:6, alignItems:'center' }}>\r\n          <button className=\"ph-btn\" disabled={page<=1} onClick={()=> setPage(p=> Math.max(1,p-1))}>◀</button>\r\n          <span style={{ fontSize:13 }}>Trang {page}/{pageCount}</span>\r\n          <button className=\"ph-btn\" disabled={page>=pageCount} onClick={()=> setPage(p=> Math.min(pageCount,p+1))}>▶</button>\r\n        </div>\r\n      </div>\r\n\r\n      {createOpen && (\r\n        <div className=\"profile-overlay promo-overlay\" onMouseDown={e=>{ if(e.target===e.currentTarget){ setCreateOpen(false); setEditing(null);} }}>\r\n          <div className=\"profile-modal promo-modal\" onMouseDown={e=> e.stopPropagation()} style={{ width:740, maxWidth:'96%' }}>\r\n            <h3 className=\"promo-modal__title\">{editing? 'Chỉnh sửa ưu đãi' : 'Tạo ưu đãi mới'}</h3>\r\n            <div className=\"promo-status-preview\">\r\n              {(() => {\r\n                // Dự kiến trạng thái dựa vào form hiện tại\r\n                const mock = { ...form, isActive:true };\r\n                const st = (!mock.startDate || !mock.endDate) ? 'Chưa đủ dữ liệu' : statusOf({ ...mock, startDate: mock.startDate, endDate: mock.endDate, isActive:true });\r\n                return <><span>Trạng thái dự kiến: </span><span className={`promo-badge promo-${(st||'').toLowerCase().replace(/ /g,'')}`}>{st}</span></>;\r\n              })()}\r\n            </div>\r\n            <div className=\"profile-modal__form promo-form\">\r\n              <label className=\"promo-field\">Mã ưu đãi\r\n                <input ref={firstFieldRef} className=\"promo-input\" value={form.code} disabled={!!editing} onChange={e=> setForm(f=> ({ ...f, code:e.target.value.toUpperCase() }))} placeholder=\"WELCOME10\" />\r\n              </label>\r\n              <label className=\"promo-field\">Loại giảm\r\n                <select className=\"promo-select-inline promo-input promo-discount-type\" data-type={form.discountType} value={form.discountType} onChange={e=> setForm(f=> ({ ...f, discountType:e.target.value }))}>\r\n                  <option value=\"PERCENT\">Phần trăm</option>\r\n                  <option value=\"FIXED\">Cố định</option>\r\n                </select>\r\n              </label>\r\n              <label className=\"promo-field\">Giá trị giảm\r\n                <input className=\"promo-input\" type=\"number\" value={form.discountValue} onChange={e=> setForm(f=> ({ ...f, discountValue:e.target.value }))} placeholder=\"10 hoặc 100000\" />\r\n              </label>\r\n              <label className=\"promo-field\">Giảm tối đa (nếu %)\r\n                <input className=\"promo-input\" type=\"number\" value={form.maxDiscount} disabled={form.discountType!=='PERCENT'} onChange={e=> setForm(f=> ({ ...f, maxDiscount:e.target.value }))} placeholder=\"200000\" />\r\n              </label>\r\n              <label className=\"promo-field\">Khách sạn áp dụng\r\n                <select className=\"promo-select-inline promo-input\" value={form.hotelId} onChange={e=> setForm(f=> ({ ...f, hotelId:e.target.value }))}>\r\n                  <option value=\"\">Tất cả khách sạn</option>\r\n                  {hotels.map(h => <option key={h.id} value={h.id}>{h.name}</option>)}\r\n                </select>\r\n              </label>\r\n              <label className=\"promo-field\">Đơn tối thiểu\r\n                <input className=\"promo-input\" type=\"number\" value={form.minOrderAmount} onChange={e=> setForm(f=> ({ ...f, minOrderAmount:e.target.value }))} placeholder=\"500000\" />\r\n              </label>\r\n              <label className=\"promo-field\">Ngày bắt đầu\r\n                <input className=\"promo-input\" type=\"date\" min={localToday} value={form.startDate} onChange={e=> setForm(f=> ({ ...f, startDate:e.target.value }))} />\r\n              </label>\r\n              <label className=\"promo-field\">Ngày kết thúc\r\n                <input className=\"promo-input\" type=\"date\" min={form.startDate || localToday} value={form.endDate} onChange={e=> setForm(f=> ({ ...f, endDate:e.target.value }))} />\r\n              </label>\r\n              <label className=\"promo-field promo-field--full\">Mô tả\r\n                <textarea className=\"promo-input\" rows={3} value={form.description} onChange={e=> setForm(f=> ({ ...f, description:e.target.value }))} placeholder=\"Mô tả ngắn...\" />\r\n              </label>\r\n            </div>\r\n            <div className=\"promo-preview-box\">\r\n              <strong>Xem nhanh:</strong>{' '}\r\n              {(() => {\r\n                const testAmt = Number(previewAmount||0);\r\n                if(!(testAmt>0)) return <span>Nhập số tiền đơn hàng ở dưới danh sách để xem mức giảm.</span>;\r\n                const mockPromo = { ...form, discountValue: Number(form.discountValue||0), maxDiscount: form.maxDiscount? Number(form.maxDiscount): null };\r\n                const { discount, final } = computeDiscount(mockPromo, testAmt);\r\n                if(!discount) return <span>Không áp dụng (chưa đủ điều kiện hoặc dữ liệu thiếu).</span>;\r\n                return <span>Giảm {Math.round(discount).toLocaleString('vi-VN')}đ còn {Math.round(final).toLocaleString('vi-VN')}đ.</span>;\r\n              })()}\r\n            </div>\r\n            <div className=\"promo-actions\">\r\n              {editing ? (\r\n                <>\r\n                  <button className=\"ph-btn promo-action-btn\" onClick={submitEdit} disabled={saving}>{saving? 'Đang lưu...':'Lưu thay đổi'}</button>\r\n                  <button className=\"ph-btn ph-btn--secondary promo-action-btn\" onClick={()=> { setCreateOpen(false); setEditing(null); }}>Hủy</button>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <button className=\"ph-btn promo-action-btn\" onClick={submitCreate} disabled={creating}>{creating? 'Đang tạo...':'Tạo mới'}</button>\r\n                  <button className=\"ph-btn ph-btn--secondary promo-action-btn\" onClick={()=> { setCreateOpen(false); setEditing(null); }}>Hủy</button>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <style>{`\r\n  .promo-badge { display:inline-block; padding:4px 8px; font-size:11px; line-height:1; border-radius:20px; letter-spacing:.3px; }\r\n        .promo-active { background:#e6f7ec; color:#087443; border:1px solid #b2e7c9; }\r\n        .promo-scheduled { background:#f0f4ff; color:#1d4ed8; border:1px solid #c7d8ff; }\r\n        .promo-expired { background:#ffe8e6; color:#b42318; border:1px solid #f5b5ae; }\r\n        .promo-disabled { background:#f1f5f9; color:#475569; border:1px solid #d3dce4; }\r\n\r\n        .af-table { border-collapse: separate; border-spacing: 0 2px; }\r\n        .af-table thead th { background:#fafbfc; position:sticky; top:0; z-index:5; }\r\n        .af-table th, .af-table td { padding:8px 10px; vertical-align:middle; }\r\n        .af-table tbody tr { background:#fff; transition:background .25s, box-shadow .25s; }\r\n        .af-table tbody tr:nth-child(odd) { background:linear-gradient(180deg,#ffffff,#fdfdfd); }\r\n        .af-table tbody tr:hover { background:#f5f9ff; box-shadow:0 2px 6px rgba(0,0,0,.05); }\r\n        .af-table input, .af-table select, .af-table textarea { font-size:14px; border:1px solid #d7dbe0; border-radius:6px; background:#fff; }\r\n        .af-table input, .af-table select { height:34px; line-height:1.3; padding:5px 10px 8px; }\r\n        .af-table textarea { padding:6px 8px; }\r\n\r\n        /* Inline promotion selects - prevent descender clipping (g,y,p,q) & polish */\r\n        .promo-select-inline { \r\n          height:44px; min-height:44px; line-height:1.3; padding:0 44px 0 12px; font-size:14px; \r\n          border:1px solid #cfd6dd; border-radius:10px; background:#fff; font-weight:500; \r\n          box-shadow:0 1px 0 rgba(0,0,0,.02); appearance:none; -webkit-appearance:none; -moz-appearance:none; \r\n          background-image: linear-gradient(#fff,#fff), url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\r\n          background-repeat:no-repeat; background-position:right 12px center, 0 0; background-size:14px 14px, auto; \r\n          transition:border-color .25s, box-shadow .25s, background-color .35s; cursor:pointer;\r\n        }\r\n        .promo-select-inline:focus { border-color:#f59e0b; box-shadow:0 0 0 3px rgba(245,158,11,.28); outline:none; }\r\n        .promo-select-inline:hover { border-color:#94a3b8; }\r\n        .promo-select-inline option { line-height:1.35; }\r\n\r\n        /* Badge subtle elevation */\r\n        .promo-badge { position:relative; font-weight:600; box-shadow:0 1px 0 rgba(0,0,0,.06), 0 0 0 1px rgba(0,0,0,.02); }\r\n        .promo-badge::after { content:\"\"; position:absolute; inset:0; border-radius:inherit; box-shadow:0 2px 4px rgba(0,0,0,.08); opacity:0; transition:opacity .25s; }\r\n        tr:hover .promo-badge::after { opacity:.4; }\r\n\r\n        /* Action buttons spacing */\r\n        .af-table td button.ph-btn { margin:2px 4px 2px 0; }\r\n\r\n  .ph-btn { cursor:pointer; }\r\n  .profile-overlay { backdrop-filter: blur(3px); background: rgba(15,23,42,0.55); display:flex; align-items:center; justify-content:center; position:fixed; inset:0; z-index:1200; animation:promoOverlayFade .4s ease; }\r\n  @keyframes promoOverlayFade { from { opacity:0; } to { opacity:1; } }\r\n  .profile-modal { box-shadow: 0 24px 70px -18px rgba(0,0,0,.35), 0 4px 14px rgba(0,0,0,.14); border: 1px solid rgba(255,255,255,0.25); background: linear-gradient(165deg,#ffffff,#fffdfa); position:relative; }\r\n  .promo-modal { border-radius:20px; padding:22px 26px 26px; animation:promoModalIn .45s cubic-bezier(.4,.22,.22,1); }\r\n  /* Đưa modal sát đỉnh: giảm translateY ban đầu để không nằm phần giữa */\r\n  @keyframes promoModalIn { 0% { opacity:0; transform:translateY(8px) scale(.97); } 60% { opacity:1; transform:translateY(0) scale(1.005);} 100% { opacity:1; transform:translateY(0) scale(1);} }\r\n  .promo-modal__title { margin:2px 0 6px; text-align:center; font-weight:800; letter-spacing:.5px; }\r\n  .promo-status-preview { text-align:center; font-size:12px; margin-bottom:14px; color:#475569; animation:fadeUp .5s .15s both; }\r\n  @keyframes fadeUp { from { opacity:0; transform:translateY(6px);} to { opacity:1; transform:translateY(0);} }\r\n  .profile-modal__form { grid-template-columns: repeat(2, minmax(200px,1fr)); }\r\n  .promo-form { display:grid; gap:18px 20px; }\r\n  .promo-field { display:flex; flex-direction:column; gap:6px; font-size:13px; font-weight:600; color:#0f172a; position:relative; opacity:0; animation:promoFieldIn .55s cubic-bezier(.4,.22,.22,1) forwards; }\r\n  .promo-field:nth-child(1){ animation-delay:.06s; }\r\n  .promo-field:nth-child(2){ animation-delay:.10s; }\r\n  .promo-field:nth-child(3){ animation-delay:.14s; }\r\n  .promo-field:nth-child(4){ animation-delay:.18s; }\r\n  .promo-field:nth-child(5){ animation-delay:.22s; }\r\n  .promo-field:nth-child(6){ animation-delay:.26s; }\r\n  .promo-field:nth-child(7){ animation-delay:.30s; }\r\n  .promo-field--full { grid-column:1 / -1; }\r\n  @keyframes promoFieldIn { 0% { opacity:0; transform:translateY(10px);} 60% { opacity:1; } 100% { opacity:1; transform:translateY(0);} }\r\n  .promo-input { background:#fff; border:1px solid #d8dee5; border-radius:10px; padding:0 12px; font-size:14px; line-height:1.3; box-shadow:0 1px 0 rgba(0,0,0,.02); transition:border-color .25s, box-shadow .28s, background-color .35s; height:44px; display:flex; align-items:center; width:100%; box-sizing:border-box; }\r\n  .promo-input:focus { outline:none; border-color:#f59e0b; box-shadow:0 0 0 3px rgba(245,158,11,.28), 0 4px 14px -2px rgba(0,0,0,.15); }\r\n  .promo-input:disabled { background:#f1f5f9; color:#64748b; }\r\n  .promo-input:hover:not(:disabled) { border-color:#94a3b8; }\r\n  textarea.promo-input { resize:vertical; min-height:92px; }\r\n  .promo-preview-box { margin-top:16px; background:#f8fafc; padding:12px 14px; border-radius:14px; font-size:13px; border:1px solid #eef2f6; animation:fadeUp .6s .25s both; }\r\n  .promo-actions { margin-top:22px; display:flex; gap:14px; justify-content:center; animation:fadeUp .55s .32s both; }\r\n  .promo-action-btn { font-weight:700; min-width:140px; position:relative; }\r\n  .promo-action-btn:not(:disabled) { transition:transform .25s, box-shadow .28s, background .35s; }\r\n  .promo-action-btn:not(:disabled):hover { transform:translateY(-2px); box-shadow:0 8px 24px -6px rgba(0,0,0,.25); }\r\n  .promo-action-btn:not(:disabled):active { transform:translateY(0) scale(.97); box-shadow:0 4px 14px -4px rgba(0,0,0,.22); }\r\n  .promo-action-btn:disabled { opacity:.7; cursor:progress; }\r\n  @media (max-width:720px){ .profile-modal__form { grid-template-columns: 1fr; } .promo-field { animation-delay:.05s !important; } }\r\n  @media (prefers-reduced-motion: reduce){\r\n    .promo-modal, .promo-field, .promo-status-preview, .promo-preview-box, .promo-actions { animation:none !important; }\r\n  }\r\n  /* ================= COLORFUL ACCENTS ADDITION ================ */\r\n  .promo-modal { background: linear-gradient(145deg,#ffffff 0%,#fff9f2 65%); }\r\n  .promo-modal-open { overflow:hidden; }\r\n  /* Overlay canh top: giảm padding-top để modal nằm sát hơn phần trên cùng */\r\n  .promo-overlay { overflow:auto; align-items:flex-start; justify-content:center; padding:8px 0 32px; }\r\n  .promo-modal__title { position:relative; }\r\n  .promo-modal__title::after { content:\"\"; position:absolute; left:50%; transform:translateX(-50%); bottom:-6px; width:160px; height:6px; border-radius:4px; background:linear-gradient(90deg,#f59e0b,#fbbf24,#fde047); box-shadow:0 2px 6px -2px rgba(245,158,11,.6); }\r\n  .promo-form { position:relative; }\r\n  .promo-form::before { content:\"\"; position:absolute; inset:-12px -18px -12px -18px; background:linear-gradient(135deg,#fff7eb,#ffffff 28%,#ffffff 72%,#fff7eb); border:1px solid #ffe2b9; border-radius:18px; z-index:0; box-shadow:0 4px 18px -6px rgba(245,158,11,.25); }\r\n  .promo-form .promo-field { z-index:1; }\r\n  .promo-field { padding:2px 4px 6px; border-radius:12px; transition: background .35s, box-shadow .35s; }\r\n  .promo-field:hover { background:rgba(255,178,36,0.06); }\r\n  .promo-input { background:linear-gradient(180deg,#ffffff,#fffdf8); }\r\n  .promo-input:focus { background:#ffffff; }\r\n  /* Discount type select dynamic color ring */\r\n  .promo-discount-type { position:relative; font-weight:700; letter-spacing:.3px; }\r\n  .promo-discount-type[data-type=\"PERCENT\"] { box-shadow:0 0 0 1px #ffd089, 0 0 0 4px rgba(245,158,11,.25); background:linear-gradient(180deg,#fffaf2,#fff); }\r\n  .promo-discount-type[data-type=\"FIXED\"] { box-shadow:0 0 0 1px #93c5fd, 0 0 0 4px rgba(59,130,246,.25); background:linear-gradient(180deg,#f1f8ff,#ffffff); }\r\n  .promo-discount-type:focus { box-shadow:0 0 0 1px #f59e0b,0 0 0 4px rgba(245,158,11,.35); }\r\n  /* Buttons accent gradient */\r\n  .promo-action-btn { background:linear-gradient(180deg,#f59e0b,#f59a0b); color:#fff; border:none; }\r\n  .promo-action-btn:hover { background:linear-gradient(180deg,#f8b13e,#f59a0b); }\r\n  .promo-action-btn:active { background:linear-gradient(180deg,#e88d04,#d97706); }\r\n  .promo-action-btn.ph-btn--secondary { background:#fff; color:#374151; border:1px solid #e2e8f0; }\r\n  .promo-action-btn.ph-btn--secondary:hover { background:#f8fafc; }\r\n  .promo-hotel-badge { display:inline-block; padding:4px 6px; border-radius:10px; font-size:11px; font-weight:600; letter-spacing:.3px; background:#eef2ff; color:#3730a3; border:1px solid #c7d2fe; }\r\n  .promo-hotel-badge[data-ht='Resort'] { background:#ecfdf5; color:#065f46; border-color:#a7f3d0; }\r\n  .promo-hotel-badge[data-ht='Business'] { background:#eff6ff; color:#1e3a8a; border-color:#bfdbfe; }\r\n  .promo-hotel-badge[data-ht='Boutique'] { background:#fdf2f8; color:#9d174d; border-color:#fbcfe8; }\r\n  /* Preview box accent border */\r\n  .promo-preview-box { border:1px solid #ffe2b9; background:linear-gradient(180deg,#fffefb,#fffaf2); }\r\n  /* Scrollbar subtle theming inside modal (WebKit) */\r\n  .promo-modal ::-webkit-scrollbar { width:10px; }\r\n  .promo-modal ::-webkit-scrollbar-track { background:transparent; }\r\n  .promo-modal ::-webkit-scrollbar-thumb { background:linear-gradient(#f59e0b,#f59a0b); border-radius:20px; border:2px solid #fff; }\r\n  /* Accessible high-contrast tweak (prefers-contrast more) */\r\n  @media (prefers-contrast: more){\r\n    .promo-form::before { box-shadow:none; }\r\n    .promo-action-btn { box-shadow:none; }\r\n  }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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AAa,GAAC;YAAS;cAAAkL,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAS,CAAC,eACnI9M,OAAA;cAAQ+M,SAAS,EAAC,2CAA2C;cAACW,OAAO,EAAEA,CAAA,KAAK;gBAAEtM,aAAa,CAAC,KAAK,CAAC;gBAAEE,UAAU,CAAC,IAAI,CAAC;cAAE,CAAE;cAAAoL,QAAA,EAAC;YAAG;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA,eACrI;QACH;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,eAED9M,OAAA;MAAA0M,QAAA,EAAQ;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAAO;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACP,CAAC;AAEV;AAAC1M,EAAA,CA3jBuBD,eAAe;AAAAsP,EAAA,GAAftP,eAAe;AAAA,IAAAsP,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}