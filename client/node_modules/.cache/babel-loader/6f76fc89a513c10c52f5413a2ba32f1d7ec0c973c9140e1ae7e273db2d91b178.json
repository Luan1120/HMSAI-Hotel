{"ast":null,"code":"import _objectSpread from\"D:/DA_TichHop/HMS_AI Hotel/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useRef,useState}from'react';import'./HomePage.css';import{authHeaders,getUserRole}from'./auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AdminServices(){const isAdminOrStaff=['Admin','Staff'].includes(getUserRole());const isAdmin=getUserRole()==='Admin';const[q,setQ]=useState('');const[statusFilter,setStatusFilter]=useState('all');const[hotelFilter,setHotelFilter]=useState('all');const[items,setItems]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[createOpen,setCreateOpen]=useState(false);const[newRow,setNewRow]=useState({name:'',description:'',price:'',status:'Active',hotelId:'',icon:''});const[creating,setCreating]=useState(false);const[hotels,setHotels]=useState([]);// <-- added hotels state\nconst debounceRef=useRef(null);const rootRef=useRef(null);// Refs for icon upload handling\nconst fileInputRef=useRef(null);// When null => uploading for create-new modal, else holds service Id for row update\nconst pendingIconForId=useRef(null);useEffect(()=>{if(rootRef.current){requestAnimationFrame(()=>rootRef.current.classList.add('is-mounted'));}},[]);const load=async function(){var _opts$q,_opts$status,_opts$hotel;let opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!isAdminOrStaff)return;const qq=(_opts$q=opts.q)!==null&&_opts$q!==void 0?_opts$q:q;const ss=(_opts$status=opts.status)!==null&&_opts$status!==void 0?_opts$status:statusFilter;const hf=(_opts$hotel=opts.hotel)!==null&&_opts$hotel!==void 0?_opts$hotel:hotelFilter;setLoading(true);setError('');try{const url=new URL('/api/admin/services',window.location.origin);if(qq)url.searchParams.set('q',qq);if(ss&&ss!=='all')url.searchParams.set('status',ss==='active'?'Active':'Paused');if(hf&&hf!=='all')url.searchParams.set('hotelId',hf);const res=await fetch(url.toString(),{headers:authHeaders(),cache:'no-store'});if(!res.ok)throw new Error('Không tải được dịch vụ');const j=await res.json();const normalizeStatus=val=>{const v=String(val||'').trim().toLowerCase();if(['active','hoạt động','hoat dong','on','enabled','1','true'].includes(v))return'Active';if(['paused','tạm dừng','tam dung','off','disabled','0','false'].includes(v))return'Paused';// Default fallback\nreturn'Active';};const list=Array.isArray(j.items)?j.items.map(r=>_objectSpread(_objectSpread({},r),{},{Status:normalizeStatus(r.Status)})):[];setItems(list);}catch(e){setError(e.message||'Lỗi');setItems([]);}finally{setLoading(false);}};useEffect(()=>{if(isAdminOrStaff)load({q:'',status:'all'});},[]);useEffect(()=>{if(!isAdminOrStaff)return;if(debounceRef.current)clearTimeout(debounceRef.current);debounceRef.current=setTimeout(()=>load({}),300);return()=>debounceRef.current&&clearTimeout(debounceRef.current);},[q,statusFilter,hotelFilter]);useEffect(()=>{if(isAdminOrStaff){fetch('/api/admin/hotels',{headers:authHeaders()}).then(r=>r.ok?r.json():{items:[]}).then(j=>setHotels(Array.isArray(j.items)?j.items:[])).catch(()=>setHotels([]));}},[isAdminOrStaff]);// (legacy per-row edit handlers removed; saving handled by saveRow with drafts map)\nconst del=async it=>{if(!window.confirm('Xóa dịch vụ này?'))return;try{const res=await fetch(\"/api/admin/services/\".concat(it.Id),{method:'DELETE',headers:authHeaders()});if(!res.ok)throw new Error('Xóa thất bại');await load({});}catch(e){alert(e.message||'Lỗi xóa');}};const create=async()=>{if(!newRow.name.trim()){alert('Nhập tên dịch vụ');return;}if(!newRow.hotelId){alert('Chọn khách sạn');return;}setCreating(true);try{const payload={name:newRow.name,description:newRow.description,price:newRow.price?Number(newRow.price):0,status:newRow.status,hotelId:newRow.hotelId,icon:newRow.icon||null};const res=await fetch('/api/admin/services',{method:'POST',headers:_objectSpread({'Content-Type':'application/json'},authHeaders()),body:JSON.stringify(payload)});if(!res.ok)throw new Error('Tạo thất bại');setNewRow({name:'',description:'',price:'',status:'Active',hotelId:'',icon:''});setCreateOpen(false);await load({});}catch(e){alert(e.message||'Lỗi');}finally{setCreating(false);}};const[drafts,setDrafts]=useState({});const[selectedId,setSelectedId]=useState(null);// Initialize / sync drafts when items change (only add missing ids, keep user edits)\nuseEffect(()=>{setDrafts(prev=>{const next=_objectSpread({},prev);items.forEach(it=>{if(!next[it.Id])next[it.Id]={Name:it.Name||'',Description:it.Description||'',Price:it.Price||0,Status:it.Status||'Active',HotelId:it.HotelId||'',Icon:it.Icon||''};else{if(next[it.Id].HotelId===undefined)next[it.Id].HotelId=it.HotelId||'';if(next[it.Id].Icon===undefined)next[it.Id].Icon=it.Icon||'';// Sync status to backend value to avoid stale draft showing 'Hoạt động' while item is paused (or vice versa)\n// We intentionally overwrite to keep UI consistent after background reloads.\nnext[it.Id].Status=it.Status||'Active';}});Object.keys(next).forEach(id=>{if(!items.find(it=>String(it.Id)===String(id)))delete next[id];});return next;});},[items]);const updateDraft=(id,field,value)=>setDrafts(d=>_objectSpread(_objectSpread({},d),{},{[id]:_objectSpread(_objectSpread({},d[id]||{}),{},{[field]:value})}));const rowChangedPayload=(id,original)=>{const dr=drafts[id];if(!dr)return null;const payload={};if(dr.Name!==original.Name)payload.name=dr.Name;if(dr.Description!==original.Description)payload.description=dr.Description;if(String(dr.Price)!==String(original.Price))payload.price=dr.Price;if(dr.Status!==original.Status)payload.status=dr.Status;if(String(dr.HotelId||'')!==String(original.HotelId||'')){payload.hotelId=dr.HotelId||null;}if((dr.Icon||'')!==(original.Icon||''))payload.icon=dr.Icon||null;return Object.keys(payload).length?payload:null;};const saveRow=async it=>{const payload=rowChangedPayload(it.Id,it);if(!payload){alert('Không có thay đổi.');return;}try{const res=await fetch(\"/api/admin/services/\".concat(it.Id),{method:'PUT',headers:_objectSpread({'Content-Type':'application/json'},authHeaders()),body:JSON.stringify(payload)});if(!res.ok)throw new Error('Lưu thất bại');await load({});}catch(e){alert(e.message||'Lỗi lưu');}};const setAvailability=async(it,nextStatus)=>{const hotelId=drafts[it.Id]&&drafts[it.Id].HotelId||it.HotelId||'';if(!hotelId){alert('Thiếu khách sạn cho dịch vụ');return;}const originalStatus=it.Status;// Optimistic UI update\nsetItems(prev=>prev.map(s=>s.Id===it.Id?_objectSpread(_objectSpread({},s),{},{Status:nextStatus}):s));setDrafts(d=>_objectSpread(_objectSpread({},d),{},{[it.Id]:_objectSpread(_objectSpread({},d[it.Id]||{}),{},{Status:nextStatus})}));try{const payload={status:nextStatus,hotelId};const res=await fetch(\"/api/admin/services/\".concat(it.Id),{method:'PUT',headers:_objectSpread({'Content-Type':'application/json'},authHeaders()),body:JSON.stringify(payload)});if(!res.ok)throw new Error('Cập nhật trạng thái thất bại');// Optionally refresh in background to ensure consistency\nload({});}catch(e){// Revert on failure\nsetItems(prev=>prev.map(s=>s.Id===it.Id?_objectSpread(_objectSpread({},s),{},{Status:originalStatus}):s));setDrafts(d=>_objectSpread(_objectSpread({},d),{},{[it.Id]:_objectSpread(_objectSpread({},d[it.Id]||{}),{},{Status:originalStatus})}));alert(e.message||'Lỗi');}};const rowChanged=it=>{const dr=drafts[it.Id];if(!dr)return false;return dr.Name!==it.Name||dr.Description!==it.Description||String(dr.Price)!==String(it.Price)||dr.Status!==it.Status||String(dr.HotelId||'')!==String(it.HotelId||'')||(dr.Icon||'')!==(it.Icon||'');};// Trigger file chooser for an existing row (serviceId) or for create modal (null)\nconst triggerIconUpload=function(){let serviceId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;pendingIconForId.current=serviceId;// null => new service modal\nif(fileInputRef.current){fileInputRef.current.value='';fileInputRef.current.click();}};const onIconFile=async e=>{const f=e.target.files&&e.target.files[0];if(!f)return;// Basic client-side validation (optional)\nif(!/^image\\//.test(f.type)){alert('Vui lòng chọn file hình ảnh');return;}if(f.size>2*1024*1024){alert('Ảnh quá lớn (tối đa 2MB)');return;}const form=new FormData();form.append('file',f);try{const res=await fetch('/api/admin/services/upload-icon',{method:'POST',headers:authHeaders(),body:form});if(!res.ok)throw new Error('Upload thất bại');const j=await res.json();const path=j.path;if(pendingIconForId.current){const sid=pendingIconForId.current;setDrafts(d=>_objectSpread(_objectSpread({},d),{},{[sid]:_objectSpread(_objectSpread({},d[sid]||{}),{},{Icon:path})}));pendingIconForId.current=null;}else{// New service modal\nsetNewRow(r=>_objectSpread(_objectSpread({},r),{},{icon:path}));}}catch(err){alert(err.message||'Lỗi upload icon');}};if(!isAdminOrStaff)return/*#__PURE__*/_jsx(\"div\",{style:{padding:16},children:\"Ch\\u1EE9c n\\u0103ng d\\xE0nh cho qu\\u1EA3n tr\\u1ECB / nh\\xE2n vi\\xEAn.\"});return/*#__PURE__*/_jsxs(\"div\",{ref:rootRef,className:\"af-container amenities-anim-root\",style:{padding:12},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-rooms-title\",style:{textAlign:'left',marginTop:0},children:\"Qu\\u1EA3n l\\xFD d\\u1ECBch v\\u1EE5 kh\\xE1ch s\\u1EA1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"reports-toolbar af-toolbar\",style:{marginBottom:10},children:[/*#__PURE__*/_jsx(\"div\",{className:\"reports-field af-field-grow\",children:/*#__PURE__*/_jsx(\"input\",{className:\"reports-input\",style:{width:'100%'},placeholder:\"T\\xECm ki\\u1EBFm d\\u1ECBch v\\u1EE5...\",value:q,onChange:e=>setQ(e.target.value)})}),/*#__PURE__*/_jsx(\"div\",{className:\"reports-field\",style:{minWidth:200},children:/*#__PURE__*/_jsxs(\"select\",{className:\"reports-select\",value:statusFilter,onChange:e=>setStatusFilter(e.target.value),style:{height:38},children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"T\\u1EA5t c\\u1EA3 tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"option\",{value:\"active\",children:\"Ho\\u1EA1t \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paused\",children:\"T\\u1EA1m d\\u1EEBng\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"reports-field\",style:{minWidth:220},children:/*#__PURE__*/_jsxs(\"select\",{className:\"reports-select\",value:hotelFilter,onChange:e=>setHotelFilter(e.target.value),style:{height:38},children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"T\\u1EA5t c\\u1EA3 kh\\xE1ch s\\u1EA1n\"}),hotels.map(h=>/*#__PURE__*/_jsx(\"option\",{value:h.id||h.Id,children:h.name||h.Name},h.id||h.Id))]})})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:8},children:isAdmin&&/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",onClick:()=>setCreateOpen(true),children:\"+ Th\\xEAm d\\u1ECBch v\\u1EE5\"})}),loading?/*#__PURE__*/_jsx(\"div\",{style:{color:'#666'},children:\"\\u0110ang t\\u1EA3i...\"}):error?/*#__PURE__*/_jsx(\"div\",{style:{color:'#b42318'},children:error}):/*#__PURE__*/_jsxs(\"table\",{className:\"ph-table-el af-table\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"T\\xEAn d\\u1ECBch v\\u1EE5\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"Icon\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"M\\xF4 t\\u1EA3\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"Gi\\xE1 (VND)\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"Kh\\xE1ch s\\u1EA1n\"}),/*#__PURE__*/_jsx(\"th\",{style:{textAlign:'center'},children:\"H\\xE0nh \\u0111\\u1ED9ng\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:items.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:8,style:{color:'#666',textAlign:'center'},children:\"Kh\\xF4ng c\\xF3 d\\u1EEF li\\u1EC7u.\"})}):items.map((it,idx)=>{const dr=drafts[it.Id]||{Name:'',Description:'',Price:0,Status:'Active'};const statusClass=dr.Status==='Active'?'svc-status-active':'svc-status-paused';return/*#__PURE__*/_jsxs(\"tr\",{onClick:()=>setSelectedId(it.Id),className:\"amenity-row\"+(rowChanged(it)?' svc-row--changed':'')+(selectedId===it.Id?' svc-row--selected':''),style:{'--row-index':idx},children:[/*#__PURE__*/_jsx(\"td\",{className:\"ph-td\",style:{textAlign:'left'},children:it.Id}),/*#__PURE__*/_jsx(\"td\",{className:\"ph-td\",style:{textAlign:'left'},children:/*#__PURE__*/_jsx(\"input\",{value:(drafts[it.Id]||{}).Name||'',onFocus:()=>setSelectedId(it.Id),onChange:e=>updateDraft(it.Id,'Name',e.target.value)})}),/*#__PURE__*/_jsx(\"td\",{className:\"ph-td\",style:{textAlign:'left',width:120},children:it.Icon||(drafts[it.Id]||{}).Icon?/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'row',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(\"img\",{src:(drafts[it.Id]||{}).Icon||it.Icon,alt:\"icon\",style:{width:44,height:44,objectFit:'cover',borderRadius:8,border:'1px solid #ddd',background:'#fafafa'}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>triggerIconUpload(it.Id),style:{width:38,height:38,border:'1px solid #d0d5dd',background:'#fff',borderRadius:8,cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',padding:0},title:\"Thay icon\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/replace.png\",alt:\"Replace\",style:{width:20,height:20,objectFit:'contain'}})})]}):/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ph-btn\",style:{height:34,fontSize:12},onClick:()=>triggerIconUpload(it.Id),children:\"+ Icon\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"ph-td\",style:{textAlign:'left'},children:/*#__PURE__*/_jsx(\"input\",{value:(drafts[it.Id]||{}).Description||'',onFocus:()=>setSelectedId(it.Id),onChange:e=>updateDraft(it.Id,'Description',e.target.value)})}),/*#__PURE__*/_jsx(\"td\",{className:\"ph-td\",style:{textAlign:'left',minWidth:120},children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:(drafts[it.Id]||{}).Price,onFocus:()=>setSelectedId(it.Id),onChange:e=>updateDraft(it.Id,'Price',e.target.value)})}),/*#__PURE__*/_jsx(\"td\",{className:\"ph-td\",style:{textAlign:'left'},children:/*#__PURE__*/_jsxs(\"select\",{value:(drafts[it.Id]||{}).Status,onFocus:()=>setSelectedId(it.Id),onChange:e=>updateDraft(it.Id,'Status',e.target.value),className:\"reports-select \".concat(statusClass),style:{height:32},children:[/*#__PURE__*/_jsx(\"option\",{value:\"Active\",children:\"Ho\\u1EA1t \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Paused\",children:\"T\\u1EA1m d\\u1EEBng\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"ph-td\",style:{textAlign:'left'},children:/*#__PURE__*/_jsxs(\"select\",{value:(drafts[it.Id]||{}).HotelId,onFocus:()=>setSelectedId(it.Id),onChange:e=>updateDraft(it.Id,'HotelId',e.target.value),className:\"reports-select\",style:{height:32},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Ch\\u1ECDn kh\\xE1ch s\\u1EA1n\"}),hotels.map(ht=>/*#__PURE__*/_jsx(\"option\",{value:ht.id||ht.Id,children:ht.name||ht.Name},ht.id||ht.Id))]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"ph-td action\",style:{whiteSpace:'nowrap',textAlign:'left'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--success\",onClick:()=>saveRow(it),children:\"S\\u1EEDa\"}),isAdmin&&/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--danger\",onClick:()=>del(it),children:\"X\\xF3a\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--warning\",disabled:!((drafts[it.Id]||{}).HotelId||it.HotelId),onClick:()=>setAvailability(it,it.Status==='Active'?'Paused':'Active'),children:it.Status==='Active'?'Tạm dừng':'Kích hoạt'})]})]},it.Id);})})]}),createOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"profile-overlay\",onMouseDown:e=>{if(e.target===e.currentTarget)setCreateOpen(false);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile-modal\",onMouseDown:e=>e.stopPropagation(),style:{width:640,maxWidth:'96%',background:'#fff',borderRadius:12,padding:16},children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0,textAlign:'center'},children:\"Th\\xEAm d\\u1ECBch v\\u1EE5\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:16},children:[/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',flexDirection:'column',gap:4},children:[\"T\\xEAn d\\u1ECBch v\\u1EE5\",/*#__PURE__*/_jsx(\"input\",{value:newRow.name,onChange:e=>setNewRow(r=>_objectSpread(_objectSpread({},r),{},{name:e.target.value})),placeholder:\"Gi\\u1EB7t \\u1EE7i...\"})]}),/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',flexDirection:'column',gap:4},children:[\"Gi\\xE1 (VND)\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newRow.price,onChange:e=>setNewRow(r=>_objectSpread(_objectSpread({},r),{},{price:e.target.value})),placeholder:\"100000\"})]}),/*#__PURE__*/_jsxs(\"label\",{style:{gridColumn:'1 / span 2',display:'flex',flexDirection:'column',gap:4},children:[\"M\\xF4 t\\u1EA3\",/*#__PURE__*/_jsx(\"textarea\",{rows:3,value:newRow.description,onChange:e=>setNewRow(r=>_objectSpread(_objectSpread({},r),{},{description:e.target.value})),placeholder:\"M\\xF4 t\\u1EA3 ng\\u1EAFn\"})]}),/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',flexDirection:'column',gap:4},children:[\"Tr\\u1EA1ng th\\xE1i\",/*#__PURE__*/_jsxs(\"select\",{className:\"reports-select\",style:{height:38},value:newRow.status,onChange:e=>setNewRow(r=>_objectSpread(_objectSpread({},r),{},{status:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Active\",children:\"Ho\\u1EA1t \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Paused\",children:\"T\\u1EA1m d\\u1EEBng\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',flexDirection:'column',gap:4},children:[\"Kh\\xE1ch s\\u1EA1n\",/*#__PURE__*/_jsxs(\"select\",{className:\"reports-select\",style:{height:38},value:newRow.hotelId,onChange:e=>setNewRow(r=>_objectSpread(_objectSpread({},r),{},{hotelId:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Ch\\u1ECDn kh\\xE1ch s\\u1EA1n\"}),hotels.map(ht=>/*#__PURE__*/_jsx(\"option\",{value:ht.id||ht.Id,children:ht.name||ht.Name},ht.id||ht.Id))]})]}),/*#__PURE__*/_jsxs(\"label\",{style:{display:'flex',flexDirection:'column',gap:4},children:[\"Icon\",/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:12},children:[newRow.icon?/*#__PURE__*/_jsx(\"img\",{src:newRow.icon,alt:\"icon\",style:{width:56,height:56,objectFit:'cover',border:'1px solid #ddd',borderRadius:10,background:'#fafafa'}}):/*#__PURE__*/_jsx(\"span\",{style:{fontSize:12,color:'#666'},children:\"Ch\\u01B0a ch\\u1ECDn\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>{pendingIconForId.current=null;fileInputRef.current&&fileInputRef.current.click();},style:{display:'flex',alignItems:'center',gap:6,background:'#fff',border:'1px solid #d0d5dd',borderRadius:8,padding:'6px 10px',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"img\",{src:\"/replace.png\",alt:\"Upload\",style:{width:18,height:18}}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:13},children:\"Ch\\u1ECDn / Thay\"})]}),newRow.icon&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ph-btn ph-btn--danger\",onClick:()=>setNewRow(r=>_objectSpread(_objectSpread({},r),{},{icon:''})),children:\"X\\xF3a\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:16,display:'flex',gap:12,justifyContent:'center'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",onClick:create,disabled:creating,children:creating?'Đang tạo...':'Tạo'}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:()=>setCreateOpen(false),children:\"H\\u1EE7y\"})]})]})}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",style:{display:'none'},onChange:onIconFile}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n        .amenities-anim-root { opacity:0; transform:translateY(12px); transition: opacity .5s ease, transform .55s cubic-bezier(.4,.2,.2,1); }\\n        .amenities-anim-root.is-mounted { opacity:1; transform:translateY(0); }\\n        .amenities-anim-root table.af-table { animation:tableFade .55s .12s both ease; }\\n        @keyframes tableFade { from { opacity:0; transform:translateY(8px);} to { opacity:1; transform:translateY(0);} }\\n\\n        /* Compact, uniform sizing */\\n        .af-table th, .af-table td { padding:6px 8px; vertical-align:middle; }\\n        .af-table input, .af-table select { height:32px; line-height:32px; padding:4px 8px; font-size:14px; border:1px solid #d7dbe0; border-radius:6px; background:#fff; }\\n        .af-table select { padding-right:28px; }\\n        .af-table .action .ph-btn { height:32px; line-height:30px; padding:0 14px; font-size:13px; margin-right:6px; }\\n        .af-table .action .ph-btn:last-child { margin-right:0; }\\n        .af-table .reports-select { height:32px !important; }\\n\\n        /* Prevent inputs from stretching row */\\n        .af-table input[type=number] { width:110px; }\\n        .af-table td:nth-child(3) input { min-width:180px; }\\n\\n        /* Changed row highlight: border only, no size change */\\n        .svc-row--changed { position:relative; background:transparent; box-shadow:0 0 0 2px #f9b334 inset; }\\n        .svc-row--changed::before { display:none !important; }\\n        .svc-row--changed input, .svc-row--changed select { background:#fff; }\\n\\n  /* Selected row highlight */\\n  .svc-row--selected { background: #fffbe6; }\\n  .svc-row--selected.svc-row--changed { box-shadow:0 0 0 2px #f59f00 inset; }\\n\\n        /* Smooth focus */\\n        .af-table input:focus, .af-table select:focus { outline:none; border-color:#f2a300; box-shadow:0 0 0 2px rgba(242,163,0,.2); }\\n\\n        /* Responsive tightening on narrow screens */\\n        @media (max-width: 1100px){\\n          .af-table th, .af-table td { padding:4px 6px; }\\n          .af-table .action .ph-btn { padding:0 10px; font-size:12px; }\\n        }\\n\\n        .af-table td:nth-child(2){ width:72px; }\\n\\n        .reports-select.svc-status-active { background:#e6f7ec; color:#086637; border-color:#bfe6ce; }\\n        .reports-select.svc-status-paused { background:#ffe8e6; color:#b42318; border-color:#f5b5ae; }\\n        .reports-select.svc-status-active:focus { box-shadow:0 0 0 2px rgba(8,102,55,.25); }\\n        .reports-select.svc-status-paused:focus { box-shadow:0 0 0 2px rgba(180,35,24,.25); }\\n      \"})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","authHeaders","getUserRole","jsx","_jsx","jsxs","_jsxs","AdminServices","isAdminOrStaff","includes","isAdmin","q","setQ","statusFilter","setStatusFilter","hotelFilter","setHotelFilter","items","setItems","loading","setLoading","error","setError","createOpen","setCreateOpen","newRow","setNewRow","name","description","price","status","hotelId","icon","creating","setCreating","hotels","setHotels","debounceRef","rootRef","fileInputRef","pendingIconForId","current","requestAnimationFrame","classList","add","load","_opts$q","_opts$status","_opts$hotel","opts","arguments","length","undefined","qq","ss","hf","hotel","url","URL","window","location","origin","searchParams","set","res","fetch","toString","headers","cache","ok","Error","j","json","normalizeStatus","val","v","String","trim","toLowerCase","list","Array","isArray","map","r","_objectSpread","Status","e","message","clearTimeout","setTimeout","then","catch","del","it","confirm","concat","Id","method","alert","create","payload","Number","body","JSON","stringify","drafts","setDrafts","selectedId","setSelectedId","prev","next","forEach","Name","Description","Price","HotelId","Icon","Object","keys","id","find","updateDraft","field","value","d","rowChangedPayload","original","dr","saveRow","setAvailability","nextStatus","originalStatus","s","rowChanged","triggerIconUpload","serviceId","click","onIconFile","f","target","files","test","type","size","form","FormData","append","path","sid","err","style","padding","children","ref","className","textAlign","marginTop","marginBottom","width","placeholder","onChange","minWidth","height","h","onClick","color","colSpan","idx","statusClass","onFocus","display","flexDirection","alignItems","gap","src","alt","objectFit","borderRadius","border","background","cursor","justifyContent","title","fontSize","ht","whiteSpace","disabled","onMouseDown","currentTarget","stopPropagation","maxWidth","gridTemplateColumns","gridColumn","rows","accept"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/AdminServices.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport './HomePage.css';\r\nimport { authHeaders, getUserRole } from './auth';\r\n\r\nexport default function AdminServices(){\r\n  const isAdminOrStaff = ['Admin','Staff'].includes(getUserRole());\r\n  const isAdmin = getUserRole()==='Admin';\r\n  const [q,setQ] = useState('');\r\n  const [statusFilter,setStatusFilter] = useState('all');\r\n  const [hotelFilter,setHotelFilter] = useState('all');\r\n  const [items,setItems] = useState([]);\r\n  const [loading,setLoading] = useState(false);\r\n  const [error,setError] = useState('');\r\n  const [createOpen,setCreateOpen] = useState(false);\r\n  const [newRow,setNewRow] = useState({ name:'', description:'', price:'', status:'Active', hotelId:'', icon:'' });\r\n  const [creating,setCreating] = useState(false);\r\n  const [hotels,setHotels] = useState([]); // <-- added hotels state\r\n  const debounceRef = useRef(null);\r\n  const rootRef = useRef(null);\r\n  // Refs for icon upload handling\r\n  const fileInputRef = useRef(null);\r\n  // When null => uploading for create-new modal, else holds service Id for row update\r\n  const pendingIconForId = useRef(null);\r\n  useEffect(()=>{ if(rootRef.current){ requestAnimationFrame(()=> rootRef.current.classList.add('is-mounted')); } },[]);\r\n\r\n  const load = async (opts={}) => {\r\n    if(!isAdminOrStaff) return;\r\n    const qq = opts.q ?? q; const ss = opts.status ?? statusFilter; const hf = opts.hotel ?? hotelFilter;\r\n    setLoading(true); setError('');\r\n    try {\r\n      const url = new URL('/api/admin/services', window.location.origin);\r\n      if(qq) url.searchParams.set('q', qq);\r\n      if(ss && ss!=='all') url.searchParams.set('status', ss==='active' ? 'Active' : 'Paused');\r\n      if(hf && hf!=='all') url.searchParams.set('hotelId', hf);\r\n      const res = await fetch(url.toString(), { headers: authHeaders(), cache:'no-store' });\r\n      if(!res.ok) throw new Error('Không tải được dịch vụ');\r\n      const j = await res.json();\r\n      const normalizeStatus = (val) => {\r\n        const v = String(val||'').trim().toLowerCase();\r\n        if(['active','hoạt động','hoat dong','on','enabled','1','true'].includes(v)) return 'Active';\r\n        if(['paused','tạm dừng','tam dung','off','disabled','0','false'].includes(v)) return 'Paused';\r\n        // Default fallback\r\n        return 'Active';\r\n      };\r\n      const list = Array.isArray(j.items) ? j.items.map(r => ({ ...r, Status: normalizeStatus(r.Status) })) : [];\r\n      setItems(list);\r\n    } catch(e){ setError(e.message || 'Lỗi'); setItems([]); } finally { setLoading(false); }\r\n  };\r\n  useEffect(()=>{ if(isAdminOrStaff) load({ q:'', status:'all' }); },[]);\r\n  useEffect(()=>{ if(!isAdminOrStaff) return; if(debounceRef.current) clearTimeout(debounceRef.current); debounceRef.current = setTimeout(()=> load({}), 300); return ()=> debounceRef.current && clearTimeout(debounceRef.current); },[q,statusFilter,hotelFilter]);\r\n  useEffect(()=>{ if(isAdminOrStaff){ fetch('/api/admin/hotels', { headers: authHeaders() }).then(r=> r.ok? r.json(): {items:[]}).then(j=> setHotels(Array.isArray(j.items)? j.items: [])).catch(()=> setHotels([])); } }, [isAdminOrStaff]);\r\n\r\n  // (legacy per-row edit handlers removed; saving handled by saveRow with drafts map)\r\n\r\n  const del = async (it)=>{\r\n    if(!window.confirm('Xóa dịch vụ này?')) return;\r\n    try { const res = await fetch(`/api/admin/services/${it.Id}`, { method:'DELETE', headers: authHeaders() }); if(!res.ok) throw new Error('Xóa thất bại'); await load({}); } catch(e){ alert(e.message || 'Lỗi xóa'); }\r\n  };\r\n\r\n  const create = async ()=>{\r\n    if(!newRow.name.trim()) { alert('Nhập tên dịch vụ'); return; }\r\n    if(!newRow.hotelId){ alert('Chọn khách sạn'); return; }\r\n    setCreating(true);\r\n    try {\r\n      const payload = { name:newRow.name, description:newRow.description, price: newRow.price? Number(newRow.price):0, status: newRow.status, hotelId: newRow.hotelId, icon: newRow.icon || null };\r\n      const res = await fetch('/api/admin/services', { method:'POST', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if(!res.ok) throw new Error('Tạo thất bại');\r\n      setNewRow({ name:'', description:'', price:'', status:'Active', hotelId:'', icon:'' }); setCreateOpen(false); await load({});\r\n    } catch(e){ alert(e.message || 'Lỗi'); } finally { setCreating(false); }\r\n  };\r\n\r\n  const [drafts,setDrafts] = useState({});\r\n  const [selectedId,setSelectedId] = useState(null);\r\n\r\n  // Initialize / sync drafts when items change (only add missing ids, keep user edits)\r\n  useEffect(()=>{\r\n    setDrafts(prev => {\r\n      const next = { ...prev };\r\n      items.forEach(it => {\r\n        if(!next[it.Id]) next[it.Id] = { Name: it.Name||'', Description: it.Description||'', Price: it.Price||0, Status: it.Status||'Active', HotelId: it.HotelId || '', Icon: it.Icon || '' };\r\n        else {\r\n          if(next[it.Id].HotelId===undefined) next[it.Id].HotelId = it.HotelId || '';\r\n          if(next[it.Id].Icon===undefined) next[it.Id].Icon = it.Icon || '';\r\n          // Sync status to backend value to avoid stale draft showing 'Hoạt động' while item is paused (or vice versa)\r\n          // We intentionally overwrite to keep UI consistent after background reloads.\r\n          next[it.Id].Status = it.Status || 'Active';\r\n        }\r\n      });\r\n      Object.keys(next).forEach(id => { if(!items.find(it => String(it.Id)===String(id))) delete next[id]; });\r\n      return next;\r\n    });\r\n  }, [items]);\r\n\r\n  const updateDraft = (id, field, value) => setDrafts(d => ({ ...d, [id]: { ...(d[id]||{}), [field]: value } }));\r\n\r\n  const rowChangedPayload = (id, original) => {\r\n    const dr = drafts[id]; if(!dr) return null;\r\n    const payload = {};\r\n    if (dr.Name !== original.Name) payload.name = dr.Name;\r\n    if (dr.Description !== original.Description) payload.description = dr.Description;\r\n    if (String(dr.Price) !== String(original.Price)) payload.price = dr.Price;\r\n    if (dr.Status !== original.Status) payload.status = dr.Status;\r\n    if (String(dr.HotelId||'') !== String(original.HotelId||'')) { payload.hotelId = dr.HotelId || null; }\r\n    if ((dr.Icon||'') !== (original.Icon||'')) payload.icon = dr.Icon || null;\r\n    return Object.keys(payload).length ? payload : null;\r\n  };\r\n\r\n  const saveRow = async (it) => {\r\n    const payload = rowChangedPayload(it.Id, it);\r\n    if(!payload){ alert('Không có thay đổi.'); return; }\r\n    try {\r\n      const res = await fetch(`/api/admin/services/${it.Id}`, { method:'PUT', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if(!res.ok) throw new Error('Lưu thất bại');\r\n      await load({});\r\n    } catch(e){ alert(e.message || 'Lỗi lưu'); }\r\n  };\r\n\r\n  const setAvailability = async (it, nextStatus) => {\r\n    const hotelId = (drafts[it.Id] && drafts[it.Id].HotelId) || it.HotelId || '';\r\n    if(!hotelId){ alert('Thiếu khách sạn cho dịch vụ'); return; }\r\n    const originalStatus = it.Status;\r\n    // Optimistic UI update\r\n    setItems(prev => prev.map(s => s.Id===it.Id ? { ...s, Status: nextStatus } : s));\r\n    setDrafts(d => ({ ...d, [it.Id]: { ...(d[it.Id]||{}), Status: nextStatus } }));\r\n    try {\r\n      const payload = { status: nextStatus, hotelId };\r\n      const res = await fetch(`/api/admin/services/${it.Id}`, { method:'PUT', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if(!res.ok) throw new Error('Cập nhật trạng thái thất bại');\r\n      // Optionally refresh in background to ensure consistency\r\n      load({});\r\n    } catch(e){\r\n      // Revert on failure\r\n      setItems(prev => prev.map(s => s.Id===it.Id ? { ...s, Status: originalStatus } : s));\r\n      setDrafts(d => ({ ...d, [it.Id]: { ...(d[it.Id]||{}), Status: originalStatus } }));\r\n      alert(e.message || 'Lỗi');\r\n    }\r\n  };\r\n\r\n  const rowChanged = (it) => {\r\n    const dr = drafts[it.Id]; if(!dr) return false;\r\n    return dr.Name!==it.Name || dr.Description!==it.Description || String(dr.Price)!==String(it.Price) || dr.Status!==it.Status || String(dr.HotelId||'') !== String(it.HotelId||'') || (dr.Icon||'') !== (it.Icon||'');\r\n  };\r\n\r\n  // Trigger file chooser for an existing row (serviceId) or for create modal (null)\r\n  const triggerIconUpload = (serviceId=null) => {\r\n    pendingIconForId.current = serviceId; // null => new service modal\r\n    if(fileInputRef.current){\r\n      fileInputRef.current.value = '';\r\n      fileInputRef.current.click();\r\n    }\r\n  };\r\n\r\n  const onIconFile = async (e) => {\r\n    const f = e.target.files && e.target.files[0];\r\n    if(!f) return;\r\n    // Basic client-side validation (optional)\r\n    if(!/^image\\//.test(f.type)) { alert('Vui lòng chọn file hình ảnh'); return; }\r\n    if(f.size > 2*1024*1024) { alert('Ảnh quá lớn (tối đa 2MB)'); return; }\r\n    const form = new FormData(); form.append('file', f);\r\n    try {\r\n      const res = await fetch('/api/admin/services/upload-icon', { method:'POST', headers: authHeaders(), body: form });\r\n      if(!res.ok) throw new Error('Upload thất bại');\r\n      const j = await res.json();\r\n      const path = j.path;\r\n      if(pendingIconForId.current){\r\n        const sid = pendingIconForId.current;\r\n        setDrafts(d => ({ ...d, [sid]: { ...(d[sid]||{}), Icon: path } }));\r\n        pendingIconForId.current = null;\r\n      } else {\r\n        // New service modal\r\n        setNewRow(r => ({ ...r, icon: path }));\r\n      }\r\n    } catch(err){\r\n      alert(err.message || 'Lỗi upload icon');\r\n    }\r\n  };\r\n\r\n  if(!isAdminOrStaff) return <div style={{ padding:16 }}>Chức năng dành cho quản trị / nhân viên.</div>;\r\n\r\n  return (\r\n    <div ref={rootRef} className=\"af-container amenities-anim-root\" style={{ padding:12 }}>\r\n      <h2 className=\"home-rooms-title\" style={{ textAlign:'left', marginTop:0 }}>Quản lý dịch vụ khách sạn</h2>\r\n      <div className=\"reports-toolbar af-toolbar\" style={{ marginBottom:10 }}>\r\n        <div className=\"reports-field af-field-grow\">\r\n          <input className=\"reports-input\" style={{ width:'100%' }} placeholder=\"Tìm kiếm dịch vụ...\" value={q} onChange={e=>setQ(e.target.value)} />\r\n        </div>\r\n        <div className=\"reports-field\" style={{ minWidth:200 }}>\r\n          <select className=\"reports-select\" value={statusFilter} onChange={e=>setStatusFilter(e.target.value)} style={{ height:38 }}>\r\n            <option value=\"all\">Tất cả trạng thái</option>\r\n            <option value=\"active\">Hoạt động</option>\r\n            <option value=\"paused\">Tạm dừng</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"reports-field\" style={{ minWidth:220 }}>\r\n          <select className=\"reports-select\" value={hotelFilter} onChange={e=>setHotelFilter(e.target.value)} style={{ height:38 }}>\r\n            <option value=\"all\">Tất cả khách sạn</option>\r\n            {hotels.map(h=> <option key={h.id||h.Id} value={h.id||h.Id}>{h.name||h.Name}</option>)}\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <div style={{ marginBottom:8 }}>\r\n        {isAdmin && <button className=\"ph-btn\" onClick={()=> setCreateOpen(true)}>+ Thêm dịch vụ</button>}\r\n      </div>\r\n      {loading ? <div style={{ color:'#666' }}>Đang tải...</div> : error ? <div style={{ color:'#b42318' }}>{error}</div> : (\r\n        <table className=\"ph-table-el af-table\" style={{ width:'100%' }}>\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign:'center' }}>ID</th>\r\n              <th style={{ textAlign:'center' }}>Tên dịch vụ</th>\r\n              <th style={{ textAlign:'center' }}>Icon</th>\r\n              <th style={{ textAlign:'center' }}>Mô tả</th>\r\n              <th style={{ textAlign:'center' }}>Giá (VND)</th>\r\n              <th style={{ textAlign:'center' }}>Trạng thái</th>\r\n              <th style={{ textAlign:'center' }}>Khách sạn</th>\r\n              <th style={{ textAlign:'center' }}>Hành động</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {items.length===0 ? <tr><td colSpan={8} style={{ color:'#666', textAlign:'center' }}>Không có dữ liệu.</td></tr> : items.map((it,idx)=> {\r\n              const dr = drafts[it.Id] || { Name:'', Description:'', Price:0, Status:'Active' };\r\n              const statusClass = (dr.Status === 'Active') ? 'svc-status-active' : 'svc-status-paused';\r\n              return (\r\n                <tr key={it.Id} onClick={()=> setSelectedId(it.Id)} className={\"amenity-row\" + (rowChanged(it)? ' svc-row--changed':'') + (selectedId===it.Id ? ' svc-row--selected':'')} style={{ '--row-index': idx }}>\r\n                  <td className=\"ph-td\" style={{ textAlign:'left' }}>{it.Id}</td>\r\n                  <td className=\"ph-td\" style={{ textAlign:'left' }}><input value={(drafts[it.Id]||{}).Name || ''} onFocus={()=> setSelectedId(it.Id)} onChange={e=>updateDraft(it.Id,'Name', e.target.value)} /></td>\r\n                  <td className=\"ph-td\" style={{ textAlign:'left', width:120 }}>\r\n                    {(it.Icon || (drafts[it.Id]||{}).Icon) ? (\r\n                      <div style={{ display:'flex', flexDirection:'row', alignItems:'center', gap:8 }}>\r\n                        <img src={(drafts[it.Id]||{}).Icon || it.Icon} alt=\"icon\" style={{ width:44,height:44,objectFit:'cover', borderRadius:8, border:'1px solid #ddd', background:'#fafafa' }} />\r\n                        <button type=\"button\" onClick={()=> triggerIconUpload(it.Id)} style={{\r\n                          width:38, height:38, border:'1px solid #d0d5dd', background:'#fff', borderRadius:8, cursor:'pointer', display:'flex', alignItems:'center', justifyContent:'center', padding:0\r\n                        }} title=\"Thay icon\">\r\n                          <img src=\"/replace.png\" alt=\"Replace\" style={{ width:20,height:20, objectFit:'contain' }} />\r\n                        </button>\r\n                      </div>\r\n                    ) : (\r\n                      <button type=\"button\" className=\"ph-btn\" style={{ height:34, fontSize:12 }} onClick={()=> triggerIconUpload(it.Id)}>+ Icon</button>\r\n                    )}\r\n                  </td>\r\n                  <td className=\"ph-td\" style={{ textAlign:'left' }}><input value={(drafts[it.Id]||{}).Description || ''} onFocus={()=> setSelectedId(it.Id)} onChange={e=>updateDraft(it.Id,'Description', e.target.value)} /></td>\r\n                  <td className=\"ph-td\" style={{ textAlign:'left', minWidth:120 }}><input type=\"number\" value={(drafts[it.Id]||{}).Price} onFocus={()=> setSelectedId(it.Id)} onChange={e=>updateDraft(it.Id,'Price', e.target.value)} /></td>\r\n                  <td className=\"ph-td\" style={{ textAlign:'left' }}>\r\n                    <select value={(drafts[it.Id]||{}).Status} onFocus={()=> setSelectedId(it.Id)} onChange={e=>updateDraft(it.Id,'Status', e.target.value)} className={`reports-select ${statusClass}`} style={{ height:32 }}>\r\n                      <option value=\"Active\">Hoạt động</option>\r\n                      <option value=\"Paused\">Tạm dừng</option>\r\n                    </select>\r\n                  </td>\r\n                  <td className=\"ph-td\" style={{ textAlign:'left' }}>\r\n                    <select value={(drafts[it.Id]||{}).HotelId} onFocus={()=> setSelectedId(it.Id)} onChange={e=>updateDraft(it.Id,'HotelId', e.target.value)} className=\"reports-select\" style={{ height:32 }}>\r\n                      <option value=\"\">Chọn khách sạn</option>\r\n                      {hotels.map(ht=> <option key={ht.id || ht.Id} value={ht.id || ht.Id}>{ht.name || ht.Name}</option>)}\r\n                    </select>\r\n                  </td>\r\n                  <td className=\"ph-td action\" style={{ whiteSpace:'nowrap', textAlign:'left' }}>\r\n                    <button className=\"ph-btn ph-btn--success\" onClick={()=>saveRow(it)}>Sửa</button>\r\n                    {isAdmin && <button className=\"ph-btn ph-btn--danger\" onClick={()=>del(it)}>Xóa</button>}\r\n                    <button className=\"ph-btn ph-btn--warning\" disabled={!((drafts[it.Id]||{}).HotelId || it.HotelId)} onClick={()=> setAvailability(it, (it.Status)==='Active'? 'Paused':'Active')}>{(it.Status)==='Active'? 'Tạm dừng':'Kích hoạt'}</button>\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n\r\n      {createOpen && (\r\n        <div className=\"profile-overlay\" onMouseDown={e=>{ if(e.target===e.currentTarget) setCreateOpen(false); }}>\r\n          <div className=\"profile-modal\" onMouseDown={e=> e.stopPropagation()} style={{ width:640, maxWidth:'96%', background:'#fff', borderRadius:12, padding:16 }}>\r\n            <h3 style={{ marginTop:0, textAlign:'center' }}>Thêm dịch vụ</h3>\r\n            <div style={{ display:'grid', gridTemplateColumns:'1fr 1fr', gap:16 }}>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Tên dịch vụ\r\n                <input value={newRow.name} onChange={e=>setNewRow(r=>({...r, name:e.target.value }))} placeholder=\"Giặt ủi...\" />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Giá (VND)\r\n                <input type=\"number\" value={newRow.price} onChange={e=>setNewRow(r=>({...r, price:e.target.value }))} placeholder=\"100000\" />\r\n              </label>\r\n              <label style={{ gridColumn:'1 / span 2', display:'flex', flexDirection:'column', gap:4 }}>Mô tả\r\n                <textarea rows={3} value={newRow.description} onChange={e=>setNewRow(r=>({...r, description:e.target.value }))} placeholder=\"Mô tả ngắn\" />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Trạng thái\r\n                <select className=\"reports-select\" style={{ height:38 }} value={newRow.status} onChange={e=>setNewRow(r=>({...r, status:e.target.value }))}>\r\n                  <option value=\"Active\">Hoạt động</option>\r\n                  <option value=\"Paused\">Tạm dừng</option>\r\n                </select>\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Khách sạn\r\n                <select className=\"reports-select\" style={{ height:38 }} value={newRow.hotelId} onChange={e=>setNewRow(r=>({...r, hotelId:e.target.value }))}>\r\n                  <option value=\"\">Chọn khách sạn</option>\r\n                  {hotels.map(ht=> <option key={ht.id || ht.Id} value={ht.id || ht.Id}>{ht.name || ht.Name}</option>)}\r\n                </select>\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Icon\r\n                <div style={{ display:'flex', alignItems:'center', gap:12 }}>\r\n                  {newRow.icon ? (\r\n                    <img src={newRow.icon} alt=\"icon\" style={{ width:56,height:56,objectFit:'cover', border:'1px solid #ddd', borderRadius:10, background:'#fafafa' }} />\r\n                  ) : (\r\n                    <span style={{ fontSize:12, color:'#666' }}>Chưa chọn</span>\r\n                  )}\r\n                  <button type=\"button\" onClick={()=> { pendingIconForId.current=null; fileInputRef.current && fileInputRef.current.click(); }} style={{\r\n                    display:'flex', alignItems:'center', gap:6, background:'#fff', border:'1px solid #d0d5dd', borderRadius:8, padding:'6px 10px', cursor:'pointer'\r\n                  }}>\r\n                    <img src=\"/replace.png\" alt=\"Upload\" style={{ width:18, height:18 }} />\r\n                    <span style={{ fontSize:13 }}>Chọn / Thay</span>\r\n                  </button>\r\n                  {newRow.icon && <button type=\"button\" className=\"ph-btn ph-btn--danger\" onClick={()=> setNewRow(r=>({...r, icon:''}))}>Xóa</button>}\r\n                </div>\r\n              </label>\r\n            </div>\r\n            <div style={{ marginTop:16, display:'flex', gap:12, justifyContent:'center' }}>\r\n              <button className=\"ph-btn\" onClick={create} disabled={creating}>{creating? 'Đang tạo...':'Tạo'}</button>\r\n              <button className=\"ph-btn ph-btn--secondary\" onClick={()=>setCreateOpen(false)}>Hủy</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <input ref={fileInputRef} type=\"file\" accept=\"image/*\" style={{ display:'none' }} onChange={onIconFile} />\r\n      <style>{`\r\n        .amenities-anim-root { opacity:0; transform:translateY(12px); transition: opacity .5s ease, transform .55s cubic-bezier(.4,.2,.2,1); }\r\n        .amenities-anim-root.is-mounted { opacity:1; transform:translateY(0); }\r\n        .amenities-anim-root table.af-table { animation:tableFade .55s .12s both ease; }\r\n        @keyframes tableFade { from { opacity:0; transform:translateY(8px);} to { opacity:1; transform:translateY(0);} }\r\n\r\n        /* Compact, uniform sizing */\r\n        .af-table th, .af-table td { padding:6px 8px; vertical-align:middle; }\r\n        .af-table input, .af-table select { height:32px; line-height:32px; padding:4px 8px; font-size:14px; border:1px solid #d7dbe0; border-radius:6px; background:#fff; }\r\n        .af-table select { padding-right:28px; }\r\n        .af-table .action .ph-btn { height:32px; line-height:30px; padding:0 14px; font-size:13px; margin-right:6px; }\r\n        .af-table .action .ph-btn:last-child { margin-right:0; }\r\n        .af-table .reports-select { height:32px !important; }\r\n\r\n        /* Prevent inputs from stretching row */\r\n        .af-table input[type=number] { width:110px; }\r\n        .af-table td:nth-child(3) input { min-width:180px; }\r\n\r\n        /* Changed row highlight: border only, no size change */\r\n        .svc-row--changed { position:relative; background:transparent; box-shadow:0 0 0 2px #f9b334 inset; }\r\n        .svc-row--changed::before { display:none !important; }\r\n        .svc-row--changed input, .svc-row--changed select { background:#fff; }\r\n\r\n  /* Selected row highlight */\r\n  .svc-row--selected { background: #fffbe6; }\r\n  .svc-row--selected.svc-row--changed { box-shadow:0 0 0 2px #f59f00 inset; }\r\n\r\n        /* Smooth focus */\r\n        .af-table input:focus, .af-table select:focus { outline:none; border-color:#f2a300; box-shadow:0 0 0 2px rgba(242,163,0,.2); }\r\n\r\n        /* Responsive tightening on narrow screens */\r\n        @media (max-width: 1100px){\r\n          .af-table th, .af-table td { padding:4px 6px; }\r\n          .af-table .action .ph-btn { padding:0 10px; font-size:12px; }\r\n        }\r\n\r\n        .af-table td:nth-child(2){ width:72px; }\r\n\r\n        .reports-select.svc-status-active { background:#e6f7ec; color:#086637; border-color:#bfe6ce; }\r\n        .reports-select.svc-status-paused { background:#ffe8e6; color:#b42318; border-color:#f5b5ae; }\r\n        .reports-select.svc-status-active:focus { box-shadow:0 0 0 2px rgba(8,102,55,.25); }\r\n        .reports-select.svc-status-paused:focus { box-shadow:0 0 0 2px rgba(180,35,24,.25); }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"sHAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CAC1D,MAAO,gBAAgB,CACvB,OAASC,WAAW,CAAEC,WAAW,KAAQ,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAElD,cAAe,SAAS,CAAAC,aAAaA,CAAA,CAAE,CACrC,KAAM,CAAAC,cAAc,CAAG,CAAC,OAAO,CAAC,OAAO,CAAC,CAACC,QAAQ,CAACP,WAAW,CAAC,CAAC,CAAC,CAChE,KAAM,CAAAQ,OAAO,CAAGR,WAAW,CAAC,CAAC,GAAG,OAAO,CACvC,KAAM,CAACS,CAAC,CAACC,IAAI,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAC7B,KAAM,CAACa,YAAY,CAACC,eAAe,CAAC,CAAGd,QAAQ,CAAC,KAAK,CAAC,CACtD,KAAM,CAACe,WAAW,CAACC,cAAc,CAAC,CAAGhB,QAAQ,CAAC,KAAK,CAAC,CACpD,KAAM,CAACiB,KAAK,CAACC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,EAAE,CAAC,CACrC,KAAM,CAACmB,OAAO,CAACC,UAAU,CAAC,CAAGpB,QAAQ,CAAC,KAAK,CAAC,CAC5C,KAAM,CAACqB,KAAK,CAACC,QAAQ,CAAC,CAAGtB,QAAQ,CAAC,EAAE,CAAC,CACrC,KAAM,CAACuB,UAAU,CAACC,aAAa,CAAC,CAAGxB,QAAQ,CAAC,KAAK,CAAC,CAClD,KAAM,CAACyB,MAAM,CAACC,SAAS,CAAC,CAAG1B,QAAQ,CAAC,CAAE2B,IAAI,CAAC,EAAE,CAAEC,WAAW,CAAC,EAAE,CAAEC,KAAK,CAAC,EAAE,CAAEC,MAAM,CAAC,QAAQ,CAAEC,OAAO,CAAC,EAAE,CAAEC,IAAI,CAAC,EAAG,CAAC,CAAC,CAChH,KAAM,CAACC,QAAQ,CAACC,WAAW,CAAC,CAAGlC,QAAQ,CAAC,KAAK,CAAC,CAC9C,KAAM,CAACmC,MAAM,CAACC,SAAS,CAAC,CAAGpC,QAAQ,CAAC,EAAE,CAAC,CAAE;AACzC,KAAM,CAAAqC,WAAW,CAAGtC,MAAM,CAAC,IAAI,CAAC,CAChC,KAAM,CAAAuC,OAAO,CAAGvC,MAAM,CAAC,IAAI,CAAC,CAC5B;AACA,KAAM,CAAAwC,YAAY,CAAGxC,MAAM,CAAC,IAAI,CAAC,CACjC;AACA,KAAM,CAAAyC,gBAAgB,CAAGzC,MAAM,CAAC,IAAI,CAAC,CACrCD,SAAS,CAAC,IAAI,CAAE,GAAGwC,OAAO,CAACG,OAAO,CAAC,CAAEC,qBAAqB,CAAC,IAAKJ,OAAO,CAACG,OAAO,CAACE,SAAS,CAACC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAE,CAAE,CAAC,CAAC,EAAE,CAAC,CAErH,KAAM,CAAAC,IAAI,CAAG,cAAAA,CAAA,CAAmB,KAAAC,OAAA,CAAAC,YAAA,CAAAC,WAAA,IAAZ,CAAAC,IAAI,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAC,CAAC,CAAC,CACzB,GAAG,CAAC1C,cAAc,CAAE,OACpB,KAAM,CAAA6C,EAAE,EAAAP,OAAA,CAAGG,IAAI,CAACtC,CAAC,UAAAmC,OAAA,UAAAA,OAAA,CAAInC,CAAC,CAAE,KAAM,CAAA2C,EAAE,EAAAP,YAAA,CAAGE,IAAI,CAACnB,MAAM,UAAAiB,YAAA,UAAAA,YAAA,CAAIlC,YAAY,CAAE,KAAM,CAAA0C,EAAE,EAAAP,WAAA,CAAGC,IAAI,CAACO,KAAK,UAAAR,WAAA,UAAAA,WAAA,CAAIjC,WAAW,CACpGK,UAAU,CAAC,IAAI,CAAC,CAAEE,QAAQ,CAAC,EAAE,CAAC,CAC9B,GAAI,CACF,KAAM,CAAAmC,GAAG,CAAG,GAAI,CAAAC,GAAG,CAAC,qBAAqB,CAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAClE,GAAGR,EAAE,CAAEI,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,GAAG,CAAEV,EAAE,CAAC,CACpC,GAAGC,EAAE,EAAIA,EAAE,GAAG,KAAK,CAAEG,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,QAAQ,CAAET,EAAE,GAAG,QAAQ,CAAG,QAAQ,CAAG,QAAQ,CAAC,CACxF,GAAGC,EAAE,EAAIA,EAAE,GAAG,KAAK,CAAEE,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,SAAS,CAAER,EAAE,CAAC,CACxD,KAAM,CAAAS,GAAG,CAAG,KAAM,CAAAC,KAAK,CAACR,GAAG,CAACS,QAAQ,CAAC,CAAC,CAAE,CAAEC,OAAO,CAAElE,WAAW,CAAC,CAAC,CAAEmE,KAAK,CAAC,UAAW,CAAC,CAAC,CACrF,GAAG,CAACJ,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,wBAAwB,CAAC,CACrD,KAAM,CAAAC,CAAC,CAAG,KAAM,CAAAP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC1B,KAAM,CAAAC,eAAe,CAAIC,GAAG,EAAK,CAC/B,KAAM,CAAAC,CAAC,CAAGC,MAAM,CAACF,GAAG,EAAE,EAAE,CAAC,CAACG,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAC9C,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAACrE,QAAQ,CAACkE,CAAC,CAAC,CAAE,MAAO,QAAQ,CAC5F,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,OAAO,CAAC,CAAClE,QAAQ,CAACkE,CAAC,CAAC,CAAE,MAAO,QAAQ,CAC7F;AACA,MAAO,QAAQ,CACjB,CAAC,CACD,KAAM,CAAAI,IAAI,CAAGC,KAAK,CAACC,OAAO,CAACV,CAAC,CAACtD,KAAK,CAAC,CAAGsD,CAAC,CAACtD,KAAK,CAACiE,GAAG,CAACC,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAUD,CAAC,MAAEE,MAAM,CAAEZ,eAAe,CAACU,CAAC,CAACE,MAAM,CAAC,EAAG,CAAC,CAAG,EAAE,CAC1GnE,QAAQ,CAAC6D,IAAI,CAAC,CAChB,CAAE,MAAMO,CAAC,CAAC,CAAEhE,QAAQ,CAACgE,CAAC,CAACC,OAAO,EAAI,KAAK,CAAC,CAAErE,QAAQ,CAAC,EAAE,CAAC,CAAE,CAAC,OAAS,CAAEE,UAAU,CAAC,KAAK,CAAC,CAAE,CACzF,CAAC,CACDtB,SAAS,CAAC,IAAI,CAAE,GAAGU,cAAc,CAAEqC,IAAI,CAAC,CAAElC,CAAC,CAAC,EAAE,CAAEmB,MAAM,CAAC,KAAM,CAAC,CAAC,CAAE,CAAC,CAAC,EAAE,CAAC,CACtEhC,SAAS,CAAC,IAAI,CAAE,GAAG,CAACU,cAAc,CAAE,OAAQ,GAAG6B,WAAW,CAACI,OAAO,CAAE+C,YAAY,CAACnD,WAAW,CAACI,OAAO,CAAC,CAAEJ,WAAW,CAACI,OAAO,CAAGgD,UAAU,CAAC,IAAK5C,IAAI,CAAC,CAAC,CAAC,CAAC,CAAE,GAAG,CAAC,CAAE,MAAO,IAAKR,WAAW,CAACI,OAAO,EAAI+C,YAAY,CAACnD,WAAW,CAACI,OAAO,CAAC,CAAE,CAAC,CAAC,CAAC9B,CAAC,CAACE,YAAY,CAACE,WAAW,CAAC,CAAC,CAClQjB,SAAS,CAAC,IAAI,CAAE,GAAGU,cAAc,CAAC,CAAEyD,KAAK,CAAC,mBAAmB,CAAE,CAAEE,OAAO,CAAElE,WAAW,CAAC,CAAE,CAAC,CAAC,CAACyF,IAAI,CAACP,CAAC,EAAGA,CAAC,CAACd,EAAE,CAAEc,CAAC,CAACX,IAAI,CAAC,CAAC,CAAE,CAACvD,KAAK,CAAC,EAAE,CAAC,CAAC,CAACyE,IAAI,CAACnB,CAAC,EAAGnC,SAAS,CAAC4C,KAAK,CAACC,OAAO,CAACV,CAAC,CAACtD,KAAK,CAAC,CAAEsD,CAAC,CAACtD,KAAK,CAAE,EAAE,CAAC,CAAC,CAAC0E,KAAK,CAAC,IAAKvD,SAAS,CAAC,EAAE,CAAC,CAAC,CAAE,CAAE,CAAC,CAAE,CAAC5B,cAAc,CAAC,CAAC,CAE1O;AAEA,KAAM,CAAAoF,GAAG,CAAG,KAAO,CAAAC,EAAE,EAAG,CACtB,GAAG,CAAClC,MAAM,CAACmC,OAAO,CAAC,kBAAkB,CAAC,CAAE,OACxC,GAAI,CAAE,KAAM,CAAA9B,GAAG,CAAG,KAAM,CAAAC,KAAK,wBAAA8B,MAAA,CAAwBF,EAAE,CAACG,EAAE,EAAI,CAAEC,MAAM,CAAC,QAAQ,CAAE9B,OAAO,CAAElE,WAAW,CAAC,CAAE,CAAC,CAAC,CAAE,GAAG,CAAC+D,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,cAAc,CAAC,CAAE,KAAM,CAAAzB,IAAI,CAAC,CAAC,CAAC,CAAC,CAAE,CAAE,MAAMyC,CAAC,CAAC,CAAEY,KAAK,CAACZ,CAAC,CAACC,OAAO,EAAI,SAAS,CAAC,CAAE,CACtN,CAAC,CAED,KAAM,CAAAY,MAAM,CAAG,KAAAA,CAAA,GAAU,CACvB,GAAG,CAAC1E,MAAM,CAACE,IAAI,CAACkD,IAAI,CAAC,CAAC,CAAE,CAAEqB,KAAK,CAAC,kBAAkB,CAAC,CAAE,OAAQ,CAC7D,GAAG,CAACzE,MAAM,CAACM,OAAO,CAAC,CAAEmE,KAAK,CAAC,gBAAgB,CAAC,CAAE,OAAQ,CACtDhE,WAAW,CAAC,IAAI,CAAC,CACjB,GAAI,CACF,KAAM,CAAAkE,OAAO,CAAG,CAAEzE,IAAI,CAACF,MAAM,CAACE,IAAI,CAAEC,WAAW,CAACH,MAAM,CAACG,WAAW,CAAEC,KAAK,CAAEJ,MAAM,CAACI,KAAK,CAAEwE,MAAM,CAAC5E,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAAEC,MAAM,CAAEL,MAAM,CAACK,MAAM,CAAEC,OAAO,CAAEN,MAAM,CAACM,OAAO,CAAEC,IAAI,CAAEP,MAAM,CAACO,IAAI,EAAI,IAAK,CAAC,CAC5L,KAAM,CAAAgC,GAAG,CAAG,KAAM,CAAAC,KAAK,CAAC,qBAAqB,CAAE,CAAEgC,MAAM,CAAC,MAAM,CAAE9B,OAAO,CAAAiB,aAAA,EAAG,cAAc,CAAC,kBAAkB,EAAKnF,WAAW,CAAC,CAAC,CAAE,CAAEqG,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACJ,OAAO,CAAE,CAAC,CAAC,CACjK,GAAG,CAACpC,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,cAAc,CAAC,CAC3C5C,SAAS,CAAC,CAAEC,IAAI,CAAC,EAAE,CAAEC,WAAW,CAAC,EAAE,CAAEC,KAAK,CAAC,EAAE,CAAEC,MAAM,CAAC,QAAQ,CAAEC,OAAO,CAAC,EAAE,CAAEC,IAAI,CAAC,EAAG,CAAC,CAAC,CAAER,aAAa,CAAC,KAAK,CAAC,CAAE,KAAM,CAAAqB,IAAI,CAAC,CAAC,CAAC,CAAC,CAC9H,CAAE,MAAMyC,CAAC,CAAC,CAAEY,KAAK,CAACZ,CAAC,CAACC,OAAO,EAAI,KAAK,CAAC,CAAE,CAAC,OAAS,CAAErD,WAAW,CAAC,KAAK,CAAC,CAAE,CACzE,CAAC,CAED,KAAM,CAACuE,MAAM,CAACC,SAAS,CAAC,CAAG1G,QAAQ,CAAC,CAAC,CAAC,CAAC,CACvC,KAAM,CAAC2G,UAAU,CAACC,aAAa,CAAC,CAAG5G,QAAQ,CAAC,IAAI,CAAC,CAEjD;AACAF,SAAS,CAAC,IAAI,CACZ4G,SAAS,CAACG,IAAI,EAAI,CAChB,KAAM,CAAAC,IAAI,CAAA1B,aAAA,IAAQyB,IAAI,CAAE,CACxB5F,KAAK,CAAC8F,OAAO,CAAClB,EAAE,EAAI,CAClB,GAAG,CAACiB,IAAI,CAACjB,EAAE,CAACG,EAAE,CAAC,CAAEc,IAAI,CAACjB,EAAE,CAACG,EAAE,CAAC,CAAG,CAAEgB,IAAI,CAAEnB,EAAE,CAACmB,IAAI,EAAE,EAAE,CAAEC,WAAW,CAAEpB,EAAE,CAACoB,WAAW,EAAE,EAAE,CAAEC,KAAK,CAAErB,EAAE,CAACqB,KAAK,EAAE,CAAC,CAAE7B,MAAM,CAAEQ,EAAE,CAACR,MAAM,EAAE,QAAQ,CAAE8B,OAAO,CAAEtB,EAAE,CAACsB,OAAO,EAAI,EAAE,CAAEC,IAAI,CAAEvB,EAAE,CAACuB,IAAI,EAAI,EAAG,CAAC,CAAC,IAClL,CACH,GAAGN,IAAI,CAACjB,EAAE,CAACG,EAAE,CAAC,CAACmB,OAAO,GAAG/D,SAAS,CAAE0D,IAAI,CAACjB,EAAE,CAACG,EAAE,CAAC,CAACmB,OAAO,CAAGtB,EAAE,CAACsB,OAAO,EAAI,EAAE,CAC1E,GAAGL,IAAI,CAACjB,EAAE,CAACG,EAAE,CAAC,CAACoB,IAAI,GAAGhE,SAAS,CAAE0D,IAAI,CAACjB,EAAE,CAACG,EAAE,CAAC,CAACoB,IAAI,CAAGvB,EAAE,CAACuB,IAAI,EAAI,EAAE,CACjE;AACA;AACAN,IAAI,CAACjB,EAAE,CAACG,EAAE,CAAC,CAACX,MAAM,CAAGQ,EAAE,CAACR,MAAM,EAAI,QAAQ,CAC5C,CACF,CAAC,CAAC,CACFgC,MAAM,CAACC,IAAI,CAACR,IAAI,CAAC,CAACC,OAAO,CAACQ,EAAE,EAAI,CAAE,GAAG,CAACtG,KAAK,CAACuG,IAAI,CAAC3B,EAAE,EAAIjB,MAAM,CAACiB,EAAE,CAACG,EAAE,CAAC,GAAGpB,MAAM,CAAC2C,EAAE,CAAC,CAAC,CAAE,MAAO,CAAAT,IAAI,CAACS,EAAE,CAAC,CAAE,CAAC,CAAC,CACvG,MAAO,CAAAT,IAAI,CACb,CAAC,CAAC,CACJ,CAAC,CAAE,CAAC7F,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAwG,WAAW,CAAGA,CAACF,EAAE,CAAEG,KAAK,CAAEC,KAAK,GAAKjB,SAAS,CAACkB,CAAC,EAAAxC,aAAA,CAAAA,aAAA,IAAUwC,CAAC,MAAE,CAACL,EAAE,EAAAnC,aAAA,CAAAA,aAAA,IAASwC,CAAC,CAACL,EAAE,CAAC,EAAE,CAAC,CAAC,MAAG,CAACG,KAAK,EAAGC,KAAK,EAAE,EAAG,CAAC,CAE9G,KAAM,CAAAE,iBAAiB,CAAGA,CAACN,EAAE,CAAEO,QAAQ,GAAK,CAC1C,KAAM,CAAAC,EAAE,CAAGtB,MAAM,CAACc,EAAE,CAAC,CAAE,GAAG,CAACQ,EAAE,CAAE,MAAO,KAAI,CAC1C,KAAM,CAAA3B,OAAO,CAAG,CAAC,CAAC,CAClB,GAAI2B,EAAE,CAACf,IAAI,GAAKc,QAAQ,CAACd,IAAI,CAAEZ,OAAO,CAACzE,IAAI,CAAGoG,EAAE,CAACf,IAAI,CACrD,GAAIe,EAAE,CAACd,WAAW,GAAKa,QAAQ,CAACb,WAAW,CAAEb,OAAO,CAACxE,WAAW,CAAGmG,EAAE,CAACd,WAAW,CACjF,GAAIrC,MAAM,CAACmD,EAAE,CAACb,KAAK,CAAC,GAAKtC,MAAM,CAACkD,QAAQ,CAACZ,KAAK,CAAC,CAAEd,OAAO,CAACvE,KAAK,CAAGkG,EAAE,CAACb,KAAK,CACzE,GAAIa,EAAE,CAAC1C,MAAM,GAAKyC,QAAQ,CAACzC,MAAM,CAAEe,OAAO,CAACtE,MAAM,CAAGiG,EAAE,CAAC1C,MAAM,CAC7D,GAAIT,MAAM,CAACmD,EAAE,CAACZ,OAAO,EAAE,EAAE,CAAC,GAAKvC,MAAM,CAACkD,QAAQ,CAACX,OAAO,EAAE,EAAE,CAAC,CAAE,CAAEf,OAAO,CAACrE,OAAO,CAAGgG,EAAE,CAACZ,OAAO,EAAI,IAAI,CAAE,CACrG,GAAI,CAACY,EAAE,CAACX,IAAI,EAAE,EAAE,KAAOU,QAAQ,CAACV,IAAI,EAAE,EAAE,CAAC,CAAEhB,OAAO,CAACpE,IAAI,CAAG+F,EAAE,CAACX,IAAI,EAAI,IAAI,CACzE,MAAO,CAAAC,MAAM,CAACC,IAAI,CAAClB,OAAO,CAAC,CAACjD,MAAM,CAAGiD,OAAO,CAAG,IAAI,CACrD,CAAC,CAED,KAAM,CAAA4B,OAAO,CAAG,KAAO,CAAAnC,EAAE,EAAK,CAC5B,KAAM,CAAAO,OAAO,CAAGyB,iBAAiB,CAAChC,EAAE,CAACG,EAAE,CAAEH,EAAE,CAAC,CAC5C,GAAG,CAACO,OAAO,CAAC,CAAEF,KAAK,CAAC,oBAAoB,CAAC,CAAE,OAAQ,CACnD,GAAI,CACF,KAAM,CAAAlC,GAAG,CAAG,KAAM,CAAAC,KAAK,wBAAA8B,MAAA,CAAwBF,EAAE,CAACG,EAAE,EAAI,CAAEC,MAAM,CAAC,KAAK,CAAE9B,OAAO,CAAAiB,aAAA,EAAG,cAAc,CAAC,kBAAkB,EAAKnF,WAAW,CAAC,CAAC,CAAE,CAAEqG,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACJ,OAAO,CAAE,CAAC,CAAC,CACzK,GAAG,CAACpC,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,cAAc,CAAC,CAC3C,KAAM,CAAAzB,IAAI,CAAC,CAAC,CAAC,CAAC,CAChB,CAAE,MAAMyC,CAAC,CAAC,CAAEY,KAAK,CAACZ,CAAC,CAACC,OAAO,EAAI,SAAS,CAAC,CAAE,CAC7C,CAAC,CAED,KAAM,CAAA0C,eAAe,CAAG,KAAAA,CAAOpC,EAAE,CAAEqC,UAAU,GAAK,CAChD,KAAM,CAAAnG,OAAO,CAAI0E,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAIS,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,CAACmB,OAAO,EAAKtB,EAAE,CAACsB,OAAO,EAAI,EAAE,CAC5E,GAAG,CAACpF,OAAO,CAAC,CAAEmE,KAAK,CAAC,6BAA6B,CAAC,CAAE,OAAQ,CAC5D,KAAM,CAAAiC,cAAc,CAAGtC,EAAE,CAACR,MAAM,CAChC;AACAnE,QAAQ,CAAC2F,IAAI,EAAIA,IAAI,CAAC3B,GAAG,CAACkD,CAAC,EAAIA,CAAC,CAACpC,EAAE,GAAGH,EAAE,CAACG,EAAE,CAAAZ,aAAA,CAAAA,aAAA,IAAQgD,CAAC,MAAE/C,MAAM,CAAE6C,UAAU,GAAKE,CAAC,CAAC,CAAC,CAChF1B,SAAS,CAACkB,CAAC,EAAAxC,aAAA,CAAAA,aAAA,IAAUwC,CAAC,MAAE,CAAC/B,EAAE,CAACG,EAAE,EAAAZ,aAAA,CAAAA,aAAA,IAASwC,CAAC,CAAC/B,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,MAAGX,MAAM,CAAE6C,UAAU,EAAE,EAAG,CAAC,CAC9E,GAAI,CACF,KAAM,CAAA9B,OAAO,CAAG,CAAEtE,MAAM,CAAEoG,UAAU,CAAEnG,OAAQ,CAAC,CAC/C,KAAM,CAAAiC,GAAG,CAAG,KAAM,CAAAC,KAAK,wBAAA8B,MAAA,CAAwBF,EAAE,CAACG,EAAE,EAAI,CAAEC,MAAM,CAAC,KAAK,CAAE9B,OAAO,CAAAiB,aAAA,EAAG,cAAc,CAAC,kBAAkB,EAAKnF,WAAW,CAAC,CAAC,CAAE,CAAEqG,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACJ,OAAO,CAAE,CAAC,CAAC,CACzK,GAAG,CAACpC,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,8BAA8B,CAAC,CAC3D;AACAzB,IAAI,CAAC,CAAC,CAAC,CAAC,CACV,CAAE,MAAMyC,CAAC,CAAC,CACR;AACApE,QAAQ,CAAC2F,IAAI,EAAIA,IAAI,CAAC3B,GAAG,CAACkD,CAAC,EAAIA,CAAC,CAACpC,EAAE,GAAGH,EAAE,CAACG,EAAE,CAAAZ,aAAA,CAAAA,aAAA,IAAQgD,CAAC,MAAE/C,MAAM,CAAE8C,cAAc,GAAKC,CAAC,CAAC,CAAC,CACpF1B,SAAS,CAACkB,CAAC,EAAAxC,aAAA,CAAAA,aAAA,IAAUwC,CAAC,MAAE,CAAC/B,EAAE,CAACG,EAAE,EAAAZ,aAAA,CAAAA,aAAA,IAASwC,CAAC,CAAC/B,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,MAAGX,MAAM,CAAE8C,cAAc,EAAE,EAAG,CAAC,CAClFjC,KAAK,CAACZ,CAAC,CAACC,OAAO,EAAI,KAAK,CAAC,CAC3B,CACF,CAAC,CAED,KAAM,CAAA8C,UAAU,CAAIxC,EAAE,EAAK,CACzB,KAAM,CAAAkC,EAAE,CAAGtB,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,CAAE,GAAG,CAAC+B,EAAE,CAAE,MAAO,MAAK,CAC9C,MAAO,CAAAA,EAAE,CAACf,IAAI,GAAGnB,EAAE,CAACmB,IAAI,EAAIe,EAAE,CAACd,WAAW,GAAGpB,EAAE,CAACoB,WAAW,EAAIrC,MAAM,CAACmD,EAAE,CAACb,KAAK,CAAC,GAAGtC,MAAM,CAACiB,EAAE,CAACqB,KAAK,CAAC,EAAIa,EAAE,CAAC1C,MAAM,GAAGQ,EAAE,CAACR,MAAM,EAAIT,MAAM,CAACmD,EAAE,CAACZ,OAAO,EAAE,EAAE,CAAC,GAAKvC,MAAM,CAACiB,EAAE,CAACsB,OAAO,EAAE,EAAE,CAAC,EAAI,CAACY,EAAE,CAACX,IAAI,EAAE,EAAE,KAAOvB,EAAE,CAACuB,IAAI,EAAE,EAAE,CAAC,CACrN,CAAC,CAED;AACA,KAAM,CAAAkB,iBAAiB,CAAG,QAAAA,CAAA,CAAoB,IAAnB,CAAAC,SAAS,CAAArF,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAC,IAAI,CACvCV,gBAAgB,CAACC,OAAO,CAAG8F,SAAS,CAAE;AACtC,GAAGhG,YAAY,CAACE,OAAO,CAAC,CACtBF,YAAY,CAACE,OAAO,CAACkF,KAAK,CAAG,EAAE,CAC/BpF,YAAY,CAACE,OAAO,CAAC+F,KAAK,CAAC,CAAC,CAC9B,CACF,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG,KAAO,CAAAnD,CAAC,EAAK,CAC9B,KAAM,CAAAoD,CAAC,CAAGpD,CAAC,CAACqD,MAAM,CAACC,KAAK,EAAItD,CAAC,CAACqD,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAC7C,GAAG,CAACF,CAAC,CAAE,OACP;AACA,GAAG,CAAC,UAAU,CAACG,IAAI,CAACH,CAAC,CAACI,IAAI,CAAC,CAAE,CAAE5C,KAAK,CAAC,6BAA6B,CAAC,CAAE,OAAQ,CAC7E,GAAGwC,CAAC,CAACK,IAAI,CAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAE,CAAE7C,KAAK,CAAC,0BAA0B,CAAC,CAAE,OAAQ,CACtE,KAAM,CAAA8C,IAAI,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAAED,IAAI,CAACE,MAAM,CAAC,MAAM,CAAER,CAAC,CAAC,CACnD,GAAI,CACF,KAAM,CAAA1E,GAAG,CAAG,KAAM,CAAAC,KAAK,CAAC,iCAAiC,CAAE,CAAEgC,MAAM,CAAC,MAAM,CAAE9B,OAAO,CAAElE,WAAW,CAAC,CAAC,CAAEqG,IAAI,CAAE0C,IAAK,CAAC,CAAC,CACjH,GAAG,CAAChF,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,iBAAiB,CAAC,CAC9C,KAAM,CAAAC,CAAC,CAAG,KAAM,CAAAP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC1B,KAAM,CAAA2E,IAAI,CAAG5E,CAAC,CAAC4E,IAAI,CACnB,GAAG3G,gBAAgB,CAACC,OAAO,CAAC,CAC1B,KAAM,CAAA2G,GAAG,CAAG5G,gBAAgB,CAACC,OAAO,CACpCiE,SAAS,CAACkB,CAAC,EAAAxC,aAAA,CAAAA,aAAA,IAAUwC,CAAC,MAAE,CAACwB,GAAG,EAAAhE,aAAA,CAAAA,aAAA,IAASwC,CAAC,CAACwB,GAAG,CAAC,EAAE,CAAC,CAAC,MAAGhC,IAAI,CAAE+B,IAAI,EAAE,EAAG,CAAC,CAClE3G,gBAAgB,CAACC,OAAO,CAAG,IAAI,CACjC,CAAC,IAAM,CACL;AACAf,SAAS,CAACyD,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAUD,CAAC,MAAEnD,IAAI,CAAEmH,IAAI,EAAG,CAAC,CACxC,CACF,CAAE,MAAME,GAAG,CAAC,CACVnD,KAAK,CAACmD,GAAG,CAAC9D,OAAO,EAAI,iBAAiB,CAAC,CACzC,CACF,CAAC,CAED,GAAG,CAAC/E,cAAc,CAAE,mBAAOJ,IAAA,QAAKkJ,KAAK,CAAE,CAAEC,OAAO,CAAC,EAAG,CAAE,CAAAC,QAAA,CAAC,uEAAwC,CAAK,CAAC,CAErG,mBACElJ,KAAA,QAAKmJ,GAAG,CAAEnH,OAAQ,CAACoH,SAAS,CAAC,kCAAkC,CAACJ,KAAK,CAAE,CAAEC,OAAO,CAAC,EAAG,CAAE,CAAAC,QAAA,eACpFpJ,IAAA,OAAIsJ,SAAS,CAAC,kBAAkB,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAM,CAAEC,SAAS,CAAC,CAAE,CAAE,CAAAJ,QAAA,CAAC,qDAAyB,CAAI,CAAC,cACzGlJ,KAAA,QAAKoJ,SAAS,CAAC,4BAA4B,CAACJ,KAAK,CAAE,CAAEO,YAAY,CAAC,EAAG,CAAE,CAAAL,QAAA,eACrEpJ,IAAA,QAAKsJ,SAAS,CAAC,6BAA6B,CAAAF,QAAA,cAC1CpJ,IAAA,UAAOsJ,SAAS,CAAC,eAAe,CAACJ,KAAK,CAAE,CAAEQ,KAAK,CAAC,MAAO,CAAE,CAACC,WAAW,CAAC,uCAAqB,CAACpC,KAAK,CAAEhH,CAAE,CAACqJ,QAAQ,CAAE1E,CAAC,EAAE1E,IAAI,CAAC0E,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAE,CAAC,CACxI,CAAC,cACNvH,IAAA,QAAKsJ,SAAS,CAAC,eAAe,CAACJ,KAAK,CAAE,CAAEW,QAAQ,CAAC,GAAI,CAAE,CAAAT,QAAA,cACrDlJ,KAAA,WAAQoJ,SAAS,CAAC,gBAAgB,CAAC/B,KAAK,CAAE9G,YAAa,CAACmJ,QAAQ,CAAE1E,CAAC,EAAExE,eAAe,CAACwE,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAC2B,KAAK,CAAE,CAAEY,MAAM,CAAC,EAAG,CAAE,CAAAV,QAAA,eACzHpJ,IAAA,WAAQuH,KAAK,CAAC,KAAK,CAAA6B,QAAA,CAAC,qCAAiB,CAAQ,CAAC,cAC9CpJ,IAAA,WAAQuH,KAAK,CAAC,QAAQ,CAAA6B,QAAA,CAAC,0BAAS,CAAQ,CAAC,cACzCpJ,IAAA,WAAQuH,KAAK,CAAC,QAAQ,CAAA6B,QAAA,CAAC,oBAAQ,CAAQ,CAAC,EAClC,CAAC,CACN,CAAC,cACNpJ,IAAA,QAAKsJ,SAAS,CAAC,eAAe,CAACJ,KAAK,CAAE,CAAEW,QAAQ,CAAC,GAAI,CAAE,CAAAT,QAAA,cACrDlJ,KAAA,WAAQoJ,SAAS,CAAC,gBAAgB,CAAC/B,KAAK,CAAE5G,WAAY,CAACiJ,QAAQ,CAAE1E,CAAC,EAAEtE,cAAc,CAACsE,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAC2B,KAAK,CAAE,CAAEY,MAAM,CAAC,EAAG,CAAE,CAAAV,QAAA,eACvHpJ,IAAA,WAAQuH,KAAK,CAAC,KAAK,CAAA6B,QAAA,CAAC,oCAAgB,CAAQ,CAAC,CAC5CrH,MAAM,CAAC+C,GAAG,CAACiF,CAAC,eAAG/J,IAAA,WAAyBuH,KAAK,CAAEwC,CAAC,CAAC5C,EAAE,EAAE4C,CAAC,CAACnE,EAAG,CAAAwD,QAAA,CAAEW,CAAC,CAACxI,IAAI,EAAEwI,CAAC,CAACnD,IAAI,EAA9CmD,CAAC,CAAC5C,EAAE,EAAE4C,CAAC,CAACnE,EAA+C,CAAC,CAAC,EAChF,CAAC,CACN,CAAC,EACH,CAAC,cACN5F,IAAA,QAAKkJ,KAAK,CAAE,CAAEO,YAAY,CAAC,CAAE,CAAE,CAAAL,QAAA,CAC5B9I,OAAO,eAAIN,IAAA,WAAQsJ,SAAS,CAAC,QAAQ,CAACU,OAAO,CAAEA,CAAA,GAAK5I,aAAa,CAAC,IAAI,CAAE,CAAAgI,QAAA,CAAC,6BAAc,CAAQ,CAAC,CAC9F,CAAC,CACLrI,OAAO,cAAGf,IAAA,QAAKkJ,KAAK,CAAE,CAAEe,KAAK,CAAC,MAAO,CAAE,CAAAb,QAAA,CAAC,uBAAW,CAAK,CAAC,CAAGnI,KAAK,cAAGjB,IAAA,QAAKkJ,KAAK,CAAE,CAAEe,KAAK,CAAC,SAAU,CAAE,CAAAb,QAAA,CAAEnI,KAAK,CAAM,CAAC,cACjHf,KAAA,UAAOoJ,SAAS,CAAC,sBAAsB,CAACJ,KAAK,CAAE,CAAEQ,KAAK,CAAC,MAAO,CAAE,CAAAN,QAAA,eAC9DpJ,IAAA,UAAAoJ,QAAA,cACElJ,KAAA,OAAAkJ,QAAA,eACEpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,IAAE,CAAI,CAAC,cAC1CpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,0BAAW,CAAI,CAAC,cACnDpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,MAAI,CAAI,CAAC,cAC5CpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,eAAK,CAAI,CAAC,cAC7CpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,cAAS,CAAI,CAAC,cACjDpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,oBAAU,CAAI,CAAC,cAClDpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,mBAAS,CAAI,CAAC,cACjDpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEK,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,wBAAS,CAAI,CAAC,EAC/C,CAAC,CACA,CAAC,cACRpJ,IAAA,UAAAoJ,QAAA,CACGvI,KAAK,CAACkC,MAAM,GAAG,CAAC,cAAG/C,IAAA,OAAAoJ,QAAA,cAAIpJ,IAAA,OAAIkK,OAAO,CAAE,CAAE,CAAChB,KAAK,CAAE,CAAEe,KAAK,CAAC,MAAM,CAAEV,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,mCAAiB,CAAI,CAAC,CAAI,CAAC,CAAGvI,KAAK,CAACiE,GAAG,CAAC,CAACW,EAAE,CAAC0E,GAAG,GAAI,CACtI,KAAM,CAAAxC,EAAE,CAAGtB,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAI,CAAEgB,IAAI,CAAC,EAAE,CAAEC,WAAW,CAAC,EAAE,CAAEC,KAAK,CAAC,CAAC,CAAE7B,MAAM,CAAC,QAAS,CAAC,CACjF,KAAM,CAAAmF,WAAW,CAAIzC,EAAE,CAAC1C,MAAM,GAAK,QAAQ,CAAI,mBAAmB,CAAG,mBAAmB,CACxF,mBACE/E,KAAA,OAAgB8J,OAAO,CAAEA,CAAA,GAAKxD,aAAa,CAACf,EAAE,CAACG,EAAE,CAAE,CAAC0D,SAAS,CAAE,aAAa,EAAIrB,UAAU,CAACxC,EAAE,CAAC,CAAE,mBAAmB,CAAC,EAAE,CAAC,EAAIc,UAAU,GAAGd,EAAE,CAACG,EAAE,CAAG,oBAAoB,CAAC,EAAE,CAAE,CAACsD,KAAK,CAAE,CAAE,aAAa,CAAEiB,GAAI,CAAE,CAAAf,QAAA,eACtMpJ,IAAA,OAAIsJ,SAAS,CAAC,OAAO,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAO,CAAE,CAAAH,QAAA,CAAE3D,EAAE,CAACG,EAAE,CAAK,CAAC,cAC/D5F,IAAA,OAAIsJ,SAAS,CAAC,OAAO,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAO,CAAE,CAAAH,QAAA,cAACpJ,IAAA,UAAOuH,KAAK,CAAE,CAAClB,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEgB,IAAI,EAAI,EAAG,CAACyD,OAAO,CAAEA,CAAA,GAAK7D,aAAa,CAACf,EAAE,CAACG,EAAE,CAAE,CAACgE,QAAQ,CAAE1E,CAAC,EAAEmC,WAAW,CAAC5B,EAAE,CAACG,EAAE,CAAC,MAAM,CAAEV,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAE,CAAC,CAAI,CAAC,cACpMvH,IAAA,OAAIsJ,SAAS,CAAC,OAAO,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAM,CAAEG,KAAK,CAAC,GAAI,CAAE,CAAAN,QAAA,CACzD3D,EAAE,CAACuB,IAAI,EAAI,CAACX,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEoB,IAAI,cACnC9G,KAAA,QAAKgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEC,aAAa,CAAC,KAAK,CAAEC,UAAU,CAAC,QAAQ,CAAEC,GAAG,CAAC,CAAE,CAAE,CAAArB,QAAA,eAC9EpJ,IAAA,QAAK0K,GAAG,CAAE,CAACrE,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEoB,IAAI,EAAIvB,EAAE,CAACuB,IAAK,CAAC2D,GAAG,CAAC,MAAM,CAACzB,KAAK,CAAE,CAAEQ,KAAK,CAAC,EAAE,CAACI,MAAM,CAAC,EAAE,CAACc,SAAS,CAAC,OAAO,CAAEC,YAAY,CAAC,CAAC,CAAEC,MAAM,CAAC,gBAAgB,CAAEC,UAAU,CAAC,SAAU,CAAE,CAAE,CAAC,cAC5K/K,IAAA,WAAQ0I,IAAI,CAAC,QAAQ,CAACsB,OAAO,CAAEA,CAAA,GAAK9B,iBAAiB,CAACzC,EAAE,CAACG,EAAE,CAAE,CAACsD,KAAK,CAAE,CACnEQ,KAAK,CAAC,EAAE,CAAEI,MAAM,CAAC,EAAE,CAAEgB,MAAM,CAAC,mBAAmB,CAAEC,UAAU,CAAC,MAAM,CAAEF,YAAY,CAAC,CAAC,CAAEG,MAAM,CAAC,SAAS,CAAEV,OAAO,CAAC,MAAM,CAAEE,UAAU,CAAC,QAAQ,CAAES,cAAc,CAAC,QAAQ,CAAE9B,OAAO,CAAC,CAC9K,CAAE,CAAC+B,KAAK,CAAC,WAAW,CAAA9B,QAAA,cAClBpJ,IAAA,QAAK0K,GAAG,CAAC,cAAc,CAACC,GAAG,CAAC,SAAS,CAACzB,KAAK,CAAE,CAAEQ,KAAK,CAAC,EAAE,CAACI,MAAM,CAAC,EAAE,CAAEc,SAAS,CAAC,SAAU,CAAE,CAAE,CAAC,CACtF,CAAC,EACN,CAAC,cAEN5K,IAAA,WAAQ0I,IAAI,CAAC,QAAQ,CAACY,SAAS,CAAC,QAAQ,CAACJ,KAAK,CAAE,CAAEY,MAAM,CAAC,EAAE,CAAEqB,QAAQ,CAAC,EAAG,CAAE,CAACnB,OAAO,CAAEA,CAAA,GAAK9B,iBAAiB,CAACzC,EAAE,CAACG,EAAE,CAAE,CAAAwD,QAAA,CAAC,QAAM,CAAQ,CACnI,CACC,CAAC,cACLpJ,IAAA,OAAIsJ,SAAS,CAAC,OAAO,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAO,CAAE,CAAAH,QAAA,cAACpJ,IAAA,UAAOuH,KAAK,CAAE,CAAClB,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEiB,WAAW,EAAI,EAAG,CAACwD,OAAO,CAAEA,CAAA,GAAK7D,aAAa,CAACf,EAAE,CAACG,EAAE,CAAE,CAACgE,QAAQ,CAAE1E,CAAC,EAAEmC,WAAW,CAAC5B,EAAE,CAACG,EAAE,CAAC,aAAa,CAAEV,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAE,CAAC,CAAI,CAAC,cAClNvH,IAAA,OAAIsJ,SAAS,CAAC,OAAO,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAM,CAAEM,QAAQ,CAAC,GAAI,CAAE,CAAAT,QAAA,cAACpJ,IAAA,UAAO0I,IAAI,CAAC,QAAQ,CAACnB,KAAK,CAAE,CAAClB,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEkB,KAAM,CAACuD,OAAO,CAAEA,CAAA,GAAK7D,aAAa,CAACf,EAAE,CAACG,EAAE,CAAE,CAACgE,QAAQ,CAAE1E,CAAC,EAAEmC,WAAW,CAAC5B,EAAE,CAACG,EAAE,CAAC,OAAO,CAAEV,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAE,CAAC,CAAI,CAAC,cAC5NvH,IAAA,OAAIsJ,SAAS,CAAC,OAAO,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAO,CAAE,CAAAH,QAAA,cAChDlJ,KAAA,WAAQqH,KAAK,CAAE,CAAClB,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEX,MAAO,CAACoF,OAAO,CAAEA,CAAA,GAAK7D,aAAa,CAACf,EAAE,CAACG,EAAE,CAAE,CAACgE,QAAQ,CAAE1E,CAAC,EAAEmC,WAAW,CAAC5B,EAAE,CAACG,EAAE,CAAC,QAAQ,CAAEV,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAC+B,SAAS,mBAAA3D,MAAA,CAAoByE,WAAW,CAAG,CAAClB,KAAK,CAAE,CAAEY,MAAM,CAAC,EAAG,CAAE,CAAAV,QAAA,eACxMpJ,IAAA,WAAQuH,KAAK,CAAC,QAAQ,CAAA6B,QAAA,CAAC,0BAAS,CAAQ,CAAC,cACzCpJ,IAAA,WAAQuH,KAAK,CAAC,QAAQ,CAAA6B,QAAA,CAAC,oBAAQ,CAAQ,CAAC,EAClC,CAAC,CACP,CAAC,cACLpJ,IAAA,OAAIsJ,SAAS,CAAC,OAAO,CAACJ,KAAK,CAAE,CAAEK,SAAS,CAAC,MAAO,CAAE,CAAAH,QAAA,cAChDlJ,KAAA,WAAQqH,KAAK,CAAE,CAAClB,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEmB,OAAQ,CAACsD,OAAO,CAAEA,CAAA,GAAK7D,aAAa,CAACf,EAAE,CAACG,EAAE,CAAE,CAACgE,QAAQ,CAAE1E,CAAC,EAAEmC,WAAW,CAAC5B,EAAE,CAACG,EAAE,CAAC,SAAS,CAAEV,CAAC,CAACqD,MAAM,CAAChB,KAAK,CAAE,CAAC+B,SAAS,CAAC,gBAAgB,CAACJ,KAAK,CAAE,CAAEY,MAAM,CAAC,EAAG,CAAE,CAAAV,QAAA,eACzLpJ,IAAA,WAAQuH,KAAK,CAAC,EAAE,CAAA6B,QAAA,CAAC,6BAAc,CAAQ,CAAC,CACvCrH,MAAM,CAAC+C,GAAG,CAACsG,EAAE,eAAGpL,IAAA,WAA6BuH,KAAK,CAAE6D,EAAE,CAACjE,EAAE,EAAIiE,EAAE,CAACxF,EAAG,CAAAwD,QAAA,CAAEgC,EAAE,CAAC7J,IAAI,EAAI6J,EAAE,CAACxE,IAAI,EAA1DwE,EAAE,CAACjE,EAAE,EAAIiE,EAAE,CAACxF,EAAuD,CAAC,CAAC,EAC7F,CAAC,CACP,CAAC,cACL1F,KAAA,OAAIoJ,SAAS,CAAC,cAAc,CAACJ,KAAK,CAAE,CAAEmC,UAAU,CAAC,QAAQ,CAAE9B,SAAS,CAAC,MAAO,CAAE,CAAAH,QAAA,eAC5EpJ,IAAA,WAAQsJ,SAAS,CAAC,wBAAwB,CAACU,OAAO,CAAEA,CAAA,GAAIpC,OAAO,CAACnC,EAAE,CAAE,CAAA2D,QAAA,CAAC,UAAG,CAAQ,CAAC,CAChF9I,OAAO,eAAIN,IAAA,WAAQsJ,SAAS,CAAC,uBAAuB,CAACU,OAAO,CAAEA,CAAA,GAAIxE,GAAG,CAACC,EAAE,CAAE,CAAA2D,QAAA,CAAC,QAAG,CAAQ,CAAC,cACxFpJ,IAAA,WAAQsJ,SAAS,CAAC,wBAAwB,CAACgC,QAAQ,CAAE,EAAE,CAACjF,MAAM,CAACZ,EAAE,CAACG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAEmB,OAAO,EAAItB,EAAE,CAACsB,OAAO,CAAE,CAACiD,OAAO,CAAEA,CAAA,GAAKnC,eAAe,CAACpC,EAAE,CAAGA,EAAE,CAACR,MAAM,GAAI,QAAQ,CAAE,QAAQ,CAAC,QAAQ,CAAE,CAAAmE,QAAA,CAAG3D,EAAE,CAACR,MAAM,GAAI,QAAQ,CAAE,UAAU,CAAC,WAAW,CAAS,CAAC,EACxO,CAAC,GAnCEQ,EAAE,CAACG,EAoCR,CAAC,CAET,CAAC,CAAC,CACG,CAAC,EACH,CACR,CAEAzE,UAAU,eACTnB,IAAA,QAAKsJ,SAAS,CAAC,iBAAiB,CAACiC,WAAW,CAAErG,CAAC,EAAE,CAAE,GAAGA,CAAC,CAACqD,MAAM,GAAGrD,CAAC,CAACsG,aAAa,CAAEpK,aAAa,CAAC,KAAK,CAAC,CAAE,CAAE,CAAAgI,QAAA,cACxGlJ,KAAA,QAAKoJ,SAAS,CAAC,eAAe,CAACiC,WAAW,CAAErG,CAAC,EAAGA,CAAC,CAACuG,eAAe,CAAC,CAAE,CAACvC,KAAK,CAAE,CAAEQ,KAAK,CAAC,GAAG,CAAEgC,QAAQ,CAAC,KAAK,CAAEX,UAAU,CAAC,MAAM,CAAEF,YAAY,CAAC,EAAE,CAAE1B,OAAO,CAAC,EAAG,CAAE,CAAAC,QAAA,eACxJpJ,IAAA,OAAIkJ,KAAK,CAAE,CAAEM,SAAS,CAAC,CAAC,CAAED,SAAS,CAAC,QAAS,CAAE,CAAAH,QAAA,CAAC,2BAAY,CAAI,CAAC,cACjElJ,KAAA,QAAKgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEqB,mBAAmB,CAAC,SAAS,CAAElB,GAAG,CAAC,EAAG,CAAE,CAAArB,QAAA,eACpElJ,KAAA,UAAOgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEC,aAAa,CAAC,QAAQ,CAAEE,GAAG,CAAC,CAAE,CAAE,CAAArB,QAAA,EAAC,0BAC/D,cAAApJ,IAAA,UAAOuH,KAAK,CAAElG,MAAM,CAACE,IAAK,CAACqI,QAAQ,CAAE1E,CAAC,EAAE5D,SAAS,CAACyD,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAOD,CAAC,MAAExD,IAAI,CAAC2D,CAAC,CAACqD,MAAM,CAAChB,KAAK,EAAG,CAAE,CAACoC,WAAW,CAAC,sBAAY,CAAE,CAAC,EAC5G,CAAC,cACRzJ,KAAA,UAAOgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEC,aAAa,CAAC,QAAQ,CAAEE,GAAG,CAAC,CAAE,CAAE,CAAArB,QAAA,EAAC,cAC/D,cAAApJ,IAAA,UAAO0I,IAAI,CAAC,QAAQ,CAACnB,KAAK,CAAElG,MAAM,CAACI,KAAM,CAACmI,QAAQ,CAAE1E,CAAC,EAAE5D,SAAS,CAACyD,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAOD,CAAC,MAAEtD,KAAK,CAACyD,CAAC,CAACqD,MAAM,CAAChB,KAAK,EAAG,CAAE,CAACoC,WAAW,CAAC,QAAQ,CAAE,CAAC,EACxH,CAAC,cACRzJ,KAAA,UAAOgJ,KAAK,CAAE,CAAE0C,UAAU,CAAC,YAAY,CAAEtB,OAAO,CAAC,MAAM,CAAEC,aAAa,CAAC,QAAQ,CAAEE,GAAG,CAAC,CAAE,CAAE,CAAArB,QAAA,EAAC,eACxF,cAAApJ,IAAA,aAAU6L,IAAI,CAAE,CAAE,CAACtE,KAAK,CAAElG,MAAM,CAACG,WAAY,CAACoI,QAAQ,CAAE1E,CAAC,EAAE5D,SAAS,CAACyD,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAOD,CAAC,MAAEvD,WAAW,CAAC0D,CAAC,CAACqD,MAAM,CAAChB,KAAK,EAAG,CAAE,CAACoC,WAAW,CAAC,yBAAY,CAAE,CAAC,EACtI,CAAC,cACRzJ,KAAA,UAAOgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEC,aAAa,CAAC,QAAQ,CAAEE,GAAG,CAAC,CAAE,CAAE,CAAArB,QAAA,EAAC,oBAC/D,cAAAlJ,KAAA,WAAQoJ,SAAS,CAAC,gBAAgB,CAACJ,KAAK,CAAE,CAAEY,MAAM,CAAC,EAAG,CAAE,CAACvC,KAAK,CAAElG,MAAM,CAACK,MAAO,CAACkI,QAAQ,CAAE1E,CAAC,EAAE5D,SAAS,CAACyD,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAOD,CAAC,MAAErD,MAAM,CAACwD,CAAC,CAACqD,MAAM,CAAChB,KAAK,EAAG,CAAE,CAAA6B,QAAA,eACzIpJ,IAAA,WAAQuH,KAAK,CAAC,QAAQ,CAAA6B,QAAA,CAAC,0BAAS,CAAQ,CAAC,cACzCpJ,IAAA,WAAQuH,KAAK,CAAC,QAAQ,CAAA6B,QAAA,CAAC,oBAAQ,CAAQ,CAAC,EAClC,CAAC,EACJ,CAAC,cACRlJ,KAAA,UAAOgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEC,aAAa,CAAC,QAAQ,CAAEE,GAAG,CAAC,CAAE,CAAE,CAAArB,QAAA,EAAC,mBAC/D,cAAAlJ,KAAA,WAAQoJ,SAAS,CAAC,gBAAgB,CAACJ,KAAK,CAAE,CAAEY,MAAM,CAAC,EAAG,CAAE,CAACvC,KAAK,CAAElG,MAAM,CAACM,OAAQ,CAACiI,QAAQ,CAAE1E,CAAC,EAAE5D,SAAS,CAACyD,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAOD,CAAC,MAAEpD,OAAO,CAACuD,CAAC,CAACqD,MAAM,CAAChB,KAAK,EAAG,CAAE,CAAA6B,QAAA,eAC3IpJ,IAAA,WAAQuH,KAAK,CAAC,EAAE,CAAA6B,QAAA,CAAC,6BAAc,CAAQ,CAAC,CACvCrH,MAAM,CAAC+C,GAAG,CAACsG,EAAE,eAAGpL,IAAA,WAA6BuH,KAAK,CAAE6D,EAAE,CAACjE,EAAE,EAAIiE,EAAE,CAACxF,EAAG,CAAAwD,QAAA,CAAEgC,EAAE,CAAC7J,IAAI,EAAI6J,EAAE,CAACxE,IAAI,EAA1DwE,EAAE,CAACjE,EAAE,EAAIiE,EAAE,CAACxF,EAAuD,CAAC,CAAC,EAC7F,CAAC,EACJ,CAAC,cACR1F,KAAA,UAAOgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEC,aAAa,CAAC,QAAQ,CAAEE,GAAG,CAAC,CAAE,CAAE,CAAArB,QAAA,EAAC,MAC/D,cAAAlJ,KAAA,QAAKgJ,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAM,CAAEE,UAAU,CAAC,QAAQ,CAAEC,GAAG,CAAC,EAAG,CAAE,CAAArB,QAAA,EACzD/H,MAAM,CAACO,IAAI,cACV5B,IAAA,QAAK0K,GAAG,CAAErJ,MAAM,CAACO,IAAK,CAAC+I,GAAG,CAAC,MAAM,CAACzB,KAAK,CAAE,CAAEQ,KAAK,CAAC,EAAE,CAACI,MAAM,CAAC,EAAE,CAACc,SAAS,CAAC,OAAO,CAAEE,MAAM,CAAC,gBAAgB,CAAED,YAAY,CAAC,EAAE,CAAEE,UAAU,CAAC,SAAU,CAAE,CAAE,CAAC,cAErJ/K,IAAA,SAAMkJ,KAAK,CAAE,CAAEiC,QAAQ,CAAC,EAAE,CAAElB,KAAK,CAAC,MAAO,CAAE,CAAAb,QAAA,CAAC,qBAAS,CAAM,CAC5D,cACDlJ,KAAA,WAAQwI,IAAI,CAAC,QAAQ,CAACsB,OAAO,CAAEA,CAAA,GAAK,CAAE5H,gBAAgB,CAACC,OAAO,CAAC,IAAI,CAAEF,YAAY,CAACE,OAAO,EAAIF,YAAY,CAACE,OAAO,CAAC+F,KAAK,CAAC,CAAC,CAAE,CAAE,CAACc,KAAK,CAAE,CACnIoB,OAAO,CAAC,MAAM,CAAEE,UAAU,CAAC,QAAQ,CAAEC,GAAG,CAAC,CAAC,CAAEM,UAAU,CAAC,MAAM,CAAED,MAAM,CAAC,mBAAmB,CAAED,YAAY,CAAC,CAAC,CAAE1B,OAAO,CAAC,UAAU,CAAE6B,MAAM,CAAC,SACxI,CAAE,CAAA5B,QAAA,eACApJ,IAAA,QAAK0K,GAAG,CAAC,cAAc,CAACC,GAAG,CAAC,QAAQ,CAACzB,KAAK,CAAE,CAAEQ,KAAK,CAAC,EAAE,CAAEI,MAAM,CAAC,EAAG,CAAE,CAAE,CAAC,cACvE9J,IAAA,SAAMkJ,KAAK,CAAE,CAAEiC,QAAQ,CAAC,EAAG,CAAE,CAAA/B,QAAA,CAAC,kBAAW,CAAM,CAAC,EAC1C,CAAC,CACR/H,MAAM,CAACO,IAAI,eAAI5B,IAAA,WAAQ0I,IAAI,CAAC,QAAQ,CAACY,SAAS,CAAC,uBAAuB,CAACU,OAAO,CAAEA,CAAA,GAAK1I,SAAS,CAACyD,CAAC,EAAAC,aAAA,CAAAA,aAAA,IAAOD,CAAC,MAAEnD,IAAI,CAAC,EAAE,EAAE,CAAE,CAAAwH,QAAA,CAAC,QAAG,CAAQ,CAAC,EAChI,CAAC,EACD,CAAC,EACL,CAAC,cACNlJ,KAAA,QAAKgJ,KAAK,CAAE,CAAEM,SAAS,CAAC,EAAE,CAAEc,OAAO,CAAC,MAAM,CAAEG,GAAG,CAAC,EAAE,CAAEQ,cAAc,CAAC,QAAS,CAAE,CAAA7B,QAAA,eAC5EpJ,IAAA,WAAQsJ,SAAS,CAAC,QAAQ,CAACU,OAAO,CAAEjE,MAAO,CAACuF,QAAQ,CAAEzJ,QAAS,CAAAuH,QAAA,CAAEvH,QAAQ,CAAE,aAAa,CAAC,KAAK,CAAS,CAAC,cACxG7B,IAAA,WAAQsJ,SAAS,CAAC,0BAA0B,CAACU,OAAO,CAAEA,CAAA,GAAI5I,aAAa,CAAC,KAAK,CAAE,CAAAgI,QAAA,CAAC,UAAG,CAAQ,CAAC,EACzF,CAAC,EACH,CAAC,CACH,CACN,cACDpJ,IAAA,UAAOqJ,GAAG,CAAElH,YAAa,CAACuG,IAAI,CAAC,MAAM,CAACoD,MAAM,CAAC,SAAS,CAAC5C,KAAK,CAAE,CAAEoB,OAAO,CAAC,MAAO,CAAE,CAACV,QAAQ,CAAEvB,UAAW,CAAE,CAAC,cAC1GrI,IAAA,UAAAoJ,QAAA,m/EA0CS,CAAC,EACP,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}