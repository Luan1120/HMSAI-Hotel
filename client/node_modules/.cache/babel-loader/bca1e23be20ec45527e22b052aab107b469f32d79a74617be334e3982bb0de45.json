{"ast":null,"code":"var _jsxFileName = \"D:\\\\Git\\\\HMSAI-Hotel\\\\client\\\\src\\\\ChatBotAI.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { authHeaders, getUserEmail } from './auth';\nimport './HomePage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DEFAULT_BOT_GREETING = 'Xin ch√†o üëã! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?';\nconst MAX_HISTORY = 200;\nconst LEGACY_MSG_KEY = 'hmsChatMsgs';\nconst LEGACY_SESSION_KEY = 'hmsChatSessionId';\nfunction createWelcomeMessages() {\n  return [{\n    role: 'bot',\n    text: DEFAULT_BOT_GREETING\n  }];\n}\nfunction normalizeEmailForKey(email) {\n  if (!email) return null;\n  const trimmed = String(email).trim().toLowerCase();\n  if (!trimmed) return null;\n  return encodeURIComponent(trimmed);\n}\nfunction buildMessageKey(email) {\n  const normalized = normalizeEmailForKey(email);\n  return normalized ? `${LEGACY_MSG_KEY}:${normalized}` : null;\n}\nfunction buildSessionKey(email) {\n  const normalized = normalizeEmailForKey(email);\n  return normalized ? `${LEGACY_SESSION_KEY}:${normalized}` : null;\n}\nfunction loadStoredMessages(email) {\n  const key = buildMessageKey(email);\n  if (!key) return createWelcomeMessages();\n  try {\n    const raw = localStorage.getItem(key);\n    if (!raw) return createWelcomeMessages();\n    const parsed = JSON.parse(raw);\n    if (Array.isArray(parsed) && parsed.length) {\n      return parsed.slice(-MAX_HISTORY);\n    }\n  } catch {/* ignore parse errors */}\n  return createWelcomeMessages();\n}\nfunction createSessionId() {\n  return `s_${Math.random().toString(36).slice(2, 10)}${Date.now().toString(36).slice(-4)}`;\n}\nfunction ensurePersistedSessionId(email, existing) {\n  const fallback = existing || createSessionId();\n  if (!email) return fallback;\n  const key = buildSessionKey(email);\n  if (!key) return fallback;\n  try {\n    const stored = localStorage.getItem(key);\n    if (stored) return stored;\n    localStorage.setItem(key, fallback);\n    return fallback;\n  } catch {\n    return fallback;\n  }\n}\nfunction persistSessionId(email, sessionId) {\n  if (!email || !sessionId) return;\n  const key = buildSessionKey(email);\n  if (!key) return;\n  try {\n    localStorage.setItem(key, sessionId);\n  } catch {/* ignore */}\n}\nfunction migrateLegacyStorage(email) {\n  if (!email) return {\n    session: null\n  };\n  let migratedSession = null;\n  const messageKey = buildMessageKey(email);\n  const sessionKey = buildSessionKey(email);\n  try {\n    const legacyMsgs = localStorage.getItem(LEGACY_MSG_KEY);\n    if (legacyMsgs) {\n      if (messageKey && !localStorage.getItem(messageKey)) {\n        localStorage.setItem(messageKey, legacyMsgs);\n      }\n      localStorage.removeItem(LEGACY_MSG_KEY);\n    }\n    const legacySession = localStorage.getItem(LEGACY_SESSION_KEY);\n    if (legacySession) {\n      if (sessionKey && !localStorage.getItem(sessionKey)) {\n        localStorage.setItem(sessionKey, legacySession);\n      }\n      localStorage.removeItem(LEGACY_SESSION_KEY);\n      migratedSession = legacySession;\n    }\n  } catch {/* ignore storage errors */}\n  return {\n    session: migratedSession\n  };\n}\n\n/** Simple AI Chatbox Component */\nexport default function ChatBotAI({\n  open,\n  onClose\n}) {\n  _s();\n  const [userEmail, setUserEmail] = useState(() => getUserEmail() || null);\n  const [messages, setMessages] = useState(() => loadStoredMessages(getUserEmail() || null));\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [sessionId, setSessionId] = useState(() => ensurePersistedSessionId(getUserEmail() || null, null));\n  const bottomRef = useRef(null);\n  const messagesRef = useRef(messages); // track latest messages for async updates\n\n  const storageKey = buildMessageKey(userEmail);\n  useEffect(() => {\n    messagesRef.current = messages;\n  }, [messages]);\n  useEffect(() => {\n    if (!storageKey) return;\n    try {\n      localStorage.setItem(storageKey, JSON.stringify(messages.slice(-MAX_HISTORY)));\n    } catch {}\n  }, [messages, storageKey]);\n  useEffect(() => {\n    setSessionId(prev => ensurePersistedSessionId(userEmail, prev));\n    const nextMessages = loadStoredMessages(userEmail);\n    setMessages(nextMessages);\n    messagesRef.current = nextMessages;\n  }, [userEmail]);\n  useEffect(() => {\n    if (!userEmail) {\n      try {\n        localStorage.removeItem(LEGACY_MSG_KEY);\n        localStorage.removeItem(LEGACY_SESSION_KEY);\n      } catch {}\n      return;\n    }\n    const {\n      session: migratedSession\n    } = migrateLegacyStorage(userEmail);\n    if (migratedSession) {\n      setSessionId(prev => prev === migratedSession ? prev : migratedSession);\n    }\n  }, [userEmail]);\n  useEffect(() => {\n    if (userEmail && sessionId) persistSessionId(userEmail, sessionId);\n  }, [sessionId, userEmail]);\n  useEffect(() => {\n    const syncUser = () => {\n      const current = getUserEmail() || null;\n      setUserEmail(prev => prev === current ? prev : current);\n    };\n    syncUser();\n    window.addEventListener('focus', syncUser);\n    window.addEventListener('storage', syncUser);\n    return () => {\n      window.removeEventListener('focus', syncUser);\n      window.removeEventListener('storage', syncUser);\n    };\n  }, []);\n  useEffect(() => {\n    if (!open) return;\n    const current = getUserEmail() || null;\n    setUserEmail(prev => prev === current ? prev : current);\n  }, [open]);\n  useEffect(() => {\n    if (bottomRef.current) bottomRef.current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages, open]);\n  useEffect(() => {\n    const onEsc = e => {\n      if (e.key === 'Escape' && open) onClose && onClose();\n    };\n    document.addEventListener('keydown', onEsc);\n    return () => document.removeEventListener('keydown', onEsc);\n  }, [open, onClose]);\n  const send = async text => {\n    const msg = (text !== null && text !== void 0 ? text : input).trim();\n    if (!msg || loading) return;\n    setInput('');\n    setMessages(m => [...m, {\n      role: 'user',\n      text: msg\n    }]);\n\n    // Command parsing (client-side UI open triggers)\n    // Vietnamese command patterns: \"m·ªü d·ªãch v·ª•\", \"m·ªü ph√≤ng\", \"m·ªü ti·ªán nghi\", \"m·ªü ƒë√°nh gi√°\", \"m·ªü khuy·∫øn m√£i\", \"m·ªü ƒë·∫∑t ph√≤ng\", etc.\n    try {\n      const lower = msg.toLowerCase();\n      const fire = (name, detail = {}) => {\n        try {\n          window.dispatchEvent(new CustomEvent(name, {\n            detail\n          }));\n        } catch {}\n      };\n      const commandMap = [{\n        keywords: ['m·ªü d·ªãch v·ª•', 'open service', 'open services', 'm·ªü service'],\n        event: 'open-services'\n      }, {\n        keywords: ['m·ªü ph√≤ng', 'open rooms', 'open room list', 'm·ªü danh s√°ch ph√≤ng'],\n        event: 'open-rooms'\n      }, {\n        keywords: ['m·ªü ti·ªán nghi', 'open amenities', 'open amenity'],\n        event: 'open-amenities'\n      }, {\n        keywords: ['m·ªü khuy·∫øn m√£i', 'm·ªü ∆∞u ƒë√£i', 'open promotions', 'open promotion'],\n        event: 'open-promotions'\n      }, {\n        keywords: ['m·ªü ƒë√°nh gi√°', 'open reviews', 'xem ƒë√°nh gi√°'],\n        event: 'open-reviews'\n      }, {\n        keywords: ['m·ªü ƒë·∫∑t ph√≤ng', 'ƒë·∫∑t ph√≤ng ngay', 'booking now', 'book now'],\n        event: 'open-booking'\n      }, {\n        keywords: ['m·ªü h·ªì s∆°', 'm·ªü profile', 'open profile', 'th√¥ng tin c√° nh√¢n'],\n        event: 'open-profile'\n      }, {\n        keywords: ['m·ªü thanh to√°n', 'xem thanh to√°n', 'payment history'],\n        event: 'open-payments'\n      }, {\n        keywords: ['m·ªü th√¥ng b√°o', 'xem th√¥ng b√°o', 'open notifications'],\n        event: 'open-notifications'\n      }];\n      const found = commandMap.find(c => c.keywords.some(k => lower.includes(k)));\n      if (found) {\n        fire(found.event, {\n          source: 'chatbot',\n          original: msg\n        });\n        // Provide a local immediate bot acknowledgement without calling API\n        setMessages(m => [...m, {\n          role: 'bot',\n          text: 'ƒêang m·ªü giao di·ªán theo y√™u c·∫ßu c·ªßa b·∫°n...'\n        }]);\n        return; // skip server request for pure UI command\n      }\n    } catch {/* ignore command parse errors */}\n    setLoading(true);\n    try {\n      const res = await fetch('/api/ai/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify({\n          message: msg,\n          sessionId\n        })\n      });\n      if (!res.ok) throw new Error('L·ªói ph·∫£n h·ªìi');\n      const j = await res.json();\n      const next = [...messagesRef.current, {\n        role: 'bot',\n        text: j.reply || '(kh√¥ng c√≥ ph·∫£n h·ªìi)'\n      }];\n      if (Array.isArray(j.results) && j.results.length) {\n        next.push({\n          role: 'results',\n          items: j.results.slice(0, 8)\n        });\n      }\n      if (Array.isArray(j.suggestions) && j.suggestions.length) {\n        next.push({\n          role: 'suggest',\n          suggestions: j.suggestions.slice(0, 6)\n        });\n      }\n      setMessages(next);\n    } catch (e) {\n      setMessages(m => [...m, {\n        role: 'bot',\n        text: 'Xin l·ªói, hi·ªán ch∆∞a ph·∫£n h·ªìi ƒë∆∞·ª£c.'\n      }]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const openBooking = roomName => {\n    // Dispatch a custom event to open room type inline / overlay if available\n    try {\n      const ev = new CustomEvent('open-room-type', {\n        detail: {\n          name: roomName\n        }\n      });\n      window.dispatchEvent(ev);\n    } catch {}\n  };\n  const clickSuggestion = s => {\n    send(s);\n  };\n  if (!open) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ai-chatbox-wrapper\",\n    role: \"dialog\",\n    \"aria-label\": \"Chat h\\u1ED7 tr\\u1EE3 AI\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-chatbox-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-chatbox-title\",\n        children: \"H\\u1ED7 tr\\u1EE3 AI\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ai-chatbox-close\",\n        \"aria-label\": \"\\u0110\\xF3ng\",\n        onClick: onClose,\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-chatbox-body\",\n      children: [messages.map((m, idx) => {\n        if (m.role === 'suggest') {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ai-suggest-row\",\n            children: m.suggestions.map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"ai-suggest-btn\",\n              onClick: () => clickSuggestion(s),\n              children: s\n            }, s, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 41\n            }, this))\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 15\n          }, this);\n        }\n        if (m.role === 'results') {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ai-results-grid\",\n            children: m.items.map(it => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ai-room-card\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-thumb\",\n                children: it.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: it.image,\n                  alt: it.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 64\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"ph-img-fallback\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 103\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-name\",\n                children: it.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-meta\",\n                children: [it.maxAdults, \" NL \\u2022 \", it.maxChildren, \" TE\", it.rating ? ` ‚Ä¢ ${it.rating}‚òÖ` : '']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-price\",\n                children: [it.price.toLocaleString('vi-VN'), \"\\u0111/\\u0111\\xEAm\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"ai-room-book\",\n                onClick: () => openBooking(it.name),\n                children: \"\\u0110\\u1EB7t ph\\xF2ng\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 21\n              }, this)]\n            }, it.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 19\n            }, this))\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 15\n          }, this);\n        }\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `ai-msg ai-msg-${m.role}`,\n          children: m.text\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 18\n        }, this);\n      }), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-msg ai-msg-bot loading\",\n        children: \"\\u0110ang g\\xF5...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: bottomRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"ai-chatbox-input\",\n      onSubmit: e => {\n        e.preventDefault();\n        send();\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Nh\\u1EADp tin nh\\u1EAFn...\",\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyDown: e => {\n          if (e.key === 'Enter' && !e.shiftKey) {\n            e.preventDefault();\n            send();\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !input.trim() || loading,\n        children: \"G\\u1EEDi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n  .ai-chatbox-wrapper { position:fixed; bottom:108px; right:120px; width:340px; max-width:90vw; background:#fff; border:1px solid #e2e8f0; border-radius:16px; box-shadow:0 8px 28px -4px rgba(0,0,0,.18),0 4px 12px -2px rgba(0,0,0,.12); display:flex; flex-direction:column; font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif; z-index:3000; animation:chatIn .35s cubic-bezier(.4,.2,.2,1); max-height:70vh; min-height:300px; }\n        @keyframes chatIn { from { opacity:0; transform:translateY(12px) scale(.96);} to { opacity:1; transform:translateY(0) scale(1);} }\n        .ai-chatbox-header { background:#f59f00; color:#fff; padding:10px 14px; border-radius:16px 16px 0 0; display:flex; align-items:center; justify-content:space-between; font-weight:600; letter-spacing:.3px; }\n        .ai-chatbox-close { background:transparent; border:none; color:#fff; font-size:20px; line-height:1; cursor:pointer; padding:4px 8px; }\n        .ai-chatbox-body { flex:1; padding:10px 12px 12px; overflow-y:auto; background:#fff; display:flex; flex-direction:column; gap:8px; overscroll-behavior:contain; }\n        /* Scrollbar tu·ª≥ bi·∫øn (WebKit) */\n        .ai-chatbox-body::-webkit-scrollbar { width:8px; }\n        .ai-chatbox-body::-webkit-scrollbar-track { background:transparent; }\n        .ai-chatbox-body::-webkit-scrollbar-thumb { background:#dadfe4; border-radius:4px; }\n        .ai-chatbox-body::-webkit-scrollbar-thumb:hover { background:#c3c9d0; }\n        /* Firefox */\n        .ai-chatbox-body { scrollbar-width:thin; scrollbar-color:#c3c9d0 transparent; }\n        .ai-msg { max-width:80%; padding:8px 12px; border-radius:14px; font-size:14px; line-height:1.4; word-break:break-word; white-space:pre-wrap; }\n        .ai-msg-bot { background:#f1f5f9; color:#111; align-self:flex-start; border:1px solid #e2e8f0; }\n        .ai-msg-user { background:#f59f00; color:#fff; align-self:flex-end; box-shadow:0 2px 4px rgba(0,0,0,0.12); }\n        .ai-msg-bot.loading { opacity:.7; font-style:italic; }\n        .ai-chatbox-input { display:flex; align-items:center; gap:8px; border-top:1px solid #e2e8f0; padding:8px 10px; }\n        .ai-chatbox-input input { flex:1; border:1px solid #d0d7e0; border-radius:10px; padding:8px 10px; font-size:14px; }\n        .ai-chatbox-input input:focus { outline:none; border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.35); }\n        .ai-chatbox-input button { background:#f59f00; color:#fff; border:none; padding:8px 14px; border-radius:10px; font-size:14px; cursor:pointer; font-weight:600; }\n        .ai-chatbox-input button:disabled { opacity:.5; cursor:not-allowed; }\n        .ai-suggest-row { display:flex; flex-wrap:wrap; gap:6px; margin-top:2px; }\n        .ai-suggest-btn { background:#fff; border:1px solid #f59f00; color:#b06900; padding:4px 8px; border-radius:20px; font-size:12px; cursor:pointer; transition:.25s; }\n        .ai-suggest-btn:hover { background:#f59f00; color:#fff; }\n        .ai-results-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:10px; }\n        .ai-room-card { background:#fffaf3; border:1px solid #fbe4c2; border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:6px; position:relative; box-shadow:0 2px 4px rgba(0,0,0,.04); }\n        .ai-room-thumb { width:100%; aspect-ratio:4/3; background:#f5f5f5; border-radius:8px; overflow:hidden; display:flex; align-items:center; justify-content:center; }\n        .ai-room-thumb img { width:100%; height:100%; object-fit:cover; display:block; }\n        .ai-room-name { font-weight:700; font-size:13px; letter-spacing:.2px; }\n        .ai-room-meta { font-size:11px; color:#555; }\n        .ai-room-price { font-size:12px; font-weight:800; color:#c2410c; }\n        .ai-room-book { background:#f59f00; color:#fff; border:none; border-radius:18px; padding:6px 10px; font-size:12px; font-weight:700; cursor:pointer; }\n        .ai-room-book:hover { background:#d97706; }\n  @media (max-width:600px){ .ai-chatbox-wrapper { right:12px; bottom:84px; width:300px; } }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 224,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatBotAI, \"+g4V2Fb5sWl6lDFLm3Uqh9Wns2s=\");\n_c = ChatBotAI;\nvar _c;\n$RefreshReg$(_c, \"ChatBotAI\");","map":{"version":3,"names":["React","useEffect","useRef","useState","authHeaders","getUserEmail","jsxDEV","_jsxDEV","DEFAULT_BOT_GREETING","MAX_HISTORY","LEGACY_MSG_KEY","LEGACY_SESSION_KEY","createWelcomeMessages","role","text","normalizeEmailForKey","email","trimmed","String","trim","toLowerCase","encodeURIComponent","buildMessageKey","normalized","buildSessionKey","loadStoredMessages","key","raw","localStorage","getItem","parsed","JSON","parse","Array","isArray","length","slice","createSessionId","Math","random","toString","Date","now","ensurePersistedSessionId","existing","fallback","stored","setItem","persistSessionId","sessionId","migrateLegacyStorage","session","migratedSession","messageKey","sessionKey","legacyMsgs","removeItem","legacySession","ChatBotAI","open","onClose","_s","userEmail","setUserEmail","messages","setMessages","input","setInput","loading","setLoading","setSessionId","bottomRef","messagesRef","storageKey","current","stringify","prev","nextMessages","syncUser","window","addEventListener","removeEventListener","scrollIntoView","behavior","onEsc","e","document","send","msg","m","lower","fire","name","detail","dispatchEvent","CustomEvent","commandMap","keywords","event","found","find","c","some","k","includes","source","original","res","fetch","method","headers","body","message","ok","Error","j","json","next","reply","results","push","items","suggestions","openBooking","roomName","ev","clickSuggestion","s","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","map","idx","type","it","image","src","alt","maxAdults","maxChildren","rating","price","toLocaleString","id","ref","onSubmit","preventDefault","placeholder","value","onChange","target","onKeyDown","shiftKey","disabled","_c","$RefreshReg$"],"sources":["D:/Git/HMSAI-Hotel/client/src/ChatBotAI.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { authHeaders, getUserEmail } from './auth';\r\nimport './HomePage.css';\r\n\r\nconst DEFAULT_BOT_GREETING = 'Xin ch√†o üëã! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?';\r\nconst MAX_HISTORY = 200;\r\nconst LEGACY_MSG_KEY = 'hmsChatMsgs';\r\nconst LEGACY_SESSION_KEY = 'hmsChatSessionId';\r\n\r\nfunction createWelcomeMessages() {\r\n  return [{ role: 'bot', text: DEFAULT_BOT_GREETING }];\r\n}\r\n\r\nfunction normalizeEmailForKey(email) {\r\n  if (!email) return null;\r\n  const trimmed = String(email).trim().toLowerCase();\r\n  if (!trimmed) return null;\r\n  return encodeURIComponent(trimmed);\r\n}\r\n\r\nfunction buildMessageKey(email) {\r\n  const normalized = normalizeEmailForKey(email);\r\n  return normalized ? `${LEGACY_MSG_KEY}:${normalized}` : null;\r\n}\r\n\r\nfunction buildSessionKey(email) {\r\n  const normalized = normalizeEmailForKey(email);\r\n  return normalized ? `${LEGACY_SESSION_KEY}:${normalized}` : null;\r\n}\r\n\r\nfunction loadStoredMessages(email) {\r\n  const key = buildMessageKey(email);\r\n  if (!key) return createWelcomeMessages();\r\n  try {\r\n    const raw = localStorage.getItem(key);\r\n    if (!raw) return createWelcomeMessages();\r\n    const parsed = JSON.parse(raw);\r\n    if (Array.isArray(parsed) && parsed.length) {\r\n      return parsed.slice(-MAX_HISTORY);\r\n    }\r\n  } catch { /* ignore parse errors */ }\r\n  return createWelcomeMessages();\r\n}\r\n\r\nfunction createSessionId() {\r\n  return `s_${Math.random().toString(36).slice(2, 10)}${Date.now().toString(36).slice(-4)}`;\r\n}\r\n\r\nfunction ensurePersistedSessionId(email, existing) {\r\n  const fallback = existing || createSessionId();\r\n  if (!email) return fallback;\r\n  const key = buildSessionKey(email);\r\n  if (!key) return fallback;\r\n  try {\r\n    const stored = localStorage.getItem(key);\r\n    if (stored) return stored;\r\n    localStorage.setItem(key, fallback);\r\n    return fallback;\r\n  } catch {\r\n    return fallback;\r\n  }\r\n}\r\n\r\nfunction persistSessionId(email, sessionId) {\r\n  if (!email || !sessionId) return;\r\n  const key = buildSessionKey(email);\r\n  if (!key) return;\r\n  try { localStorage.setItem(key, sessionId); } catch { /* ignore */ }\r\n}\r\n\r\nfunction migrateLegacyStorage(email) {\r\n  if (!email) return { session: null };\r\n  let migratedSession = null;\r\n  const messageKey = buildMessageKey(email);\r\n  const sessionKey = buildSessionKey(email);\r\n  try {\r\n    const legacyMsgs = localStorage.getItem(LEGACY_MSG_KEY);\r\n    if (legacyMsgs) {\r\n      if (messageKey && !localStorage.getItem(messageKey)) {\r\n        localStorage.setItem(messageKey, legacyMsgs);\r\n      }\r\n      localStorage.removeItem(LEGACY_MSG_KEY);\r\n    }\r\n    const legacySession = localStorage.getItem(LEGACY_SESSION_KEY);\r\n    if (legacySession) {\r\n      if (sessionKey && !localStorage.getItem(sessionKey)) {\r\n        localStorage.setItem(sessionKey, legacySession);\r\n      }\r\n      localStorage.removeItem(LEGACY_SESSION_KEY);\r\n      migratedSession = legacySession;\r\n    }\r\n  } catch { /* ignore storage errors */ }\r\n  return { session: migratedSession };\r\n}\r\n\r\n/** Simple AI Chatbox Component */\r\nexport default function ChatBotAI({ open, onClose }) {\r\n  const [userEmail, setUserEmail] = useState(() => getUserEmail() || null);\r\n  const [messages, setMessages] = useState(() => loadStoredMessages(getUserEmail() || null));\r\n  const [input, setInput] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [sessionId, setSessionId] = useState(() => ensurePersistedSessionId(getUserEmail() || null, null));\r\n  const bottomRef = useRef(null);\r\n  const messagesRef = useRef(messages); // track latest messages for async updates\r\n\r\n  const storageKey = buildMessageKey(userEmail);\r\n\r\n  useEffect(() => { messagesRef.current = messages; }, [messages]);\r\n\r\n  useEffect(() => {\r\n    if (!storageKey) return;\r\n    try { localStorage.setItem(storageKey, JSON.stringify(messages.slice(-MAX_HISTORY))); } catch {}\r\n  }, [messages, storageKey]);\r\n\r\n  useEffect(() => {\r\n    setSessionId(prev => ensurePersistedSessionId(userEmail, prev));\r\n    const nextMessages = loadStoredMessages(userEmail);\r\n    setMessages(nextMessages);\r\n    messagesRef.current = nextMessages;\r\n  }, [userEmail]);\r\n\r\n  useEffect(() => {\r\n    if (!userEmail) {\r\n      try {\r\n        localStorage.removeItem(LEGACY_MSG_KEY);\r\n        localStorage.removeItem(LEGACY_SESSION_KEY);\r\n      } catch {}\r\n      return;\r\n    }\r\n    const { session: migratedSession } = migrateLegacyStorage(userEmail);\r\n    if (migratedSession) {\r\n      setSessionId(prev => (prev === migratedSession ? prev : migratedSession));\r\n    }\r\n  }, [userEmail]);\r\n\r\n  useEffect(() => {\r\n    if (userEmail && sessionId) persistSessionId(userEmail, sessionId);\r\n  }, [sessionId, userEmail]);\r\n\r\n  useEffect(() => {\r\n    const syncUser = () => {\r\n      const current = getUserEmail() || null;\r\n      setUserEmail(prev => (prev === current ? prev : current));\r\n    };\r\n    syncUser();\r\n    window.addEventListener('focus', syncUser);\r\n    window.addEventListener('storage', syncUser);\r\n    return () => {\r\n      window.removeEventListener('focus', syncUser);\r\n      window.removeEventListener('storage', syncUser);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!open) return;\r\n    const current = getUserEmail() || null;\r\n    setUserEmail(prev => (prev === current ? prev : current));\r\n  }, [open]);\r\n\r\n  useEffect(()=>{ if(bottomRef.current) bottomRef.current.scrollIntoView({ behavior:'smooth' }); }, [messages, open]);\r\n  useEffect(()=>{ const onEsc = (e)=>{ if(e.key==='Escape' && open) onClose && onClose(); }; document.addEventListener('keydown', onEsc); return ()=> document.removeEventListener('keydown', onEsc); }, [open,onClose]);\r\n\r\n  const send = async (text) => {\r\n    const msg = (text ?? input).trim();\r\n    if(!msg || loading) return;\r\n    setInput('');\r\n    setMessages(m => [...m, { role:'user', text: msg }]);\r\n\r\n    // Command parsing (client-side UI open triggers)\r\n    // Vietnamese command patterns: \"m·ªü d·ªãch v·ª•\", \"m·ªü ph√≤ng\", \"m·ªü ti·ªán nghi\", \"m·ªü ƒë√°nh gi√°\", \"m·ªü khuy·∫øn m√£i\", \"m·ªü ƒë·∫∑t ph√≤ng\", etc.\r\n    try {\r\n      const lower = msg.toLowerCase();\r\n      const fire = (name, detail={}) => { try { window.dispatchEvent(new CustomEvent(name,{ detail })); } catch {} };\r\n      const commandMap = [\r\n        { keywords:['m·ªü d·ªãch v·ª•','open service','open services','m·ªü service'], event:'open-services' },\r\n        { keywords:['m·ªü ph√≤ng','open rooms','open room list','m·ªü danh s√°ch ph√≤ng'], event:'open-rooms' },\r\n        { keywords:['m·ªü ti·ªán nghi','open amenities','open amenity'], event:'open-amenities' },\r\n        { keywords:['m·ªü khuy·∫øn m√£i','m·ªü ∆∞u ƒë√£i','open promotions','open promotion'], event:'open-promotions' },\r\n        { keywords:['m·ªü ƒë√°nh gi√°','open reviews','xem ƒë√°nh gi√°'], event:'open-reviews' },\r\n        { keywords:['m·ªü ƒë·∫∑t ph√≤ng','ƒë·∫∑t ph√≤ng ngay','booking now','book now'], event:'open-booking' },\r\n        { keywords:['m·ªü h·ªì s∆°','m·ªü profile','open profile','th√¥ng tin c√° nh√¢n'], event:'open-profile' },\r\n        { keywords:['m·ªü thanh to√°n','xem thanh to√°n','payment history'], event:'open-payments' },\r\n        { keywords:['m·ªü th√¥ng b√°o','xem th√¥ng b√°o','open notifications'], event:'open-notifications' },\r\n      ];\r\n      const found = commandMap.find(c => c.keywords.some(k => lower.includes(k)));\r\n      if (found) {\r\n        fire(found.event, { source:'chatbot', original: msg });\r\n        // Provide a local immediate bot acknowledgement without calling API\r\n        setMessages(m => [...m, { role:'bot', text: 'ƒêang m·ªü giao di·ªán theo y√™u c·∫ßu c·ªßa b·∫°n...' }]);\r\n        return; // skip server request for pure UI command\r\n      }\r\n    } catch {/* ignore command parse errors */}\r\n\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/ai/chat', { method:'POST', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify({ message: msg, sessionId }) });\r\n      if(!res.ok) throw new Error('L·ªói ph·∫£n h·ªìi');\r\n      const j = await res.json();\r\n      const next = [...messagesRef.current, { role:'bot', text: j.reply || '(kh√¥ng c√≥ ph·∫£n h·ªìi)' }];\r\n      if (Array.isArray(j.results) && j.results.length) {\r\n        next.push({ role:'results', items: j.results.slice(0,8) });\r\n      }\r\n      if (Array.isArray(j.suggestions) && j.suggestions.length) {\r\n        next.push({ role:'suggest', suggestions: j.suggestions.slice(0,6) });\r\n      }\r\n      setMessages(next);\r\n    } catch(e){\r\n      setMessages(m => [...m, { role:'bot', text: 'Xin l·ªói, hi·ªán ch∆∞a ph·∫£n h·ªìi ƒë∆∞·ª£c.' }]);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  const openBooking = (roomName) => {\r\n    // Dispatch a custom event to open room type inline / overlay if available\r\n    try {\r\n      const ev = new CustomEvent('open-room-type', { detail: { name: roomName }});\r\n      window.dispatchEvent(ev);\r\n    } catch {}\r\n  };\r\n\r\n  const clickSuggestion = (s) => { send(s); };\r\n\r\n  if(!open) return null;\r\n  return (\r\n    <div className=\"ai-chatbox-wrapper\" role=\"dialog\" aria-label=\"Chat h·ªó tr·ª£ AI\">\r\n      <div className=\"ai-chatbox-header\">\r\n        <div className=\"ai-chatbox-title\">H·ªó tr·ª£ AI</div>\r\n        <button className=\"ai-chatbox-close\" aria-label=\"ƒê√≥ng\" onClick={onClose}>√ó</button>\r\n      </div>\r\n      <div className=\"ai-chatbox-body\">\r\n        {messages.map((m,idx)=> {\r\n          if (m.role==='suggest') {\r\n            return (\r\n              <div key={idx} className=\"ai-suggest-row\">\r\n                {m.suggestions.map(s => <button key={s} type=\"button\" className=\"ai-suggest-btn\" onClick={()=>clickSuggestion(s)}>{s}</button>)}\r\n              </div>\r\n            );\r\n          }\r\n          if (m.role==='results') {\r\n            return (\r\n              <div key={idx} className=\"ai-results-grid\">\r\n                {m.items.map(it => (\r\n                  <div key={it.id} className=\"ai-room-card\">\r\n                    <div className=\"ai-room-thumb\">{it.image ? <img src={it.image} alt={it.name} /> : <div className=\"ph-img-fallback\" />}</div>\r\n                    <div className=\"ai-room-name\">{it.name}</div>\r\n                    <div className=\"ai-room-meta\">{it.maxAdults} NL ‚Ä¢ {it.maxChildren} TE{it.rating ? ` ‚Ä¢ ${it.rating}‚òÖ` : ''}</div>\r\n                    <div className=\"ai-room-price\">{it.price.toLocaleString('vi-VN')}ƒë/ƒë√™m</div>\r\n                    <button type=\"button\" className=\"ai-room-book\" onClick={()=>openBooking(it.name)}>ƒê·∫∑t ph√≤ng</button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            );\r\n          }\r\n          return <div key={idx} className={`ai-msg ai-msg-${m.role}`}>{m.text}</div>;\r\n        })}\r\n        {loading && <div className=\"ai-msg ai-msg-bot loading\">ƒêang g√µ...</div>}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n      <form className=\"ai-chatbox-input\" onSubmit={e=>{ e.preventDefault(); send(); }}>\r\n        <input\r\n          placeholder=\"Nh·∫≠p tin nh·∫Øn...\"\r\n          value={input}\r\n          onChange={e=>setInput(e.target.value)}\r\n          onKeyDown={e=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); send(); } }}\r\n        />\r\n        <button type=\"submit\" disabled={!input.trim() || loading}>G·ª≠i</button>\r\n      </form>\r\n      <style>{`\r\n  .ai-chatbox-wrapper { position:fixed; bottom:108px; right:120px; width:340px; max-width:90vw; background:#fff; border:1px solid #e2e8f0; border-radius:16px; box-shadow:0 8px 28px -4px rgba(0,0,0,.18),0 4px 12px -2px rgba(0,0,0,.12); display:flex; flex-direction:column; font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif; z-index:3000; animation:chatIn .35s cubic-bezier(.4,.2,.2,1); max-height:70vh; min-height:300px; }\r\n        @keyframes chatIn { from { opacity:0; transform:translateY(12px) scale(.96);} to { opacity:1; transform:translateY(0) scale(1);} }\r\n        .ai-chatbox-header { background:#f59f00; color:#fff; padding:10px 14px; border-radius:16px 16px 0 0; display:flex; align-items:center; justify-content:space-between; font-weight:600; letter-spacing:.3px; }\r\n        .ai-chatbox-close { background:transparent; border:none; color:#fff; font-size:20px; line-height:1; cursor:pointer; padding:4px 8px; }\r\n        .ai-chatbox-body { flex:1; padding:10px 12px 12px; overflow-y:auto; background:#fff; display:flex; flex-direction:column; gap:8px; overscroll-behavior:contain; }\r\n        /* Scrollbar tu·ª≥ bi·∫øn (WebKit) */\r\n        .ai-chatbox-body::-webkit-scrollbar { width:8px; }\r\n        .ai-chatbox-body::-webkit-scrollbar-track { background:transparent; }\r\n        .ai-chatbox-body::-webkit-scrollbar-thumb { background:#dadfe4; border-radius:4px; }\r\n        .ai-chatbox-body::-webkit-scrollbar-thumb:hover { background:#c3c9d0; }\r\n        /* Firefox */\r\n        .ai-chatbox-body { scrollbar-width:thin; scrollbar-color:#c3c9d0 transparent; }\r\n        .ai-msg { max-width:80%; padding:8px 12px; border-radius:14px; font-size:14px; line-height:1.4; word-break:break-word; white-space:pre-wrap; }\r\n        .ai-msg-bot { background:#f1f5f9; color:#111; align-self:flex-start; border:1px solid #e2e8f0; }\r\n        .ai-msg-user { background:#f59f00; color:#fff; align-self:flex-end; box-shadow:0 2px 4px rgba(0,0,0,0.12); }\r\n        .ai-msg-bot.loading { opacity:.7; font-style:italic; }\r\n        .ai-chatbox-input { display:flex; align-items:center; gap:8px; border-top:1px solid #e2e8f0; padding:8px 10px; }\r\n        .ai-chatbox-input input { flex:1; border:1px solid #d0d7e0; border-radius:10px; padding:8px 10px; font-size:14px; }\r\n        .ai-chatbox-input input:focus { outline:none; border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.35); }\r\n        .ai-chatbox-input button { background:#f59f00; color:#fff; border:none; padding:8px 14px; border-radius:10px; font-size:14px; cursor:pointer; font-weight:600; }\r\n        .ai-chatbox-input button:disabled { opacity:.5; cursor:not-allowed; }\r\n        .ai-suggest-row { display:flex; flex-wrap:wrap; gap:6px; margin-top:2px; }\r\n        .ai-suggest-btn { background:#fff; border:1px solid #f59f00; color:#b06900; padding:4px 8px; border-radius:20px; font-size:12px; cursor:pointer; transition:.25s; }\r\n        .ai-suggest-btn:hover { background:#f59f00; color:#fff; }\r\n        .ai-results-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:10px; }\r\n        .ai-room-card { background:#fffaf3; border:1px solid #fbe4c2; border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:6px; position:relative; box-shadow:0 2px 4px rgba(0,0,0,.04); }\r\n        .ai-room-thumb { width:100%; aspect-ratio:4/3; background:#f5f5f5; border-radius:8px; overflow:hidden; display:flex; align-items:center; justify-content:center; }\r\n        .ai-room-thumb img { width:100%; height:100%; object-fit:cover; display:block; }\r\n        .ai-room-name { font-weight:700; font-size:13px; letter-spacing:.2px; }\r\n        .ai-room-meta { font-size:11px; color:#555; }\r\n        .ai-room-price { font-size:12px; font-weight:800; color:#c2410c; }\r\n        .ai-room-book { background:#f59f00; color:#fff; border:none; border-radius:18px; padding:6px 10px; font-size:12px; font-weight:700; cursor:pointer; }\r\n        .ai-room-book:hover { background:#d97706; }\r\n  @media (max-width:600px){ .ai-chatbox-wrapper { right:12px; bottom:84px; width:300px; } }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}