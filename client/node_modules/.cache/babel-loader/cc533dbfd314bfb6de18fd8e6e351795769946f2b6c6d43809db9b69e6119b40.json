{"ast":null,"code":"var _jsxFileName = \"D:\\\\DA_TichHop\\\\HMS_AI Hotel\\\\client\\\\src\\\\ChatBotAI.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { authHeaders, getUserEmail } from './auth';\nimport './HomePage.css';\n\n/** Simple AI Chatbox Component */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChatBotAI({\n  open,\n  onClose\n}) {\n  _s();\n  // L·∫•y email hi·ªán t·∫°i (ho·∫∑c guest n·∫øu ch∆∞a ƒëƒÉng nh·∫≠p) ƒë·ªÉ ph√¢n t√°ch d·ªØ li·ªáu chat theo ng∆∞·ªùi d√πng\n  const email = getUserEmail() || 'guest';\n  const MSG_KEY = `hmsChatMsgs_${email}`;\n  const SID_KEY = `hmsChatSessionId_${email}`;\n  const initialBotMsg = {\n    role: 'bot',\n    text: 'Xin ch√†o üëã! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?'\n  };\n  const [messages, setMessages] = useState(() => {\n    try {\n      const raw = localStorage.getItem(MSG_KEY);\n      if (raw) return JSON.parse(raw);\n    } catch {}\n    return [initialBotMsg];\n  });\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  // Wizard state cho ƒë·∫∑t ph√≤ng\n  const [wizard, setWizard] = useState({\n    step: null,\n    roomType: null,\n    rooms: [],\n    selectedRoomId: null,\n    checkIn: '',\n    checkOut: '',\n    adults: 1,\n    children: 0,\n    creating: false,\n    error: null,\n    bookingId: null\n  });\n  const [sessionId, setSessionId] = useState(() => {\n    try {\n      const existing = localStorage.getItem(SID_KEY);\n      if (existing) return existing;\n    } catch {}\n    const sid = 's_' + Math.random().toString(36).slice(2, 10);\n    try {\n      localStorage.setItem(SID_KEY, sid);\n    } catch {}\n    return sid;\n  });\n  const bottomRef = useRef(null);\n\n  // L∆∞u l·ªãch s·ª≠ theo key ri√™ng cho user\n  useEffect(() => {\n    try {\n      localStorage.setItem(MSG_KEY, JSON.stringify(messages.slice(-200)));\n    } catch {}\n  }, [messages, MSG_KEY]);\n\n  // ƒê·ªìng b·ªô server: t·∫£i l·ªãch s·ª≠ khi mount (ch·ªâ khi c√≥ email ƒëƒÉng nh·∫≠p)\n  useEffect(() => {\n    if (email === 'guest') return; // b·ªè qua kh√°ch\n    let aborted = false;\n    (async () => {\n      try {\n        const res = await fetch('/api/ai/chat/history', {\n          headers: {\n            ...authHeaders()\n          }\n        });\n        if (!res.ok) return;\n        const j = await res.json();\n        if (aborted) return;\n        if (Array.isArray(j.messages) && j.messages.length) {\n          // H·ª£p nh·∫•t n·∫øu local r·ªóng ho·∫∑c ch·ªâ ch·ª©a tin nh·∫Øn ch√†o\n          const localCount = messagesRef.current.filter(m => m.role === 'user' || m.role === 'bot').length;\n          if (localCount <= 1) {\n            setMessages(j.messages);\n          }\n          if (j.sessionId) {\n            setSessionId(j.sessionId);\n            try {\n              localStorage.setItem(SID_KEY, j.sessionId);\n            } catch {}\n          }\n        }\n      } catch {}\n    })();\n    return () => {\n      aborted = true;\n    };\n  }, [email, SID_KEY]);\n\n  // Debounce l∆∞u server khi messages thay ƒë·ªïi (b·ªè qua guest + ch·ªâ khi c√≥ >=1 user message)\n  useEffect(() => {\n    if (email === 'guest') return;\n    const coreMsgs = messages.filter(m => m.role === 'user' || m.role === 'bot');\n    if (!coreMsgs.length) return;\n    const h = setTimeout(() => {\n      try {\n        fetch('/api/ai/chat/history', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            ...authHeaders()\n          },\n          body: JSON.stringify({\n            messages: coreMsgs,\n            sessionId\n          })\n        });\n      } catch {}\n    }, 600);\n    return () => clearTimeout(h);\n  }, [messages, email, sessionId]);\n\n  // Migration: x√≥a key c≈© kh√¥ng ph√¢n t√°ch n·∫øu c√≤n (tr√°nh leak gi·ªØa user)\n  useEffect(() => {\n    try {\n      localStorage.removeItem('hmsChatMsgs');\n      localStorage.removeItem('hmsChatSessionId');\n    } catch {}\n  }, []);\n\n  // N·∫øu l√Ω do n√†o ƒë√≥ email thay ƒë·ªïi trong khi component c√≤n mount (hi·∫øm), reset l·∫°i state t·ªëi thi·ªÉu\n  const emailRef = useRef(email);\n  useEffect(() => {\n    if (emailRef.current !== email) {\n      emailRef.current = email;\n      setMessages([initialBotMsg]);\n      const sid = 's_' + Math.random().toString(36).slice(2, 10);\n      setSessionId(sid);\n      try {\n        localStorage.setItem(`hmsChatSessionId_${email}`, sid);\n      } catch {}\n    }\n  }, [email]);\n  useEffect(() => {\n    if (bottomRef.current) bottomRef.current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages, open]);\n  useEffect(() => {\n    const onEsc = e => {\n      if (e.key === 'Escape' && open) onClose && onClose();\n    };\n    document.addEventListener('keydown', onEsc);\n    return () => document.removeEventListener('keydown', onEsc);\n  }, [open, onClose]);\n  const send = async text => {\n    const msg = (text !== null && text !== void 0 ? text : input).trim();\n    if (!msg || loading) return;\n    setInput('');\n    setMessages(m => [...m, {\n      role: 'user',\n      text: msg\n    }]);\n    setLoading(true);\n    try {\n      const res = await fetch('/api/ai/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify({\n          message: msg,\n          sessionId\n        })\n      });\n      if (!res.ok) throw new Error('L·ªói ph·∫£n h·ªìi');\n      const j = await res.json();\n      const next = [...messagesRef.current, {\n        role: 'bot',\n        text: j.reply || '(kh√¥ng c√≥ ph·∫£n h·ªìi)'\n      }];\n      if (Array.isArray(j.results) && j.results.length) {\n        next.push({\n          role: 'results',\n          items: j.results.slice(0, 8)\n        });\n      }\n      if (Array.isArray(j.suggestions) && j.suggestions.length) {\n        next.push({\n          role: 'suggest',\n          suggestions: j.suggestions.slice(0, 6)\n        });\n      }\n      setMessages(next);\n    } catch (e) {\n      setMessages(m => [...m, {\n        role: 'bot',\n        text: 'Xin l·ªói, hi·ªán ch∆∞a ph·∫£n h·ªìi ƒë∆∞·ª£c.'\n      }]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Keep a ref of messages to build new arrays cleanly in async\n  const messagesRef = useRef(messages);\n  useEffect(() => {\n    messagesRef.current = messages;\n  }, [messages]);\n  const openBooking = roomName => {\n    // Thay v√¨ ch·ªâ dispatch event, m·ªü wizard n·ªôi b·ªô\n    setWizard(w => ({\n      ...w,\n      step: 'loadingType',\n      roomType: null,\n      rooms: [],\n      selectedRoomId: null,\n      bookingId: null,\n      error: null\n    }));\n    (async () => {\n      try {\n        const res = await fetch(`/api/ai/room-type-info?name=${encodeURIComponent(roomName)}`, {\n          headers: {\n            ...authHeaders()\n          }\n        });\n        if (!res.ok) {\n          throw new Error('Kh√¥ng t·∫£i ƒë∆∞·ª£c h·∫°ng ph√≤ng');\n        }\n        const j = await res.json();\n        setWizard(w => ({\n          ...w,\n          step: 'selectRoom',\n          roomType: j.roomType,\n          rooms: j.rooms || [],\n          selectedRoomId: null\n        }));\n      } catch (e) {\n        setWizard(w => ({\n          ...w,\n          step: 'error',\n          error: e.message || 'L·ªói t·∫£i d·ªØ li·ªáu'\n        }));\n      }\n    })();\n  };\n  const clickSuggestion = s => {\n    send(s);\n  };\n  const submitBooking = async () => {\n    if (wizard.creating) return;\n    const {\n      selectedRoomId,\n      checkIn,\n      checkOut,\n      adults,\n      children\n    } = wizard;\n    if (!selectedRoomId || !checkIn || !checkOut) {\n      setWizard(w => ({\n        ...w,\n        error: 'Vui l√≤ng ch·ªçn ph√≤ng v√† nh·∫≠p ng√†y'\n      }));\n      return;\n    }\n    if (email === 'guest') {\n      setWizard(w => ({\n        ...w,\n        error: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ ƒë·∫∑t ph√≤ng'\n      }));\n      return;\n    }\n    setWizard(w => ({\n      ...w,\n      creating: true,\n      error: null\n    }));\n    try {\n      const body = {\n        roomId: selectedRoomId,\n        checkIn,\n        checkOut,\n        adults: Number(adults || 1),\n        children: Number(children || 0)\n      };\n      const res = await fetch('/api/ai/book-room', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify(body)\n      });\n      if (!res.ok) {\n        const j = await res.json().catch(() => ({}));\n        throw new Error(j.message || 'L·ªói t·∫°o booking');\n      }\n      const j = await res.json();\n      setWizard(w => ({\n        ...w,\n        step: 'done',\n        creating: false,\n        bookingId: j.bookingId\n      }));\n      setMessages(m => [...m, {\n        role: 'bot',\n        text: `ƒê√£ t·∫°o y√™u c·∫ßu ƒë·∫∑t ph√≤ng (ID ${j.bookingId}) ·ªü tr·∫°ng th√°i Pending. B·∫°n vui l√≤ng ch·ªù x√°c nh·∫≠n.`\n      }]);\n    } catch (e) {\n      setWizard(w => ({\n        ...w,\n        creating: false,\n        error: e.message || 'L·ªói ƒë·∫∑t ph√≤ng'\n      }));\n    }\n  };\n  const resetWizard = () => setWizard({\n    step: null,\n    roomType: null,\n    rooms: [],\n    selectedRoomId: null,\n    checkIn: '',\n    checkOut: '',\n    adults: 1,\n    children: 0,\n    creating: false,\n    error: null,\n    bookingId: null\n  });\n  const wizardUI = () => {\n    var _wizard$roomType, _wizard$roomType2, _wizard$roomType3;\n    if (!wizard.step) return null;\n    if (wizard.step === 'loadingType') return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-wizard-box\",\n      children: \"\\u0110ang t\\u1EA3i h\\u1EA1ng ph\\xF2ng...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 44\n    }, this);\n    if (wizard.step === 'error') return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-wizard-box error\",\n      children: [wizard.error, \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: resetWizard,\n        children: \"\\u0110\\xF3ng\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 90\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 38\n    }, this);\n    if (wizard.step === 'selectRoom') return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-wizard-box\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-wizard-title\",\n        children: [\"Ch\\u1ECDn ph\\xF2ng (\", (_wizard$roomType = wizard.roomType) === null || _wizard$roomType === void 0 ? void 0 : _wizard$roomType.name, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-wizard-rooms\",\n        children: [wizard.rooms.map(r => /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: `wiz-room ${wizard.selectedRoomId === r.id ? 'active' : ''}`,\n          onClick: () => setWizard(w => ({\n            ...w,\n            selectedRoomId: r.id\n          })),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"num\",\n            children: r.number || '#' + r.id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"st\",\n            children: r.status || '?'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this)]\n        }, r.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 13\n        }, this)), !wizard.rooms.length && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty\",\n          children: \"Kh\\xF4ng c\\xF3 ph\\xF2ng thu\\u1ED9c h\\u1EA1ng n\\xE0y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 36\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this), wizard.selectedRoomId && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-wizard-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Ng\\xE0y nh\\u1EADn:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: wizard.checkIn,\n            onChange: e => setWizard(w => ({\n              ...w,\n              checkIn: e.target.value\n            }))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Ng\\xE0y tr\\u1EA3:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: wizard.checkOut,\n            onChange: e => setWizard(w => ({\n              ...w,\n              checkOut: e.target.value\n            }))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Ng\\u01B0\\u1EDDi l\\u1EDBn:\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              min: 1,\n              max: ((_wizard$roomType2 = wizard.roomType) === null || _wizard$roomType2 === void 0 ? void 0 : _wizard$roomType2.maxAdults) || 10,\n              value: wizard.adults,\n              onChange: e => setWizard(w => ({\n                ...w,\n                adults: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 32\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Tr\\u1EBB em:\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              min: 0,\n              max: ((_wizard$roomType3 = wizard.roomType) === null || _wizard$roomType3 === void 0 ? void 0 : _wizard$roomType3.maxChildren) || 10,\n              value: wizard.children,\n              onChange: e => setWizard(w => ({\n                ...w,\n                children: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 13\n        }, this), wizard.error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"err-msg\",\n          children: wizard.error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: submitBooking,\n            disabled: wizard.creating,\n            children: wizard.creating ? 'ƒêang t·∫°o...' : 'X√°c nh·∫≠n ƒë·∫∑t ph√≤ng'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"secondary\",\n            onClick: resetWizard,\n            children: \"H\\u1EE7y\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this);\n    if (wizard.step === 'done') return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-wizard-box success\",\n      children: [\"T\\u1EA1o booking th\\xE0nh c\\xF4ng (ID \", wizard.bookingId, \"). \", /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: resetWizard,\n        children: \"\\u0110\\xF3ng\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 94\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this);\n    return null;\n  };\n  if (!open) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ai-chatbox-wrapper\",\n    role: \"dialog\",\n    \"aria-label\": \"Chat h\\u1ED7 tr\\u1EE3 AI\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-chatbox-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-chatbox-title\",\n        children: \"H\\u1ED7 tr\\u1EE3 AI\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ai-chatbox-close\",\n        \"aria-label\": \"\\u0110\\xF3ng\",\n        onClick: onClose,\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-chatbox-body\",\n      children: [wizardUI(), messages.map((m, idx) => {\n        if (m.role === 'suggest') {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ai-suggest-row\",\n            children: m.suggestions.map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"ai-suggest-btn\",\n              onClick: () => clickSuggestion(s),\n              children: s\n            }, s, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 41\n            }, this))\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 15\n          }, this);\n        }\n        if (m.role === 'results') {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ai-results-grid\",\n            children: m.items.map(it => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ai-room-card\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-thumb\",\n                children: it.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: it.image,\n                  alt: it.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 64\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"ph-img-fallback\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 103\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-name\",\n                children: it.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-meta\",\n                children: [it.maxAdults, \" NL \\u2022 \", it.maxChildren, \" TE\", it.rating ? ` ‚Ä¢ ${it.rating}‚òÖ` : '']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ai-room-price\",\n                children: [it.price.toLocaleString('vi-VN'), \"\\u0111/\\u0111\\xEAm\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"ai-room-book\",\n                onClick: () => openBooking(it.name),\n                children: \"\\u0110\\u1EB7t ph\\xF2ng\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 209,\n                columnNumber: 21\n              }, this)]\n            }, it.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 19\n            }, this))\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 15\n          }, this);\n        }\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `ai-msg ai-msg-${m.role}`,\n          children: m.text\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 18\n        }, this);\n      }), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ai-msg ai-msg-bot loading\",\n        children: \"\\u0110ang g\\xF5...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: bottomRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"ai-chatbox-input\",\n      onSubmit: e => {\n        e.preventDefault();\n        send();\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Nh\\u1EADp tin nh\\u1EAFn...\",\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyDown: e => {\n          if (e.key === 'Enter' && !e.shiftKey) {\n            e.preventDefault();\n            send();\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !input.trim() || loading,\n        children: \"G\\u1EEDi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n  .ai-chatbox-wrapper { position:fixed; bottom:108px; right:120px; width:340px; max-width:90vw; background:#fff; border:1px solid #e2e8f0; border-radius:16px; box-shadow:0 8px 28px -4px rgba(0,0,0,.18),0 4px 12px -2px rgba(0,0,0,.12); display:flex; flex-direction:column; font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif; z-index:3000; animation:chatIn .35s cubic-bezier(.4,.2,.2,1); max-height:70vh; min-height:300px; }\n        @keyframes chatIn { from { opacity:0; transform:translateY(12px) scale(.96);} to { opacity:1; transform:translateY(0) scale(1);} }\n        .ai-chatbox-header { background:#f59f00; color:#fff; padding:10px 14px; border-radius:16px 16px 0 0; display:flex; align-items:center; justify-content:space-between; font-weight:600; letter-spacing:.3px; }\n        .ai-chatbox-close { background:transparent; border:none; color:#fff; font-size:20px; line-height:1; cursor:pointer; padding:4px 8px; }\n        .ai-chatbox-body { flex:1; padding:10px 12px 12px; overflow-y:auto; background:#fff; display:flex; flex-direction:column; gap:8px; overscroll-behavior:contain; }\n        /* Scrollbar tu·ª≥ bi·∫øn (WebKit) */\n        .ai-chatbox-body::-webkit-scrollbar { width:8px; }\n        .ai-chatbox-body::-webkit-scrollbar-track { background:transparent; }\n        .ai-chatbox-body::-webkit-scrollbar-thumb { background:#dadfe4; border-radius:4px; }\n        .ai-chatbox-body::-webkit-scrollbar-thumb:hover { background:#c3c9d0; }\n        /* Firefox */\n        .ai-chatbox-body { scrollbar-width:thin; scrollbar-color:#c3c9d0 transparent; }\n        .ai-msg { max-width:80%; padding:8px 12px; border-radius:14px; font-size:14px; line-height:1.4; word-break:break-word; white-space:pre-wrap; }\n        .ai-msg-bot { background:#f1f5f9; color:#111; align-self:flex-start; border:1px solid #e2e8f0; }\n        .ai-msg-user { background:#f59f00; color:#fff; align-self:flex-end; box-shadow:0 2px 4px rgba(0,0,0,0.12); }\n        .ai-msg-bot.loading { opacity:.7; font-style:italic; }\n        .ai-chatbox-input { display:flex; align-items:center; gap:8px; border-top:1px solid #e2e8f0; padding:8px 10px; }\n        .ai-chatbox-input input { flex:1; border:1px solid #d0d7e0; border-radius:10px; padding:8px 10px; font-size:14px; }\n        .ai-chatbox-input input:focus { outline:none; border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.35); }\n        .ai-chatbox-input button { background:#f59f00; color:#fff; border:none; padding:8px 14px; border-radius:10px; font-size:14px; cursor:pointer; font-weight:600; }\n        .ai-chatbox-input button:disabled { opacity:.5; cursor:not-allowed; }\n        .ai-suggest-row { display:flex; flex-wrap:wrap; gap:6px; margin-top:2px; }\n        .ai-suggest-btn { background:#fff; border:1px solid #f59f00; color:#b06900; padding:4px 8px; border-radius:20px; font-size:12px; cursor:pointer; transition:.25s; }\n        .ai-suggest-btn:hover { background:#f59f00; color:#fff; }\n        .ai-results-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:10px; }\n        .ai-room-card { background:#fffaf3; border:1px solid #fbe4c2; border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:6px; position:relative; box-shadow:0 2px 4px rgba(0,0,0,.04); }\n        .ai-room-thumb { width:100%; aspect-ratio:4/3; background:#f5f5f5; border-radius:8px; overflow:hidden; display:flex; align-items:center; justify-content:center; }\n        .ai-room-thumb img { width:100%; height:100%; object-fit:cover; display:block; }\n        .ai-room-name { font-weight:700; font-size:13px; letter-spacing:.2px; }\n        .ai-room-meta { font-size:11px; color:#555; }\n        .ai-room-price { font-size:12px; font-weight:800; color:#c2410c; }\n        .ai-room-book { background:#f59f00; color:#fff; border:none; border-radius:18px; padding:6px 10px; font-size:12px; font-weight:700; cursor:pointer; }\n        .ai-room-book:hover { background:#d97706; }\n  /* Wizard styles */\n  .ai-wizard-box { border:1px solid #f0eadc; background:#fffef9; padding:10px 12px; border-radius:12px; font-size:13px; display:flex; flex-direction:column; gap:8px; animation:fadeIn .25s ease; }\n  .ai-wizard-box.error { border-color:#fcd2d2; background:#fff6f6; }\n  .ai-wizard-box.success { border-color:#c5f0c8; background:#f4fff5; }\n  .ai-wizard-title { font-weight:700; font-size:14px; }\n  .ai-wizard-rooms { display:flex; flex-wrap:wrap; gap:6px; max-height:140px; overflow:auto; }\n  .wiz-room { background:#fff; border:1px solid #e2e2e2; border-radius:8px; padding:6px 8px; display:flex; flex-direction:column; align-items:flex-start; gap:2px; cursor:pointer; min-width:60px; position:relative; font-size:11px; }\n  .wiz-room.active { border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.25); }\n  .wiz-room .num { font-weight:600; }\n  .wiz-room .st { font-size:10px; color:#666; }\n  .ai-wizard-form { display:flex; flex-direction:column; gap:6px; }\n  .ai-wizard-form label { display:flex; flex-direction:column; gap:2px; font-size:11px; font-weight:600; }\n  .ai-wizard-form input[type=date], .ai-wizard-form input[type=number]{ padding:4px 6px; border:1px solid #d0d7e0; border-radius:6px; font-size:12px; }\n  .ai-wizard-form input:focus { outline:none; border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.25); }\n  .ai-wizard-form .row2 { display:flex; gap:8px; }\n  .ai-wizard-form .actions { display:flex; gap:8px; }\n  .ai-wizard-form .actions button { flex:1; border:none; background:#f59f00; color:#fff; padding:8px 10px; border-radius:8px; font-size:12px; font-weight:600; cursor:pointer; }\n  .ai-wizard-form .actions button.secondary { background:#e2e8f0; color:#222; }\n  .ai-wizard-form .err-msg { color:#b42318; font-size:11px; font-weight:600; }\n  @keyframes fadeIn { from { opacity:0; transform:translateY(4px);} to { opacity:1; transform:translateY(0);} }\n  @media (max-width:600px){ .ai-chatbox-wrapper { right:12px; bottom:84px; width:300px; } }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 185,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatBotAI, \"bKdAw65Lrm5ZU7PbuWrLKHPNpSo=\");\n_c = ChatBotAI;\nvar _c;\n$RefreshReg$(_c, \"ChatBotAI\");","map":{"version":3,"names":["React","useEffect","useRef","useState","authHeaders","getUserEmail","jsxDEV","_jsxDEV","ChatBotAI","open","onClose","_s","email","MSG_KEY","SID_KEY","initialBotMsg","role","text","messages","setMessages","raw","localStorage","getItem","JSON","parse","input","setInput","loading","setLoading","wizard","setWizard","step","roomType","rooms","selectedRoomId","checkIn","checkOut","adults","children","creating","error","bookingId","sessionId","setSessionId","existing","sid","Math","random","toString","slice","setItem","bottomRef","stringify","aborted","res","fetch","headers","ok","j","json","Array","isArray","length","localCount","messagesRef","current","filter","m","coreMsgs","h","setTimeout","method","body","clearTimeout","removeItem","emailRef","scrollIntoView","behavior","onEsc","e","key","document","addEventListener","removeEventListener","send","msg","trim","message","Error","next","reply","results","push","items","suggestions","openBooking","roomName","w","encodeURIComponent","clickSuggestion","s","submitBooking","roomId","Number","catch","resetWizard","wizardUI","_wizard$roomType","_wizard$roomType2","_wizard$roomType3","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","name","map","r","type","id","number","status","value","onChange","target","min","max","maxAdults","maxChildren","disabled","idx","it","image","src","alt","rating","price","toLocaleString","ref","onSubmit","preventDefault","placeholder","onKeyDown","shiftKey","_c","$RefreshReg$"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/ChatBotAI.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { authHeaders, getUserEmail } from './auth';\r\nimport './HomePage.css';\r\n\r\n/** Simple AI Chatbox Component */\r\nexport default function ChatBotAI({ open, onClose }) {\r\n  // L·∫•y email hi·ªán t·∫°i (ho·∫∑c guest n·∫øu ch∆∞a ƒëƒÉng nh·∫≠p) ƒë·ªÉ ph√¢n t√°ch d·ªØ li·ªáu chat theo ng∆∞·ªùi d√πng\r\n  const email = getUserEmail() || 'guest';\r\n  const MSG_KEY = `hmsChatMsgs_${email}`;\r\n  const SID_KEY = `hmsChatSessionId_${email}`;\r\n  const initialBotMsg = { role: 'bot', text: 'Xin ch√†o üëã! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?' };\r\n  const [messages, setMessages] = useState(() => {\r\n    try { const raw = localStorage.getItem(MSG_KEY); if (raw) return JSON.parse(raw); } catch {}\r\n    return [initialBotMsg];\r\n  });\r\n  const [input, setInput] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  // Wizard state cho ƒë·∫∑t ph√≤ng\r\n  const [wizard, setWizard] = useState({ step:null, roomType:null, rooms:[], selectedRoomId:null, checkIn:'', checkOut:'', adults:1, children:0, creating:false, error:null, bookingId:null });\r\n  const [sessionId, setSessionId] = useState(()=>{\r\n    try { const existing = localStorage.getItem(SID_KEY); if (existing) return existing; } catch {}\r\n    const sid = 's_' + Math.random().toString(36).slice(2,10);\r\n    try { localStorage.setItem(SID_KEY, sid); } catch {}\r\n    return sid;\r\n  });\r\n  const bottomRef = useRef(null);\r\n\r\n  // L∆∞u l·ªãch s·ª≠ theo key ri√™ng cho user\r\n  useEffect(()=>{ try { localStorage.setItem(MSG_KEY, JSON.stringify(messages.slice(-200))); } catch {} }, [messages, MSG_KEY]);\r\n\r\n  // ƒê·ªìng b·ªô server: t·∫£i l·ªãch s·ª≠ khi mount (ch·ªâ khi c√≥ email ƒëƒÉng nh·∫≠p)\r\n  useEffect(()=>{\r\n    if(email === 'guest') return; // b·ªè qua kh√°ch\r\n    let aborted = false;\r\n    (async ()=>{\r\n      try {\r\n        const res = await fetch('/api/ai/chat/history', { headers: { ...authHeaders() } });\r\n        if(!res.ok) return;\r\n        const j = await res.json();\r\n        if(aborted) return;\r\n        if (Array.isArray(j.messages) && j.messages.length) {\r\n          // H·ª£p nh·∫•t n·∫øu local r·ªóng ho·∫∑c ch·ªâ ch·ª©a tin nh·∫Øn ch√†o\r\n          const localCount = messagesRef.current.filter(m=>m.role==='user'||m.role==='bot').length;\r\n          if(localCount <= 1){\r\n            setMessages(j.messages);\r\n          }\r\n          if(j.sessionId){ setSessionId(j.sessionId); try { localStorage.setItem(SID_KEY, j.sessionId); } catch {} }\r\n        }\r\n      } catch {}\r\n    })();\r\n    return ()=>{ aborted = true; };\r\n  }, [email, SID_KEY]);\r\n\r\n  // Debounce l∆∞u server khi messages thay ƒë·ªïi (b·ªè qua guest + ch·ªâ khi c√≥ >=1 user message)\r\n  useEffect(()=>{\r\n    if(email==='guest') return;\r\n    const coreMsgs = messages.filter(m=>m.role==='user'||m.role==='bot');\r\n    if(!coreMsgs.length) return;\r\n    const h = setTimeout(()=>{\r\n      try {\r\n        fetch('/api/ai/chat/history', { method:'POST', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify({ messages: coreMsgs, sessionId }) });\r\n      } catch {}\r\n    }, 600);\r\n    return ()=> clearTimeout(h);\r\n  }, [messages, email, sessionId]);\r\n\r\n  // Migration: x√≥a key c≈© kh√¥ng ph√¢n t√°ch n·∫øu c√≤n (tr√°nh leak gi·ªØa user)\r\n  useEffect(()=>{ try { localStorage.removeItem('hmsChatMsgs'); localStorage.removeItem('hmsChatSessionId'); } catch {} }, []);\r\n\r\n  // N·∫øu l√Ω do n√†o ƒë√≥ email thay ƒë·ªïi trong khi component c√≤n mount (hi·∫øm), reset l·∫°i state t·ªëi thi·ªÉu\r\n  const emailRef = useRef(email);\r\n  useEffect(()=>{\r\n    if(emailRef.current !== email){\r\n      emailRef.current = email;\r\n      setMessages([initialBotMsg]);\r\n      const sid = 's_' + Math.random().toString(36).slice(2,10);\r\n      setSessionId(sid);\r\n      try { localStorage.setItem(`hmsChatSessionId_${email}`, sid); } catch {}\r\n    }\r\n  },[email]);\r\n  useEffect(()=>{ if(bottomRef.current) bottomRef.current.scrollIntoView({ behavior:'smooth' }); }, [messages, open]);\r\n  useEffect(()=>{ const onEsc = (e)=>{ if(e.key==='Escape' && open) onClose && onClose(); }; document.addEventListener('keydown', onEsc); return ()=> document.removeEventListener('keydown', onEsc); }, [open,onClose]);\r\n\r\n  const send = async (text) => {\r\n    const msg = (text ?? input).trim();\r\n    if(!msg || loading) return;\r\n    setInput('');\r\n    setMessages(m => [...m, { role:'user', text: msg }]);\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/ai/chat', { method:'POST', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify({ message: msg, sessionId }) });\r\n      if(!res.ok) throw new Error('L·ªói ph·∫£n h·ªìi');\r\n      const j = await res.json();\r\n      const next = [...messagesRef.current, { role:'bot', text: j.reply || '(kh√¥ng c√≥ ph·∫£n h·ªìi)' }];\r\n      if (Array.isArray(j.results) && j.results.length) {\r\n        next.push({ role:'results', items: j.results.slice(0,8) });\r\n      }\r\n      if (Array.isArray(j.suggestions) && j.suggestions.length) {\r\n        next.push({ role:'suggest', suggestions: j.suggestions.slice(0,6) });\r\n      }\r\n      setMessages(next);\r\n    } catch(e){\r\n      setMessages(m => [...m, { role:'bot', text: 'Xin l·ªói, hi·ªán ch∆∞a ph·∫£n h·ªìi ƒë∆∞·ª£c.' }]);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  // Keep a ref of messages to build new arrays cleanly in async\r\n  const messagesRef = useRef(messages);\r\n  useEffect(()=>{ messagesRef.current = messages; },[messages]);\r\n\r\n  const openBooking = (roomName) => {\r\n    // Thay v√¨ ch·ªâ dispatch event, m·ªü wizard n·ªôi b·ªô\r\n    setWizard(w => ({ ...w, step:'loadingType', roomType:null, rooms:[], selectedRoomId:null, bookingId:null, error:null }));\r\n    (async ()=>{\r\n      try {\r\n        const res = await fetch(`/api/ai/room-type-info?name=${encodeURIComponent(roomName)}`, { headers: { ...authHeaders() } });\r\n        if(!res.ok){ throw new Error('Kh√¥ng t·∫£i ƒë∆∞·ª£c h·∫°ng ph√≤ng'); }\r\n        const j = await res.json();\r\n        setWizard(w => ({ ...w, step:'selectRoom', roomType:j.roomType, rooms:j.rooms||[], selectedRoomId:null }));\r\n      } catch(e){ setWizard(w => ({ ...w, step:'error', error:e.message||'L·ªói t·∫£i d·ªØ li·ªáu' })); }\r\n    })();\r\n  };\r\n\r\n  const clickSuggestion = (s) => { send(s); };\r\n\r\n  const submitBooking = async () => {\r\n    if (wizard.creating) return;\r\n    const { selectedRoomId, checkIn, checkOut, adults, children } = wizard;\r\n    if(!selectedRoomId || !checkIn || !checkOut) { setWizard(w=>({...w,error:'Vui l√≤ng ch·ªçn ph√≤ng v√† nh·∫≠p ng√†y'})); return; }\r\n    if(email==='guest'){ setWizard(w=>({...w,error:'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ ƒë·∫∑t ph√≤ng'})); return; }\r\n    setWizard(w=>({...w, creating:true, error:null }));\r\n    try {\r\n      const body = { roomId:selectedRoomId, checkIn, checkOut, adults:Number(adults||1), children:Number(children||0) };\r\n      const res = await fetch('/api/ai/book-room', { method:'POST', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(body) });\r\n      if(!res.ok){ const j = await res.json().catch(()=>({})); throw new Error(j.message||'L·ªói t·∫°o booking'); }\r\n      const j = await res.json();\r\n      setWizard(w=>({...w, step:'done', creating:false, bookingId:j.bookingId }));\r\n      setMessages(m=>[...m, { role:'bot', text:`ƒê√£ t·∫°o y√™u c·∫ßu ƒë·∫∑t ph√≤ng (ID ${j.bookingId}) ·ªü tr·∫°ng th√°i Pending. B·∫°n vui l√≤ng ch·ªù x√°c nh·∫≠n.` }]);\r\n    } catch(e){ setWizard(w=>({...w, creating:false, error:e.message||'L·ªói ƒë·∫∑t ph√≤ng'})); }\r\n  };\r\n\r\n  const resetWizard = () => setWizard({ step:null, roomType:null, rooms:[], selectedRoomId:null, checkIn:'', checkOut:'', adults:1, children:0, creating:false, error:null, bookingId:null });\r\n\r\n  const wizardUI = () => {\r\n    if(!wizard.step) return null;\r\n    if(wizard.step==='loadingType') return <div className=\"ai-wizard-box\">ƒêang t·∫£i h·∫°ng ph√≤ng...</div>;\r\n    if(wizard.step==='error') return <div className=\"ai-wizard-box error\">{wizard.error} <button onClick={resetWizard}>ƒê√≥ng</button></div>;\r\n    if(wizard.step==='selectRoom') return (\r\n      <div className=\"ai-wizard-box\">\r\n        <div className=\"ai-wizard-title\">Ch·ªçn ph√≤ng ({wizard.roomType?.name})</div>\r\n        <div className=\"ai-wizard-rooms\">\r\n          {wizard.rooms.map(r=> (\r\n            <button type=\"button\" key={r.id} className={`wiz-room ${wizard.selectedRoomId===r.id?'active':''}`} onClick={()=>setWizard(w=>({...w, selectedRoomId:r.id}))}>\r\n              <div className=\"num\">{r.number||('#'+r.id)}</div>\r\n              <div className=\"st\">{r.status||'?'}</div>\r\n            </button>\r\n          ))}\r\n          {!wizard.rooms.length && <div className=\"empty\">Kh√¥ng c√≥ ph√≤ng thu·ªôc h·∫°ng n√†y</div>}\r\n        </div>\r\n        {wizard.selectedRoomId && (\r\n          <div className=\"ai-wizard-form\">\r\n            <label>Ng√†y nh·∫≠n:<input type=\"date\" value={wizard.checkIn} onChange={e=>setWizard(w=>({...w,checkIn:e.target.value}))} /></label>\r\n            <label>Ng√†y tr·∫£:<input type=\"date\" value={wizard.checkOut} onChange={e=>setWizard(w=>({...w,checkOut:e.target.value}))} /></label>\r\n            <div className=\"row2\">\r\n              <label>Ng∆∞·ªùi l·ªõn:<input type=\"number\" min={1} max={wizard.roomType?.maxAdults||10} value={wizard.adults} onChange={e=>setWizard(w=>({...w,adults:e.target.value}))} /></label>\r\n              <label>Tr·∫ª em:<input type=\"number\" min={0} max={wizard.roomType?.maxChildren||10} value={wizard.children} onChange={e=>setWizard(w=>({...w,children:e.target.value}))} /></label>\r\n            </div>\r\n            {wizard.error && <div className=\"err-msg\">{wizard.error}</div>}\r\n            <div className=\"actions\">\r\n              <button type=\"button\" onClick={submitBooking} disabled={wizard.creating}>{wizard.creating?'ƒêang t·∫°o...':'X√°c nh·∫≠n ƒë·∫∑t ph√≤ng'}</button>\r\n              <button type=\"button\" className=\"secondary\" onClick={resetWizard}>H·ªßy</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n    if(wizard.step==='done') return (\r\n      <div className=\"ai-wizard-box success\">T·∫°o booking th√†nh c√¥ng (ID {wizard.bookingId}). <button onClick={resetWizard}>ƒê√≥ng</button></div>\r\n    );\r\n    return null;\r\n  };\r\n\r\n  if(!open) return null;\r\n  return (\r\n    <div className=\"ai-chatbox-wrapper\" role=\"dialog\" aria-label=\"Chat h·ªó tr·ª£ AI\">\r\n      <div className=\"ai-chatbox-header\">\r\n        <div className=\"ai-chatbox-title\">H·ªó tr·ª£ AI</div>\r\n        <button className=\"ai-chatbox-close\" aria-label=\"ƒê√≥ng\" onClick={onClose}>√ó</button>\r\n      </div>\r\n      <div className=\"ai-chatbox-body\">\r\n        {wizardUI()}\r\n        {messages.map((m,idx)=> {\r\n          if (m.role==='suggest') {\r\n            return (\r\n              <div key={idx} className=\"ai-suggest-row\">\r\n                {m.suggestions.map(s => <button key={s} type=\"button\" className=\"ai-suggest-btn\" onClick={()=>clickSuggestion(s)}>{s}</button>)}\r\n              </div>\r\n            );\r\n          }\r\n          if (m.role==='results') {\r\n            return (\r\n              <div key={idx} className=\"ai-results-grid\">\r\n                {m.items.map(it => (\r\n                  <div key={it.id} className=\"ai-room-card\">\r\n                    <div className=\"ai-room-thumb\">{it.image ? <img src={it.image} alt={it.name} /> : <div className=\"ph-img-fallback\" />}</div>\r\n                    <div className=\"ai-room-name\">{it.name}</div>\r\n                    <div className=\"ai-room-meta\">{it.maxAdults} NL ‚Ä¢ {it.maxChildren} TE{it.rating ? ` ‚Ä¢ ${it.rating}‚òÖ` : ''}</div>\r\n                    <div className=\"ai-room-price\">{it.price.toLocaleString('vi-VN')}ƒë/ƒë√™m</div>\r\n                    <button type=\"button\" className=\"ai-room-book\" onClick={()=>openBooking(it.name)}>ƒê·∫∑t ph√≤ng</button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            );\r\n          }\r\n          return <div key={idx} className={`ai-msg ai-msg-${m.role}`}>{m.text}</div>;\r\n        })}\r\n        {loading && <div className=\"ai-msg ai-msg-bot loading\">ƒêang g√µ...</div>}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n      <form className=\"ai-chatbox-input\" onSubmit={e=>{ e.preventDefault(); send(); }}>\r\n        <input\r\n          placeholder=\"Nh·∫≠p tin nh·∫Øn...\"\r\n          value={input}\r\n          onChange={e=>setInput(e.target.value)}\r\n          onKeyDown={e=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); send(); } }}\r\n        />\r\n        <button type=\"submit\" disabled={!input.trim() || loading}>G·ª≠i</button>\r\n      </form>\r\n      <style>{`\r\n  .ai-chatbox-wrapper { position:fixed; bottom:108px; right:120px; width:340px; max-width:90vw; background:#fff; border:1px solid #e2e8f0; border-radius:16px; box-shadow:0 8px 28px -4px rgba(0,0,0,.18),0 4px 12px -2px rgba(0,0,0,.12); display:flex; flex-direction:column; font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif; z-index:3000; animation:chatIn .35s cubic-bezier(.4,.2,.2,1); max-height:70vh; min-height:300px; }\r\n        @keyframes chatIn { from { opacity:0; transform:translateY(12px) scale(.96);} to { opacity:1; transform:translateY(0) scale(1);} }\r\n        .ai-chatbox-header { background:#f59f00; color:#fff; padding:10px 14px; border-radius:16px 16px 0 0; display:flex; align-items:center; justify-content:space-between; font-weight:600; letter-spacing:.3px; }\r\n        .ai-chatbox-close { background:transparent; border:none; color:#fff; font-size:20px; line-height:1; cursor:pointer; padding:4px 8px; }\r\n        .ai-chatbox-body { flex:1; padding:10px 12px 12px; overflow-y:auto; background:#fff; display:flex; flex-direction:column; gap:8px; overscroll-behavior:contain; }\r\n        /* Scrollbar tu·ª≥ bi·∫øn (WebKit) */\r\n        .ai-chatbox-body::-webkit-scrollbar { width:8px; }\r\n        .ai-chatbox-body::-webkit-scrollbar-track { background:transparent; }\r\n        .ai-chatbox-body::-webkit-scrollbar-thumb { background:#dadfe4; border-radius:4px; }\r\n        .ai-chatbox-body::-webkit-scrollbar-thumb:hover { background:#c3c9d0; }\r\n        /* Firefox */\r\n        .ai-chatbox-body { scrollbar-width:thin; scrollbar-color:#c3c9d0 transparent; }\r\n        .ai-msg { max-width:80%; padding:8px 12px; border-radius:14px; font-size:14px; line-height:1.4; word-break:break-word; white-space:pre-wrap; }\r\n        .ai-msg-bot { background:#f1f5f9; color:#111; align-self:flex-start; border:1px solid #e2e8f0; }\r\n        .ai-msg-user { background:#f59f00; color:#fff; align-self:flex-end; box-shadow:0 2px 4px rgba(0,0,0,0.12); }\r\n        .ai-msg-bot.loading { opacity:.7; font-style:italic; }\r\n        .ai-chatbox-input { display:flex; align-items:center; gap:8px; border-top:1px solid #e2e8f0; padding:8px 10px; }\r\n        .ai-chatbox-input input { flex:1; border:1px solid #d0d7e0; border-radius:10px; padding:8px 10px; font-size:14px; }\r\n        .ai-chatbox-input input:focus { outline:none; border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.35); }\r\n        .ai-chatbox-input button { background:#f59f00; color:#fff; border:none; padding:8px 14px; border-radius:10px; font-size:14px; cursor:pointer; font-weight:600; }\r\n        .ai-chatbox-input button:disabled { opacity:.5; cursor:not-allowed; }\r\n        .ai-suggest-row { display:flex; flex-wrap:wrap; gap:6px; margin-top:2px; }\r\n        .ai-suggest-btn { background:#fff; border:1px solid #f59f00; color:#b06900; padding:4px 8px; border-radius:20px; font-size:12px; cursor:pointer; transition:.25s; }\r\n        .ai-suggest-btn:hover { background:#f59f00; color:#fff; }\r\n        .ai-results-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:10px; }\r\n        .ai-room-card { background:#fffaf3; border:1px solid #fbe4c2; border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:6px; position:relative; box-shadow:0 2px 4px rgba(0,0,0,.04); }\r\n        .ai-room-thumb { width:100%; aspect-ratio:4/3; background:#f5f5f5; border-radius:8px; overflow:hidden; display:flex; align-items:center; justify-content:center; }\r\n        .ai-room-thumb img { width:100%; height:100%; object-fit:cover; display:block; }\r\n        .ai-room-name { font-weight:700; font-size:13px; letter-spacing:.2px; }\r\n        .ai-room-meta { font-size:11px; color:#555; }\r\n        .ai-room-price { font-size:12px; font-weight:800; color:#c2410c; }\r\n        .ai-room-book { background:#f59f00; color:#fff; border:none; border-radius:18px; padding:6px 10px; font-size:12px; font-weight:700; cursor:pointer; }\r\n        .ai-room-book:hover { background:#d97706; }\r\n  /* Wizard styles */\r\n  .ai-wizard-box { border:1px solid #f0eadc; background:#fffef9; padding:10px 12px; border-radius:12px; font-size:13px; display:flex; flex-direction:column; gap:8px; animation:fadeIn .25s ease; }\r\n  .ai-wizard-box.error { border-color:#fcd2d2; background:#fff6f6; }\r\n  .ai-wizard-box.success { border-color:#c5f0c8; background:#f4fff5; }\r\n  .ai-wizard-title { font-weight:700; font-size:14px; }\r\n  .ai-wizard-rooms { display:flex; flex-wrap:wrap; gap:6px; max-height:140px; overflow:auto; }\r\n  .wiz-room { background:#fff; border:1px solid #e2e2e2; border-radius:8px; padding:6px 8px; display:flex; flex-direction:column; align-items:flex-start; gap:2px; cursor:pointer; min-width:60px; position:relative; font-size:11px; }\r\n  .wiz-room.active { border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.25); }\r\n  .wiz-room .num { font-weight:600; }\r\n  .wiz-room .st { font-size:10px; color:#666; }\r\n  .ai-wizard-form { display:flex; flex-direction:column; gap:6px; }\r\n  .ai-wizard-form label { display:flex; flex-direction:column; gap:2px; font-size:11px; font-weight:600; }\r\n  .ai-wizard-form input[type=date], .ai-wizard-form input[type=number]{ padding:4px 6px; border:1px solid #d0d7e0; border-radius:6px; font-size:12px; }\r\n  .ai-wizard-form input:focus { outline:none; border-color:#f59f00; box-shadow:0 0 0 2px rgba(245,159,0,.25); }\r\n  .ai-wizard-form .row2 { display:flex; gap:8px; }\r\n  .ai-wizard-form .actions { display:flex; gap:8px; }\r\n  .ai-wizard-form .actions button { flex:1; border:none; background:#f59f00; color:#fff; padding:8px 10px; border-radius:8px; font-size:12px; font-weight:600; cursor:pointer; }\r\n  .ai-wizard-form .actions button.secondary { background:#e2e8f0; color:#222; }\r\n  .ai-wizard-form .err-msg { color:#b42318; font-size:11px; font-weight:600; }\r\n  @keyframes fadeIn { from { opacity:0; transform:translateY(4px);} to { opacity:1; transform:translateY(0);} }\r\n  @media (max-width:600px){ .ai-chatbox-wrapper { right:12px; bottom:84px; width:300px; } }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}