{"ast":null,"code":"import _objectSpread from\"D:/DA_TichHop/HMS_AI Hotel/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useRef,useState}from'react';import html2canvas from'html2canvas';import jsPDF from'jspdf';import'./HomePage.css';import{authHeaders,getUserRole}from'./auth';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function CheckInOut(_ref){let{isModal,onClose}=_ref;const role=getUserRole();const isStaff=role==='Staff';if(!isStaff){return null;}const[date,setDate]=useState(()=>new Date());const[showAll,setShowAll]=useState(true);const[openPicker,setOpenPicker]=useState(false);const[q,setQ]=useState('');const[typingTimer,setTypingTimer]=useState(null);const[loading,setLoading]=useState(false);const[items,setItems]=useState([]);const[selectedIds,setSelectedIds]=useState([]);const[stats,setStats]=useState({checkin:0,checkout:0,stay:0});const[statsToday,setStatsToday]=useState({checkInsToday:0,checkOutsToday:0,notArrivedToday:0});const[err,setErr]=useState('');const[invoice,setInvoice]=useState(null);const[hideDone,setHideDone]=useState(true);const[modal,setModal]=useState({open:false,message:'',onConfirm:null,onCancel:null});const invRef=useRef(null);const fmtDate=d=>{if(!d)return'';const dt=d instanceof Date?d:new Date(d);const mm=String(dt.getMonth()+1).padStart(2,'0');const dd=String(dt.getDate()).padStart(2,'0');const yy=dt.getFullYear();return\"\".concat(mm,\"/\").concat(dd,\"/\").concat(yy);};const toIso=d=>{const dt=d instanceof Date?d:new Date(d);const y=dt.getFullYear();const m=String(dt.getMonth()+1).padStart(2,'0');const da=String(dt.getDate()).padStart(2,'0');return\"\".concat(y,\"-\").concat(m,\"-\").concat(da);};const fetchList=async()=>{setLoading(true);setErr('');try{const url=new URL('/api/admin/checkinout',window.location.origin);if(!showAll&&date)url.searchParams.set('date',toIso(date));if(q.trim())url.searchParams.set('q',q.trim());const res=await fetch(url.toString(),{cache:'no-store',headers:_objectSpread({},authHeaders())});if(!res.ok){const j=await res.json().catch(()=>({}));throw new Error(j.message||\"HTTP \".concat(res.status));}const j=await res.json();setItems(Array.isArray(j.items)?j.items:[]);setSelectedIds([]);setStats(j.stats||{checkin:0,checkout:0,stay:0});// Also refresh today's stats\ntry{const sres=await fetch('/api/admin/stats/today',{headers:_objectSpread({},authHeaders()),cache:'no-store'});if(sres.ok){const sj=await sres.json();setStatsToday({checkInsToday:Number(sj.checkInsToday||0),checkOutsToday:Number(sj.checkOutsToday||0),notArrivedToday:Number(sj.notArrivedToday||0)});}}catch(_unused){}}catch(e){setErr(e.message||'L·ªói t·∫£i danh s√°ch');}finally{setLoading(false);}};useEffect(()=>{fetchList();/* eslint-disable-next-line */},[date,showAll]);const doAction=async(id,action)=>{try{// For checkout, run preview first\nif(action==='checkout'){const prev=await fetch(\"/api/admin/checkinout/\".concat(id,\"/checkout-preview\"),{headers:_objectSpread({},authHeaders()),cache:'no-store'});if(!prev.ok){const pj=await prev.json().catch(()=>({}));setModal({open:true,message:pj.message||'Kh√¥ng t√≠nh ƒë∆∞·ª£c h√≥a ƒë∆°n',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});return;}const{invoice:pre}=await prev.json();const paid=Number(pre.paidAmount||0);const total=Number(pre.total||0);const refund=Number(pre.refund||0);const collect=Number(pre.collect||0);const msg=collect>0?\"X\\xE1c nh\\u1EADn CHECK-OUT?\\nC\\u1EA7n THU th\\xEAm: \".concat(collect.toLocaleString('vi-VN'),\" \\u0111\\n(\\u0110\\xE3 thanh to\\xE1n: \").concat(paid.toLocaleString('vi-VN'),\" \\u0111, T\\u1ED5ng m\\u1EDBi: \").concat(total.toLocaleString('vi-VN'),\" \\u0111)\"):\"X\\xE1c nh\\u1EADn CHECK-OUT?\\nC\\u1EA7n TH\\u1ED0I l\\u1EA1i: \".concat(refund.toLocaleString('vi-VN'),\" \\u0111\\n(\\u0110\\xE3 thanh to\\xE1n: \").concat(paid.toLocaleString('vi-VN'),\" \\u0111, T\\u1ED5ng m\\u1EDBi: \").concat(total.toLocaleString('vi-VN'),\" \\u0111)\");const ok=await new Promise(resolve=>{setModal({open:true,message:msg,onConfirm:()=>{setModal({open:false,message:'',onConfirm:null,onCancel:null});resolve(true);},onCancel:()=>{setModal({open:false,message:'',onConfirm:null,onCancel:null});resolve(false);}});});if(!ok)return;}const res=await fetch(\"/api/admin/checkinout/\".concat(id,\"/\").concat(action),{method:'PUT',headers:_objectSpread({},authHeaders())});const data=await res.json().catch(()=>({}));if(!res.ok){setModal({open:true,message:data&&data.message||'Thao t√°c th·∫•t b·∫°i',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});return;}if(action==='checkout'&&data&&data.invoice){setInvoice(data.invoice);const paid=Number(data.invoice.paidAmount||0);const total=Number(data.invoice.total||0);const refund=Number(data.invoice.refund||0);const collect=Number(data.invoice.collect||0);const resultMsg=collect>0?\"\\u0110\\xC3 CHECK-OUT.\\nC\\u1EA7n THU th\\xEAm: \".concat(collect.toLocaleString('vi-VN'),\" \\u0111\"):refund>0?\"\\u0110\\xC3 CHECK-OUT.\\nC\\u1EA7n TH\\u1ED0I l\\u1EA1i: \".concat(refund.toLocaleString('vi-VN'),\" \\u0111\"):'ƒê√É CHECK-OUT. Kh√¥ng ph√°t sinh ch√™nh l·ªách.';setModal({open:true,message:resultMsg,onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});}// Optimistic UI: update local row status immediately\nsetItems(prev=>(prev||[]).map(it=>{if(it.bookingId!==id)return it;if(action==='checkin')return _objectSpread(_objectSpread({},it),{},{status:'checkedin'});if(action==='checkout')return _objectSpread(_objectSpread({},it),{},{status:'checkedout'});if(action==='complete')return _objectSpread(_objectSpread({},it),{},{status:'completed'});return it;}));// Optional: th√¥ng b√°o nhanh\n// alert(data && data.message ? data.message : 'Th√†nh c√¥ng');\nawait fetchList();try{const sres=await fetch('/api/admin/stats/today',{headers:_objectSpread({},authHeaders()),cache:'no-store'});if(sres.ok){const sj=await sres.json();setStatsToday({checkInsToday:Number(sj.checkInsToday||0),checkOutsToday:Number(sj.checkOutsToday||0),notArrivedToday:Number(sj.notArrivedToday||0)});}}catch(_unused2){}}catch(e){setModal({open:true,message:e.message||'L·ªói thao t√°c',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});}};const viewInvoice=async id=>{try{const prev=await fetch(\"/api/admin/checkinout/\".concat(id,\"/checkout-preview\"),{headers:_objectSpread({},authHeaders()),cache:'no-store'});if(!prev.ok){const pj=await prev.json().catch(()=>({}));setModal({open:true,message:pj.message||'Kh√¥ng xem ƒë∆∞·ª£c h√≥a ƒë∆°n',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});return;}const{invoice:pre}=await prev.json();setInvoice(pre);}catch(e){setModal({open:true,message:e.message||'L·ªói khi xem h√≥a ƒë∆°n',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});}};const deleteBooking=async id=>{const ok=await new Promise(resolve=>setModal({open:true,message:'X√≥a ƒë∆°n n√†y? Thao t√°c kh√¥ng th·ªÉ ho√†n t√°c.',onConfirm:()=>{setModal({open:false,message:'',onConfirm:null,onCancel:null});resolve(true);},onCancel:()=>{setModal({open:false,message:'',onConfirm:null,onCancel:null});resolve(false);}}));if(!ok)return;try{const res=await fetch(\"/api/admin/checkinout/\".concat(id),{method:'DELETE',headers:_objectSpread(_objectSpread({},authHeaders()),{},{'Content-Type':'application/json'})});const j=await res.json().catch(()=>({}));if(!res.ok){setModal({open:true,message:j.message||'X√≥a th·∫•t b·∫°i',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});return;}setModal({open:true,message:j.message||'ƒê√£ x√≥a',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});setInvoice(null);await fetchList();}catch(e){setModal({open:true,message:e.message||'L·ªói khi x√≥a',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});}};const bulkDelete=async()=>{if(!selectedIds.length)return;const ok=await new Promise(resolve=>setModal({open:true,message:\"X\\xF3a \".concat(selectedIds.length,\" \\u0111\\u01A1n \\u0111\\xE3 ch\\u1ECDn?\"),onConfirm:()=>{setModal({open:false,message:'',onConfirm:null,onCancel:null});resolve(true);},onCancel:()=>{setModal({open:false,message:'',onConfirm:null,onCancel:null});resolve(false);}}));if(!ok)return;try{const res=await fetch('/api/admin/checkinout/bulk-delete',{method:'POST',headers:_objectSpread(_objectSpread({},authHeaders()),{},{'Content-Type':'application/json'}),body:JSON.stringify({ids:selectedIds})});const j=await res.json().catch(()=>({}));if(!res.ok){setModal({open:true,message:j.message||'X√≥a th·∫•t b·∫°i',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});return;}setModal({open:true,message:j.message||\"\\u0110\\xE3 x\\xF3a \".concat(selectedIds.length,\" \\u0111\\u01A1n\"),onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});setInvoice(null);await fetchList();}catch(e){setModal({open:true,message:e.message||'L·ªói khi x√≥a h√†ng lo·∫°t',onConfirm:()=>setModal({open:false,message:'',onConfirm:null})});}};const Calendar=useMemo(()=>function CalendarComp(){// Simple inline calendar (no external lib)\nconst[view,setView]=useState(()=>{const d=date||new Date();return{y:d.getFullYear(),m:d.getMonth()};});const first=new Date(view.y,view.m,1);const startDay=first.getDay();const daysInMonth=new Date(view.y,view.m+1,0).getDate();const todayIso=toIso(new Date());const selectedIso=date?toIso(date):'';const cells=[];for(let i=0;i<startDay;i++)cells.push(null);for(let d=1;d<=daysInMonth;d++)cells.push(new Date(view.y,view.m,d));return/*#__PURE__*/_jsxs(\"div\",{className:\"ph-calendar\",style:{border:'1px solid #ddd',borderRadius:8,padding:8,background:'#fff',width:260,boxShadow:'0 2px 10px rgba(0,0,0,0.06)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:6},children:[/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:()=>setView(v=>({y:v.m===0?v.y-1:v.y,m:(v.m+11)%12})),children:\"\\u2039\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700},children:new Date(view.y,view.m,1).toLocaleString('vi-VN',{month:'long',year:'numeric'})}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:()=>setView(v=>({y:v.m===11?v.y+1:v.y,m:(v.m+1)%12})),children:\"\\u203A\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(7, 1fr)',gap:2,fontSize:12,color:'#666',marginBottom:4},children:['Su','Mo','Tu','We','Th','Fr','Sa'].map(d=>/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:d},d))}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(7, 1fr)',gap:2},children:cells.map((d,i)=>{if(!d)return/*#__PURE__*/_jsx(\"div\",{},i);const iso=toIso(d);const isToday=iso===todayIso;const isSel=iso===selectedIso;return/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",style:{padding:6,background:isSel?'#2e90fa':'#fff',color:isSel?'#fff':isToday?'#2e90fa':'#111',border:'1px solid #eee'},onClick:()=>{setDate(d);setOpenPicker(false);},children:d.getDate()},iso);})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',marginTop:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:()=>{setDate(new Date());setOpenPicker(false);},children:\"Today\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--danger\",onClick:()=>{setDate(null);setOpenPicker(false);},children:\"Clear\"})]})]});// depend on date so selected day reflects\n},[date]);return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-checkio\",style:{padding:isModal?0:'80px 12px 20px'},children:[modal.open&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',inset:0,background:'rgba(0,0,0,0.35)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{style:{width:420,maxWidth:'90vw',background:'#fff',borderRadius:10,boxShadow:'0 10px 30px rgba(0,0,0,0.25)',padding:18},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:800,fontSize:18,marginBottom:10,textAlign:'center'},children:\"Th\\xF4ng b\\xE1o\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:15,color:'#111',marginBottom:16,textAlign:'center',whiteSpace:'pre-wrap'},children:modal.message}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',gap:10},children:[modal.onCancel&&/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:()=>modal.onCancel?modal.onCancel():setModal({open:false,message:'',onConfirm:null,onCancel:null}),children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",onClick:()=>modal.onConfirm?modal.onConfirm():setModal({open:false,message:'',onConfirm:null,onCancel:null}),children:\"X\\xE1c nh\\u1EADn\"})]})]})}),!isModal&&/*#__PURE__*/_jsx(\"header\",{className:\"home-header\",style:{position:'sticky',top:0},children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-header-left\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"logo\",className:\"home-header-logo\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/\",className:\"home-header-title home-header-home-btn\",children:\"TRANG CH\\u1EE6\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ph-table\",style:{padding:16},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-rooms-title\",style:{textAlign:'left',marginTop:0},children:\"Qu\\u1EA3n l\\xFD Check in - Check out\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'auto 1fr auto',alignItems:'end',gap:12,flexWrap:'wrap',marginBottom:10},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsx(\"label\",{style:{fontSize:13,color:'#111',fontWeight:600,marginBottom:4},children:\"Ch\\u1ECDn ng\\xE0y:\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:10},children:/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{value:showAll?'':date?fmtDate(date):'',onChange:()=>{},placeholder:\"mm/dd/yyyy\",className:\"ph-input\",style:{width:200,paddingRight:34},readOnly:true,disabled:showAll}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-icon-btn\",\"aria-label\":\"Calendar\",onClick:()=>setOpenPicker(v=>!v),style:{position:'absolute',right:4,top:4},disabled:showAll,children:\"\\uD83D\\uDDD3\\uFE0F\"}),openPicker&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',zIndex:50,marginTop:6},children:/*#__PURE__*/_jsx(Calendar,{})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'flex-end',gap:10},children:[/*#__PURE__*/_jsx(\"input\",{className:\"ph-input\",placeholder:\"M\\xE3/t\\xEAn/SDT...\",value:q,onChange:e=>{const v=e.target.value;setQ(v);if(typingTimer)clearTimeout(typingTimer);const t=setTimeout(()=>{fetchList();},300);setTypingTimer(t);},style:{width:260,fontWeight:700}}),/*#__PURE__*/_jsxs(\"label\",{style:{margin:0,display:'flex',alignItems:'center',gap:6},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:showAll,onChange:e=>setShowAll(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{children:\"Hi\\u1EC3n th\\u1ECB t\\u1EA5t c\\u1EA3\"})]}),/*#__PURE__*/_jsxs(\"label\",{style:{margin:0,display:'flex',alignItems:'center',gap:6},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:hideDone,onChange:e=>setHideDone(e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u1EA8n \\u0111\\u01A1n \\u0111\\xE3 ho\\xE0n t\\u1EA5t\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'flex-end',gap:10},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:13,color:'#333',display:'flex',alignItems:'center',gap:6},children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"chart\",children:\"\\uD83D\\uDCCA\"}),\" Th\\u1ED1ng k\\xEA h\\xF4m nay:\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"ph-badge ph-badge--success\",children:[\"Check-in: \",statsToday.checkInsToday]}),/*#__PURE__*/_jsxs(\"span\",{className:\"ph-badge ph-badge--warning\",children:[\"Check-out: \",statsToday.checkOutsToday]}),/*#__PURE__*/_jsxs(\"span\",{className:\"ph-badge ph-badge--neutral\",children:[\"Ch\\u01B0a \\u0111\\u1EBFn: \",statsToday.notArrivedToday]}),(()=>{const visible=(items||[]).filter(it=>hideDone?it.status!=='completed':true);const visibleCompleted=visible.filter(it=>it.status==='completed');return!!visibleCompleted.length&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"label\",{style:{marginLeft:10,display:'flex',alignItems:'center',gap:6},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:visibleCompleted.length>0&&selectedIds.length===visibleCompleted.length,onChange:e=>{if(e.target.checked)setSelectedIds(visibleCompleted.map(x=>x.bookingId));else setSelectedIds([]);}}),/*#__PURE__*/_jsx(\"span\",{children:\"Ch\\u1ECDn t\\u1EA5t c\\u1EA3 (\\u0111\\u01A1n \\u0111\\xE3 ho\\xE0n t\\u1EA5t)\"})]}),selectedIds.length>0&&/*#__PURE__*/_jsxs(\"button\",{className:\"ph-btn ph-btn--danger\",onClick:bulkDelete,children:[\"X\\xF3a \",selectedIds.length,\" \\u0111\\u01A1n\"]})]});})()]})]}),err&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#b42318',marginBottom:8},children:err}),invoice&&/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-panel\",style:{marginTop:12},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"checkout-title\",children:\"H\\xF3a \\u0111\\u01A1n thanh to\\xE1n\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",onClick:()=>setInvoice(null),children:\"\\u0110\\xF3ng\"})]}),/*#__PURE__*/_jsxs(\"div\",{ref:invRef,className:\"invoice-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"invoice-top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-brand\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"invoice-icon\",children:\"\\uD83C\\uDFE8\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"invoice-title2\",children:\"H\\xF3a \\u0111\\u01A1n thanh to\\xE1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-sub\",children:[\"M\\xE3 BK\",String(invoice.bookingId).padStart(6,'0'),\" \\u2022 \",invoice.hotelName]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"success-grid invoice-grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Ng\\xE0y l\\u1EADp\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:/*#__PURE__*/_jsx(\"span\",{className:\"invoice-date\",children:fmtDate(new Date())})}),/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[invoice.customerName,\" (\",invoice.phone||'‚Äî',\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Ph\\xF2ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[invoice.roomNumber,\" \\u2014 \",invoice.roomType]}),/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Nh\\u1EADn ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:fmtDate(invoice.checkIn)}),/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Tr\\u1EA3 ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:fmtDate(invoice.checkOut)}),/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"S\\u1ED1 \\u0111\\xEAm\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:invoice.nights}),/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\u0110\\u01A1n gi\\xE1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[Number(invoice.unitPrice||0).toLocaleString('vi-VN'),\" \\u0111/\\u0111\\xEAm\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Th\\xE0nh ti\\u1EC1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value bold\",children:[Number(invoice.total||0).toLocaleString('vi-VN'),\" \\u0111\"]}),typeof invoice.paidAmount!=='undefined'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\u0110\\xE3 thanh to\\xE1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[Number(invoice.paidAmount||0).toLocaleString('vi-VN'),\" \\u0111\"]}),Number(invoice.collect||0)>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"C\\u1EA7n thu th\\xEAm\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"invoice-badge invoice-badge--collect\",children:[Number(invoice.collect||0).toLocaleString('vi-VN'),\" \\u0111\"]})})]}),Number(invoice.refund||0)>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"C\\u1EA7n th\\u1ED1i l\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"invoice-badge invoice-badge--refund\",children:[Number(invoice.refund||0).toLocaleString('vi-VN'),\" \\u0111\"]})})]})]})]}),invoice.earlyCheckout&&/*#__PURE__*/_jsxs(\"div\",{className:\"invoice-note\",children:[\"L\\u01B0u \\xFD: Kh\\xE1ch tr\\u1EA3 ph\\xF2ng s\\u1EDBm h\\u01A1n d\\u1EF1 ki\\u1EBFn. Vui l\\xF2ng x\\u1EED l\\xFD \",Number(invoice.collect||0)>0?'thu th√™m':'ho√†n ti·ªÅn',\" theo s\\u1ED1 li\\u1EC7u tr\\xEAn.\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"checkout-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"checkout-btn\",onClick:async()=>{if(!invRef.current)return;const canvas=await html2canvas(invRef.current,{scale:2});const imgData=canvas.toDataURL('image/png');const pdf=new jsPDF('p','mm','a4');const pageWidth=pdf.internal.pageSize.getWidth();const imgWidth=pageWidth-20;const imgHeight=canvas.height/canvas.width*imgWidth;pdf.addImage(imgData,'PNG',10,10,imgWidth,imgHeight);pdf.save(\"hoa-don-\".concat(invoice.bookingId,\".pdf\"));},children:\"In h\\xF3a \\u0111\\u01A1n\"})})]}),loading?/*#__PURE__*/_jsx(\"div\",{style:{color:'#666'},children:\"\\u0110ang t\\u1EA3i...\"}):/*#__PURE__*/_jsx(\"div\",{className:\"ph-table-wrap\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"ph-table-el\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{children:\"M\\xE3\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"SDT\"}),/*#__PURE__*/_jsx(\"th\",{children:\"S\\u1ED1 ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Lo\\u1EA1i ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\xE0y nh\\u1EADn\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\xE0y tr\\u1EA3\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:(items||[]).filter(it=>hideDone?it.status!=='completed':true).map(it=>{const canCheckIn=it.status==='pending';const canCheckOut=it.status==='checkedin';const done=it.status==='checkedout';const completed=it.status==='completed';const processed=canCheckOut||done||completed;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:it.status==='completed'&&selectedIds.includes(it.bookingId),disabled:it.status!=='completed',onChange:e=>{if(it.status!=='completed')return;setSelectedIds(prev=>e.target.checked?Array.from(new Set([...prev,it.bookingId])):prev.filter(x=>x!==it.bookingId));}})}),/*#__PURE__*/_jsx(\"td\",{children:it.code}),/*#__PURE__*/_jsx(\"td\",{children:it.customerName}),/*#__PURE__*/_jsx(\"td\",{children:it.phone||'‚Äî'}),/*#__PURE__*/_jsx(\"td\",{children:it.roomNumber||'‚Äî'}),/*#__PURE__*/_jsx(\"td\",{children:it.roomType||'‚Äî'}),/*#__PURE__*/_jsx(\"td\",{children:fmtDate(it.checkIn)}),/*#__PURE__*/_jsx(\"td\",{children:fmtDate(it.checkOut)}),/*#__PURE__*/_jsxs(\"td\",{children:[it.status==='pending'&&/*#__PURE__*/_jsx(\"span\",{className:\"ph-badge ph-badge--neutral\",children:\"Ch\\u01B0a check-in\"}),it.status==='checkedin'&&/*#__PURE__*/_jsx(\"span\",{className:\"ph-badge ph-badge--success\",children:\"\\u0110ang s\\u1EED d\\u1EE5ng\"}),it.status==='checkedout'&&/*#__PURE__*/_jsx(\"span\",{className:\"ph-badge ph-badge--warning\",children:\"\\u0110ang d\\u1ECDn d\\u1EB9p\"}),completed&&/*#__PURE__*/_jsx(\"span\",{className:\"ph-badge ph-badge--success\",children:\"Tr\\u1ED1ng\"})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"action-group\",children:[canCheckIn&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ph-btn ph-btn--success\",onClick:()=>doAction(it.bookingId,'checkin'),children:\"Check-in\"}),it.status==='completed'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ph-btn\",onClick:()=>viewInvoice(it.bookingId),children:\"Xem\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ph-btn ph-btn--danger\",onClick:()=>deleteBooking(it.bookingId),children:\"X\\xF3a\"})]}),canCheckOut&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ph-btn ph-btn--warning\",onClick:()=>doAction(it.bookingId,'checkout'),children:\"Check-out\"}),done&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ph-btn ph-btn--success\",onClick:async()=>{await doAction(it.bookingId,'complete');// Hide invoice panel and clear UI-only fields after cleaning is completed\nsetInvoice(null);},children:\"Ho\\xE0n t\\u1EA5t\"})})]})})]},it.bookingId);})})]})})]})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","html2canvas","jsPDF","authHeaders","getUserRole","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CheckInOut","_ref","isModal","onClose","role","isStaff","date","setDate","Date","showAll","setShowAll","openPicker","setOpenPicker","q","setQ","typingTimer","setTypingTimer","loading","setLoading","items","setItems","selectedIds","setSelectedIds","stats","setStats","checkin","checkout","stay","statsToday","setStatsToday","checkInsToday","checkOutsToday","notArrivedToday","err","setErr","invoice","setInvoice","hideDone","setHideDone","modal","setModal","open","message","onConfirm","onCancel","invRef","fmtDate","d","dt","mm","String","getMonth","padStart","dd","getDate","yy","getFullYear","concat","toIso","y","m","da","fetchList","url","URL","window","location","origin","searchParams","set","trim","res","fetch","toString","cache","headers","_objectSpread","ok","j","json","catch","Error","status","Array","isArray","sres","sj","Number","_unused","e","doAction","id","action","prev","pj","pre","paid","paidAmount","total","refund","collect","msg","toLocaleString","Promise","resolve","method","data","resultMsg","map","it","bookingId","_unused2","viewInvoice","deleteBooking","bulkDelete","length","body","JSON","stringify","ids","Calendar","CalendarComp","view","setView","first","startDay","getDay","daysInMonth","todayIso","selectedIso","cells","i","push","className","style","border","borderRadius","padding","background","width","boxShadow","children","display","alignItems","justifyContent","marginBottom","onClick","v","fontWeight","month","year","gridTemplateColumns","gap","fontSize","color","textAlign","iso","isToday","isSel","marginTop","position","inset","zIndex","maxWidth","whiteSpace","top","src","alt","href","flexWrap","flexDirection","value","onChange","placeholder","paddingRight","readOnly","disabled","right","target","clearTimeout","t","setTimeout","margin","type","checked","visible","filter","visibleCompleted","marginLeft","x","ref","hotelName","customerName","phone","roomNumber","roomType","checkIn","checkOut","nights","unitPrice","earlyCheckout","current","canvas","scale","imgData","toDataURL","pdf","pageWidth","internal","pageSize","getWidth","imgWidth","imgHeight","height","addImage","save","canCheckIn","canCheckOut","done","completed","processed","includes","from","Set","code"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/CheckInOut.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport html2canvas from 'html2canvas';\r\nimport jsPDF from 'jspdf';\r\nimport './HomePage.css';\r\nimport { authHeaders, getUserRole } from './auth';\r\n\r\nexport default function CheckInOut({ isModal, onClose }) {\r\n  const role = getUserRole();\r\n  const isStaff = role === 'Staff';\r\n  if (!isStaff) {\r\n    return null;\r\n  }\r\n  const [date, setDate] = useState(() => new Date());\r\n  const [showAll, setShowAll] = useState(true);\r\n  const [openPicker, setOpenPicker] = useState(false);\r\n  const [q, setQ] = useState('');\r\n  const [typingTimer, setTypingTimer] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [items, setItems] = useState([]);\r\n  const [selectedIds, setSelectedIds] = useState([]);\r\n  const [stats, setStats] = useState({ checkin: 0, checkout: 0, stay: 0 });\r\n  const [statsToday, setStatsToday] = useState({ checkInsToday: 0, checkOutsToday: 0, notArrivedToday: 0 });\r\n  const [err, setErr] = useState('');\r\n  const [invoice, setInvoice] = useState(null);\r\n  const [hideDone, setHideDone] = useState(true);\r\n  const [modal, setModal] = useState({ open: false, message: '', onConfirm: null, onCancel: null });\r\n  const invRef = useRef(null);\r\n\r\n  const fmtDate = (d) => {\r\n    if (!d) return '';\r\n    const dt = (d instanceof Date) ? d : new Date(d);\r\n    const mm = String(dt.getMonth() + 1).padStart(2, '0');\r\n    const dd = String(dt.getDate()).padStart(2, '0');\r\n    const yy = dt.getFullYear();\r\n    return `${mm}/${dd}/${yy}`;\r\n  };\r\n  const toIso = (d) => {\r\n    const dt = (d instanceof Date) ? d : new Date(d);\r\n    const y = dt.getFullYear();\r\n    const m = String(dt.getMonth() + 1).padStart(2, '0');\r\n    const da = String(dt.getDate()).padStart(2, '0');\r\n    return `${y}-${m}-${da}`;\r\n  };\r\n\r\n  const fetchList = async () => {\r\n    setLoading(true); setErr('');\r\n    try {\r\n      const url = new URL('/api/admin/checkinout', window.location.origin);\r\n      if (!showAll && date) url.searchParams.set('date', toIso(date));\r\n      if (q.trim()) url.searchParams.set('q', q.trim());\r\n  const res = await fetch(url.toString(), { cache: 'no-store', headers: { ...authHeaders() } });\r\n      if (!res.ok) {\r\n        const j = await res.json().catch(()=>({}));\r\n        throw new Error(j.message || `HTTP ${res.status}`);\r\n      }\r\n      const j = await res.json();\r\n      setItems(Array.isArray(j.items) ? j.items : []);\r\n  setSelectedIds([]);\r\n      setStats(j.stats || { checkin: 0, checkout: 0, stay: 0 });\r\n      // Also refresh today's stats\r\n      try {\r\n        const sres = await fetch('/api/admin/stats/today', { headers: { ...authHeaders() }, cache: 'no-store' });\r\n        if (sres.ok) {\r\n          const sj = await sres.json();\r\n          setStatsToday({\r\n            checkInsToday: Number(sj.checkInsToday || 0),\r\n            checkOutsToday: Number(sj.checkOutsToday || 0),\r\n            notArrivedToday: Number(sj.notArrivedToday || 0)\r\n          });\r\n        }\r\n      } catch {}\r\n    } catch (e) {\r\n      setErr(e.message || 'L·ªói t·∫£i danh s√°ch');\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  useEffect(() => { fetchList(); /* eslint-disable-next-line */ }, [date, showAll]);\r\n\r\n  const doAction = async (id, action) => {\r\n    try {\r\n      // For checkout, run preview first\r\n      if (action === 'checkout') {\r\n        const prev = await fetch(`/api/admin/checkinout/${id}/checkout-preview`, { headers: { ...authHeaders() }, cache: 'no-store' });\r\n        if (!prev.ok) {\r\n          const pj = await prev.json().catch(()=>({}));\r\n          setModal({ open: true, message: pj.message || 'Kh√¥ng t√≠nh ƒë∆∞·ª£c h√≥a ƒë∆°n', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n          return;\r\n        }\r\n        const { invoice: pre } = await prev.json();\r\n        const paid = Number(pre.paidAmount || 0);\r\n        const total = Number(pre.total || 0);\r\n        const refund = Number(pre.refund || 0);\r\n        const collect = Number(pre.collect || 0);\r\n        const msg = collect > 0\r\n          ? `X√°c nh·∫≠n CHECK-OUT?\r\nC·∫ßn THU th√™m: ${collect.toLocaleString('vi-VN')} ƒë\r\n(ƒê√£ thanh to√°n: ${paid.toLocaleString('vi-VN')} ƒë, T·ªïng m·ªõi: ${total.toLocaleString('vi-VN')} ƒë)`\r\n          : `X√°c nh·∫≠n CHECK-OUT?\r\nC·∫ßn TH·ªêI l·∫°i: ${refund.toLocaleString('vi-VN')} ƒë\r\n(ƒê√£ thanh to√°n: ${paid.toLocaleString('vi-VN')} ƒë, T·ªïng m·ªõi: ${total.toLocaleString('vi-VN')} ƒë)`;\r\n        const ok = await new Promise(resolve => {\r\n          setModal({\r\n            open: true,\r\n            message: msg,\r\n            onConfirm: () => { setModal({ open: false, message: '', onConfirm: null, onCancel: null }); resolve(true); },\r\n            onCancel: () => { setModal({ open: false, message: '', onConfirm: null, onCancel: null }); resolve(false); }\r\n          });\r\n        });\r\n        if (!ok) return;\r\n      }\r\n\r\n      const res = await fetch(`/api/admin/checkinout/${id}/${action}`, { method: 'PUT', headers: { ...authHeaders() } });\r\n      const data = await res.json().catch(()=>({}));\r\n      if (!res.ok) {\r\n        setModal({ open: true, message: (data && data.message) || 'Thao t√°c th·∫•t b·∫°i', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n        return;\r\n      }\r\n      if (action === 'checkout' && data && data.invoice) {\r\n        setInvoice(data.invoice);\r\n        const paid = Number(data.invoice.paidAmount || 0);\r\n        const total = Number(data.invoice.total || 0);\r\n        const refund = Number(data.invoice.refund || 0);\r\n        const collect = Number(data.invoice.collect || 0);\r\n        const resultMsg = collect > 0\r\n          ? `ƒê√É CHECK-OUT.\r\nC·∫ßn THU th√™m: ${collect.toLocaleString('vi-VN')} ƒë`\r\n          : (refund > 0 ? `ƒê√É CHECK-OUT.\r\nC·∫ßn TH·ªêI l·∫°i: ${refund.toLocaleString('vi-VN')} ƒë` : 'ƒê√É CHECK-OUT. Kh√¥ng ph√°t sinh ch√™nh l·ªách.');\r\n        setModal({ open: true, message: resultMsg, onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n      }\r\n      // Optimistic UI: update local row status immediately\r\n      setItems(prev => (prev || []).map(it => {\r\n        if (it.bookingId !== id) return it;\r\n        if (action === 'checkin') return { ...it, status: 'checkedin' };\r\n        if (action === 'checkout') return { ...it, status: 'checkedout' };\r\n        if (action === 'complete') return { ...it, status: 'completed' };\r\n        return it;\r\n      }));\r\n      // Optional: th√¥ng b√°o nhanh\r\n      // alert(data && data.message ? data.message : 'Th√†nh c√¥ng');\r\n      await fetchList();\r\n      try {\r\n        const sres = await fetch('/api/admin/stats/today', { headers: { ...authHeaders() }, cache: 'no-store' });\r\n        if (sres.ok) {\r\n          const sj = await sres.json();\r\n          setStatsToday({\r\n            checkInsToday: Number(sj.checkInsToday || 0),\r\n            checkOutsToday: Number(sj.checkOutsToday || 0),\r\n            notArrivedToday: Number(sj.notArrivedToday || 0)\r\n          });\r\n        }\r\n      } catch {}\r\n    } catch (e) {\r\n      setModal({ open: true, message: e.message || 'L·ªói thao t√°c', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n    }\r\n  };\r\n\r\n  const viewInvoice = async (id) => {\r\n    try {\r\n      const prev = await fetch(`/api/admin/checkinout/${id}/checkout-preview`, { headers: { ...authHeaders() }, cache: 'no-store' });\r\n      if (!prev.ok) {\r\n        const pj = await prev.json().catch(()=>({}));\r\n        setModal({ open: true, message: pj.message || 'Kh√¥ng xem ƒë∆∞·ª£c h√≥a ƒë∆°n', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n        return;\r\n      }\r\n      const { invoice: pre } = await prev.json();\r\n      setInvoice(pre);\r\n    } catch (e) {\r\n      setModal({ open: true, message: e.message || 'L·ªói khi xem h√≥a ƒë∆°n', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n    }\r\n  };\r\n\r\n  const deleteBooking = async (id) => {\r\n    const ok = await new Promise(resolve => setModal({\r\n      open: true,\r\n      message: 'X√≥a ƒë∆°n n√†y? Thao t√°c kh√¥ng th·ªÉ ho√†n t√°c.',\r\n      onConfirm: () => { setModal({ open: false, message: '', onConfirm: null, onCancel: null }); resolve(true); },\r\n      onCancel: () => { setModal({ open: false, message: '', onConfirm: null, onCancel: null }); resolve(false); }\r\n    }));\r\n    if (!ok) return;\r\n    try {\r\n      const res = await fetch(`/api/admin/checkinout/${id}`, { method: 'DELETE', headers: { ...authHeaders(), 'Content-Type': 'application/json' } });\r\n      const j = await res.json().catch(()=>({}));\r\n      if (!res.ok) {\r\n        setModal({ open: true, message: j.message || 'X√≥a th·∫•t b·∫°i', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n        return;\r\n      }\r\n      setModal({ open: true, message: j.message || 'ƒê√£ x√≥a', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n      setInvoice(null);\r\n      await fetchList();\r\n    } catch (e) {\r\n      setModal({ open: true, message: e.message || 'L·ªói khi x√≥a', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n    }\r\n  };\r\n\r\n  const bulkDelete = async () => {\r\n    if (!selectedIds.length) return;\r\n    const ok = await new Promise(resolve => setModal({\r\n      open: true,\r\n      message: `X√≥a ${selectedIds.length} ƒë∆°n ƒë√£ ch·ªçn?`,\r\n      onConfirm: () => { setModal({ open: false, message: '', onConfirm: null, onCancel: null }); resolve(true); },\r\n      onCancel: () => { setModal({ open: false, message: '', onConfirm: null, onCancel: null }); resolve(false); }\r\n    }));\r\n    if (!ok) return;\r\n    try {\r\n      const res = await fetch('/api/admin/checkinout/bulk-delete', { method: 'POST', headers: { ...authHeaders(), 'Content-Type': 'application/json' }, body: JSON.stringify({ ids: selectedIds }) });\r\n      const j = await res.json().catch(()=>({}));\r\n      if (!res.ok) {\r\n        setModal({ open: true, message: j.message || 'X√≥a th·∫•t b·∫°i', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n        return;\r\n      }\r\n      setModal({ open: true, message: j.message || `ƒê√£ x√≥a ${selectedIds.length} ƒë∆°n`, onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n      setInvoice(null);\r\n      await fetchList();\r\n    } catch (e) {\r\n      setModal({ open: true, message: e.message || 'L·ªói khi x√≥a h√†ng lo·∫°t', onConfirm: () => setModal({ open: false, message: '', onConfirm: null }) });\r\n    }\r\n  };\r\n\r\n  const Calendar = useMemo(() => function CalendarComp() {\r\n    // Simple inline calendar (no external lib)\r\n    const [view, setView] = useState(() => {\r\n      const d = date || new Date();\r\n      return { y: d.getFullYear(), m: d.getMonth() };\r\n    });\r\n    const first = new Date(view.y, view.m, 1);\r\n    const startDay = first.getDay();\r\n    const daysInMonth = new Date(view.y, view.m + 1, 0).getDate();\r\n    const todayIso = toIso(new Date());\r\n    const selectedIso = date ? toIso(date) : '';\r\n    const cells = [];\r\n    for (let i = 0; i < startDay; i++) cells.push(null);\r\n    for (let d = 1; d <= daysInMonth; d++) cells.push(new Date(view.y, view.m, d));\r\n    return (\r\n      <div className=\"ph-calendar\" style={{ border: '1px solid #ddd', borderRadius: 8, padding: 8, background: '#fff', width: 260, boxShadow: '0 2px 10px rgba(0,0,0,0.06)' }}>\r\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 6 }}>\r\n          <button className=\"ph-btn ph-btn--secondary\" onClick={() => setView(v => ({ y: v.m === 0 ? v.y - 1 : v.y, m: (v.m + 11) % 12 }))}>‚Äπ</button>\r\n          <div style={{ fontWeight: 700 }}>{new Date(view.y, view.m, 1).toLocaleString('vi-VN', { month: 'long', year: 'numeric' })}</div>\r\n          <button className=\"ph-btn ph-btn--secondary\" onClick={() => setView(v => ({ y: v.m === 11 ? v.y + 1 : v.y, m: (v.m + 1) % 12 }))}>‚Ä∫</button>\r\n        </div>\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7, 1fr)', gap: 2, fontSize: 12, color: '#666', marginBottom: 4 }}>\r\n          {['Su','Mo','Tu','We','Th','Fr','Sa'].map(d => <div key={d} style={{ textAlign: 'center' }}>{d}</div>)}\r\n        </div>\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7, 1fr)', gap: 2 }}>\r\n          {cells.map((d, i) => {\r\n            if (!d) return <div key={i} />;\r\n            const iso = toIso(d);\r\n            const isToday = iso === todayIso;\r\n            const isSel = iso === selectedIso;\r\n            return (\r\n              <button\r\n                key={iso}\r\n                className=\"ph-btn\"\r\n                style={{ padding: 6, background: isSel ? '#2e90fa' : '#fff', color: isSel ? '#fff' : (isToday ? '#2e90fa' : '#111'), border: '1px solid #eee' }}\r\n                onClick={() => { setDate(d); setOpenPicker(false); }}\r\n              >\r\n                {d.getDate()}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: 8 }}>\r\n          <button className=\"ph-btn ph-btn--secondary\" onClick={() => { setDate(new Date()); setOpenPicker(false); }}>Today</button>\r\n          <button className=\"ph-btn ph-btn--danger\" onClick={() => { setDate(null); setOpenPicker(false); }}>Clear</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  // depend on date so selected day reflects\r\n  }, [date]);\r\n\r\n  return (\r\n    <div className=\"admin-checkio\" style={{ padding: isModal ? 0 : '80px 12px 20px' }}>\r\n      {modal.open && (\r\n        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.35)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000 }}>\r\n          <div style={{ width: 420, maxWidth: '90vw', background: '#fff', borderRadius: 10, boxShadow: '0 10px 30px rgba(0,0,0,0.25)', padding: 18 }}>\r\n            <div style={{ fontWeight: 800, fontSize: 18, marginBottom: 10, textAlign: 'center' }}>Th√¥ng b√°o</div>\r\n            <div style={{ fontSize: 15, color: '#111', marginBottom: 16, textAlign: 'center', whiteSpace: 'pre-wrap' }}>{modal.message}</div>\r\n            <div style={{ display: 'flex', justifyContent: 'center', gap: 10 }}>\r\n              {modal.onCancel && (\r\n                <button className=\"ph-btn ph-btn--secondary\" onClick={() => modal.onCancel ? modal.onCancel() : setModal({ open: false, message: '', onConfirm: null, onCancel: null })}>H·ªßy</button>\r\n              )}\r\n              <button className=\"ph-btn\" onClick={() => modal.onConfirm ? modal.onConfirm() : setModal({ open: false, message: '', onConfirm: null, onCancel: null })}>X√°c nh·∫≠n</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {!isModal && (\r\n        <header className=\"home-header\" style={{ position: 'sticky', top: 0 }}>\r\n          <div className=\"home-header-left\">\r\n            <img src=\"/logo.png\" alt=\"logo\" className=\"home-header-logo\" />\r\n            <a href=\"/\" className=\"home-header-title home-header-home-btn\">TRANG CH·ª¶</a>\r\n          </div>\r\n        </header>\r\n      )}\r\n      <div className=\"ph-table\" style={{ padding: 16 }}>\r\n        <h2 className=\"home-rooms-title\" style={{ textAlign: 'left', marginTop: 0 }}>Qu·∫£n l√Ω Check in - Check out</h2>\r\n\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'auto 1fr auto', alignItems: 'end', gap: 12, flexWrap: 'wrap', marginBottom: 10 }}>\r\n          <div style={{ display: 'flex', flexDirection: 'column' }}>\r\n            <label style={{ fontSize: 13, color: '#111', fontWeight: 600, marginBottom: 4 }}>Ch·ªçn ng√†y:</label>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>\r\n              <div style={{ position: 'relative' }}>\r\n                <input\r\n                  value={showAll ? '' : (date ? fmtDate(date) : '')}\r\n                  onChange={()=>{}}\r\n                  placeholder=\"mm/dd/yyyy\"\r\n                  className=\"ph-input\"\r\n                  style={{ width: 200, paddingRight: 34 }}\r\n                  readOnly\r\n                  disabled={showAll}\r\n                />\r\n                <button className=\"ph-icon-btn\" aria-label=\"Calendar\" onClick={() => setOpenPicker(v=>!v)} style={{ position: 'absolute', right: 4, top: 4 }} disabled={showAll}>\r\n                  üóìÔ∏è\r\n                </button>\r\n                {openPicker && (\r\n                  <div style={{ position: 'absolute', zIndex: 50, marginTop: 6 }}>\r\n                    <Calendar />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ display: 'flex', alignItems: 'flex-end', gap: 10 }}>\r\n            <input\r\n              className=\"ph-input\"\r\n              placeholder=\"M√£/t√™n/SDT...\"\r\n              value={q}\r\n              onChange={(e)=> {\r\n                const v = e.target.value; setQ(v);\r\n                if (typingTimer) clearTimeout(typingTimer);\r\n                const t = setTimeout(()=>{ fetchList(); }, 300);\r\n                setTypingTimer(t);\r\n              }}\r\n              style={{ width: 260, fontWeight: 700 }}\r\n            />\r\n            <label style={{ margin: 0, display: 'flex', alignItems: 'center', gap: 6 }}>\r\n              <input type=\"checkbox\" checked={showAll} onChange={(e)=> setShowAll(e.target.checked)} />\r\n              <span>Hi·ªÉn th·ªã t·∫•t c·∫£</span>\r\n            </label>\r\n            <label style={{ margin: 0, display: 'flex', alignItems: 'center', gap: 6 }}>\r\n              <input type=\"checkbox\" checked={hideDone} onChange={(e)=> setHideDone(e.target.checked)} />\r\n              <span>·∫®n ƒë∆°n ƒë√£ ho√†n t·∫•t</span>\r\n            </label>\r\n          </div>\r\n\r\n          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'flex-end', gap: 10 }}>\r\n            <span style={{ fontSize: 13, color: '#333', display: 'flex', alignItems: 'center', gap: 6 }}>\r\n              <span role=\"img\" aria-label=\"chart\">üìä</span> Th·ªëng k√™ h√¥m nay:\r\n            </span>\r\n            <span className=\"ph-badge ph-badge--success\">Check-in: {statsToday.checkInsToday}</span>\r\n            <span className=\"ph-badge ph-badge--warning\">Check-out: {statsToday.checkOutsToday}</span>\r\n            <span className=\"ph-badge ph-badge--neutral\">Ch∆∞a ƒë·∫øn: {statsToday.notArrivedToday}</span>\r\n            {(() => {\r\n              const visible = (items || []).filter(it => hideDone ? (it.status !== 'completed') : true);\r\n              const visibleCompleted = visible.filter(it => it.status === 'completed');\r\n              return !!visibleCompleted.length && (\r\n              <>\r\n                <label style={{ marginLeft: 10, display: 'flex', alignItems: 'center', gap: 6 }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={visibleCompleted.length > 0 && selectedIds.length === visibleCompleted.length}\r\n                    onChange={(e)=> {\r\n                      if (e.target.checked) setSelectedIds(visibleCompleted.map(x => x.bookingId));\r\n                      else setSelectedIds([]);\r\n                    }}\r\n                  />\r\n                  <span>Ch·ªçn t·∫•t c·∫£ (ƒë∆°n ƒë√£ ho√†n t·∫•t)</span>\r\n                </label>\r\n                {selectedIds.length > 0 && (\r\n                  <button className=\"ph-btn ph-btn--danger\" onClick={bulkDelete}>X√≥a {selectedIds.length} ƒë∆°n</button>\r\n                )}\r\n              </>\r\n              );\r\n            })()}\r\n          </div>\r\n        </div>\r\n\r\n        {err && <div style={{ color: '#b42318', marginBottom: 8 }}>{err}</div>}\r\n        {invoice && (\r\n          <div className=\"checkout-panel\" style={{ marginTop: 12 }}>\r\n            <div className=\"checkout-header\">\r\n              <div className=\"checkout-title\">H√≥a ƒë∆°n thanh to√°n</div>\r\n              <button className=\"ph-btn\" onClick={()=> setInvoice(null)}>ƒê√≥ng</button>\r\n            </div>\r\n            <div ref={invRef} className=\"invoice-card\">\r\n              <div className=\"invoice-top\">\r\n                <div className=\"invoice-brand\">\r\n                  <div className=\"invoice-icon\">üè®</div>\r\n                  <div>\r\n                    <div className=\"invoice-title2\">H√≥a ƒë∆°n thanh to√°n</div>\r\n                    <div className=\"invoice-sub\">M√£ BK{String(invoice.bookingId).padStart(6,'0')} ‚Ä¢ {invoice.hotelName}</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"success-grid invoice-grid\">\r\n                <div className=\"label\">Ng√†y l·∫≠p</div><div className=\"value\"><span className=\"invoice-date\">{fmtDate(new Date())}</span></div>\r\n                <div className=\"label\">Kh√°ch h√†ng</div><div className=\"value\">{invoice.customerName} ({invoice.phone||'‚Äî'})</div>\r\n                <div className=\"label\">Ph√≤ng</div><div className=\"value\">{invoice.roomNumber} ‚Äî {invoice.roomType}</div>\r\n                <div className=\"label\">Nh·∫≠n ph√≤ng</div><div className=\"value\">{fmtDate(invoice.checkIn)}</div>\r\n                <div className=\"label\">Tr·∫£ ph√≤ng</div><div className=\"value\">{fmtDate(invoice.checkOut)}</div>\r\n                <div className=\"label\">S·ªë ƒë√™m</div><div className=\"value\">{invoice.nights}</div>\r\n                <div className=\"label\">ƒê∆°n gi√°</div><div className=\"value\">{Number(invoice.unitPrice||0).toLocaleString('vi-VN')} ƒë/ƒë√™m</div>\r\n                <div className=\"label\">Th√†nh ti·ªÅn</div><div className=\"value bold\">{Number(invoice.total||0).toLocaleString('vi-VN')} ƒë</div>\r\n                {typeof invoice.paidAmount !== 'undefined' && (\r\n                  <>\r\n                    <div className=\"label\">ƒê√£ thanh to√°n</div><div className=\"value\">{Number(invoice.paidAmount||0).toLocaleString('vi-VN')} ƒë</div>\r\n                    {Number(invoice.collect||0) > 0 && (\r\n                      <>\r\n                        <div className=\"label\">C·∫ßn thu th√™m</div><div className=\"value\"><span className=\"invoice-badge invoice-badge--collect\">{Number(invoice.collect||0).toLocaleString('vi-VN')} ƒë</span></div>\r\n                      </>\r\n                    )}\r\n                    {Number(invoice.refund||0) > 0 && (\r\n                      <>\r\n                        <div className=\"label\">C·∫ßn th·ªëi l·∫°i</div><div className=\"value\"><span className=\"invoice-badge invoice-badge--refund\">{Number(invoice.refund||0).toLocaleString('vi-VN')} ƒë</span></div>\r\n                      </>\r\n                    )}\r\n                  </>\r\n                )}\r\n              </div>\r\n              {invoice.earlyCheckout && (\r\n                <div className=\"invoice-note\">\r\n                  L∆∞u √Ω: Kh√°ch tr·∫£ ph√≤ng s·ªõm h∆°n d·ª± ki·∫øn. Vui l√≤ng x·ª≠ l√Ω {Number(invoice.collect||0) > 0 ? 'thu th√™m' : 'ho√†n ti·ªÅn'} theo s·ªë li·ªáu tr√™n.\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"checkout-actions\">\r\n              <button className=\"checkout-btn\" onClick={async ()=>{\r\n                if (!invRef.current) return;\r\n                const canvas = await html2canvas(invRef.current, { scale: 2 });\r\n                const imgData = canvas.toDataURL('image/png');\r\n                const pdf = new jsPDF('p', 'mm', 'a4');\r\n                const pageWidth = pdf.internal.pageSize.getWidth();\r\n                const imgWidth = pageWidth - 20;\r\n                const imgHeight = (canvas.height / canvas.width) * imgWidth;\r\n                pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);\r\n                pdf.save(`hoa-don-${invoice.bookingId}.pdf`);\r\n              }}>In h√≥a ƒë∆°n</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {loading ? (\r\n          <div style={{ color:'#666' }}>ƒêang t·∫£i...</div>\r\n        ) : (\r\n          <div className=\"ph-table-wrap\">\r\n            <table className=\"ph-table-el\">\r\n              <thead>\r\n                <tr>\r\n                  <th></th>\r\n                  <th>M√£</th>\r\n                  <th>Kh√°ch h√†ng</th>\r\n                  <th>SDT</th>\r\n                  <th>S·ªë ph√≤ng</th>\r\n                  <th>Lo·∫°i ph√≤ng</th>\r\n                  <th>Ng√†y nh·∫≠n</th>\r\n                  <th>Ng√†y tr·∫£</th>\r\n                  <th>Tr·∫°ng th√°i</th>\r\n                  <th>Thao t√°c</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {((items || []).filter(it => hideDone ? (it.status !== 'completed') : true)).map(it => {\r\n                  const canCheckIn = it.status === 'pending';\r\n                  const canCheckOut = it.status === 'checkedin';\r\n                  const done = it.status === 'checkedout';\r\n                  const completed = it.status === 'completed';\r\n                  const processed = canCheckOut || done || completed;\r\n                  return (\r\n                    <tr key={it.bookingId}>\r\n                      <td>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={it.status === 'completed' && selectedIds.includes(it.bookingId)}\r\n                          disabled={it.status !== 'completed'}\r\n                          onChange={(e)=> {\r\n                            if (it.status !== 'completed') return;\r\n                            setSelectedIds(prev => e.target.checked ? Array.from(new Set([...prev, it.bookingId])) : prev.filter(x => x !== it.bookingId));\r\n                          }}\r\n                        />\r\n                      </td>\r\n                      <td>{it.code}</td>\r\n                      <td>{it.customerName}</td>\r\n                      <td>{it.phone || '‚Äî'}</td>\r\n                      <td>{it.roomNumber || '‚Äî'}</td>\r\n                      <td>{it.roomType || '‚Äî'}</td>\r\n                      <td>{fmtDate(it.checkIn)}</td>\r\n                      <td>{fmtDate(it.checkOut)}</td>\r\n                      <td>\r\n                        {it.status === 'pending' && <span className=\"ph-badge ph-badge--neutral\">Ch∆∞a check-in</span>}\r\n                        {it.status === 'checkedin' && <span className=\"ph-badge ph-badge--success\">ƒêang s·ª≠ d·ª•ng</span>}\r\n                        {it.status === 'checkedout' && <span className=\"ph-badge ph-badge--warning\">ƒêang d·ªçn d·∫πp</span>}\r\n                        {completed && <span className=\"ph-badge ph-badge--success\">Tr·ªëng</span>}\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"action-group\">\r\n                          {canCheckIn && (\r\n                            <button\r\n                              type=\"button\"\r\n                              className=\"ph-btn ph-btn--success\"\r\n                              onClick={() => doAction(it.bookingId, 'checkin')}\r\n                            >\r\n                              Check-in\r\n                            </button>\r\n                          )}\r\n                          {it.status === 'completed' && (\r\n                            <>\r\n                              <button type=\"button\" className=\"ph-btn\" onClick={() => viewInvoice(it.bookingId)}>Xem</button>\r\n                              <button type=\"button\" className=\"ph-btn ph-btn--danger\" onClick={() => deleteBooking(it.bookingId)}>X√≥a</button>\r\n                            </>\r\n                          )}\r\n                        {canCheckOut && (\r\n                          <button type=\"button\" className=\"ph-btn ph-btn--warning\" onClick={() => doAction(it.bookingId, 'checkout')}>Check-out</button>\r\n                        )}\r\n                        {done && (\r\n                          <>\r\n                            <button\r\n                              type=\"button\"\r\n                                className=\"ph-btn ph-btn--success\"\r\n                              onClick={async () => {\r\n                                await doAction(it.bookingId, 'complete');\r\n                                // Hide invoice panel and clear UI-only fields after cleaning is completed\r\n                                setInvoice(null);\r\n                              }}\r\n                            >\r\n                                Ho√†n t·∫•t\r\n                            </button>\r\n                          </>\r\n                        )}\r\n                        \r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}