{"ast":null,"code":"var _jsxFileName = \"D:\\\\DA_TichHop\\\\HMS_AI Hotel\\\\client\\\\src\\\\PaymentHistory.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport './HomePage.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function PaymentHistory({\n  inline = false,\n  onReview\n}) {\n  _s();\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [q, setQ] = useState('');\n  const [fromDate, setFromDate] = useState(() => {\n    const now = new Date();\n    const start = new Date(now.getFullYear(), now.getMonth(), 1);\n    return toISODate(start);\n  });\n  const [toDate, setToDate] = useState(() => {\n    const now = new Date();\n    const end = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n    return toISODate(end);\n  });\n  const [status, setStatus] = useState('all');\n  const [page, setPage] = useState(1);\n  const pageSize = 10;\n  // Invoice state\n  const [invoiceItem, setInvoiceItem] = useState(null);\n  const [invoiceHotel, setInvoiceHotel] = useState(null);\n  const [invoiceLoading, setInvoiceLoading] = useState(false);\n  useEffect(() => {\n    try {\n      const u = localStorage.getItem('hmsUser');\n      setUser(u ? JSON.parse(u) : null);\n    } catch {\n      setUser(null);\n    }\n  }, []);\n  const fetchList = async () => {\n    if (!(user !== null && user !== void 0 && user.email)) return;\n    setLoading(true);\n    setError('');\n    try {\n      const url = new URL('/api/transactions', window.location.origin);\n      url.searchParams.set('email', user.email);\n      if (q) url.searchParams.set('q', q);\n      if (status && status !== 'all') url.searchParams.set('status', status);\n      if (fromDate) url.searchParams.set('from', fromDate);\n      if (toDate) url.searchParams.set('to', toDate);\n      const res = await fetch(url.toString());\n      if (!res.ok) throw new Error('Không tải được dữ liệu');\n      const j = await res.json();\n      let raw = Array.isArray(j.items) ? j.items : [];\n      // Rehydrate refund info for canceled bookings (if server omitted it)\n      raw = raw.map(it => {\n        if (it.paymentStatus === 'canceled') {\n          if (it.refundAmount == null) {\n            // Try localStorage cache first\n            try {\n              const cache = localStorage.getItem('refund:' + it.bookingId);\n              if (cache) {\n                const parsed = JSON.parse(cache);\n                if (parsed && typeof parsed.refundAmount !== 'undefined') {\n                  return {\n                    ...it,\n                    refundAmount: parsed.refundAmount,\n                    cancellationFee: parsed.cancellationFee\n                  };\n                }\n              }\n            } catch {}\n            // Fallback compute (85% refund, 15% fee) based on total if available\n            const total = Number(it.total) || 0;\n            if (total > 0) {\n              const refundAmount = Math.round(total * 0.85);\n              const cancellationFee = total - refundAmount;\n              return {\n                ...it,\n                refundAmount,\n                cancellationFee\n              };\n            }\n          }\n        }\n        return it;\n      });\n      setItems(raw);\n    } catch (e) {\n      setError(e.message || 'Lỗi tải dữ liệu');\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchList();\n  }, [user]);\n  const filtered = useMemo(() => items, [items]);\n  const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));\n  const pageItems = filtered.slice((page - 1) * pageSize, page * pageSize);\n  const topScrollRef = useRef(null);\n  const tableRef = useRef(null);\n  const openInvoice = async row => {\n    setInvoiceItem(null);\n    setInvoiceHotel(null);\n    setInvoiceLoading(true);\n    try {\n      // Optional: fetch hotel detail if needed in future\n      setInvoiceItem(row);\n    } catch {/* ignore */} finally {\n      setInvoiceLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: inline ? '' : 'home-root',\n    style: {\n      paddingTop: inline ? 0 : 80\n    },\n    children: [!inline && /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"home-header\",\n      style: {\n        position: 'sticky',\n        top: 0\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"home-header-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/logo.png\",\n          alt: \"logo\",\n          className: \"home-header-logo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          className: \"home-header-title home-header-home-btn\",\n          children: \"TRANG CH\\u1EE6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"home-header-icons\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/login\",\n          className: \"home-header-icon\",\n          title: \"\\u0110\\u0103ng nh\\u1EADp\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/icon-user.png\",\n            alt: \"user\",\n            className: \"home-header-icon-img\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: inline ? '6px' : '16px 12px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"home-rooms-title\",\n        style: {\n          textAlign: 'left',\n          marginTop: 12\n        },\n        children: \"L\\u1ECBch s\\u1EED giao d\\u1ECBch\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rt-toolbar\",\n        style: {\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rt-field rt-field--wide\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"T\\u1EEB kh\\xF3a\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"VD: HMS20250904 ho\\u1EB7c HMS-AI \\u0110\\xE0 N\\u1EB5ng\",\n            value: q,\n            onChange: e => setQ(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rt-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"T\\u1EEB ng\\xE0y\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: fromDate,\n            onChange: e => setFromDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rt-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u0110\\u1EBFn ng\\xE0y\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: toDate,\n            min: fromDate || undefined,\n            onChange: e => setToDate(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rt-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Tr\\u1EA1ng th\\xE1i\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: status,\n            onChange: e => setStatus(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"all\",\n              children: \"T\\u1EA5t c\\u1EA3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"paid\",\n              children: \"\\u0110\\xE3 thanh to\\xE1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"pending\",\n              children: \"Ch\\u1EDD thanh to\\xE1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"canceled\",\n              children: \"H\\u1EE7y\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          onClick: () => {\n            setPage(1);\n            fetchList();\n          },\n          children: \"T\\xECm ki\\u1EBFm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn ph-btn--secondary\",\n          onClick: () => exportCsv(filtered),\n          children: \"Xu\\u1EA5t CSV\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          overflowX: 'auto',\n          maxWidth: '100%'\n        },\n        ref: topScrollRef,\n        className: \"ph-scroll-top\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: tableRef,\n          className: \"ph-table\",\n          role: \"table\",\n          \"aria-label\": \"L\\u1ECBch s\\u1EED giao d\\u1ECBch\",\n          style: {\n            minWidth: 1700\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ph-tr ph-head ph-hist\",\n            role: \"row\",\n            children: ['MÃ ĐẶT PHÒNG', 'KHÁCH SẠN', 'PHÒNG', 'LOẠI PHÒNG', 'NHẬN PHÒNG', 'TRẢ PHÒNG', 'SỐ ĐÊM', 'KHÁCH', 'GIÁ/ĐÊM', 'TỔNG TIỀN', 'THANH TOÁN', 'THỜI GIAN TT', 'PTTT', 'HÀNH ĐỘNG'].map(h => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              role: \"columnheader\",\n              children: h\n            }, h, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ph-empty\",\n            children: \"\\u0110ang t\\u1EA3i...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 15\n          }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ph-empty\",\n            style: {\n              color: '#c1121f'\n            },\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 15\n          }, this) : pageItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ph-empty\",\n            children: \"Ch\\u01B0a c\\xF3 giao d\\u1ECBch\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 15\n          }, this) : pageItems.map(it => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ph-tr ph-hist\",\n            role: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td code\",\n              children: it.code\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: it.hotelName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: it.roomName || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: it.roomType || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: fmtDateTime(it.checkIn)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: fmtDateTime(it.checkOut)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td center\",\n              children: it.nights\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: it.guests\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td right\",\n              children: [fmtMoney(it.pricePerNight), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td right\",\n              children: [fmtMoney(it.total), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: /*#__PURE__*/_jsxDEV(StatusBadge, {\n                status: it.paymentStatus\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 42\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: it.paidAt ? fmtDateTime(it.paidAt) : '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td\",\n              children: it.method || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ph-td action ph-action-inline\",\n              children: [(() => {\n                const reviewedKey = 'reviewedBooking:' + it.bookingId;\n                let reviewed = false;\n                try {\n                  reviewed = !!localStorage.getItem(reviewedKey);\n                } catch {}\n                const reviewLabel = reviewed ? 'Đã đánh giá' : 'Đánh giá';\n                const reviewNode = typeof onReview === 'function' ? /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: \"#\",\n                  className: reviewed ? 'ph-link disabled' : 'ph-link',\n                  onClick: e => {\n                    e.preventDefault();\n                    if (reviewed) return;\n                    onReview(it);\n                    try {\n                      localStorage.setItem(reviewedKey, '1');\n                    } catch {}\n                    ;\n                    setItems(list => list.map(x => x.bookingId === it.bookingId ? {\n                      ...x\n                    } : x));\n                  },\n                  children: reviewLabel\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: buildReviewHref(it),\n                  className: reviewed ? 'ph-link disabled' : 'ph-link',\n                  onClick: () => {\n                    if (!reviewed) {\n                      try {\n                        localStorage.setItem(reviewedKey, '1');\n                      } catch {}\n                      ;\n                    }\n                  },\n                  children: reviewLabel\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 25\n                }, this);\n                return /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: reviewNode\n                }, void 0, false);\n              })(), it.paymentStatus === 'paid' && /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"ph-btn ph-btn--secondary\",\n                style: {\n                  marginLeft: 8\n                },\n                onClick: () => openInvoice(it),\n                children: \"H\\xF3a \\u0111\\u01A1n\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 23\n              }, this), it.paymentStatus === 'pending' && /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"ph-cancel-btn\",\n                onClick: async () => {\n                  if (!window.confirm('Hủy giao dịch này? Hoàn 85%, phí 15%.')) return;\n                  try {\n                    const uRaw = localStorage.getItem('hmsUser');\n                    const email = uRaw ? JSON.parse(uRaw).email : null;\n                    if (!email) {\n                      alert('Chưa đăng nhập');\n                      return;\n                    }\n                    const r = await fetch(`/api/payments/${it.bookingId}/cancel`, {\n                      method: 'PUT',\n                      headers: {\n                        'Content-Type': 'application/json'\n                      },\n                      body: JSON.stringify({\n                        email\n                      })\n                    });\n                    if (!r.ok) {\n                      const t = await r.text();\n                      throw new Error(t);\n                    }\n                    const j = await r.json();\n                    setItems(list => list.map(x => x.bookingId === it.bookingId ? {\n                      ...x,\n                      paymentStatus: 'canceled',\n                      refundAmount: j.refundAmount,\n                      cancellationFee: j.cancellationFee\n                    } : x));\n                    // Persist refund info locally so it shows after navigation\n                    try {\n                      localStorage.setItem('refund:' + it.bookingId, JSON.stringify({\n                        refundAmount: j.refundAmount,\n                        cancellationFee: j.cancellationFee\n                      }));\n                    } catch {}\n                  } catch (e) {\n                    alert(e.message || 'Hủy thất bại');\n                  }\n                },\n                title: \"H\\u1EE7y giao d\\u1ECBch\",\n                children: \"H\\u1EE7y\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 23\n              }, this), it.paymentStatus === 'canceled' && it.refundAmount != null && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ph-refund-note\",\n                children: [\"Ho\\xE0n: \", Number(it.refundAmount).toLocaleString('vi-VN'), \" VND\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 19\n            }, this)]\n          }, it.bookingId, true, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ph-pager\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: page <= 1,\n          onClick: () => setPage(p => Math.max(1, p - 1)),\n          children: \"\\xAB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), Array.from({\n          length: totalPages\n        }, (_, i) => i + 1).slice(0, 5).map(n => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: n === page ? 'active' : '',\n          onClick: () => setPage(n),\n          children: n\n        }, n, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: page >= totalPages,\n          onClick: () => setPage(p => Math.min(totalPages, p + 1)),\n          children: \"\\xBB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), invoiceItem && /*#__PURE__*/_jsxDEV(InvoiceModal, {\n      item: invoiceItem,\n      hotel: invoiceHotel,\n      onClose: () => setInvoiceItem(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n}\n\n// ================= INVOICE HELPERS & MODAL =================\n_s(PaymentHistory, \"gml+Lp5CKjbi5QEnaI2YSLpBVo0=\", false, function () {\n  return [useNavigate];\n});\n_c = PaymentHistory;\nfunction buildInvoiceNumber(item) {\n  if (!item) return '';\n  const id = String(item.bookingId || '').padStart(6, '0');\n  // Use paid date or today for sequence prefix\n  const d = item.paidAt ? new Date(item.paidAt) : new Date();\n  const y = d.getFullYear();\n  const m = String(d.getMonth() + 1).padStart(2, '0');\n  const day = String(d.getDate()).padStart(2, '0');\n  return `HD${y}${m}${day}-${id}`;\n}\nfunction generateNightRows(item) {\n  if (!item) return [];\n  try {\n    const ci = new Date(item.checkIn);\n    const co = new Date(item.checkOut);\n    const rows = [];\n    let cursor = new Date(ci.getFullYear(), ci.getMonth(), ci.getDate());\n    let idx = 0;\n    while (cursor < co) {\n      if (idx > 60) {\n        // safety stop for abnormal data\n        rows.push({\n          date: fmtDate(cursor),\n          desc: 'Tiền phòng (gộp)',\n          qty: (item.nights || 0) - idx,\n          unit: item.pricePerNight,\n          amount: item.pricePerNight * ((item.nights || 0) - idx)\n        });\n        break;\n      }\n      rows.push({\n        date: fmtDate(cursor),\n        desc: 'Tiền phòng',\n        qty: 1,\n        unit: item.pricePerNight,\n        amount: item.pricePerNight\n      });\n      cursor = new Date(cursor.getFullYear(), cursor.getMonth(), cursor.getDate() + 1);\n      idx++;\n      if (idx >= (item.nights || 0)) break;\n    }\n    return rows;\n  } catch {\n    return [];\n  }\n}\nfunction calcInvoiceTotals(item, extra) {\n  if (!item) return {\n    roomTotal: 0,\n    serviceTotal: 0,\n    tax: 0,\n    grand: 0\n  };\n  const nightRows = generateNightRows(item);\n  const roomTotal = nightRows.reduce((s, r) => s + Number(r.amount || 0), 0);\n  const serviceTotal = extra && Array.isArray(extra.services) ? extra.services.reduce((s, r) => s + Number(r.amount || 0), 0) : 0;\n  const tax = Math.round(roomTotal * 0.03); // 3% VAT giả định\n  const grand = roomTotal + serviceTotal + tax;\n  return {\n    roomTotal,\n    serviceTotal,\n    tax,\n    grand,\n    nightRows\n  };\n}\nfunction InvoiceModal({\n  item,\n  hotel,\n  onClose\n}) {\n  if (!item) return null;\n  const {\n    roomTotal,\n    serviceTotal,\n    tax,\n    grand,\n    nightRows\n  } = calcInvoiceTotals(item, {});\n  const invoiceNo = buildInvoiceNumber(item);\n  const custName = item.customerName || item.userName || 'Khách hàng';\n  const checkInTime = '14:00:00';\n  const checkOutTime = '12:00:00';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"invoice-overlay\",\n    onMouseDown: e => {\n      if (e.target === e.currentTarget) onClose();\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"invoice-modal\",\n      onMouseDown: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"invoice-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn ph-btn--secondary\",\n          onClick: () => window.print(),\n          children: \"In / L\\u01B0u PDF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          onClick: onClose,\n          children: \"\\u0110\\xF3ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"invoice-paper\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"invoice-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"brand-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"brand-logo\",\n              children: \"HMS - AI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"brand-meta\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: (hotel === null || hotel === void 0 ? void 0 : hotel.name) || 'HMS - AI - Demo1'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: (hotel === null || hotel === void 0 ? void 0 : hotel.address) || '03 Quang Trung - Đà Nẵng'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: (hotel === null || hotel === void 0 ? void 0 : hotel.phone) || '0388618687 · E: hms@gmail.com'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 291,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: (hotel === null || hotel === void 0 ? void 0 : hotel.website) || 'www.demonwebsite.com'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"invoice-title-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              children: \"H\\xD3A \\u0110\\u01A0N\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-meta\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"S\\u1ED1 h\\xF3a \\u0111\\u01A1n:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 41\n              }, this), \" \", invoiceNo]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-meta\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Ng\\xE0y:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 41\n              }, this), \" \", fmtDateTime(item.paidAt || Date.now())]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"invoice-cards\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"M\\xE3 \\u0111\\u1EB7t ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: item.code\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 84\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"Ngu\\u1ED3n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: \"HMS-AI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 77\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"Ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: item.roomName || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 77\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"T\\xEAn kh\\xE1ch h\\xE0ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: custName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 86\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"Ng\\xE0y nh\\u1EADn\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: fmtDate(item.checkIn)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 81\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"Ng\\xE0y tr\\u1EA3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: fmtDate(item.checkOut)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 80\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"Lo\\u1EA1i ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: item.roomType\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 82\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"S\\u1ED1 \\u0111\\xEAm l\\u01B0u tr\\xFA\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: item.nights\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 86\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"Gi\\u1EDD nh\\u1EADn\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: checkInTime\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 80\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-label\",\n              children: \"Gi\\u1EDD tr\\u1EA3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"inv-value\",\n              children: checkOutTime\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 79\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"invoice-table-section\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"invoice-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"#\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Ng\\xE0y\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 318,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Ph\\xF2ng / N\\u1ED9i dung\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"S\\u1ED1 l\\u01B0\\u1EE3ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"\\u0110\\u01A1n gi\\xE1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 321,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Th\\xE0nh ti\\u1EC1n\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 322,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: [nightRows.map((r, i) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: i + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: r.date\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: r.desc\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: r.qty\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [fmtMoney(r.unit), \" VND\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [fmtMoney(r.amount), \" VND\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 21\n                }, this)]\n              }, i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 19\n              }, this)), serviceTotal > 0 && /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: nightRows.length + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 338,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"\\u2014\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"D\\u1ECBch v\\u1EE5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 340,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [fmtMoney(serviceTotal), \" VND\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [fmtMoney(serviceTotal), \" VND\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 343,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"invoice-summary\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-sum-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Ti\\u1EC1n ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 42\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [fmtMoney(roomTotal), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 65\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this), serviceTotal > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-sum-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Ph\\xED d\\u1ECBch v\\u1EE5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 61\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [fmtMoney(serviceTotal), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 85\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 32\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-sum-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Thu\\u1EBF (3%)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 42\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [fmtMoney(tax), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 64\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inv-sum-row inv-total\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"T\\u1ED5ng ti\\u1EC1n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 52\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [fmtMoney(grand), \" VND\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 74\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"invoice-footer-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"C\\u1EA3m \\u01A1n Qu\\xFD kh\\xE1ch \\u0111\\xE3 tin t\\u01B0\\u1EDFng v\\xE0 s\\u1EED d\\u1EE5ng d\\u1ECBch v\\u1EE5 c\\u1EE7a ch\\xFAng t\\xF4i.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Ch\\xFAc Qu\\xFD kh\\xE1ch c\\xF3 m\\u1ED9t k\\u1EF3 ngh\\u0129 vui v\\u1EBB!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"invoice-sign\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sig-col\",\n            children: [\"L\\u1EC5 t\\xE2n\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 44\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 49\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 54\n            }, this), \"__________________\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sig-col\",\n            children: [\"Kh\\xE1ch h\\xE0ng\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 48\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 53\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 58\n            }, this), \"__________________\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n        children: `\n          .invoice-overlay{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;align-items:flex-start;justify-content:center;overflow:auto;z-index:4000;padding:30px 18px;}\n          .invoice-modal{background:#fff;border-radius:14px;max-width:980px;width:100%;box-shadow:0 10px 40px -8px rgba(0,0,0,.3);padding:18px 18px 32px;animation:invIn .45s ease;}\n          @keyframes invIn{from{opacity:0;transform:translateY(18px);}to{opacity:1;transform:translateY(0);}}\n          .invoice-actions{display:flex;justify-content:flex-end;gap:10px;margin-bottom:8px;}\n          .invoice-paper{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#0f172a;}\n          .invoice-header{display:flex;justify-content:space-between;border-bottom:3px solid #0f5fa8;padding-bottom:12px;margin-bottom:14px;gap:20px;}\n          .brand-logo{font-weight:700;font-size:20px;background:#0f5fa8;color:#fff;padding:6px 14px;border-radius:6px;display:inline-block;margin-bottom:6px;}\n          .brand-meta div{font-size:12px;line-height:1.25;color:#334155;}\n          .invoice-title-block{text-align:right;}\n          .invoice-title-block h1{margin:0 0 6px;font-size:28px;letter-spacing:.5px;color:#0f5fa8;}\n          .inv-meta{font-size:12px;color:#475569;}\n          .inv-meta span{font-weight:600;color:#0f172a;}\n          .invoice-cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px;margin:6px 0 18px;}\n          .inv-card{background:#f1f5f9;border:1px solid #e2e8f0;border-radius:8px;padding:8px 10px;min-height:66px;display:flex;flex-direction:column;justify-content:center;}\n          .inv-label{font-size:11px;text-transform:uppercase;letter-spacing:.5px;color:#64748b;font-weight:600;margin-bottom:4px;}\n          .inv-value{font-size:13px;font-weight:600;color:#0f172a;word-break:break-word;}\n          .invoice-table{width:100%;border-collapse:collapse;font-size:13px;}\n          .invoice-table th{background:#0f5fa8;color:#fff;padding:8px 10px;text-align:left;font-weight:600;font-size:12px;}\n          .invoice-table td{padding:8px 10px;border-bottom:1px solid #e2e8f0;}\n          .invoice-table tbody tr:nth-child(even){background:#f8fafc;}\n          .invoice-summary{margin-top:18px;border-top:2px solid #0f5fa8;padding-top:12px;max-width:360px;margin-left:auto;font-size:13px;}\n          .inv-sum-row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dashed #e2e8f0;}\n          .inv-sum-row:last-child{border-bottom:none;}\n          .inv-total{font-size:14px;font-weight:700;}\n          .invoice-footer-text{margin-top:22px;font-size:12px;color:#475569;text-align:center;}\n          .invoice-sign{display:flex;justify-content:space-between;margin-top:38px;font-size:13px;text-align:center;}\n          .sig-col{flex:1;}\n          @media print{body{background:#fff;} .invoice-overlay{position:static;background:#fff;box-shadow:none;padding:0;} .invoice-modal{box-shadow:none;padding:0;} .invoice-actions{display:none;} .invoice-table th{background:#0f5fa8 !important;-webkit-print-color-adjust:exact;print-color-adjust:exact;} .inv-card{background:#f1f5f9 !important;-webkit-print-color-adjust:exact;print-color-adjust:exact;} }\n        `\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 278,\n    columnNumber: 5\n  }, this);\n}\n_c2 = InvoiceModal;\nfunction StatusBadge({\n  status\n}) {\n  const map = {\n    paid: {\n      text: 'Đã thanh toán',\n      cls: 'ok'\n    },\n    pending: {\n      text: 'Chờ thanh toán',\n      cls: 'pending'\n    },\n    canceled: {\n      text: 'Hủy',\n      cls: 'cancel'\n    }\n  };\n  const s = map[status] || map.pending;\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    className: `ph-badge ${s.cls}`,\n    children: s.text\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 407,\n    columnNumber: 10\n  }, this);\n}\n_c3 = StatusBadge;\nfunction toISODate(d) {\n  const dt = new Date(d);\n  const y = dt.getFullYear();\n  const m = String(dt.getMonth() + 1).padStart(2, '0');\n  const day = String(dt.getDate()).padStart(2, '0');\n  return `${y}-${m}-${day}`;\n}\nfunction fmtDate(d) {\n  const dt = new Date(d);\n  const dd = String(dt.getDate()).padStart(2, '0');\n  const mm = String(dt.getMonth() + 1).padStart(2, '0');\n  const yy = dt.getFullYear();\n  return `${dd}/${mm}/${yy}`;\n}\nfunction fmtDateTime(d) {\n  if (!d) return '';\n  const dt = new Date(d);\n  const hh = String(dt.getHours()).padStart(2, '0');\n  const mi = String(dt.getMinutes()).padStart(2, '0');\n  return `${fmtDate(dt)} ${hh}:${mi}`;\n}\nfunction toISO(s) {\n  const [d, m, y] = s.split('/');\n  return `${y}-${m}-${d}`;\n}\nfunction fmtMoney(n) {\n  return Number(n || 0).toLocaleString('vi-VN');\n}\nfunction exportCsv(list) {\n  const header = ['Mã đặt', 'Khách sạn', 'Phòng', 'Loại phòng', 'Nhận', 'Trả', 'Số đêm', 'Khách', 'Giá/đêm', 'Tổng', 'Trạng thái', 'Thanh toán', 'PTTT'];\n  const rows = list.map(it => [it.code, it.hotelName, it.roomName || '', it.roomType || '', fmtDateTime(it.checkIn), fmtDateTime(it.checkOut), it.nights, it.guests, fmtMoney(it.pricePerNight), fmtMoney(it.total), it.paymentStatus, it.paidAt ? fmtDateTime(it.paidAt) : '', it.method]);\n  const csv = [header, ...rows].map(r => r.map(v => `\"${String(v).replace(/\"/g, '\"\"')}\"`).join(',')).join('\\n');\n  const blob = new Blob([\"\\uFEFF\" + csv], {\n    type: 'text/csv;charset=utf-8;'\n  });\n  const a = document.createElement('a');\n  a.href = URL.createObjectURL(blob);\n  a.download = 'lich-su-giao-dich.csv';\n  a.click();\n}\nfunction buildReviewHref(it) {\n  const q = new URLSearchParams({\n    bookingId: String(it.bookingId || ''),\n    hotel: String(it.hotelName || ''),\n    roomType: String(it.roomType || ''),\n    ci: it.checkIn ? toISODate(it.checkIn) : '',\n    co: it.checkOut ? toISODate(it.checkOut) : ''\n  });\n  return `/review?${q.toString()}`;\n}\n\n// Styles for .ph-action-inline, .ph-link, .ph-cancel-btn, .ph-refund-note moved to HomePage.css\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"PaymentHistory\");\n$RefreshReg$(_c2, \"InvoiceModal\");\n$RefreshReg$(_c3, \"StatusBadge\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","Link","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","PaymentHistory","inline","onReview","_s","navigate","user","setUser","items","setItems","loading","setLoading","error","setError","q","setQ","fromDate","setFromDate","now","Date","start","getFullYear","getMonth","toISODate","toDate","setToDate","end","status","setStatus","page","setPage","pageSize","invoiceItem","setInvoiceItem","invoiceHotel","setInvoiceHotel","invoiceLoading","setInvoiceLoading","u","localStorage","getItem","JSON","parse","fetchList","email","url","URL","window","location","origin","searchParams","set","res","fetch","toString","ok","Error","j","json","raw","Array","isArray","map","it","paymentStatus","refundAmount","cache","bookingId","parsed","cancellationFee","total","Number","Math","round","e","message","filtered","totalPages","max","ceil","length","pageItems","slice","topScrollRef","tableRef","openInvoice","row","className","style","paddingTop","children","position","top","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","to","title","padding","textAlign","marginTop","alignItems","type","placeholder","value","onChange","target","min","undefined","onClick","exportCsv","overflowX","maxWidth","ref","role","minWidth","h","color","code","hotelName","roomName","roomType","fmtDateTime","checkIn","checkOut","nights","guests","fmtMoney","pricePerNight","StatusBadge","paidAt","method","reviewedKey","reviewed","reviewLabel","reviewNode","href","preventDefault","setItem","list","x","buildReviewHref","marginLeft","confirm","uRaw","alert","r","headers","body","stringify","t","text","toLocaleString","disabled","p","from","_","i","n","InvoiceModal","item","hotel","onClose","_c","buildInvoiceNumber","id","String","padStart","d","y","m","day","getDate","generateNightRows","ci","co","rows","cursor","idx","push","date","fmtDate","desc","qty","unit","amount","calcInvoiceTotals","extra","roomTotal","serviceTotal","tax","grand","nightRows","reduce","s","services","invoiceNo","custName","customerName","userName","checkInTime","checkOutTime","onMouseDown","currentTarget","stopPropagation","print","name","address","phone","website","_c2","paid","cls","pending","canceled","_c3","dt","dd","mm","yy","hh","getHours","mi","getMinutes","toISO","split","header","csv","v","replace","join","blob","Blob","a","document","createElement","createObjectURL","download","click","URLSearchParams","$RefreshReg$"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/PaymentHistory.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport './HomePage.css';\r\n\r\nexport default function PaymentHistory({ inline = false, onReview }) {\r\n  const navigate = useNavigate();\r\n  const [user, setUser] = useState(null);\r\n  const [items, setItems] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [q, setQ] = useState('');\r\n  const [fromDate, setFromDate] = useState(() => {\r\n    const now = new Date();\r\n    const start = new Date(now.getFullYear(), now.getMonth(), 1);\r\n    return toISODate(start);\r\n  });\r\n  const [toDate, setToDate] = useState(() => {\r\n    const now = new Date();\r\n    const end = new Date(now.getFullYear(), now.getMonth()+1, 0);\r\n    return toISODate(end);\r\n  });\r\n  const [status, setStatus] = useState('all');\r\n  const [page, setPage] = useState(1);\r\n  const pageSize = 10;\r\n  // Invoice state\r\n  const [invoiceItem, setInvoiceItem] = useState(null);\r\n  const [invoiceHotel, setInvoiceHotel] = useState(null);\r\n  const [invoiceLoading, setInvoiceLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    try { const u = localStorage.getItem('hmsUser'); setUser(u? JSON.parse(u): null);} catch { setUser(null);} \r\n  }, []);\r\n\r\n  const fetchList = async () => {\r\n    if (!user?.email) return;\r\n    setLoading(true); setError('');\r\n    try {\r\n      const url = new URL('/api/transactions', window.location.origin);\r\n      url.searchParams.set('email', user.email);\r\n      if (q) url.searchParams.set('q', q);\r\n      if (status && status !== 'all') url.searchParams.set('status', status);\r\n      if (fromDate) url.searchParams.set('from', fromDate);\r\n      if (toDate) url.searchParams.set('to', toDate);\r\n      const res = await fetch(url.toString());\r\n      if (!res.ok) throw new Error('Không tải được dữ liệu');\r\n      const j = await res.json();\r\n      let raw = Array.isArray(j.items)? j.items: [];\r\n      // Rehydrate refund info for canceled bookings (if server omitted it)\r\n      raw = raw.map(it => {\r\n        if(it.paymentStatus === 'canceled') {\r\n          if(it.refundAmount == null) {\r\n            // Try localStorage cache first\r\n            try {\r\n              const cache = localStorage.getItem('refund:'+it.bookingId);\r\n              if(cache) {\r\n                const parsed = JSON.parse(cache);\r\n                if(parsed && typeof parsed.refundAmount !== 'undefined') {\r\n                  return { ...it, refundAmount: parsed.refundAmount, cancellationFee: parsed.cancellationFee };\r\n                }\r\n              }\r\n            } catch {}\r\n            // Fallback compute (85% refund, 15% fee) based on total if available\r\n            const total = Number(it.total)||0;\r\n            if(total>0) {\r\n              const refundAmount = Math.round(total * 0.85);\r\n              const cancellationFee = total - refundAmount;\r\n              return { ...it, refundAmount, cancellationFee };\r\n            }\r\n          }\r\n        }\r\n        return it;\r\n      });\r\n      setItems(raw);\r\n    } catch (e) { setError(e.message || 'Lỗi tải dữ liệu'); }\r\n    finally { setLoading(false); }\r\n  };\r\n\r\n  useEffect(() => { fetchList(); }, [user]);\r\n\r\n  const filtered = useMemo(() => items, [items]);\r\n  const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));\r\n  const pageItems = filtered.slice((page-1)*pageSize, page*pageSize);\r\n\r\n  const topScrollRef = useRef(null);\r\n  const tableRef = useRef(null);\r\n\r\n  const openInvoice = async (row) => {\r\n    setInvoiceItem(null); setInvoiceHotel(null); setInvoiceLoading(true);\r\n    try {\r\n      // Optional: fetch hotel detail if needed in future\r\n      setInvoiceItem(row);\r\n    } catch { /* ignore */ } finally { setInvoiceLoading(false); }\r\n  };\r\n\r\n  return (\r\n    <div className={inline ? '' : 'home-root'} style={{ paddingTop: inline ? 0 : 80 }}>\r\n      {!inline && (\r\n        <header className=\"home-header\" style={{ position: 'sticky', top: 0 }}>\r\n          <div className=\"home-header-left\">\r\n            <img src=\"/logo.png\" alt=\"logo\" className=\"home-header-logo\" />\r\n            <Link to=\"/\" className=\"home-header-title home-header-home-btn\">TRANG CHỦ</Link>\r\n          </div>\r\n          <div className=\"home-header-icons\">\r\n            <Link to=\"/login\" className=\"home-header-icon\" title=\"Đăng nhập\">\r\n              <img src=\"/icon-user.png\" alt=\"user\" className=\"home-header-icon-img\" />\r\n            </Link>\r\n          </div>\r\n        </header>\r\n      )}\r\n      <div style={{ padding: inline ? '6px' : '16px 12px' }}>\r\n        <h2 className=\"home-rooms-title\" style={{ textAlign: 'left', marginTop: 12 }}>Lịch sử giao dịch</h2>\r\n        <div className=\"rt-toolbar\" style={{ alignItems: 'center' }}>\r\n          <div className=\"rt-field rt-field--wide\">\r\n            <label>Từ khóa</label>\r\n            <input type=\"text\" placeholder=\"VD: HMS20250904 hoặc HMS-AI Đà Nẵng\" value={q} onChange={(e)=>setQ(e.target.value)} />\r\n          </div>\r\n          <div className=\"rt-field\">\r\n            <label>Từ ngày</label>\r\n            <input type=\"date\" value={fromDate} onChange={(e)=>setFromDate(e.target.value)} />\r\n          </div>\r\n          <div className=\"rt-field\">\r\n            <label>Đến ngày</label>\r\n            <input type=\"date\" value={toDate} min={fromDate || undefined} onChange={(e)=>setToDate(e.target.value)} />\r\n          </div>\r\n          <div className=\"rt-field\">\r\n            <label>Trạng thái</label>\r\n            <select value={status} onChange={(e)=>setStatus(e.target.value)}>\r\n              <option value=\"all\">Tất cả</option>\r\n              <option value=\"paid\">Đã thanh toán</option>\r\n              <option value=\"pending\">Chờ thanh toán</option>\r\n              <option value=\"canceled\">Hủy</option>\r\n            </select>\r\n          </div>\r\n          <button className=\"ph-btn\" onClick={()=>{setPage(1); fetchList();}}>Tìm kiếm</button>\r\n          <button className=\"ph-btn ph-btn--secondary\" onClick={()=>exportCsv(filtered)}>Xuất CSV</button>\r\n        </div>\r\n\r\n        <div style={{ overflowX:'auto', maxWidth:'100%' }} ref={topScrollRef} className=\"ph-scroll-top\">\r\n          <div ref={tableRef} className=\"ph-table\" role=\"table\" aria-label=\"Lịch sử giao dịch\" style={{ minWidth:1700 }}>\r\n            <div className=\"ph-tr ph-head ph-hist\" role=\"row\">\r\n              {['MÃ ĐẶT PHÒNG','KHÁCH SẠN','PHÒNG','LOẠI PHÒNG','NHẬN PHÒNG','TRẢ PHÒNG','SỐ ĐÊM','KHÁCH','GIÁ/ĐÊM','TỔNG TIỀN','THANH TOÁN','THỜI GIAN TT','PTTT','HÀNH ĐỘNG'].map(h=> (\r\n                <div key={h} className=\"ph-td\" role=\"columnheader\">{h}</div>\r\n              ))}\r\n            </div>\r\n            {loading ? (\r\n              <div className=\"ph-empty\">Đang tải...</div>\r\n            ) : error ? (\r\n              <div className=\"ph-empty\" style={{ color: '#c1121f' }}>{error}</div>\r\n            ) : pageItems.length === 0 ? (\r\n              <div className=\"ph-empty\">Chưa có giao dịch</div>\r\n            ) : (\r\n              pageItems.map((it) => (\r\n                <div className=\"ph-tr ph-hist\" role=\"row\" key={it.bookingId}>\r\n                  <div className=\"ph-td code\">{it.code}</div>\r\n                  <div className=\"ph-td\">{it.hotelName}</div>\r\n                  <div className=\"ph-td\">{it.roomName || '—'}</div>\r\n                  <div className=\"ph-td\">{it.roomType || '—'}</div>\r\n                  <div className=\"ph-td\">{fmtDateTime(it.checkIn)}</div>\r\n                  <div className=\"ph-td\">{fmtDateTime(it.checkOut)}</div>\r\n                  <div className=\"ph-td center\">{it.nights}</div>\r\n                  <div className=\"ph-td\">{it.guests}</div>\r\n                  <div className=\"ph-td right\">{fmtMoney(it.pricePerNight)} VND</div>\r\n                  <div className=\"ph-td right\">{fmtMoney(it.total)} VND</div>\r\n                  <div className=\"ph-td\"><StatusBadge status={it.paymentStatus} /></div>\r\n                  <div className=\"ph-td\">{it.paidAt ? fmtDateTime(it.paidAt) : '—'}</div>\r\n                  <div className=\"ph-td\">{it.method || '—'}</div>\r\n                  <div className=\"ph-td action ph-action-inline\">\r\n                    {(() => {\r\n                      const reviewedKey = 'reviewedBooking:' + it.bookingId;\r\n                      let reviewed = false; try { reviewed = !!localStorage.getItem(reviewedKey); } catch {}\r\n                      const reviewLabel = reviewed ? 'Đã đánh giá' : 'Đánh giá';\r\n                      const reviewNode = (typeof onReview === 'function') ? (\r\n                        <a href=\"#\" className={reviewed? 'ph-link disabled' : 'ph-link'} onClick={(e)=>{ e.preventDefault(); if(reviewed) return; onReview(it); try { localStorage.setItem(reviewedKey,'1'); } catch {}; setItems(list=> list.map(x=> x.bookingId===it.bookingId ? { ...x } : x)); }}>{reviewLabel}</a>\r\n                      ) : (\r\n                        <a href={buildReviewHref(it)} className={reviewed? 'ph-link disabled':'ph-link'} onClick={()=>{ if(!reviewed){ try { localStorage.setItem(reviewedKey,'1'); } catch {}; } }}>{reviewLabel}</a>\r\n                      );\r\n                      return <>{reviewNode}</>;\r\n                    })()}\r\n                    {it.paymentStatus==='paid' && (\r\n                      <button\r\n                        className=\"ph-btn ph-btn--secondary\"\r\n                        style={{ marginLeft:8 }}\r\n                        onClick={()=> openInvoice(it)}\r\n                      >Hóa đơn</button>\r\n                    )}\r\n                    {it.paymentStatus==='pending' && (\r\n                      <button\r\n                        className=\"ph-cancel-btn\"\r\n                        onClick={async()=>{\r\n                          if(!window.confirm('Hủy giao dịch này? Hoàn 85%, phí 15%.')) return;\r\n                          try {\r\n                            const uRaw = localStorage.getItem('hmsUser');\r\n                            const email = uRaw? JSON.parse(uRaw).email: null;\r\n                            if(!email) { alert('Chưa đăng nhập'); return; }\r\n                            const r = await fetch(`/api/payments/${it.bookingId}/cancel`, { method:'PUT', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ email }) });\r\n                            if(!r.ok){ const t=await r.text(); throw new Error(t); }\r\n                            const j = await r.json();\r\n                            setItems(list => list.map(x => x.bookingId===it.bookingId ? { ...x, paymentStatus:'canceled', refundAmount:j.refundAmount, cancellationFee:j.cancellationFee } : x));\r\n                            // Persist refund info locally so it shows after navigation\r\n                            try { localStorage.setItem('refund:'+it.bookingId, JSON.stringify({ refundAmount:j.refundAmount, cancellationFee:j.cancellationFee })); } catch {}\r\n                          } catch(e){ alert(e.message||'Hủy thất bại'); }\r\n                        }}\r\n                        title=\"Hủy giao dịch\"\r\n                      >Hủy</button>\r\n                    )}\r\n                    {it.paymentStatus==='canceled' && (it.refundAmount!=null) && (\r\n                      <span className=\"ph-refund-note\">Hoàn: {Number(it.refundAmount).toLocaleString('vi-VN')} VND</span>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        </div>\r\n        {/* Removed secondary scrollbar to keep UI clean */}\r\n\r\n        <div className=\"ph-pager\">\r\n          <button disabled={page<=1} onClick={()=>setPage((p)=>Math.max(1,p-1))}>«</button>\r\n          {Array.from({length: totalPages}, (_,i)=>i+1).slice(0,5).map(n => (\r\n            <button key={n} className={n===page? 'active': ''} onClick={()=>setPage(n)}>{n}</button>\r\n          ))}\r\n          <button disabled={page>=totalPages} onClick={()=>setPage((p)=>Math.min(totalPages,p+1))}>»</button>\r\n        </div>\r\n      </div>\r\n      {invoiceItem && (\r\n        <InvoiceModal item={invoiceItem} hotel={invoiceHotel} onClose={()=>setInvoiceItem(null)} />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ================= INVOICE HELPERS & MODAL =================\r\nfunction buildInvoiceNumber(item){\r\n  if(!item) return '';\r\n  const id = String(item.bookingId||'').padStart(6,'0');\r\n  // Use paid date or today for sequence prefix\r\n  const d = item.paidAt? new Date(item.paidAt): new Date();\r\n  const y = d.getFullYear(); const m = String(d.getMonth()+1).padStart(2,'0'); const day = String(d.getDate()).padStart(2,'0');\r\n  return `HD${y}${m}${day}-${id}`;\r\n}\r\n\r\nfunction generateNightRows(item){\r\n  if(!item) return [];\r\n  try {\r\n    const ci = new Date(item.checkIn); const co = new Date(item.checkOut);\r\n    const rows=[]; let cursor = new Date(ci.getFullYear(), ci.getMonth(), ci.getDate());\r\n    let idx=0; while(cursor < co){\r\n      if(idx>60){ // safety stop for abnormal data\r\n        rows.push({ date: fmtDate(cursor), desc:'Tiền phòng (gộp)', qty: (item.nights||0)-idx, unit: item.pricePerNight, amount: item.pricePerNight*((item.nights||0)-idx)});\r\n        break;\r\n      }\r\n      rows.push({ date: fmtDate(cursor), desc:'Tiền phòng', qty:1, unit:item.pricePerNight, amount:item.pricePerNight });\r\n      cursor = new Date(cursor.getFullYear(), cursor.getMonth(), cursor.getDate()+1); idx++;\r\n      if(idx >= (item.nights||0)) break;\r\n    }\r\n    return rows;\r\n  } catch { return []; }\r\n}\r\n\r\nfunction calcInvoiceTotals(item, extra){\r\n  if(!item) return { roomTotal:0, serviceTotal:0, tax:0, grand:0};\r\n  const nightRows = generateNightRows(item);\r\n  const roomTotal = nightRows.reduce((s,r)=> s + Number(r.amount||0), 0);\r\n  const serviceTotal = (extra&&Array.isArray(extra.services)) ? extra.services.reduce((s,r)=> s+Number(r.amount||0),0):0;\r\n  const tax = Math.round(roomTotal * 0.03); // 3% VAT giả định\r\n  const grand = roomTotal + serviceTotal + tax;\r\n  return { roomTotal, serviceTotal, tax, grand, nightRows };\r\n}\r\n\r\nfunction InvoiceModal({ item, hotel, onClose }){\r\n  if(!item) return null;\r\n  const { roomTotal, serviceTotal, tax, grand, nightRows } = calcInvoiceTotals(item, {});\r\n  const invoiceNo = buildInvoiceNumber(item);\r\n  const custName = item.customerName || item.userName || 'Khách hàng';\r\n  const checkInTime = '14:00:00';\r\n  const checkOutTime = '12:00:00';\r\n  return (\r\n    <div className=\"invoice-overlay\" onMouseDown={(e)=>{ if(e.target===e.currentTarget) onClose(); }}>\r\n      <div className=\"invoice-modal\" onMouseDown={(e)=>e.stopPropagation()}> \r\n        <div className=\"invoice-actions\">\r\n          <button className=\"ph-btn ph-btn--secondary\" onClick={()=>window.print()}>In / Lưu PDF</button>\r\n          <button className=\"ph-btn\" onClick={onClose}>Đóng</button>\r\n        </div>\r\n        <div className=\"invoice-paper\">\r\n          <header className=\"invoice-header\">\r\n            <div className=\"brand-block\">\r\n              <div className=\"brand-logo\">HMS - AI</div>\r\n              <div className=\"brand-meta\">\r\n                <div>{hotel?.name || 'HMS - AI - Demo1'}</div>\r\n                <div>{hotel?.address || '03 Quang Trung - Đà Nẵng'}</div>\r\n                <div>{hotel?.phone || '0388618687 · E: hms@gmail.com'}</div>\r\n                <div>{hotel?.website || 'www.demonwebsite.com'}</div>\r\n              </div>\r\n            </div>\r\n            <div className=\"invoice-title-block\">\r\n              <h1>HÓA ĐƠN</h1>\r\n              <div className=\"inv-meta\"><span>Số hóa đơn:</span> {invoiceNo}</div>\r\n              <div className=\"inv-meta\"><span>Ngày:</span> {fmtDateTime(item.paidAt || Date.now())}</div>\r\n            </div>\r\n          </header>\r\n          <section className=\"invoice-cards\">\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Mã đặt phòng</div><div className=\"inv-value\">{item.code}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Nguồn</div><div className=\"inv-value\">HMS-AI</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Phòng</div><div className=\"inv-value\">{item.roomName || '—'}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Tên khách hàng</div><div className=\"inv-value\">{custName}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Ngày nhận</div><div className=\"inv-value\">{fmtDate(item.checkIn)}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Ngày trả</div><div className=\"inv-value\">{fmtDate(item.checkOut)}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Loại phòng</div><div className=\"inv-value\">{item.roomType}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Số đêm lưu trú</div><div className=\"inv-value\">{item.nights}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Giờ nhận</div><div className=\"inv-value\">{checkInTime}</div></div>\r\n            <div className=\"inv-card\"><div className=\"inv-label\">Giờ trả</div><div className=\"inv-value\">{checkOutTime}</div></div>\r\n          </section>\r\n          <section className=\"invoice-table-section\">\r\n            <table className=\"invoice-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>#</th>\r\n                  <th>Ngày</th>\r\n                  <th>Phòng / Nội dung</th>\r\n                  <th>Số lượng</th>\r\n                  <th>Đơn giá</th>\r\n                  <th>Thành tiền</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {nightRows.map((r,i)=> (\r\n                  <tr key={i}>\r\n                    <td>{i+1}</td>\r\n                    <td>{r.date}</td>\r\n                    <td>{r.desc}</td>\r\n                    <td>{r.qty}</td>\r\n                    <td>{fmtMoney(r.unit)} VND</td>\r\n                    <td>{fmtMoney(r.amount)} VND</td>\r\n                  </tr>\r\n                ))}\r\n                {serviceTotal>0 && (\r\n                  <tr>\r\n                    <td>{nightRows.length+1}</td>\r\n                    <td>—</td>\r\n                    <td>Dịch vụ</td>\r\n                    <td>1</td>\r\n                    <td>{fmtMoney(serviceTotal)} VND</td>\r\n                    <td>{fmtMoney(serviceTotal)} VND</td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </section>\r\n          <section className=\"invoice-summary\">\r\n            <div className=\"inv-sum-row\"><span>Tiền phòng</span><strong>{fmtMoney(roomTotal)} VND</strong></div>\r\n            {serviceTotal>0 && <div className=\"inv-sum-row\"><span>Phí dịch vụ</span><strong>{fmtMoney(serviceTotal)} VND</strong></div>}\r\n            <div className=\"inv-sum-row\"><span>Thuế (3%)</span><strong>{fmtMoney(tax)} VND</strong></div>\r\n            <div className=\"inv-sum-row inv-total\"><span>Tổng tiền</span><strong>{fmtMoney(grand)} VND</strong></div>\r\n          </section>\r\n          <section className=\"invoice-footer-text\">\r\n            <p>Cảm ơn Quý khách đã tin tưởng và sử dụng dịch vụ của chúng tôi.</p>\r\n            <p>Chúc Quý khách có một kỳ nghĩ vui vẻ!</p>\r\n          </section>\r\n          <section className=\"invoice-sign\">\r\n            <div className=\"sig-col\">Lễ tân<br/><br/><br/>__________________</div>\r\n            <div className=\"sig-col\">Khách hàng<br/><br/><br/>__________________</div>\r\n          </section>\r\n        </div>\r\n        <style>{`\r\n          .invoice-overlay{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;align-items:flex-start;justify-content:center;overflow:auto;z-index:4000;padding:30px 18px;}\r\n          .invoice-modal{background:#fff;border-radius:14px;max-width:980px;width:100%;box-shadow:0 10px 40px -8px rgba(0,0,0,.3);padding:18px 18px 32px;animation:invIn .45s ease;}\r\n          @keyframes invIn{from{opacity:0;transform:translateY(18px);}to{opacity:1;transform:translateY(0);}}\r\n          .invoice-actions{display:flex;justify-content:flex-end;gap:10px;margin-bottom:8px;}\r\n          .invoice-paper{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#0f172a;}\r\n          .invoice-header{display:flex;justify-content:space-between;border-bottom:3px solid #0f5fa8;padding-bottom:12px;margin-bottom:14px;gap:20px;}\r\n          .brand-logo{font-weight:700;font-size:20px;background:#0f5fa8;color:#fff;padding:6px 14px;border-radius:6px;display:inline-block;margin-bottom:6px;}\r\n          .brand-meta div{font-size:12px;line-height:1.25;color:#334155;}\r\n          .invoice-title-block{text-align:right;}\r\n          .invoice-title-block h1{margin:0 0 6px;font-size:28px;letter-spacing:.5px;color:#0f5fa8;}\r\n          .inv-meta{font-size:12px;color:#475569;}\r\n          .inv-meta span{font-weight:600;color:#0f172a;}\r\n          .invoice-cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px;margin:6px 0 18px;}\r\n          .inv-card{background:#f1f5f9;border:1px solid #e2e8f0;border-radius:8px;padding:8px 10px;min-height:66px;display:flex;flex-direction:column;justify-content:center;}\r\n          .inv-label{font-size:11px;text-transform:uppercase;letter-spacing:.5px;color:#64748b;font-weight:600;margin-bottom:4px;}\r\n          .inv-value{font-size:13px;font-weight:600;color:#0f172a;word-break:break-word;}\r\n          .invoice-table{width:100%;border-collapse:collapse;font-size:13px;}\r\n          .invoice-table th{background:#0f5fa8;color:#fff;padding:8px 10px;text-align:left;font-weight:600;font-size:12px;}\r\n          .invoice-table td{padding:8px 10px;border-bottom:1px solid #e2e8f0;}\r\n          .invoice-table tbody tr:nth-child(even){background:#f8fafc;}\r\n          .invoice-summary{margin-top:18px;border-top:2px solid #0f5fa8;padding-top:12px;max-width:360px;margin-left:auto;font-size:13px;}\r\n          .inv-sum-row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dashed #e2e8f0;}\r\n          .inv-sum-row:last-child{border-bottom:none;}\r\n          .inv-total{font-size:14px;font-weight:700;}\r\n          .invoice-footer-text{margin-top:22px;font-size:12px;color:#475569;text-align:center;}\r\n          .invoice-sign{display:flex;justify-content:space-between;margin-top:38px;font-size:13px;text-align:center;}\r\n          .sig-col{flex:1;}\r\n          @media print{body{background:#fff;} .invoice-overlay{position:static;background:#fff;box-shadow:none;padding:0;} .invoice-modal{box-shadow:none;padding:0;} .invoice-actions{display:none;} .invoice-table th{background:#0f5fa8 !important;-webkit-print-color-adjust:exact;print-color-adjust:exact;} .inv-card{background:#f1f5f9 !important;-webkit-print-color-adjust:exact;print-color-adjust:exact;} }\r\n        `}</style>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nfunction StatusBadge({ status }) {\r\n  const map = {\r\n    paid: { text: 'Đã thanh toán', cls: 'ok' },\r\n    pending: { text: 'Chờ thanh toán', cls: 'pending' },\r\n    canceled: { text: 'Hủy', cls: 'cancel' },\r\n  };\r\n  const s = map[status] || map.pending;\r\n  return <span className={`ph-badge ${s.cls}`}>{s.text}</span>;\r\n}\r\n\r\nfunction toISODate(d){ const dt = new Date(d); const y=dt.getFullYear(); const m=String(dt.getMonth()+1).padStart(2,'0'); const day=String(dt.getDate()).padStart(2,'0'); return `${y}-${m}-${day}`; }\r\nfunction fmtDate(d){ const dt = new Date(d); const dd=String(dt.getDate()).padStart(2,'0'); const mm = String(dt.getMonth()+1).padStart(2,'0'); const yy = dt.getFullYear(); return `${dd}/${mm}/${yy}`; }\r\nfunction fmtDateTime(d){ if(!d) return ''; const dt=new Date(d); const hh=String(dt.getHours()).padStart(2,'0'); const mi=String(dt.getMinutes()).padStart(2,'0'); return `${fmtDate(dt)} ${hh}:${mi}`; }\r\nfunction toISO(s){ const [d,m,y] = s.split('/'); return `${y}-${m}-${d}`; }\r\nfunction fmtMoney(n){ return Number(n||0).toLocaleString('vi-VN'); }\r\nfunction exportCsv(list){\r\n  const header = ['Mã đặt','Khách sạn','Phòng','Loại phòng','Nhận','Trả','Số đêm','Khách','Giá/đêm','Tổng','Trạng thái','Thanh toán','PTTT'];\r\n  const rows = list.map(it => [\r\n    it.code,\r\n    it.hotelName,\r\n    (it.roomName||''),\r\n    (it.roomType||''),\r\n    fmtDateTime(it.checkIn),\r\n    fmtDateTime(it.checkOut),\r\n    it.nights,\r\n    it.guests,\r\n    fmtMoney(it.pricePerNight),\r\n    fmtMoney(it.total),\r\n    it.paymentStatus,\r\n    (it.paidAt?fmtDateTime(it.paidAt):''),\r\n    it.method\r\n  ]);\r\n  const csv = [header, ...rows].map(r=>r.map(v=>`\"${String(v).replace(/\"/g,'\"\"')}\"`).join(',')).join('\\n');\r\n  const blob = new Blob([\"\\uFEFF\"+csv], { type: 'text/csv;charset=utf-8;' });\r\n  const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'lich-su-giao-dich.csv'; a.click();\r\n}\r\n\r\nfunction buildReviewHref(it){\r\n  const q = new URLSearchParams({\r\n    bookingId: String(it.bookingId || ''),\r\n    hotel: String(it.hotelName || ''),\r\n    roomType: String(it.roomType || ''),\r\n    ci: it.checkIn ? toISODate(it.checkIn) : '',\r\n    co: it.checkOut ? toISODate(it.checkOut) : '',\r\n  });\r\n  return `/review?${q.toString()}`;\r\n}\r\n\r\n// Styles for .ph-action-inline, .ph-link, .ph-cancel-btn, .ph-refund-note moved to HomePage.css\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}