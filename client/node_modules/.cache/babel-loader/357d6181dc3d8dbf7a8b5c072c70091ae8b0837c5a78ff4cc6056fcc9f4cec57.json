{"ast":null,"code":"import _objectSpread from\"D:/DA_TichHop/HMS_AI Hotel/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useRef,useState}from'react';import'./HomePage.css';import{authHeaders}from'./auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const STATUS_UI=['Trống','Đang ở','Đang dọn dẹp','Đang bảo trì'];const statusDbToUi=s=>{const v=String(s||'').toLowerCase();if(v==='available')return'Trống';if(v==='occupied')return'Đang ở';if(v==='cleaning')return'Đang dọn dẹp';if(v==='maintenance')return'Đang bảo trì';return'Trống';};const statusUiToDb=s=>{const v=String(s||'').toLowerCase();if(v.includes('trống'))return'Available';if(v.includes('đang ở'))return'Occupied';if(v.includes('dọn'))return'Cleaning';if(v.includes('bảo trì'))return'Maintenance';return'Available';};export default function AdminRooms(_ref){let{isModal,onClose}=_ref;const[q,setQ]=useState('');const[typeId,setTypeId]=useState('');const[hotelFilter,setHotelFilter]=useState('');const[items,setItems]=useState([]);const[totalRoomCount,setTotalRoomCount]=useState(0);// tổng số phòng (không lọc)\nconst[types,setTypes]=useState([]);const[hotels,setHotels]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[isCreateOpen,setIsCreateOpen]=useState(false);const[creating,setCreating]=useState(false);const[newRoom,setNewRoom]=useState({images:[],price:'',roomNumber:'',status:'Trống',roomTypeId:'',floor:'',description:''});const[newErrors,setNewErrors]=useState({});// For per-room image upload\nconst roomImageInputRef=useRef(null);const[activeRoomForImage,setActiveRoomForImage]=useState(null);// Ảnh tạm thời (chưa upload) mỗi phòng: { [roomId]: { file, preview } }\nconst[pendingRoomImages,setPendingRoomImages]=useState({});const fetchRooms=async function(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};setLoading(true);setError('');try{const url=new URL('/api/admin/rooms',window.location.origin);if(q)url.searchParams.set('q',q);if(typeId)url.searchParams.set('typeId',String(typeId));if(hotelFilter)url.searchParams.set('hotelId',String(hotelFilter));if(params.q!==undefined){url.searchParams.set('q',params.q);}if(params.typeId!==undefined){if(params.typeId)url.searchParams.set('typeId',String(params.typeId));else url.searchParams.delete('typeId');}if(params.hotelId!==undefined){if(params.hotelId)url.searchParams.set('hotelId',String(params.hotelId));else url.searchParams.delete('hotelId');}const res=await fetch(url.toString(),{headers:_objectSpread({},authHeaders())});if(!res.ok)throw new Error('Không tải được danh sách phòng');const j=await res.json();const list=Array.isArray(j.rooms)?j.rooms:[];const mapped=list.map(r=>{let imgs=r.images;if(typeof imgs==='string'){try{const parsed=JSON.parse(imgs);if(Array.isArray(parsed))imgs=parsed;}catch(_unused){/* ignore */}}if(!Array.isArray(imgs))imgs=[];return _objectSpread(_objectSpread({},r),{},{images:imgs,statusVi:statusDbToUi(r.status)});});setItems(mapped);// Cập nhật tổng số phòng (không lọc: gọi một lần không tham số nếu có filter)\ntry{if(q||typeId||hotelFilter){const allRes=await fetch(new URL('/api/admin/rooms',window.location.origin),{headers:_objectSpread({},authHeaders())});if(allRes.ok){const allJ=await allRes.json();const allList=Array.isArray(allJ.rooms)?allJ.rooms:[];setTotalRoomCount(allList.length);}}else{setTotalRoomCount(mapped.length);}}catch(_unused2){}}catch(e){setError(e.message||'Lỗi tải dữ liệu');setItems([]);}finally{setLoading(false);}};const fetchTypes=async hotelId=>{try{const url=new URL('/api/room-types',window.location.origin);if(hotelId)url.searchParams.set('hotelId',String(hotelId));const res=await fetch(url,{headers:_objectSpread({},authHeaders())});if(!res.ok)throw new Error();const list=await res.json();setTypes(Array.isArray(list)?list:[]);}catch(_unused3){setTypes([]);}};const fetchHotels=async()=>{try{const res=await fetch('/api/hotels');if(!res.ok)throw new Error();const list=await res.json();setHotels(Array.isArray(list)?list:[]);}catch(_unused4){setHotels([]);}};useEffect(()=>{fetchHotels();fetchTypes();fetchRooms({q:''});},[]);// Live search debounce\nconst debounceRef=useRef(null);useEffect(()=>{if(debounceRef.current)clearTimeout(debounceRef.current);debounceRef.current=setTimeout(()=>{fetchRooms({});},250);return()=>{if(debounceRef.current)clearTimeout(debounceRef.current);};},[q,typeId,hotelFilter]);const updateField=(id,field,value)=>{setItems(prev=>prev.map(it=>it.id===id?_objectSpread(_objectSpread({},it),{},{[field]:value}):it));};const handleSave=async it=>{try{let imagesToPersist=it.images&&it.images.length?[...it.images]:[];// Nếu có ảnh pending thì upload trước rồi thay preview\nif(pendingRoomImages[it.id]){const{file,preview}=pendingRoomImages[it.id];const form=new FormData();form.append('files',file);const uploadRes=await fetch('/api/admin/rooms/upload',{method:'POST',body:form,headers:_objectSpread({},authHeaders())});if(!uploadRes.ok)throw new Error('Tải ảnh thất bại');const uj=await uploadRes.json();const upList=Array.isArray(uj.files)?uj.files:[];if(!upList.length)throw new Error('Không nhận được ảnh');const realPath=upList[0];if(imagesToPersist.length){if(imagesToPersist[0]===preview){imagesToPersist[0]=realPath;}else{imagesToPersist=[realPath,...imagesToPersist];}}else{imagesToPersist=[realPath];}// cleanup preview object URL & state\nURL.revokeObjectURL(preview);setPendingRoomImages(prev=>{const cp=_objectSpread({},prev);delete cp[it.id];return cp;});}// Loại bỏ mọi blob preview còn sót\nimagesToPersist=imagesToPersist.filter(u=>typeof u==='string'&&!u.startsWith('blob:'));const payload={roomNumber:it.roomNumber,roomTypeId:it.roomTypeId,status:statusUiToDb(it.statusVi),images:imagesToPersist.length?imagesToPersist:undefined};const res=await fetch(\"/api/admin/rooms/\".concat(it.id),{method:'PUT',headers:_objectSpread({'Content-Type':'application/json'},authHeaders()),body:JSON.stringify(payload)});if(!res.ok)throw new Error('Lưu thất bại');await fetchRooms({});alert('Đã lưu phòng');}catch(e){alert(e.message||'Lỗi lưu');}};const onSelectRoomImage=room=>{var _roomImageInputRef$cu;setActiveRoomForImage(room);(_roomImageInputRef$cu=roomImageInputRef.current)===null||_roomImageInputRef$cu===void 0?void 0:_roomImageInputRef$cu.click();};const onRoomImageChosen=async e=>{const files=Array.from(e.target.files||[]);if(!files.length||!activeRoomForImage)return;const f=files[0];const preview=URL.createObjectURL(f);const roomId=activeRoomForImage.id;// Lưu ảnh tạm\nsetPendingRoomImages(prev=>_objectSpread(_objectSpread({},prev),{},{[roomId]:{file:f,preview}}));// Hiển thị ngay preview ở vị trí ảnh đầu\nsetItems(prev=>prev.map(it=>it.id===roomId?_objectSpread(_objectSpread({},it),{},{images:it.images&&it.images.length?[preview,...it.images.slice(1)]:[preview]}):it));setActiveRoomForImage(null);if(roomImageInputRef.current)roomImageInputRef.current.value='';};const handleDelete=async it=>{if(!window.confirm('Xóa phòng này?'))return;try{const res=await fetch(\"/api/admin/rooms/\".concat(it.id),{method:'DELETE',headers:_objectSpread({},authHeaders())});if(!res.ok)throw new Error('Xóa thất bại');await fetchRooms({});}catch(e){alert(e.message||'Lỗi xóa');}};const selectedType=useMemo(()=>{const id=Number(newRoom.roomTypeId||0);return types.find(t=>Number(t.id)===id)||null;},[types,newRoom.roomTypeId]);const selectedHotel=useMemo(()=>{const hid=Number(newRoom.hotelId||0);return hotels.find(h=>Number(h.id)===hid)||null;},[hotels,newRoom.hotelId]);const computedErrors=useMemo(()=>{const e={};if(!newRoom.roomNumber||!String(newRoom.roomNumber).trim())e.roomNumber='Vui lòng nhập số phòng';if(!newRoom.hotelId)e.hotelId='Vui lòng chọn khách sạn';if(!newRoom.roomTypeId)e.roomTypeId='Vui lòng chọn loại phòng';if(!newRoom.status)e.status='Vui lòng chọn trạng thái';if(newRoom.floor!==''&&Number.isNaN(Number(newRoom.floor)))e.floor='Tầng không hợp lệ';return e;},[newRoom]);const isFormValid=useMemo(()=>Object.keys(computedErrors).length===0,[computedErrors]);const tooltipText=useMemo(()=>{if(isFormValid||creating)return'';const msgs=[];if(computedErrors.roomNumber)msgs.push(computedErrors.roomNumber);if(computedErrors.roomTypeId)msgs.push(computedErrors.roomTypeId);if(computedErrors.status)msgs.push(computedErrors.status);return msgs.join('; ');},[computedErrors,isFormValid,creating]);const handleCreate=async()=>{setNewErrors(computedErrors);if(!isFormValid)return;setCreating(true);try{const payload={roomNumber:String(newRoom.roomNumber).trim(),roomTypeId:Number(newRoom.roomTypeId),status:statusUiToDb(newRoom.status),hotelId:newRoom.hotelId?Number(newRoom.hotelId):undefined,floor:newRoom.floor!==''?Number(newRoom.floor):undefined,price:selectedType?Number(selectedType.basePrice||0):undefined,description:newRoom.description||undefined,images:newRoom.images&&newRoom.images.length?newRoom.images:undefined};const res=await fetch('/api/admin/rooms',{method:'POST',headers:_objectSpread({'Content-Type':'application/json'},authHeaders()),body:JSON.stringify(payload)});if(!res.ok){let msg='Tạo thất bại';try{const j=await res.json();if(j!==null&&j!==void 0&&j.message)msg=j.message;}catch(_unused5){const t=await res.text();if(t)msg=t;}throw new Error(msg);}setNewRoom({images:[],price:'',roomNumber:'',status:'Trống',hotelId:'',roomTypeId:'',floor:'',description:''});setNewErrors({});// Reset filters and refresh list to default view\nsetQ('');setTypeId('');setHotelFilter('');await fetchTypes();await fetchRooms({q:'',typeId:'',hotelId:''});setCreating(false);alert('Tạo phòng thành công');setIsCreateOpen(false);}catch(e){alert(e.message||'Lỗi tạo');setCreating(false);}};const fileInputRef=useRef(null);const onPickFiles=()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();};const onFilesSelected=async e=>{const files=Array.from(e.target.files||[]);if(!files.length)return;const current=(newRoom.images||[]).length;const spaceLeft=Math.max(0,5-current);if(spaceLeft<=0){alert('Bạn chỉ có thể chọn tối đa 5 ảnh.');return;}const pick=files.slice(0,spaceLeft);const form=new FormData();for(const f of pick)form.append('files',f);try{const res=await fetch('/api/admin/rooms/upload',{method:'POST',body:form,headers:_objectSpread({},authHeaders())});if(!res.ok)throw new Error('Tải ảnh thất bại');const j=await res.json();const list=Array.isArray(j.files)?j.files:[];setNewRoom(r=>_objectSpread(_objectSpread({},r),{},{images:[...(r.images||[]),...list]}));}catch(err){alert(err.message||'Lỗi tải ảnh');}};const removeImage=idx=>{setNewRoom(r=>_objectSpread(_objectSpread({},r),{},{images:(r.images||[]).filter((_,i)=>i!==idx)}));};const statusColorClass=label=>{if(!label)return'';if(label.includes('Trống'))return'room-status-green';if(label.includes('dọn'))return'room-status-yellow';if(label.includes('Đang ở')||label.includes('bảo trì'))return'room-status-red';return'';};return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-rooms\",style:{padding:isModal?0:'80px 12px 20px'},children:[!isModal&&/*#__PURE__*/_jsx(\"header\",{className:\"home-header\",style:{position:'sticky',top:0},children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-header-left\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"logo\",className:\"home-header-logo\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/\",className:\"home-header-title home-header-home-btn\",children:\"TRANG CH\\u1EE6\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ph-table\",style:{padding:16},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"home-rooms-title\",style:{textAlign:'left',marginTop:0},children:\"Qu\\u1EA3n l\\xFD ph\\xF2ng kh\\xE1ch s\\u1EA1n\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>e.preventDefault(),className:\"au-toolbar\",style:{gridTemplateColumns:'1fr auto auto auto'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"au-group\",children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(\"input\",{className:\"au-input\",placeholder:\"T\\xECm ki\\u1EBFm ph\\xF2ng...\",value:q,onChange:e=>setQ(e.target.value)}),totalRoomCount?/*#__PURE__*/_jsxs(\"div\",{className:\"room-count-badge\",title:\"T\\u1ED5ng s\\u1ED1 ph\\xF2ng hi\\u1EC7n c\\xF3 trong h\\u1EC7 th\\u1ED1ng\",children:[\"T\\u1ED5ng: \",totalRoomCount]}):null]})}),/*#__PURE__*/_jsxs(\"select\",{className:\"ph-btn ph-btn--secondary\",value:hotelFilter,onChange:e=>{const hid=e.target.value;setHotelFilter(hid);fetchTypes(hid||undefined);},style:{height:36},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3 kh\\xE1ch s\\u1EA1n\"}),hotels.map(h=>/*#__PURE__*/_jsx(\"option\",{value:h.id,children:h.name},h.id))]}),/*#__PURE__*/_jsxs(\"select\",{className:\"ph-btn ph-btn--secondary\",value:typeId,onChange:e=>setTypeId(e.target.value),style:{height:36},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3 lo\\u1EA1i ph\\xF2ng\"}),types.map(t=>/*#__PURE__*/_jsx(\"option\",{value:t.id,children:t.name},t.id))]}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn au-add-btn\",type:\"button\",onClick:()=>{setIsCreateOpen(true);setNewErrors({});},children:\"+ Th\\xEAm ph\\xF2ng\"})]}),loading?/*#__PURE__*/_jsx(\"div\",{style:{color:'#666'},children:\"\\u0110ang t\\u1EA3i...\"}):error?/*#__PURE__*/_jsx(\"div\",{style:{color:'#b42318'},children:error}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ph-tr ph-head\",style:{gridTemplateColumns:'100px 120px 1.1fr 1fr 1fr 1.4fr 1fr 1.1fr'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"\\u1EA2nh\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"S\\u1ED1 ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"Lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"Gi\\xE1 (VN\\u0110/\\u0111\\xEAm)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"S\\u1EE9c ch\\u1EE9a\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"Ti\\u1EC7n nghi\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:\"H\\xE0nh \\u0111\\u1ED9ng\"})]}),items.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",style:{padding:12,color:'#666'},children:\"Kh\\xF4ng c\\xF3 ph\\xF2ng n\\xE0o.\"}):items.map(it=>/*#__PURE__*/_jsxs(\"div\",{className:\"ph-tr\",style:{gridTemplateColumns:'100px 120px 1.1fr 1fr 1fr 1.4fr 1fr 1.1fr'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:/*#__PURE__*/_jsx(\"div\",{onClick:()=>onSelectRoomImage(it),className:\"admin-room-thumb\",title:\"B\\u1EA5m \\u0111\\u1EC3 th\\xEAm/\\u0111\\u1ED5i \\u1EA3nh\",children:Array.isArray(it.images)&&it.images.length?/*#__PURE__*/_jsx(\"img\",{src:it.images[0],alt:\"thumb\",style:pendingRoomImages[it.id]?{outline:'2px dashed #ff9800'}:undefined}):/*#__PURE__*/_jsx(\"span\",{children:\"No image\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:/*#__PURE__*/_jsx(\"input\",{value:it.roomNumber||'',onChange:e=>updateField(it.id,'roomNumber',e.target.value)})}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:/*#__PURE__*/_jsxs(\"select\",{value:it.roomTypeId||'',onChange:e=>updateField(it.id,'roomTypeId',Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u2014\"}),types.map(t=>/*#__PURE__*/_jsx(\"option\",{value:t.id,children:t.name},t.id))]})}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:Number(it.basePrice||0).toLocaleString('vi-VN')}),/*#__PURE__*/_jsxs(\"div\",{className:\"ph-td\",children:[Number(it.maxAdults||0),\" kh\\xE1ch\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",title:it.amenities||'',style:{overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'},children:it.amenities||'—'}),/*#__PURE__*/_jsx(\"div\",{className:\"ph-td\",children:/*#__PURE__*/_jsx(\"select\",{value:it.statusVi,onChange:e=>updateField(it.id,'statusVi',e.target.value),className:statusColorClass(it.statusVi),children:STATUS_UI.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ph-td\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",type:\"button\",onClick:()=>handleSave(it),children:\"S\\u1EEDa\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",type:\"button\",onClick:()=>handleDelete(it),children:\"X\\xF3a\"})]})]},it.id))]}),/*#__PURE__*/_jsx(\"input\",{ref:roomImageInputRef,type:\"file\",accept:\"image/*\",hidden:true,onChange:onRoomImageChosen})]}),isCreateOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"profile-overlay\",onMouseDown:e=>{if(e.target===e.currentTarget)setIsCreateOpen(false);},children:/*#__PURE__*/_jsx(\"div\",{className:\"profile-modal\",onMouseDown:e=>e.stopPropagation(),style:{width:980,maxWidth:'98%'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"ph-table\",style:{padding:16},children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0,textAlign:'center'},children:\"Th\\xEAm Ph\\xF2ng M\\u1EDBi\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"room-create-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rc-left\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"H\\xECnh \\u1EA3nh ph\\xF2ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-uploader\",onClick:onPickFiles,children:[(newRoom.images||[]).length?/*#__PURE__*/_jsx(\"div\",{className:\"rc-thumbs\",children:newRoom.images.map((url,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"rc-thumb\",children:[/*#__PURE__*/_jsx(\"img\",{src:url,alt:\"\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"rc-thumb-del\",onClick:ev=>{ev.stopPropagation();removeImage(idx);},children:\"\\xD7\"})]},idx))}):/*#__PURE__*/_jsx(\"div\",{className:\"rc-empty\",children:\"B\\u1EA5m \\u0111\\u1EC3 ch\\u1ECDn \\u1EA3nh\"}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,onChange:onFilesSelected,type:\"file\",accept:\"image/*\",multiple:true,hidden:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-hint\",children:[(newRoom.images||[]).length,\"/5 \\u1EA3nh\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Gi\\xE1 c\\u01A1 b\\u1EA3n (VND)\"}),/*#__PURE__*/_jsx(\"input\",{value:selectedType?Number(selectedType.basePrice||0).toLocaleString('vi-VN'):'',placeholder:\"VD: 850000\",disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"S\\u1ED1 ph\\xF2ng\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Nh\\u1EADp s\\u1ED1 ph\\xF2ng\",className:newErrors.roomNumber?'au-error':'',value:newRoom.roomNumber,onChange:e=>{setNewRoom(_objectSpread(_objectSpread({},newRoom),{},{roomNumber:e.target.value}));if(newErrors.roomNumber)setNewErrors(_objectSpread(_objectSpread({},newErrors),{},{roomNumber:undefined}));}}),newErrors.roomNumber?/*#__PURE__*/_jsx(\"div\",{className:\"rc-error\",children:newErrors.roomNumber}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"select\",{className:\"\".concat(newErrors.status?'au-error':'',\" \").concat(statusColorClass(newRoom.status)),value:newRoom.status,onChange:e=>{setNewRoom(_objectSpread(_objectSpread({},newRoom),{},{status:e.target.value}));if(newErrors.status)setNewErrors(_objectSpread(_objectSpread({},newErrors),{},{status:undefined}));},children:STATUS_UI.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))}),newErrors.status?/*#__PURE__*/_jsx(\"div\",{className:\"rc-error\",children:newErrors.status}):null]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Kh\\xE1ch s\\u1EA1n\"}),/*#__PURE__*/_jsxs(\"select\",{className:newErrors.hotelId?'au-error':'',value:newRoom.hotelId||'',onChange:e=>{const hid=e.target.value?Number(e.target.value):'';setNewRoom(_objectSpread(_objectSpread({},newRoom),{},{hotelId:hid,roomTypeId:''}));fetchTypes(hid||undefined);if(newErrors.hotelId)setNewErrors(_objectSpread(_objectSpread({},newErrors),{},{hotelId:undefined}));},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Ch\\u1ECDn kh\\xE1ch s\\u1EA1n --\"}),hotels.map(h=>/*#__PURE__*/_jsx(\"option\",{value:h.id,children:h.name},h.id))]}),newErrors.hotelId?/*#__PURE__*/_jsx(\"div\",{className:\"rc-error\",children:newErrors.hotelId}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Lo\\u1EA1i ph\\xF2ng\"}),/*#__PURE__*/_jsxs(\"select\",{className:newErrors.roomTypeId?'au-error':'',value:newRoom.roomTypeId,onChange:e=>{const val=e.target.value;setNewRoom(_objectSpread(_objectSpread({},newRoom),{},{roomTypeId:val?Number(val):''}));if(newErrors.roomTypeId)setNewErrors(_objectSpread(_objectSpread({},newErrors),{},{roomTypeId:undefined}));},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Ch\\u1ECDn lo\\u1EA1i ph\\xF2ng --\"}),types.map(t=>/*#__PURE__*/_jsx(\"option\",{value:t.id,children:t.name},t.id))]}),newErrors.roomTypeId?/*#__PURE__*/_jsx(\"div\",{className:\"rc-error\",children:newErrors.roomTypeId}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"T\\u1EA7ng\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Nh\\u1EADp t\\u1EA7ng\",value:newRoom.floor,onChange:e=>{setNewRoom(_objectSpread(_objectSpread({},newRoom),{},{floor:e.target.value}));if(newErrors.floor)setNewErrors(_objectSpread(_objectSpread({},newErrors),{},{floor:undefined}));},className:newErrors.floor?'au-error':''}),newErrors.floor?/*#__PURE__*/_jsx(\"div\",{className:\"rc-error\",children:newErrors.floor}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"M\\xF4 t\\u1EA3\"}),/*#__PURE__*/_jsx(\"textarea\",{rows:3,placeholder:\"M\\xF4 t\\u1EA3 chi ti\\u1EBFt v\\u1EC1 ph\\xF2ng...\",value:newRoom.description,onChange:e=>setNewRoom(_objectSpread(_objectSpread({},newRoom),{},{description:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"S\\u1ED1 ng\\u01B0\\u1EDDi l\\u1EDBn t\\u1ED1i \\u0111a\"}),/*#__PURE__*/_jsx(\"input\",{value:selectedType?selectedType.maxAdults:'',disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rc-field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"S\\u1ED1 tr\\u1EBB em t\\u1ED1i \\u0111a\"}),/*#__PURE__*/_jsx(\"input\",{value:selectedType?selectedType.maxChildren:'',disabled:true})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12,display:'flex',gap:8,justifyContent:'center'},children:[/*#__PURE__*/_jsx(\"span\",{title:!isFormValid&&!creating?tooltipText:'',style:{display:'inline-block'},children:/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn\",onClick:handleCreate,disabled:creating||!isFormValid,type:\"button\",children:creating?'Đang tạo...':'Thêm phòng'})}),/*#__PURE__*/_jsx(\"button\",{className:\"ph-btn ph-btn--secondary\",onClick:()=>setIsCreateOpen(false),type:\"button\",children:\"H\\u1EE7y\"})]})]})})})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","authHeaders","jsx","_jsx","jsxs","_jsxs","STATUS_UI","statusDbToUi","s","v","String","toLowerCase","statusUiToDb","includes","AdminRooms","_ref","isModal","onClose","q","setQ","typeId","setTypeId","hotelFilter","setHotelFilter","items","setItems","totalRoomCount","setTotalRoomCount","types","setTypes","hotels","setHotels","loading","setLoading","error","setError","isCreateOpen","setIsCreateOpen","creating","setCreating","newRoom","setNewRoom","images","price","roomNumber","status","roomTypeId","floor","description","newErrors","setNewErrors","roomImageInputRef","activeRoomForImage","setActiveRoomForImage","pendingRoomImages","setPendingRoomImages","fetchRooms","params","arguments","length","undefined","url","URL","window","location","origin","searchParams","set","delete","hotelId","res","fetch","toString","headers","_objectSpread","ok","Error","j","json","list","Array","isArray","rooms","mapped","map","r","imgs","parsed","JSON","parse","_unused","statusVi","allRes","allJ","allList","_unused2","e","message","fetchTypes","_unused3","fetchHotels","_unused4","debounceRef","current","clearTimeout","setTimeout","updateField","id","field","value","prev","it","handleSave","imagesToPersist","file","preview","form","FormData","append","uploadRes","method","body","uj","upList","files","realPath","revokeObjectURL","cp","filter","u","startsWith","payload","concat","stringify","alert","onSelectRoomImage","room","_roomImageInputRef$cu","click","onRoomImageChosen","from","target","f","createObjectURL","roomId","slice","handleDelete","confirm","selectedType","Number","find","t","selectedHotel","hid","h","computedErrors","trim","isNaN","isFormValid","Object","keys","tooltipText","msgs","push","join","handleCreate","basePrice","msg","_unused5","text","fileInputRef","onPickFiles","_fileInputRef$current","onFilesSelected","spaceLeft","Math","max","pick","err","removeImage","idx","_","i","statusColorClass","label","className","style","padding","children","position","top","src","alt","href","textAlign","marginTop","onSubmit","preventDefault","gridTemplateColumns","display","alignItems","gap","placeholder","onChange","title","height","name","type","onClick","color","outline","toLocaleString","maxAdults","amenities","overflow","textOverflow","whiteSpace","ref","accept","hidden","onMouseDown","currentTarget","stopPropagation","width","maxWidth","ev","multiple","disabled","val","rows","maxChildren","justifyContent"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/AdminRooms.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport './HomePage.css';\r\nimport { authHeaders } from './auth';\r\n\r\nconst STATUS_UI = ['Trống', 'Đang ở', 'Đang dọn dẹp', 'Đang bảo trì'];\r\nconst statusDbToUi = (s) => {\r\n  const v = String(s || '').toLowerCase();\r\n  if (v === 'available') return 'Trống';\r\n  if (v === 'occupied') return 'Đang ở';\r\n  if (v === 'cleaning') return 'Đang dọn dẹp';\r\n  if (v === 'maintenance') return 'Đang bảo trì';\r\n  return 'Trống';\r\n};\r\nconst statusUiToDb = (s) => {\r\n  const v = String(s || '').toLowerCase();\r\n  if (v.includes('trống')) return 'Available';\r\n  if (v.includes('đang ở')) return 'Occupied';\r\n  if (v.includes('dọn')) return 'Cleaning';\r\n  if (v.includes('bảo trì')) return 'Maintenance';\r\n  return 'Available';\r\n};\r\n\r\nexport default function AdminRooms({ isModal, onClose }) {\r\n  const [q, setQ] = useState('');\r\n  const [typeId, setTypeId] = useState('');\r\n  const [hotelFilter, setHotelFilter] = useState('');\r\n  const [items, setItems] = useState([]);\r\n  const [totalRoomCount, setTotalRoomCount] = useState(0); // tổng số phòng (không lọc)\r\n  const [types, setTypes] = useState([]);\r\n  const [hotels, setHotels] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\r\n  const [creating, setCreating] = useState(false);\r\n  const [newRoom, setNewRoom] = useState({\r\n    images: [],\r\n    price: '',\r\n    roomNumber: '',\r\n    status: 'Trống',\r\n    roomTypeId: '',\r\n    floor: '',\r\n    description: ''\r\n  });\r\n  const [newErrors, setNewErrors] = useState({});\r\n  // For per-room image upload\r\n  const roomImageInputRef = useRef(null);\r\n  const [activeRoomForImage, setActiveRoomForImage] = useState(null);\r\n  // Ảnh tạm thời (chưa upload) mỗi phòng: { [roomId]: { file, preview } }\r\n  const [pendingRoomImages, setPendingRoomImages] = useState({});\r\n\r\n  const fetchRooms = async (params = {}) => {\r\n    setLoading(true); setError('');\r\n    try {\r\n      const url = new URL('/api/admin/rooms', window.location.origin);\r\n  if (q) url.searchParams.set('q', q);\r\n  if (typeId) url.searchParams.set('typeId', String(typeId));\r\n  if (hotelFilter) url.searchParams.set('hotelId', String(hotelFilter));\r\n      if (params.q !== undefined) { url.searchParams.set('q', params.q); }\r\n      if (params.typeId !== undefined) { if (params.typeId) url.searchParams.set('typeId', String(params.typeId)); else url.searchParams.delete('typeId'); }\r\n  if (params.hotelId !== undefined) { if (params.hotelId) url.searchParams.set('hotelId', String(params.hotelId)); else url.searchParams.delete('hotelId'); }\r\n  const res = await fetch(url.toString(), { headers: { ...authHeaders() } });\r\n      if (!res.ok) throw new Error('Không tải được danh sách phòng');\r\n      const j = await res.json();\r\n      const list = Array.isArray(j.rooms) ? j.rooms : [];\r\n      const mapped = list.map(r => {\r\n        let imgs = r.images;\r\n        if (typeof imgs === 'string') {\r\n          try { const parsed = JSON.parse(imgs); if (Array.isArray(parsed)) imgs = parsed; } catch { /* ignore */ }\r\n        }\r\n        if (!Array.isArray(imgs)) imgs = [];\r\n        return { ...r, images: imgs, statusVi: statusDbToUi(r.status) };\r\n      });\r\n      setItems(mapped);\r\n      // Cập nhật tổng số phòng (không lọc: gọi một lần không tham số nếu có filter)\r\n      try {\r\n        if (q || typeId || hotelFilter) {\r\n          const allRes = await fetch(new URL('/api/admin/rooms', window.location.origin), { headers: { ...authHeaders() } });\r\n          if (allRes.ok) {\r\n            const allJ = await allRes.json();\r\n            const allList = Array.isArray(allJ.rooms) ? allJ.rooms : [];\r\n            setTotalRoomCount(allList.length);\r\n          }\r\n        } else {\r\n          setTotalRoomCount(mapped.length);\r\n        }\r\n      } catch {}\r\n    } catch (e) {\r\n      setError(e.message || 'Lỗi tải dữ liệu'); setItems([]);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  const fetchTypes = async (hotelId) => {\r\n    try {\r\n      const url = new URL('/api/room-types', window.location.origin);\r\n      if (hotelId) url.searchParams.set('hotelId', String(hotelId));\r\n  const res = await fetch(url, { headers: { ...authHeaders() } });\r\n      if (!res.ok) throw new Error();\r\n      const list = await res.json();\r\n      setTypes(Array.isArray(list) ? list : []);\r\n    } catch { setTypes([]); }\r\n  };\r\n  const fetchHotels = async () => {\r\n    try {\r\n  const res = await fetch('/api/hotels');\r\n      if (!res.ok) throw new Error();\r\n      const list = await res.json();\r\n      setHotels(Array.isArray(list) ? list : []);\r\n    } catch { setHotels([]); }\r\n  };\r\n\r\n  useEffect(() => { fetchHotels(); fetchTypes(); fetchRooms({ q: '' }); }, []);\r\n\r\n  // Live search debounce\r\n  const debounceRef = useRef(null);\r\n  useEffect(() => {\r\n    if (debounceRef.current) clearTimeout(debounceRef.current);\r\n    debounceRef.current = setTimeout(() => { fetchRooms({}); }, 250);\r\n    return () => { if (debounceRef.current) clearTimeout(debounceRef.current); };\r\n  }, [q, typeId, hotelFilter]);\r\n\r\n  const updateField = (id, field, value) => {\r\n    setItems(prev => prev.map(it => it.id === id ? { ...it, [field]: value } : it));\r\n  };\r\n\r\n  const handleSave = async (it) => {\r\n    try {\r\n      let imagesToPersist = it.images && it.images.length ? [...it.images] : [];\r\n      // Nếu có ảnh pending thì upload trước rồi thay preview\r\n      if (pendingRoomImages[it.id]) {\r\n        const { file, preview } = pendingRoomImages[it.id];\r\n        const form = new FormData();\r\n        form.append('files', file);\r\n        const uploadRes = await fetch('/api/admin/rooms/upload', { method: 'POST', body: form, headers: { ...authHeaders() } });\r\n        if (!uploadRes.ok) throw new Error('Tải ảnh thất bại');\r\n        const uj = await uploadRes.json();\r\n        const upList = Array.isArray(uj.files) ? uj.files : [];\r\n        if (!upList.length) throw new Error('Không nhận được ảnh');\r\n        const realPath = upList[0];\r\n        if (imagesToPersist.length) {\r\n          if (imagesToPersist[0] === preview) {\r\n            imagesToPersist[0] = realPath;\r\n          } else {\r\n            imagesToPersist = [realPath, ...imagesToPersist];\r\n          }\r\n        } else {\r\n          imagesToPersist = [realPath];\r\n        }\r\n        // cleanup preview object URL & state\r\n        URL.revokeObjectURL(preview);\r\n        setPendingRoomImages(prev => { const cp = { ...prev }; delete cp[it.id]; return cp; });\r\n      }\r\n      // Loại bỏ mọi blob preview còn sót\r\n      imagesToPersist = imagesToPersist.filter(u => typeof u === 'string' && !u.startsWith('blob:'));\r\n      const payload = { roomNumber: it.roomNumber, roomTypeId: it.roomTypeId, status: statusUiToDb(it.statusVi), images: imagesToPersist.length ? imagesToPersist : undefined };\r\n      const res = await fetch(`/api/admin/rooms/${it.id}`, { method: 'PUT', headers: { 'Content-Type': 'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if (!res.ok) throw new Error('Lưu thất bại');\r\n      await fetchRooms({});\r\n      alert('Đã lưu phòng');\r\n    } catch (e) { alert(e.message || 'Lỗi lưu'); }\r\n  };\r\n\r\n  const onSelectRoomImage = (room) => {\r\n    setActiveRoomForImage(room);\r\n    roomImageInputRef.current?.click();\r\n  };\r\n\r\n  const onRoomImageChosen = async (e) => {\r\n    const files = Array.from(e.target.files || []);\r\n    if (!files.length || !activeRoomForImage) return;\r\n    const f = files[0];\r\n    const preview = URL.createObjectURL(f);\r\n    const roomId = activeRoomForImage.id;\r\n    // Lưu ảnh tạm\r\n    setPendingRoomImages(prev => ({ ...prev, [roomId]: { file: f, preview } }));\r\n    // Hiển thị ngay preview ở vị trí ảnh đầu\r\n    setItems(prev => prev.map(it => it.id === roomId ? { ...it, images: it.images && it.images.length ? [preview, ...it.images.slice(1)] : [preview] } : it));\r\n    setActiveRoomForImage(null);\r\n    if (roomImageInputRef.current) roomImageInputRef.current.value = '';\r\n  };\r\n\r\n  const handleDelete = async (it) => {\r\n    if (!window.confirm('Xóa phòng này?')) return;\r\n    try {\r\n  const res = await fetch(`/api/admin/rooms/${it.id}`, { method: 'DELETE', headers: { ...authHeaders() } });\r\n      if (!res.ok) throw new Error('Xóa thất bại');\r\n      await fetchRooms({});\r\n    } catch (e) { alert(e.message || 'Lỗi xóa'); }\r\n  };\r\n\r\n  const selectedType = useMemo(() => {\r\n    const id = Number(newRoom.roomTypeId || 0);\r\n    return types.find(t => Number(t.id) === id) || null;\r\n  }, [types, newRoom.roomTypeId]);\r\n  const selectedHotel = useMemo(() => {\r\n    const hid = Number(newRoom.hotelId || 0);\r\n    return hotels.find(h => Number(h.id) === hid) || null;\r\n  }, [hotels, newRoom.hotelId]);\r\n\r\n  const computedErrors = useMemo(() => {\r\n    const e = {};\r\n    if (!newRoom.roomNumber || !String(newRoom.roomNumber).trim()) e.roomNumber = 'Vui lòng nhập số phòng';\r\n  if (!newRoom.hotelId) e.hotelId = 'Vui lòng chọn khách sạn';\r\n  if (!newRoom.roomTypeId) e.roomTypeId = 'Vui lòng chọn loại phòng';\r\n    if (!newRoom.status) e.status = 'Vui lòng chọn trạng thái';\r\n    if (newRoom.floor !== '' && Number.isNaN(Number(newRoom.floor))) e.floor = 'Tầng không hợp lệ';\r\n    return e;\r\n  }, [newRoom]);\r\n  const isFormValid = useMemo(() => Object.keys(computedErrors).length === 0, [computedErrors]);\r\n  const tooltipText = useMemo(() => {\r\n    if (isFormValid || creating) return '';\r\n    const msgs = [];\r\n    if (computedErrors.roomNumber) msgs.push(computedErrors.roomNumber);\r\n    if (computedErrors.roomTypeId) msgs.push(computedErrors.roomTypeId);\r\n    if (computedErrors.status) msgs.push(computedErrors.status);\r\n    return msgs.join('; ');\r\n  }, [computedErrors, isFormValid, creating]);\r\n\r\n  const handleCreate = async () => {\r\n    setNewErrors(computedErrors);\r\n    if (!isFormValid) return;\r\n    setCreating(true);\r\n    try {\r\n      const payload = {\r\n        roomNumber: String(newRoom.roomNumber).trim(),\r\n        roomTypeId: Number(newRoom.roomTypeId),\r\n        status: statusUiToDb(newRoom.status),\r\n        hotelId: newRoom.hotelId ? Number(newRoom.hotelId) : undefined,\r\n        floor: newRoom.floor !== '' ? Number(newRoom.floor) : undefined,\r\n        price: selectedType ? Number(selectedType.basePrice || 0) : undefined,\r\n        description: newRoom.description || undefined,\r\n        images: newRoom.images && newRoom.images.length ? newRoom.images : undefined\r\n      };\r\n  const res = await fetch('/api/admin/rooms', { method: 'POST', headers: { 'Content-Type': 'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if (!res.ok) {\r\n        let msg = 'Tạo thất bại';\r\n        try { const j = await res.json(); if (j?.message) msg = j.message; } catch { const t = await res.text(); if (t) msg = t; }\r\n        throw new Error(msg);\r\n      }\r\n  setNewRoom({ images:[], price:'', roomNumber: '', status: 'Trống', hotelId:'', roomTypeId: '', floor:'', description:'' });\r\n  setNewErrors({});\r\n  // Reset filters and refresh list to default view\r\n  setQ('');\r\n  setTypeId('');\r\n  setHotelFilter('');\r\n  await fetchTypes();\r\n  await fetchRooms({ q: '', typeId: '', hotelId: '' });\r\n      setCreating(false);\r\n      alert('Tạo phòng thành công');\r\n      setIsCreateOpen(false);\r\n    } catch (e) { alert(e.message || 'Lỗi tạo'); setCreating(false); }\r\n  };\r\n\r\n  const fileInputRef = useRef(null);\r\n  const onPickFiles = () => fileInputRef.current?.click();\r\n  const onFilesSelected = async (e) => {\r\n    const files = Array.from(e.target.files || []);\r\n    if (!files.length) return;\r\n    const current = (newRoom.images || []).length;\r\n    const spaceLeft = Math.max(0, 5 - current);\r\n    if (spaceLeft <= 0) { alert('Bạn chỉ có thể chọn tối đa 5 ảnh.'); return; }\r\n    const pick = files.slice(0, spaceLeft);\r\n    const form = new FormData();\r\n    for (const f of pick) form.append('files', f);\r\n    try {\r\n  const res = await fetch('/api/admin/rooms/upload', { method: 'POST', body: form, headers: { ...authHeaders() } });\r\n      if (!res.ok) throw new Error('Tải ảnh thất bại');\r\n      const j = await res.json();\r\n      const list = Array.isArray(j.files) ? j.files : [];\r\n      setNewRoom(r => ({ ...r, images: [...(r.images||[]), ...list] }));\r\n    } catch (err) { alert(err.message || 'Lỗi tải ảnh'); }\r\n  };\r\n\r\n  const removeImage = (idx) => {\r\n    setNewRoom(r => ({ ...r, images: (r.images||[]).filter((_, i) => i !== idx) }));\r\n  };\r\n\r\n  const statusColorClass = (label) => {\r\n    if (!label) return '';\r\n    if (label.includes('Trống')) return 'room-status-green';\r\n    if (label.includes('dọn')) return 'room-status-yellow';\r\n    if (label.includes('Đang ở') || label.includes('bảo trì')) return 'room-status-red';\r\n    return '';\r\n  };\r\n\r\n  return (\r\n    <div className=\"admin-rooms\" style={{ padding: isModal ? 0 : '80px 12px 20px' }}>\r\n      {!isModal && (\r\n        <header className=\"home-header\" style={{ position: 'sticky', top: 0 }}>\r\n          <div className=\"home-header-left\">\r\n            <img src=\"/logo.png\" alt=\"logo\" className=\"home-header-logo\" />\r\n            <a href=\"/\" className=\"home-header-title home-header-home-btn\">TRANG CHỦ</a>\r\n          </div>\r\n        </header>\r\n      )}\r\n      <div className=\"ph-table\" style={{ padding: 16 }}>\r\n        <h2 className=\"home-rooms-title\" style={{ textAlign: 'left', marginTop: 0 }}>Quản lý phòng khách sạn</h2>\r\n        <form onSubmit={(e)=>e.preventDefault()} className=\"au-toolbar\" style={{ gridTemplateColumns: '1fr auto auto auto' }}>\r\n          <div className=\"au-group\">\r\n            <div style={{ display:'flex', alignItems:'center', gap:8 }}>\r\n              <input className=\"au-input\" placeholder=\"Tìm kiếm phòng...\" value={q} onChange={e=>setQ(e.target.value)} />\r\n              {totalRoomCount ? (\r\n                <div className=\"room-count-badge\" title=\"Tổng số phòng hiện có trong hệ thống\">\r\n                  Tổng: {totalRoomCount}\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n          </div>\r\n          <select className=\"ph-btn ph-btn--secondary\" value={hotelFilter} onChange={e=>{ const hid = e.target.value; setHotelFilter(hid); fetchTypes(hid || undefined); }} style={{ height: 36 }}>\r\n            <option value=\"\">Tất cả khách sạn</option>\r\n            {hotels.map(h => <option key={h.id} value={h.id}>{h.name}</option>)}\r\n          </select>\r\n          <select className=\"ph-btn ph-btn--secondary\" value={typeId} onChange={e=>setTypeId(e.target.value)} style={{ height: 36 }}>\r\n            <option value=\"\">Tất cả loại phòng</option>\r\n            {types.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}\r\n          </select>\r\n          <button className=\"ph-btn au-add-btn\" type=\"button\" onClick={()=>{ setIsCreateOpen(true); setNewErrors({}); }}>+ Thêm phòng</button>\r\n        </form>\r\n        {loading ? <div style={{ color:'#666' }}>Đang tải...</div> : error ? <div style={{ color:'#b42318' }}>{error}</div> : (\r\n          <div>\r\n            <div className=\"ph-tr ph-head\" style={{ gridTemplateColumns: '100px 120px 1.1fr 1fr 1fr 1.4fr 1fr 1.1fr' }}>\r\n              <div className=\"ph-td\">Ảnh</div>\r\n              <div className=\"ph-td\">Số phòng</div>\r\n              <div className=\"ph-td\">Loại</div>\r\n              <div className=\"ph-td\">Giá (VNĐ/đêm)</div>\r\n              <div className=\"ph-td\">Sức chứa</div>\r\n              <div className=\"ph-td\">Tiện nghi</div>\r\n              <div className=\"ph-td\">Trạng thái</div>\r\n              <div className=\"ph-td\">Hành động</div>\r\n            </div>\r\n            {items.length === 0 ? (\r\n              <div className=\"ph-td\" style={{ padding: 12, color: '#666' }}>Không có phòng nào.</div>\r\n            ) : items.map(it => (\r\n              <div key={it.id} className=\"ph-tr\" style={{ gridTemplateColumns: '100px 120px 1.1fr 1fr 1fr 1.4fr 1fr 1.1fr' }}>\r\n                <div className=\"ph-td\">\r\n                  <div onClick={()=>onSelectRoomImage(it)} className=\"admin-room-thumb\" title=\"Bấm để thêm/đổi ảnh\">\r\n                    {Array.isArray(it.images) && it.images.length ? (\r\n                      <img src={it.images[0]} alt=\"thumb\" style={pendingRoomImages[it.id] ? { outline: '2px dashed #ff9800' } : undefined} />\r\n                    ) : <span>No image</span>}\r\n                  </div>\r\n                </div>\r\n                <div className=\"ph-td\"><input value={it.roomNumber || ''} onChange={e=>updateField(it.id, 'roomNumber', e.target.value)} /></div>\r\n                <div className=\"ph-td\">\r\n                  <select value={it.roomTypeId || ''} onChange={e=>updateField(it.id, 'roomTypeId', Number(e.target.value))}>\r\n                    <option value=\"\">—</option>\r\n                    {types.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}\r\n                  </select>\r\n                </div>\r\n                <div className=\"ph-td\">{Number(it.basePrice || 0).toLocaleString('vi-VN')}</div>\r\n                <div className=\"ph-td\">{(Number(it.maxAdults||0))} khách</div>\r\n                <div className=\"ph-td\" title={it.amenities || ''} style={{ overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{it.amenities || '—'}</div>\r\n                <div className=\"ph-td\">\r\n                  <select value={it.statusVi} onChange={e=>updateField(it.id, 'statusVi', e.target.value)} className={statusColorClass(it.statusVi)}>\r\n                    {STATUS_UI.map(s => <option key={s} value={s}>{s}</option>)}\r\n                  </select>\r\n                </div>\r\n                <div className=\"ph-td\">\r\n                  <button className=\"ph-btn\" type=\"button\" onClick={()=>handleSave(it)}>Sửa</button>\r\n                  <button className=\"ph-btn ph-btn--secondary\" type=\"button\" onClick={()=>handleDelete(it)}>Xóa</button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n        {/* Hidden input for per-room image selection */}\r\n        <input ref={roomImageInputRef} type=\"file\" accept=\"image/*\" hidden onChange={onRoomImageChosen} />\r\n      </div>\r\n\r\n      {isCreateOpen && (\r\n        <div className=\"profile-overlay\" onMouseDown={(e)=>{ if (e.target===e.currentTarget) setIsCreateOpen(false); }}>\r\n          <div className=\"profile-modal\" onMouseDown={(e)=>e.stopPropagation()} style={{ width: 980, maxWidth:'98%' }}>\r\n            <div className=\"ph-table\" style={{ padding: 16 }}>\r\n              <h3 style={{ marginTop:0, textAlign:'center' }}>Thêm Phòng Mới</h3>\r\n              <div className=\"room-create-grid\">\r\n                <div className=\"rc-left\">\r\n                  <label>Hình ảnh phòng</label>\r\n                  <div className=\"rc-uploader\" onClick={onPickFiles}>\r\n                    {(newRoom.images||[]).length ? (\r\n                      <div className=\"rc-thumbs\">\r\n                        {newRoom.images.map((url, idx) => (\r\n                          <div key={idx} className=\"rc-thumb\">\r\n                            <img src={url} alt=\"\" />\r\n                            <button type=\"button\" className=\"rc-thumb-del\" onClick={(ev)=>{ev.stopPropagation(); removeImage(idx);}}>×</button>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    ) : <div className=\"rc-empty\">Bấm để chọn ảnh</div>}\r\n                    <input ref={fileInputRef} onChange={onFilesSelected} type=\"file\" accept=\"image/*\" multiple hidden />\r\n                  </div>\r\n                  <div className=\"rc-hint\">{(newRoom.images||[]).length}/5 ảnh</div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Giá cơ bản (VND)</label>\r\n                    <input value={selectedType ? Number(selectedType.basePrice||0).toLocaleString('vi-VN') : ''} placeholder=\"VD: 850000\" disabled />\r\n                  </div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Số phòng</label>\r\n                    <input placeholder=\"Nhập số phòng\" className={newErrors.roomNumber ? 'au-error' : ''} value={newRoom.roomNumber} onChange={e=>{ setNewRoom({...newRoom, roomNumber:e.target.value}); if (newErrors.roomNumber) setNewErrors({...newErrors, roomNumber: undefined}); }} />\r\n                    {newErrors.roomNumber ? <div className=\"rc-error\">{newErrors.roomNumber}</div> : null}\r\n                  </div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Trạng thái</label>\r\n                    <select className={`${newErrors.status ? 'au-error' : ''} ${statusColorClass(newRoom.status)}`} value={newRoom.status} onChange={e=>{ setNewRoom({...newRoom, status:e.target.value}); if (newErrors.status) setNewErrors({...newErrors, status: undefined}); }}>\r\n                      {STATUS_UI.map(s => <option key={s} value={s}>{s}</option>)}\r\n                    </select>\r\n                    {newErrors.status ? <div className=\"rc-error\">{newErrors.status}</div> : null}\r\n                  </div>\r\n                </div>\r\n                <div className=\"rc-right\">\r\n                  <div className=\"rc-field\">\r\n                    <label>Khách sạn</label>\r\n                    <select className={newErrors.hotelId ? 'au-error' : ''} value={newRoom.hotelId || ''} onChange={e=>{\r\n                      const hid = e.target.value ? Number(e.target.value) : '';\r\n                      setNewRoom({ ...newRoom, hotelId: hid, roomTypeId: '' });\r\n                      fetchTypes(hid || undefined);\r\n                      if (newErrors.hotelId) setNewErrors({ ...newErrors, hotelId: undefined });\r\n                    }}>\r\n                      <option value=\"\">-- Chọn khách sạn --</option>\r\n                      {hotels.map(h => <option key={h.id} value={h.id}>{h.name}</option>)}\r\n                    </select>\r\n                    {newErrors.hotelId ? <div className=\"rc-error\">{newErrors.hotelId}</div> : null}\r\n                  </div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Loại phòng</label>\r\n                    <select className={newErrors.roomTypeId ? 'au-error' : ''} value={newRoom.roomTypeId} onChange={e=>{ const val = e.target.value; setNewRoom({...newRoom, roomTypeId: val ? Number(val) : ''}); if (newErrors.roomTypeId) setNewErrors({...newErrors, roomTypeId: undefined}); }}>\r\n                      <option value=\"\">-- Chọn loại phòng --</option>\r\n                      {types.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}\r\n                    </select>\r\n                    {newErrors.roomTypeId ? <div className=\"rc-error\">{newErrors.roomTypeId}</div> : null}\r\n                  </div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Tầng</label>\r\n                    <input placeholder=\"Nhập tầng\" value={newRoom.floor} onChange={e=>{ setNewRoom({...newRoom, floor: e.target.value}); if (newErrors.floor) setNewErrors({...newErrors, floor: undefined}); }} className={newErrors.floor ? 'au-error' : ''} />\r\n                    {newErrors.floor ? <div className=\"rc-error\">{newErrors.floor}</div> : null}\r\n                  </div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Mô tả</label>\r\n                    <textarea rows={3} placeholder=\"Mô tả chi tiết về phòng...\" value={newRoom.description} onChange={e=>setNewRoom({...newRoom, description:e.target.value})} />\r\n                  </div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Số người lớn tối đa</label>\r\n                    <input value={selectedType ? selectedType.maxAdults : ''} disabled />\r\n                  </div>\r\n                  <div className=\"rc-field\">\r\n                    <label>Số trẻ em tối đa</label>\r\n                    <input value={selectedType ? selectedType.maxChildren : ''} disabled />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div style={{ marginTop:12, display:'flex', gap:8, justifyContent:'center' }}>\r\n                <span title={(!isFormValid && !creating) ? tooltipText : ''} style={{ display:'inline-block' }}>\r\n                  <button className=\"ph-btn\" onClick={handleCreate} disabled={creating || !isFormValid} type=\"button\">{creating ? 'Đang tạo...' : 'Thêm phòng'}</button>\r\n                </span>\r\n                <button className=\"ph-btn ph-btn--secondary\" onClick={()=>setIsCreateOpen(false)} type=\"button\">Hủy</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"sHAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,OAAO,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CACnE,MAAO,gBAAgB,CACvB,OAASC,WAAW,KAAQ,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErC,KAAM,CAAAC,SAAS,CAAG,CAAC,OAAO,CAAE,QAAQ,CAAE,cAAc,CAAE,cAAc,CAAC,CACrE,KAAM,CAAAC,YAAY,CAAIC,CAAC,EAAK,CAC1B,KAAM,CAAAC,CAAC,CAAGC,MAAM,CAACF,CAAC,EAAI,EAAE,CAAC,CAACG,WAAW,CAAC,CAAC,CACvC,GAAIF,CAAC,GAAK,WAAW,CAAE,MAAO,OAAO,CACrC,GAAIA,CAAC,GAAK,UAAU,CAAE,MAAO,QAAQ,CACrC,GAAIA,CAAC,GAAK,UAAU,CAAE,MAAO,cAAc,CAC3C,GAAIA,CAAC,GAAK,aAAa,CAAE,MAAO,cAAc,CAC9C,MAAO,OAAO,CAChB,CAAC,CACD,KAAM,CAAAG,YAAY,CAAIJ,CAAC,EAAK,CAC1B,KAAM,CAAAC,CAAC,CAAGC,MAAM,CAACF,CAAC,EAAI,EAAE,CAAC,CAACG,WAAW,CAAC,CAAC,CACvC,GAAIF,CAAC,CAACI,QAAQ,CAAC,OAAO,CAAC,CAAE,MAAO,WAAW,CAC3C,GAAIJ,CAAC,CAACI,QAAQ,CAAC,QAAQ,CAAC,CAAE,MAAO,UAAU,CAC3C,GAAIJ,CAAC,CAACI,QAAQ,CAAC,KAAK,CAAC,CAAE,MAAO,UAAU,CACxC,GAAIJ,CAAC,CAACI,QAAQ,CAAC,SAAS,CAAC,CAAE,MAAO,aAAa,CAC/C,MAAO,WAAW,CACpB,CAAC,CAED,cAAe,SAAS,CAAAC,UAAUA,CAAAC,IAAA,CAAuB,IAAtB,CAAEC,OAAO,CAAEC,OAAQ,CAAC,CAAAF,IAAA,CACrD,KAAM,CAACG,CAAC,CAAEC,IAAI,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CAC9B,KAAM,CAACoB,MAAM,CAAEC,SAAS,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACsB,WAAW,CAAEC,cAAc,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAACwB,KAAK,CAAEC,QAAQ,CAAC,CAAGzB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC0B,cAAc,CAAEC,iBAAiB,CAAC,CAAG3B,QAAQ,CAAC,CAAC,CAAC,CAAE;AACzD,KAAM,CAAC4B,KAAK,CAAEC,QAAQ,CAAC,CAAG7B,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC8B,MAAM,CAAEC,SAAS,CAAC,CAAG/B,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACgC,OAAO,CAAEC,UAAU,CAAC,CAAGjC,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACkC,KAAK,CAAEC,QAAQ,CAAC,CAAGnC,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACoC,YAAY,CAAEC,eAAe,CAAC,CAAGrC,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAACsC,QAAQ,CAAEC,WAAW,CAAC,CAAGvC,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACwC,OAAO,CAAEC,UAAU,CAAC,CAAGzC,QAAQ,CAAC,CACrC0C,MAAM,CAAE,EAAE,CACVC,KAAK,CAAE,EAAE,CACTC,UAAU,CAAE,EAAE,CACdC,MAAM,CAAE,OAAO,CACfC,UAAU,CAAE,EAAE,CACdC,KAAK,CAAE,EAAE,CACTC,WAAW,CAAE,EACf,CAAC,CAAC,CACF,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGlD,QAAQ,CAAC,CAAC,CAAC,CAAC,CAC9C;AACA,KAAM,CAAAmD,iBAAiB,CAAGpD,MAAM,CAAC,IAAI,CAAC,CACtC,KAAM,CAACqD,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGrD,QAAQ,CAAC,IAAI,CAAC,CAClE;AACA,KAAM,CAACsD,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGvD,QAAQ,CAAC,CAAC,CAAC,CAAC,CAE9D,KAAM,CAAAwD,UAAU,CAAG,cAAAA,CAAA,CAAuB,IAAhB,CAAAC,MAAM,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CACnCzB,UAAU,CAAC,IAAI,CAAC,CAAEE,QAAQ,CAAC,EAAE,CAAC,CAC9B,GAAI,CACF,KAAM,CAAA0B,GAAG,CAAG,GAAI,CAAAC,GAAG,CAAC,kBAAkB,CAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CACnE,GAAI/C,CAAC,CAAE2C,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,GAAG,CAAEjD,CAAC,CAAC,CACnC,GAAIE,MAAM,CAAEyC,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,QAAQ,CAAEzD,MAAM,CAACU,MAAM,CAAC,CAAC,CAC1D,GAAIE,WAAW,CAAEuC,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,SAAS,CAAEzD,MAAM,CAACY,WAAW,CAAC,CAAC,CACjE,GAAImC,MAAM,CAACvC,CAAC,GAAK0C,SAAS,CAAE,CAAEC,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,GAAG,CAAEV,MAAM,CAACvC,CAAC,CAAC,CAAE,CACnE,GAAIuC,MAAM,CAACrC,MAAM,GAAKwC,SAAS,CAAE,CAAE,GAAIH,MAAM,CAACrC,MAAM,CAAEyC,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,QAAQ,CAAEzD,MAAM,CAAC+C,MAAM,CAACrC,MAAM,CAAC,CAAC,CAAC,IAAM,CAAAyC,GAAG,CAACK,YAAY,CAACE,MAAM,CAAC,QAAQ,CAAC,CAAE,CACzJ,GAAIX,MAAM,CAACY,OAAO,GAAKT,SAAS,CAAE,CAAE,GAAIH,MAAM,CAACY,OAAO,CAAER,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,SAAS,CAAEzD,MAAM,CAAC+C,MAAM,CAACY,OAAO,CAAC,CAAC,CAAC,IAAM,CAAAR,GAAG,CAACK,YAAY,CAACE,MAAM,CAAC,SAAS,CAAC,CAAE,CAC1J,KAAM,CAAAE,GAAG,CAAG,KAAM,CAAAC,KAAK,CAACV,GAAG,CAACW,QAAQ,CAAC,CAAC,CAAE,CAAEC,OAAO,CAAAC,aAAA,IAAOzE,WAAW,CAAC,CAAC,CAAG,CAAC,CAAC,CACtE,GAAI,CAACqE,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,gCAAgC,CAAC,CAC9D,KAAM,CAAAC,CAAC,CAAG,KAAM,CAAAP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC1B,KAAM,CAAAC,IAAI,CAAGC,KAAK,CAACC,OAAO,CAACJ,CAAC,CAACK,KAAK,CAAC,CAAGL,CAAC,CAACK,KAAK,CAAG,EAAE,CAClD,KAAM,CAAAC,MAAM,CAAGJ,IAAI,CAACK,GAAG,CAACC,CAAC,EAAI,CAC3B,GAAI,CAAAC,IAAI,CAAGD,CAAC,CAAC3C,MAAM,CACnB,GAAI,MAAO,CAAA4C,IAAI,GAAK,QAAQ,CAAE,CAC5B,GAAI,CAAE,KAAM,CAAAC,MAAM,CAAGC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,CAAE,GAAIN,KAAK,CAACC,OAAO,CAACM,MAAM,CAAC,CAAED,IAAI,CAAGC,MAAM,CAAE,CAAE,MAAAG,OAAA,CAAM,CAAE,aAC7F,CACA,GAAI,CAACV,KAAK,CAACC,OAAO,CAACK,IAAI,CAAC,CAAEA,IAAI,CAAG,EAAE,CACnC,OAAAZ,aAAA,CAAAA,aAAA,IAAYW,CAAC,MAAE3C,MAAM,CAAE4C,IAAI,CAAEK,QAAQ,CAAEpF,YAAY,CAAC8E,CAAC,CAACxC,MAAM,CAAC,GAC/D,CAAC,CAAC,CACFpB,QAAQ,CAAC0D,MAAM,CAAC,CAChB;AACA,GAAI,CACF,GAAIjE,CAAC,EAAIE,MAAM,EAAIE,WAAW,CAAE,CAC9B,KAAM,CAAAsE,MAAM,CAAG,KAAM,CAAArB,KAAK,CAAC,GAAI,CAAAT,GAAG,CAAC,kBAAkB,CAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAE,CAAEQ,OAAO,CAAAC,aAAA,IAAOzE,WAAW,CAAC,CAAC,CAAG,CAAC,CAAC,CAClH,GAAI2F,MAAM,CAACjB,EAAE,CAAE,CACb,KAAM,CAAAkB,IAAI,CAAG,KAAM,CAAAD,MAAM,CAACd,IAAI,CAAC,CAAC,CAChC,KAAM,CAAAgB,OAAO,CAAGd,KAAK,CAACC,OAAO,CAACY,IAAI,CAACX,KAAK,CAAC,CAAGW,IAAI,CAACX,KAAK,CAAG,EAAE,CAC3DvD,iBAAiB,CAACmE,OAAO,CAACnC,MAAM,CAAC,CACnC,CACF,CAAC,IAAM,CACLhC,iBAAiB,CAACwD,MAAM,CAACxB,MAAM,CAAC,CAClC,CACF,CAAE,MAAAoC,QAAA,CAAM,CAAC,CACX,CAAE,MAAOC,CAAC,CAAE,CACV7D,QAAQ,CAAC6D,CAAC,CAACC,OAAO,EAAI,iBAAiB,CAAC,CAAExE,QAAQ,CAAC,EAAE,CAAC,CACxD,CAAC,OAAS,CAAEQ,UAAU,CAAC,KAAK,CAAC,CAAE,CACjC,CAAC,CAED,KAAM,CAAAiE,UAAU,CAAG,KAAO,CAAA7B,OAAO,EAAK,CACpC,GAAI,CACF,KAAM,CAAAR,GAAG,CAAG,GAAI,CAAAC,GAAG,CAAC,iBAAiB,CAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAC9D,GAAII,OAAO,CAAER,GAAG,CAACK,YAAY,CAACC,GAAG,CAAC,SAAS,CAAEzD,MAAM,CAAC2D,OAAO,CAAC,CAAC,CACjE,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAC,KAAK,CAACV,GAAG,CAAE,CAAEY,OAAO,CAAAC,aAAA,IAAOzE,WAAW,CAAC,CAAC,CAAG,CAAC,CAAC,CAC3D,GAAI,CAACqE,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,CAAC,CAC9B,KAAM,CAAAG,IAAI,CAAG,KAAM,CAAAT,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC7BjD,QAAQ,CAACmD,KAAK,CAACC,OAAO,CAACF,IAAI,CAAC,CAAGA,IAAI,CAAG,EAAE,CAAC,CAC3C,CAAE,MAAAoB,QAAA,CAAM,CAAEtE,QAAQ,CAAC,EAAE,CAAC,CAAE,CAC1B,CAAC,CACD,KAAM,CAAAuE,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACN,KAAM,CAAA9B,GAAG,CAAG,KAAM,CAAAC,KAAK,CAAC,aAAa,CAAC,CAClC,GAAI,CAACD,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,CAAC,CAC9B,KAAM,CAAAG,IAAI,CAAG,KAAM,CAAAT,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC7B/C,SAAS,CAACiD,KAAK,CAACC,OAAO,CAACF,IAAI,CAAC,CAAGA,IAAI,CAAG,EAAE,CAAC,CAC5C,CAAE,MAAAsB,QAAA,CAAM,CAAEtE,SAAS,CAAC,EAAE,CAAC,CAAE,CAC3B,CAAC,CAEDlC,SAAS,CAAC,IAAM,CAAEuG,WAAW,CAAC,CAAC,CAAEF,UAAU,CAAC,CAAC,CAAE1C,UAAU,CAAC,CAAEtC,CAAC,CAAE,EAAG,CAAC,CAAC,CAAE,CAAC,CAAE,EAAE,CAAC,CAE5E;AACA,KAAM,CAAAoF,WAAW,CAAGvG,MAAM,CAAC,IAAI,CAAC,CAChCF,SAAS,CAAC,IAAM,CACd,GAAIyG,WAAW,CAACC,OAAO,CAAEC,YAAY,CAACF,WAAW,CAACC,OAAO,CAAC,CAC1DD,WAAW,CAACC,OAAO,CAAGE,UAAU,CAAC,IAAM,CAAEjD,UAAU,CAAC,CAAC,CAAC,CAAC,CAAE,CAAC,CAAE,GAAG,CAAC,CAChE,MAAO,IAAM,CAAE,GAAI8C,WAAW,CAACC,OAAO,CAAEC,YAAY,CAACF,WAAW,CAACC,OAAO,CAAC,CAAE,CAAC,CAC9E,CAAC,CAAE,CAACrF,CAAC,CAAEE,MAAM,CAAEE,WAAW,CAAC,CAAC,CAE5B,KAAM,CAAAoF,WAAW,CAAGA,CAACC,EAAE,CAAEC,KAAK,CAAEC,KAAK,GAAK,CACxCpF,QAAQ,CAACqF,IAAI,EAAIA,IAAI,CAAC1B,GAAG,CAAC2B,EAAE,EAAIA,EAAE,CAACJ,EAAE,GAAKA,EAAE,CAAAjC,aAAA,CAAAA,aAAA,IAAQqC,EAAE,MAAE,CAACH,KAAK,EAAGC,KAAK,GAAKE,EAAE,CAAC,CAAC,CACjF,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG,KAAO,CAAAD,EAAE,EAAK,CAC/B,GAAI,CACF,GAAI,CAAAE,eAAe,CAAGF,EAAE,CAACrE,MAAM,EAAIqE,EAAE,CAACrE,MAAM,CAACiB,MAAM,CAAG,CAAC,GAAGoD,EAAE,CAACrE,MAAM,CAAC,CAAG,EAAE,CACzE;AACA,GAAIY,iBAAiB,CAACyD,EAAE,CAACJ,EAAE,CAAC,CAAE,CAC5B,KAAM,CAAEO,IAAI,CAAEC,OAAQ,CAAC,CAAG7D,iBAAiB,CAACyD,EAAE,CAACJ,EAAE,CAAC,CAClD,KAAM,CAAAS,IAAI,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC3BD,IAAI,CAACE,MAAM,CAAC,OAAO,CAAEJ,IAAI,CAAC,CAC1B,KAAM,CAAAK,SAAS,CAAG,KAAM,CAAAhD,KAAK,CAAC,yBAAyB,CAAE,CAAEiD,MAAM,CAAE,MAAM,CAAEC,IAAI,CAAEL,IAAI,CAAE3C,OAAO,CAAAC,aAAA,IAAOzE,WAAW,CAAC,CAAC,CAAG,CAAC,CAAC,CACvH,GAAI,CAACsH,SAAS,CAAC5C,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,kBAAkB,CAAC,CACtD,KAAM,CAAA8C,EAAE,CAAG,KAAM,CAAAH,SAAS,CAACzC,IAAI,CAAC,CAAC,CACjC,KAAM,CAAA6C,MAAM,CAAG3C,KAAK,CAACC,OAAO,CAACyC,EAAE,CAACE,KAAK,CAAC,CAAGF,EAAE,CAACE,KAAK,CAAG,EAAE,CACtD,GAAI,CAACD,MAAM,CAAChE,MAAM,CAAE,KAAM,IAAI,CAAAiB,KAAK,CAAC,qBAAqB,CAAC,CAC1D,KAAM,CAAAiD,QAAQ,CAAGF,MAAM,CAAC,CAAC,CAAC,CAC1B,GAAIV,eAAe,CAACtD,MAAM,CAAE,CAC1B,GAAIsD,eAAe,CAAC,CAAC,CAAC,GAAKE,OAAO,CAAE,CAClCF,eAAe,CAAC,CAAC,CAAC,CAAGY,QAAQ,CAC/B,CAAC,IAAM,CACLZ,eAAe,CAAG,CAACY,QAAQ,CAAE,GAAGZ,eAAe,CAAC,CAClD,CACF,CAAC,IAAM,CACLA,eAAe,CAAG,CAACY,QAAQ,CAAC,CAC9B,CACA;AACA/D,GAAG,CAACgE,eAAe,CAACX,OAAO,CAAC,CAC5B5D,oBAAoB,CAACuD,IAAI,EAAI,CAAE,KAAM,CAAAiB,EAAE,CAAArD,aAAA,IAAQoC,IAAI,CAAE,CAAE,MAAO,CAAAiB,EAAE,CAAChB,EAAE,CAACJ,EAAE,CAAC,CAAE,MAAO,CAAAoB,EAAE,CAAE,CAAC,CAAC,CACxF,CACA;AACAd,eAAe,CAAGA,eAAe,CAACe,MAAM,CAACC,CAAC,EAAI,MAAO,CAAAA,CAAC,GAAK,QAAQ,EAAI,CAACA,CAAC,CAACC,UAAU,CAAC,OAAO,CAAC,CAAC,CAC9F,KAAM,CAAAC,OAAO,CAAG,CAAEvF,UAAU,CAAEmE,EAAE,CAACnE,UAAU,CAAEE,UAAU,CAAEiE,EAAE,CAACjE,UAAU,CAAED,MAAM,CAAEjC,YAAY,CAACmG,EAAE,CAACpB,QAAQ,CAAC,CAAEjD,MAAM,CAAEuE,eAAe,CAACtD,MAAM,CAAGsD,eAAe,CAAGrD,SAAU,CAAC,CACzK,KAAM,CAAAU,GAAG,CAAG,KAAM,CAAAC,KAAK,qBAAA6D,MAAA,CAAqBrB,EAAE,CAACJ,EAAE,EAAI,CAAEa,MAAM,CAAE,KAAK,CAAE/C,OAAO,CAAAC,aAAA,EAAI,cAAc,CAAE,kBAAkB,EAAKzE,WAAW,CAAC,CAAC,CAAE,CAAEwH,IAAI,CAAEjC,IAAI,CAAC6C,SAAS,CAACF,OAAO,CAAE,CAAC,CAAC,CACzK,GAAI,CAAC7D,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,cAAc,CAAC,CAC5C,KAAM,CAAApB,UAAU,CAAC,CAAC,CAAC,CAAC,CACpB8E,KAAK,CAAC,cAAc,CAAC,CACvB,CAAE,MAAOtC,CAAC,CAAE,CAAEsC,KAAK,CAACtC,CAAC,CAACC,OAAO,EAAI,SAAS,CAAC,CAAE,CAC/C,CAAC,CAED,KAAM,CAAAsC,iBAAiB,CAAIC,IAAI,EAAK,KAAAC,qBAAA,CAClCpF,qBAAqB,CAACmF,IAAI,CAAC,CAC3B,CAAAC,qBAAA,CAAAtF,iBAAiB,CAACoD,OAAO,UAAAkC,qBAAA,iBAAzBA,qBAAA,CAA2BC,KAAK,CAAC,CAAC,CACpC,CAAC,CAED,KAAM,CAAAC,iBAAiB,CAAG,KAAO,CAAA3C,CAAC,EAAK,CACrC,KAAM,CAAA4B,KAAK,CAAG5C,KAAK,CAAC4D,IAAI,CAAC5C,CAAC,CAAC6C,MAAM,CAACjB,KAAK,EAAI,EAAE,CAAC,CAC9C,GAAI,CAACA,KAAK,CAACjE,MAAM,EAAI,CAACP,kBAAkB,CAAE,OAC1C,KAAM,CAAA0F,CAAC,CAAGlB,KAAK,CAAC,CAAC,CAAC,CAClB,KAAM,CAAAT,OAAO,CAAGrD,GAAG,CAACiF,eAAe,CAACD,CAAC,CAAC,CACtC,KAAM,CAAAE,MAAM,CAAG5F,kBAAkB,CAACuD,EAAE,CACpC;AACApD,oBAAoB,CAACuD,IAAI,EAAApC,aAAA,CAAAA,aAAA,IAAUoC,IAAI,MAAE,CAACkC,MAAM,EAAG,CAAE9B,IAAI,CAAE4B,CAAC,CAAE3B,OAAQ,CAAC,EAAG,CAAC,CAC3E;AACA1F,QAAQ,CAACqF,IAAI,EAAIA,IAAI,CAAC1B,GAAG,CAAC2B,EAAE,EAAIA,EAAE,CAACJ,EAAE,GAAKqC,MAAM,CAAAtE,aAAA,CAAAA,aAAA,IAAQqC,EAAE,MAAErE,MAAM,CAAEqE,EAAE,CAACrE,MAAM,EAAIqE,EAAE,CAACrE,MAAM,CAACiB,MAAM,CAAG,CAACwD,OAAO,CAAE,GAAGJ,EAAE,CAACrE,MAAM,CAACuG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAG,CAAC9B,OAAO,CAAC,GAAKJ,EAAE,CAAC,CAAC,CACzJ1D,qBAAqB,CAAC,IAAI,CAAC,CAC3B,GAAIF,iBAAiB,CAACoD,OAAO,CAAEpD,iBAAiB,CAACoD,OAAO,CAACM,KAAK,CAAG,EAAE,CACrE,CAAC,CAED,KAAM,CAAAqC,YAAY,CAAG,KAAO,CAAAnC,EAAE,EAAK,CACjC,GAAI,CAAChD,MAAM,CAACoF,OAAO,CAAC,gBAAgB,CAAC,CAAE,OACvC,GAAI,CACN,KAAM,CAAA7E,GAAG,CAAG,KAAM,CAAAC,KAAK,qBAAA6D,MAAA,CAAqBrB,EAAE,CAACJ,EAAE,EAAI,CAAEa,MAAM,CAAE,QAAQ,CAAE/C,OAAO,CAAAC,aAAA,IAAOzE,WAAW,CAAC,CAAC,CAAG,CAAC,CAAC,CACrG,GAAI,CAACqE,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,cAAc,CAAC,CAC5C,KAAM,CAAApB,UAAU,CAAC,CAAC,CAAC,CAAC,CACtB,CAAE,MAAOwC,CAAC,CAAE,CAAEsC,KAAK,CAACtC,CAAC,CAACC,OAAO,EAAI,SAAS,CAAC,CAAE,CAC/C,CAAC,CAED,KAAM,CAAAmD,YAAY,CAAGtJ,OAAO,CAAC,IAAM,CACjC,KAAM,CAAA6G,EAAE,CAAG0C,MAAM,CAAC7G,OAAO,CAACM,UAAU,EAAI,CAAC,CAAC,CAC1C,MAAO,CAAAlB,KAAK,CAAC0H,IAAI,CAACC,CAAC,EAAIF,MAAM,CAACE,CAAC,CAAC5C,EAAE,CAAC,GAAKA,EAAE,CAAC,EAAI,IAAI,CACrD,CAAC,CAAE,CAAC/E,KAAK,CAAEY,OAAO,CAACM,UAAU,CAAC,CAAC,CAC/B,KAAM,CAAA0G,aAAa,CAAG1J,OAAO,CAAC,IAAM,CAClC,KAAM,CAAA2J,GAAG,CAAGJ,MAAM,CAAC7G,OAAO,CAAC6B,OAAO,EAAI,CAAC,CAAC,CACxC,MAAO,CAAAvC,MAAM,CAACwH,IAAI,CAACI,CAAC,EAAIL,MAAM,CAACK,CAAC,CAAC/C,EAAE,CAAC,GAAK8C,GAAG,CAAC,EAAI,IAAI,CACvD,CAAC,CAAE,CAAC3H,MAAM,CAAEU,OAAO,CAAC6B,OAAO,CAAC,CAAC,CAE7B,KAAM,CAAAsF,cAAc,CAAG7J,OAAO,CAAC,IAAM,CACnC,KAAM,CAAAkG,CAAC,CAAG,CAAC,CAAC,CACZ,GAAI,CAACxD,OAAO,CAACI,UAAU,EAAI,CAAClC,MAAM,CAAC8B,OAAO,CAACI,UAAU,CAAC,CAACgH,IAAI,CAAC,CAAC,CAAE5D,CAAC,CAACpD,UAAU,CAAG,wBAAwB,CACxG,GAAI,CAACJ,OAAO,CAAC6B,OAAO,CAAE2B,CAAC,CAAC3B,OAAO,CAAG,yBAAyB,CAC3D,GAAI,CAAC7B,OAAO,CAACM,UAAU,CAAEkD,CAAC,CAAClD,UAAU,CAAG,0BAA0B,CAChE,GAAI,CAACN,OAAO,CAACK,MAAM,CAAEmD,CAAC,CAACnD,MAAM,CAAG,0BAA0B,CAC1D,GAAIL,OAAO,CAACO,KAAK,GAAK,EAAE,EAAIsG,MAAM,CAACQ,KAAK,CAACR,MAAM,CAAC7G,OAAO,CAACO,KAAK,CAAC,CAAC,CAAEiD,CAAC,CAACjD,KAAK,CAAG,mBAAmB,CAC9F,MAAO,CAAAiD,CAAC,CACV,CAAC,CAAE,CAACxD,OAAO,CAAC,CAAC,CACb,KAAM,CAAAsH,WAAW,CAAGhK,OAAO,CAAC,IAAMiK,MAAM,CAACC,IAAI,CAACL,cAAc,CAAC,CAAChG,MAAM,GAAK,CAAC,CAAE,CAACgG,cAAc,CAAC,CAAC,CAC7F,KAAM,CAAAM,WAAW,CAAGnK,OAAO,CAAC,IAAM,CAChC,GAAIgK,WAAW,EAAIxH,QAAQ,CAAE,MAAO,EAAE,CACtC,KAAM,CAAA4H,IAAI,CAAG,EAAE,CACf,GAAIP,cAAc,CAAC/G,UAAU,CAAEsH,IAAI,CAACC,IAAI,CAACR,cAAc,CAAC/G,UAAU,CAAC,CACnE,GAAI+G,cAAc,CAAC7G,UAAU,CAAEoH,IAAI,CAACC,IAAI,CAACR,cAAc,CAAC7G,UAAU,CAAC,CACnE,GAAI6G,cAAc,CAAC9G,MAAM,CAAEqH,IAAI,CAACC,IAAI,CAACR,cAAc,CAAC9G,MAAM,CAAC,CAC3D,MAAO,CAAAqH,IAAI,CAACE,IAAI,CAAC,IAAI,CAAC,CACxB,CAAC,CAAE,CAACT,cAAc,CAAEG,WAAW,CAAExH,QAAQ,CAAC,CAAC,CAE3C,KAAM,CAAA+H,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/BnH,YAAY,CAACyG,cAAc,CAAC,CAC5B,GAAI,CAACG,WAAW,CAAE,OAClBvH,WAAW,CAAC,IAAI,CAAC,CACjB,GAAI,CACF,KAAM,CAAA4F,OAAO,CAAG,CACdvF,UAAU,CAAElC,MAAM,CAAC8B,OAAO,CAACI,UAAU,CAAC,CAACgH,IAAI,CAAC,CAAC,CAC7C9G,UAAU,CAAEuG,MAAM,CAAC7G,OAAO,CAACM,UAAU,CAAC,CACtCD,MAAM,CAAEjC,YAAY,CAAC4B,OAAO,CAACK,MAAM,CAAC,CACpCwB,OAAO,CAAE7B,OAAO,CAAC6B,OAAO,CAAGgF,MAAM,CAAC7G,OAAO,CAAC6B,OAAO,CAAC,CAAGT,SAAS,CAC9Db,KAAK,CAAEP,OAAO,CAACO,KAAK,GAAK,EAAE,CAAGsG,MAAM,CAAC7G,OAAO,CAACO,KAAK,CAAC,CAAGa,SAAS,CAC/DjB,KAAK,CAAEyG,YAAY,CAAGC,MAAM,CAACD,YAAY,CAACkB,SAAS,EAAI,CAAC,CAAC,CAAG1G,SAAS,CACrEZ,WAAW,CAAER,OAAO,CAACQ,WAAW,EAAIY,SAAS,CAC7ClB,MAAM,CAAEF,OAAO,CAACE,MAAM,EAAIF,OAAO,CAACE,MAAM,CAACiB,MAAM,CAAGnB,OAAO,CAACE,MAAM,CAAGkB,SACrE,CAAC,CACL,KAAM,CAAAU,GAAG,CAAG,KAAM,CAAAC,KAAK,CAAC,kBAAkB,CAAE,CAAEiD,MAAM,CAAE,MAAM,CAAE/C,OAAO,CAAAC,aAAA,EAAI,cAAc,CAAE,kBAAkB,EAAKzE,WAAW,CAAC,CAAC,CAAE,CAAEwH,IAAI,CAAEjC,IAAI,CAAC6C,SAAS,CAACF,OAAO,CAAE,CAAC,CAAC,CAC7J,GAAI,CAAC7D,GAAG,CAACK,EAAE,CAAE,CACX,GAAI,CAAA4F,GAAG,CAAG,cAAc,CACxB,GAAI,CAAE,KAAM,CAAA1F,CAAC,CAAG,KAAM,CAAAP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAAE,GAAID,CAAC,SAADA,CAAC,WAADA,CAAC,CAAEoB,OAAO,CAAEsE,GAAG,CAAG1F,CAAC,CAACoB,OAAO,CAAE,CAAE,MAAAuE,QAAA,CAAM,CAAE,KAAM,CAAAjB,CAAC,CAAG,KAAM,CAAAjF,GAAG,CAACmG,IAAI,CAAC,CAAC,CAAE,GAAIlB,CAAC,CAAEgB,GAAG,CAAGhB,CAAC,CAAE,CACzH,KAAM,IAAI,CAAA3E,KAAK,CAAC2F,GAAG,CAAC,CACtB,CACJ9H,UAAU,CAAC,CAAEC,MAAM,CAAC,EAAE,CAAEC,KAAK,CAAC,EAAE,CAAEC,UAAU,CAAE,EAAE,CAAEC,MAAM,CAAE,OAAO,CAAEwB,OAAO,CAAC,EAAE,CAAEvB,UAAU,CAAE,EAAE,CAAEC,KAAK,CAAC,EAAE,CAAEC,WAAW,CAAC,EAAG,CAAC,CAAC,CAC1HE,YAAY,CAAC,CAAC,CAAC,CAAC,CAChB;AACA/B,IAAI,CAAC,EAAE,CAAC,CACRE,SAAS,CAAC,EAAE,CAAC,CACbE,cAAc,CAAC,EAAE,CAAC,CAClB,KAAM,CAAA2E,UAAU,CAAC,CAAC,CAClB,KAAM,CAAA1C,UAAU,CAAC,CAAEtC,CAAC,CAAE,EAAE,CAAEE,MAAM,CAAE,EAAE,CAAEiD,OAAO,CAAE,EAAG,CAAC,CAAC,CAChD9B,WAAW,CAAC,KAAK,CAAC,CAClB+F,KAAK,CAAC,sBAAsB,CAAC,CAC7BjG,eAAe,CAAC,KAAK,CAAC,CACxB,CAAE,MAAO2D,CAAC,CAAE,CAAEsC,KAAK,CAACtC,CAAC,CAACC,OAAO,EAAI,SAAS,CAAC,CAAE1D,WAAW,CAAC,KAAK,CAAC,CAAE,CACnE,CAAC,CAED,KAAM,CAAAmI,YAAY,CAAG3K,MAAM,CAAC,IAAI,CAAC,CACjC,KAAM,CAAA4K,WAAW,CAAGA,CAAA,QAAAC,qBAAA,QAAAA,qBAAA,CAAMF,YAAY,CAACnE,OAAO,UAAAqE,qBAAA,iBAApBA,qBAAA,CAAsBlC,KAAK,CAAC,CAAC,GACvD,KAAM,CAAAmC,eAAe,CAAG,KAAO,CAAA7E,CAAC,EAAK,CACnC,KAAM,CAAA4B,KAAK,CAAG5C,KAAK,CAAC4D,IAAI,CAAC5C,CAAC,CAAC6C,MAAM,CAACjB,KAAK,EAAI,EAAE,CAAC,CAC9C,GAAI,CAACA,KAAK,CAACjE,MAAM,CAAE,OACnB,KAAM,CAAA4C,OAAO,CAAG,CAAC/D,OAAO,CAACE,MAAM,EAAI,EAAE,EAAEiB,MAAM,CAC7C,KAAM,CAAAmH,SAAS,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE,CAAC,CAAGzE,OAAO,CAAC,CAC1C,GAAIuE,SAAS,EAAI,CAAC,CAAE,CAAExC,KAAK,CAAC,mCAAmC,CAAC,CAAE,OAAQ,CAC1E,KAAM,CAAA2C,IAAI,CAAGrD,KAAK,CAACqB,KAAK,CAAC,CAAC,CAAE6B,SAAS,CAAC,CACtC,KAAM,CAAA1D,IAAI,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC3B,IAAK,KAAM,CAAAyB,CAAC,GAAI,CAAAmC,IAAI,CAAE7D,IAAI,CAACE,MAAM,CAAC,OAAO,CAAEwB,CAAC,CAAC,CAC7C,GAAI,CACN,KAAM,CAAAxE,GAAG,CAAG,KAAM,CAAAC,KAAK,CAAC,yBAAyB,CAAE,CAAEiD,MAAM,CAAE,MAAM,CAAEC,IAAI,CAAEL,IAAI,CAAE3C,OAAO,CAAAC,aAAA,IAAOzE,WAAW,CAAC,CAAC,CAAG,CAAC,CAAC,CAC7G,GAAI,CAACqE,GAAG,CAACK,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,kBAAkB,CAAC,CAChD,KAAM,CAAAC,CAAC,CAAG,KAAM,CAAAP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC1B,KAAM,CAAAC,IAAI,CAAGC,KAAK,CAACC,OAAO,CAACJ,CAAC,CAAC+C,KAAK,CAAC,CAAG/C,CAAC,CAAC+C,KAAK,CAAG,EAAE,CAClDnF,UAAU,CAAC4C,CAAC,EAAAX,aAAA,CAAAA,aAAA,IAAUW,CAAC,MAAE3C,MAAM,CAAE,CAAC,IAAI2C,CAAC,CAAC3C,MAAM,EAAE,EAAE,CAAC,CAAE,GAAGqC,IAAI,CAAC,EAAG,CAAC,CACnE,CAAE,MAAOmG,GAAG,CAAE,CAAE5C,KAAK,CAAC4C,GAAG,CAACjF,OAAO,EAAI,aAAa,CAAC,CAAE,CACvD,CAAC,CAED,KAAM,CAAAkF,WAAW,CAAIC,GAAG,EAAK,CAC3B3I,UAAU,CAAC4C,CAAC,EAAAX,aAAA,CAAAA,aAAA,IAAUW,CAAC,MAAE3C,MAAM,CAAE,CAAC2C,CAAC,CAAC3C,MAAM,EAAE,EAAE,EAAEsF,MAAM,CAAC,CAACqD,CAAC,CAAEC,CAAC,GAAKA,CAAC,GAAKF,GAAG,CAAC,EAAG,CAAC,CACjF,CAAC,CAED,KAAM,CAAAG,gBAAgB,CAAIC,KAAK,EAAK,CAClC,GAAI,CAACA,KAAK,CAAE,MAAO,EAAE,CACrB,GAAIA,KAAK,CAAC3K,QAAQ,CAAC,OAAO,CAAC,CAAE,MAAO,mBAAmB,CACvD,GAAI2K,KAAK,CAAC3K,QAAQ,CAAC,KAAK,CAAC,CAAE,MAAO,oBAAoB,CACtD,GAAI2K,KAAK,CAAC3K,QAAQ,CAAC,QAAQ,CAAC,EAAI2K,KAAK,CAAC3K,QAAQ,CAAC,SAAS,CAAC,CAAE,MAAO,iBAAiB,CACnF,MAAO,EAAE,CACX,CAAC,CAED,mBACER,KAAA,QAAKoL,SAAS,CAAC,aAAa,CAACC,KAAK,CAAE,CAAEC,OAAO,CAAE3K,OAAO,CAAG,CAAC,CAAG,gBAAiB,CAAE,CAAA4K,QAAA,EAC7E,CAAC5K,OAAO,eACPb,IAAA,WAAQsL,SAAS,CAAC,aAAa,CAACC,KAAK,CAAE,CAAEG,QAAQ,CAAE,QAAQ,CAAEC,GAAG,CAAE,CAAE,CAAE,CAAAF,QAAA,cACpEvL,KAAA,QAAKoL,SAAS,CAAC,kBAAkB,CAAAG,QAAA,eAC/BzL,IAAA,QAAK4L,GAAG,CAAC,WAAW,CAACC,GAAG,CAAC,MAAM,CAACP,SAAS,CAAC,kBAAkB,CAAE,CAAC,cAC/DtL,IAAA,MAAG8L,IAAI,CAAC,GAAG,CAACR,SAAS,CAAC,wCAAwC,CAAAG,QAAA,CAAC,gBAAS,CAAG,CAAC,EACzE,CAAC,CACA,CACT,cACDvL,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAACC,KAAK,CAAE,CAAEC,OAAO,CAAE,EAAG,CAAE,CAAAC,QAAA,eAC/CzL,IAAA,OAAIsL,SAAS,CAAC,kBAAkB,CAACC,KAAK,CAAE,CAAEQ,SAAS,CAAE,MAAM,CAAEC,SAAS,CAAE,CAAE,CAAE,CAAAP,QAAA,CAAC,4CAAuB,CAAI,CAAC,cACzGvL,KAAA,SAAM+L,QAAQ,CAAGpG,CAAC,EAAGA,CAAC,CAACqG,cAAc,CAAC,CAAE,CAACZ,SAAS,CAAC,YAAY,CAACC,KAAK,CAAE,CAAEY,mBAAmB,CAAE,oBAAqB,CAAE,CAAAV,QAAA,eACnHzL,IAAA,QAAKsL,SAAS,CAAC,UAAU,CAAAG,QAAA,cACvBvL,KAAA,QAAKqL,KAAK,CAAE,CAAEa,OAAO,CAAC,MAAM,CAAEC,UAAU,CAAC,QAAQ,CAAEC,GAAG,CAAC,CAAE,CAAE,CAAAb,QAAA,eACzDzL,IAAA,UAAOsL,SAAS,CAAC,UAAU,CAACiB,WAAW,CAAC,8BAAmB,CAAC7F,KAAK,CAAE3F,CAAE,CAACyL,QAAQ,CAAE3G,CAAC,EAAE7E,IAAI,CAAC6E,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAE,CAAE,CAAC,CAC1GnF,cAAc,cACbrB,KAAA,QAAKoL,SAAS,CAAC,kBAAkB,CAACmB,KAAK,CAAC,qEAAsC,CAAAhB,QAAA,EAAC,aACvE,CAAClK,cAAc,EAClB,CAAC,CACJ,IAAI,EACL,CAAC,CACH,CAAC,cACNrB,KAAA,WAAQoL,SAAS,CAAC,0BAA0B,CAAC5E,KAAK,CAAEvF,WAAY,CAACqL,QAAQ,CAAE3G,CAAC,EAAE,CAAE,KAAM,CAAAyD,GAAG,CAAGzD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAEtF,cAAc,CAACkI,GAAG,CAAC,CAAEvD,UAAU,CAACuD,GAAG,EAAI7F,SAAS,CAAC,CAAE,CAAE,CAAC8H,KAAK,CAAE,CAAEmB,MAAM,CAAE,EAAG,CAAE,CAAAjB,QAAA,eACtLzL,IAAA,WAAQ0G,KAAK,CAAC,EAAE,CAAA+E,QAAA,CAAC,oCAAgB,CAAQ,CAAC,CACzC9J,MAAM,CAACsD,GAAG,CAACsE,CAAC,eAAIvJ,IAAA,WAAmB0G,KAAK,CAAE6C,CAAC,CAAC/C,EAAG,CAAAiF,QAAA,CAAElC,CAAC,CAACoD,IAAI,EAA1BpD,CAAC,CAAC/C,EAAiC,CAAC,CAAC,EAC7D,CAAC,cACTtG,KAAA,WAAQoL,SAAS,CAAC,0BAA0B,CAAC5E,KAAK,CAAEzF,MAAO,CAACuL,QAAQ,CAAE3G,CAAC,EAAE3E,SAAS,CAAC2E,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAE,CAAC6E,KAAK,CAAE,CAAEmB,MAAM,CAAE,EAAG,CAAE,CAAAjB,QAAA,eACxHzL,IAAA,WAAQ0G,KAAK,CAAC,EAAE,CAAA+E,QAAA,CAAC,qCAAiB,CAAQ,CAAC,CAC1ChK,KAAK,CAACwD,GAAG,CAACmE,CAAC,eAAIpJ,IAAA,WAAmB0G,KAAK,CAAE0C,CAAC,CAAC5C,EAAG,CAAAiF,QAAA,CAAErC,CAAC,CAACuD,IAAI,EAA1BvD,CAAC,CAAC5C,EAAiC,CAAC,CAAC,EAC5D,CAAC,cACTxG,IAAA,WAAQsL,SAAS,CAAC,mBAAmB,CAACsB,IAAI,CAAC,QAAQ,CAACC,OAAO,CAAEA,CAAA,GAAI,CAAE3K,eAAe,CAAC,IAAI,CAAC,CAAEa,YAAY,CAAC,CAAC,CAAC,CAAC,CAAE,CAAE,CAAA0I,QAAA,CAAC,oBAAY,CAAQ,CAAC,EAChI,CAAC,CACN5J,OAAO,cAAG7B,IAAA,QAAKuL,KAAK,CAAE,CAAEuB,KAAK,CAAC,MAAO,CAAE,CAAArB,QAAA,CAAC,uBAAW,CAAK,CAAC,CAAG1J,KAAK,cAAG/B,IAAA,QAAKuL,KAAK,CAAE,CAAEuB,KAAK,CAAC,SAAU,CAAE,CAAArB,QAAA,CAAE1J,KAAK,CAAM,CAAC,cACjH7B,KAAA,QAAAuL,QAAA,eACEvL,KAAA,QAAKoL,SAAS,CAAC,eAAe,CAACC,KAAK,CAAE,CAAEY,mBAAmB,CAAE,2CAA4C,CAAE,CAAAV,QAAA,eACzGzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,UAAG,CAAK,CAAC,cAChCzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,kBAAQ,CAAK,CAAC,cACrCzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,WAAI,CAAK,CAAC,cACjCzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,+BAAa,CAAK,CAAC,cAC1CzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,oBAAQ,CAAK,CAAC,cACrCzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,gBAAS,CAAK,CAAC,cACtCzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,oBAAU,CAAK,CAAC,cACvCzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAC,wBAAS,CAAK,CAAC,EACnC,CAAC,CACLpK,KAAK,CAACmC,MAAM,GAAK,CAAC,cACjBxD,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAACC,KAAK,CAAE,CAAEC,OAAO,CAAE,EAAE,CAAEsB,KAAK,CAAE,MAAO,CAAE,CAAArB,QAAA,CAAC,iCAAmB,CAAK,CAAC,CACrFpK,KAAK,CAAC4D,GAAG,CAAC2B,EAAE,eACd1G,KAAA,QAAiBoL,SAAS,CAAC,OAAO,CAACC,KAAK,CAAE,CAAEY,mBAAmB,CAAE,2CAA4C,CAAE,CAAAV,QAAA,eAC7GzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,cACpBzL,IAAA,QAAK6M,OAAO,CAAEA,CAAA,GAAIzE,iBAAiB,CAACxB,EAAE,CAAE,CAAC0E,SAAS,CAAC,kBAAkB,CAACmB,KAAK,CAAC,sDAAqB,CAAAhB,QAAA,CAC9F5G,KAAK,CAACC,OAAO,CAAC8B,EAAE,CAACrE,MAAM,CAAC,EAAIqE,EAAE,CAACrE,MAAM,CAACiB,MAAM,cAC3CxD,IAAA,QAAK4L,GAAG,CAAEhF,EAAE,CAACrE,MAAM,CAAC,CAAC,CAAE,CAACsJ,GAAG,CAAC,OAAO,CAACN,KAAK,CAAEpI,iBAAiB,CAACyD,EAAE,CAACJ,EAAE,CAAC,CAAG,CAAEuG,OAAO,CAAE,oBAAqB,CAAC,CAAGtJ,SAAU,CAAE,CAAC,cACrHzD,IAAA,SAAAyL,QAAA,CAAM,UAAQ,CAAM,CAAC,CACtB,CAAC,CACH,CAAC,cACNzL,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,cAACzL,IAAA,UAAO0G,KAAK,CAAEE,EAAE,CAACnE,UAAU,EAAI,EAAG,CAAC+J,QAAQ,CAAE3G,CAAC,EAAEU,WAAW,CAACK,EAAE,CAACJ,EAAE,CAAE,YAAY,CAAEX,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAE,CAAE,CAAC,CAAK,CAAC,cACjI1G,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,cACpBvL,KAAA,WAAQwG,KAAK,CAAEE,EAAE,CAACjE,UAAU,EAAI,EAAG,CAAC6J,QAAQ,CAAE3G,CAAC,EAAEU,WAAW,CAACK,EAAE,CAACJ,EAAE,CAAE,YAAY,CAAE0C,MAAM,CAACrD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAC,CAAE,CAAA+E,QAAA,eACxGzL,IAAA,WAAQ0G,KAAK,CAAC,EAAE,CAAA+E,QAAA,CAAC,QAAC,CAAQ,CAAC,CAC1BhK,KAAK,CAACwD,GAAG,CAACmE,CAAC,eAAIpJ,IAAA,WAAmB0G,KAAK,CAAE0C,CAAC,CAAC5C,EAAG,CAAAiF,QAAA,CAAErC,CAAC,CAACuD,IAAI,EAA1BvD,CAAC,CAAC5C,EAAiC,CAAC,CAAC,EAC5D,CAAC,CACN,CAAC,cACNxG,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,CAAEvC,MAAM,CAACtC,EAAE,CAACuD,SAAS,EAAI,CAAC,CAAC,CAAC6C,cAAc,CAAC,OAAO,CAAC,CAAM,CAAC,cAChF9M,KAAA,QAAKoL,SAAS,CAAC,OAAO,CAAAG,QAAA,EAAGvC,MAAM,CAACtC,EAAE,CAACqG,SAAS,EAAE,CAAC,CAAC,CAAE,WAAM,EAAK,CAAC,cAC9DjN,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAACmB,KAAK,CAAE7F,EAAE,CAACsG,SAAS,EAAI,EAAG,CAAC3B,KAAK,CAAE,CAAE4B,QAAQ,CAAE,QAAQ,CAAEC,YAAY,CAAE,UAAU,CAAEC,UAAU,CAAE,QAAS,CAAE,CAAA5B,QAAA,CAAE7E,EAAE,CAACsG,SAAS,EAAI,GAAG,CAAM,CAAC,cAC5JlN,IAAA,QAAKsL,SAAS,CAAC,OAAO,CAAAG,QAAA,cACpBzL,IAAA,WAAQ0G,KAAK,CAAEE,EAAE,CAACpB,QAAS,CAACgH,QAAQ,CAAE3G,CAAC,EAAEU,WAAW,CAACK,EAAE,CAACJ,EAAE,CAAE,UAAU,CAAEX,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAE,CAAC4E,SAAS,CAAEF,gBAAgB,CAACxE,EAAE,CAACpB,QAAQ,CAAE,CAAAiG,QAAA,CAC/HtL,SAAS,CAAC8E,GAAG,CAAC5E,CAAC,eAAIL,IAAA,WAAgB0G,KAAK,CAAErG,CAAE,CAAAoL,QAAA,CAAEpL,CAAC,EAAfA,CAAwB,CAAC,CAAC,CACrD,CAAC,CACN,CAAC,cACNH,KAAA,QAAKoL,SAAS,CAAC,OAAO,CAAAG,QAAA,eACpBzL,IAAA,WAAQsL,SAAS,CAAC,QAAQ,CAACsB,IAAI,CAAC,QAAQ,CAACC,OAAO,CAAEA,CAAA,GAAIhG,UAAU,CAACD,EAAE,CAAE,CAAA6E,QAAA,CAAC,UAAG,CAAQ,CAAC,cAClFzL,IAAA,WAAQsL,SAAS,CAAC,0BAA0B,CAACsB,IAAI,CAAC,QAAQ,CAACC,OAAO,CAAEA,CAAA,GAAI9D,YAAY,CAACnC,EAAE,CAAE,CAAA6E,QAAA,CAAC,QAAG,CAAQ,CAAC,EACnG,CAAC,GA1BE7E,EAAE,CAACJ,EA2BR,CACN,CAAC,EACC,CACN,cAEDxG,IAAA,UAAOsN,GAAG,CAAEtK,iBAAkB,CAAC4J,IAAI,CAAC,MAAM,CAACW,MAAM,CAAC,SAAS,CAACC,MAAM,MAAChB,QAAQ,CAAEhE,iBAAkB,CAAE,CAAC,EAC/F,CAAC,CAELvG,YAAY,eACXjC,IAAA,QAAKsL,SAAS,CAAC,iBAAiB,CAACmC,WAAW,CAAG5H,CAAC,EAAG,CAAE,GAAIA,CAAC,CAAC6C,MAAM,GAAG7C,CAAC,CAAC6H,aAAa,CAAExL,eAAe,CAAC,KAAK,CAAC,CAAE,CAAE,CAAAuJ,QAAA,cAC7GzL,IAAA,QAAKsL,SAAS,CAAC,eAAe,CAACmC,WAAW,CAAG5H,CAAC,EAAGA,CAAC,CAAC8H,eAAe,CAAC,CAAE,CAACpC,KAAK,CAAE,CAAEqC,KAAK,CAAE,GAAG,CAAEC,QAAQ,CAAC,KAAM,CAAE,CAAApC,QAAA,cAC1GvL,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAACC,KAAK,CAAE,CAAEC,OAAO,CAAE,EAAG,CAAE,CAAAC,QAAA,eAC/CzL,IAAA,OAAIuL,KAAK,CAAE,CAAES,SAAS,CAAC,CAAC,CAAED,SAAS,CAAC,QAAS,CAAE,CAAAN,QAAA,CAAC,2BAAc,CAAI,CAAC,cACnEvL,KAAA,QAAKoL,SAAS,CAAC,kBAAkB,CAAAG,QAAA,eAC/BvL,KAAA,QAAKoL,SAAS,CAAC,SAAS,CAAAG,QAAA,eACtBzL,IAAA,UAAAyL,QAAA,CAAO,2BAAc,CAAO,CAAC,cAC7BvL,KAAA,QAAKoL,SAAS,CAAC,aAAa,CAACuB,OAAO,CAAErC,WAAY,CAAAiB,QAAA,EAC/C,CAACpJ,OAAO,CAACE,MAAM,EAAE,EAAE,EAAEiB,MAAM,cAC1BxD,IAAA,QAAKsL,SAAS,CAAC,WAAW,CAAAG,QAAA,CACvBpJ,OAAO,CAACE,MAAM,CAAC0C,GAAG,CAAC,CAACvB,GAAG,CAAEuH,GAAG,gBAC3B/K,KAAA,QAAeoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACjCzL,IAAA,QAAK4L,GAAG,CAAElI,GAAI,CAACmI,GAAG,CAAC,EAAE,CAAE,CAAC,cACxB7L,IAAA,WAAQ4M,IAAI,CAAC,QAAQ,CAACtB,SAAS,CAAC,cAAc,CAACuB,OAAO,CAAGiB,EAAE,EAAG,CAACA,EAAE,CAACH,eAAe,CAAC,CAAC,CAAE3C,WAAW,CAACC,GAAG,CAAC,CAAC,CAAE,CAAAQ,QAAA,CAAC,MAAC,CAAQ,CAAC,GAF3GR,GAGL,CACN,CAAC,CACC,CAAC,cACJjL,IAAA,QAAKsL,SAAS,CAAC,UAAU,CAAAG,QAAA,CAAC,0CAAe,CAAK,CAAC,cACnDzL,IAAA,UAAOsN,GAAG,CAAE/C,YAAa,CAACiC,QAAQ,CAAE9B,eAAgB,CAACkC,IAAI,CAAC,MAAM,CAACW,MAAM,CAAC,SAAS,CAACQ,QAAQ,MAACP,MAAM,MAAE,CAAC,EACjG,CAAC,cACNtN,KAAA,QAAKoL,SAAS,CAAC,SAAS,CAAAG,QAAA,EAAE,CAACpJ,OAAO,CAACE,MAAM,EAAE,EAAE,EAAEiB,MAAM,CAAC,aAAM,EAAK,CAAC,cAClEtD,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,+BAAgB,CAAO,CAAC,cAC/BzL,IAAA,UAAO0G,KAAK,CAAEuC,YAAY,CAAGC,MAAM,CAACD,YAAY,CAACkB,SAAS,EAAE,CAAC,CAAC,CAAC6C,cAAc,CAAC,OAAO,CAAC,CAAG,EAAG,CAACT,WAAW,CAAC,YAAY,CAACyB,QAAQ,MAAE,CAAC,EAC9H,CAAC,cACN9N,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,kBAAQ,CAAO,CAAC,cACvBzL,IAAA,UAAOuM,WAAW,CAAC,4BAAe,CAACjB,SAAS,CAAExI,SAAS,CAACL,UAAU,CAAG,UAAU,CAAG,EAAG,CAACiE,KAAK,CAAErE,OAAO,CAACI,UAAW,CAAC+J,QAAQ,CAAE3G,CAAC,EAAE,CAAEvD,UAAU,CAAAiC,aAAA,CAAAA,aAAA,IAAKlC,OAAO,MAAEI,UAAU,CAACoD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,EAAC,CAAC,CAAE,GAAI5D,SAAS,CAACL,UAAU,CAAEM,YAAY,CAAAwB,aAAA,CAAAA,aAAA,IAAKzB,SAAS,MAAEL,UAAU,CAAEgB,SAAS,EAAC,CAAC,CAAE,CAAE,CAAE,CAAC,CACxQX,SAAS,CAACL,UAAU,cAAGzC,IAAA,QAAKsL,SAAS,CAAC,UAAU,CAAAG,QAAA,CAAE3I,SAAS,CAACL,UAAU,CAAM,CAAC,CAAG,IAAI,EAClF,CAAC,cACNvC,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,oBAAU,CAAO,CAAC,cACzBzL,IAAA,WAAQsL,SAAS,IAAArD,MAAA,CAAKnF,SAAS,CAACJ,MAAM,CAAG,UAAU,CAAG,EAAE,MAAAuF,MAAA,CAAImD,gBAAgB,CAAC/I,OAAO,CAACK,MAAM,CAAC,CAAG,CAACgE,KAAK,CAAErE,OAAO,CAACK,MAAO,CAAC8J,QAAQ,CAAE3G,CAAC,EAAE,CAAEvD,UAAU,CAAAiC,aAAA,CAAAA,aAAA,IAAKlC,OAAO,MAAEK,MAAM,CAACmD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,EAAC,CAAC,CAAE,GAAI5D,SAAS,CAACJ,MAAM,CAAEK,YAAY,CAAAwB,aAAA,CAAAA,aAAA,IAAKzB,SAAS,MAAEJ,MAAM,CAAEe,SAAS,EAAC,CAAC,CAAE,CAAE,CAAAgI,QAAA,CAC7PtL,SAAS,CAAC8E,GAAG,CAAC5E,CAAC,eAAIL,IAAA,WAAgB0G,KAAK,CAAErG,CAAE,CAAAoL,QAAA,CAAEpL,CAAC,EAAfA,CAAwB,CAAC,CAAC,CACrD,CAAC,CACRyC,SAAS,CAACJ,MAAM,cAAG1C,IAAA,QAAKsL,SAAS,CAAC,UAAU,CAAAG,QAAA,CAAE3I,SAAS,CAACJ,MAAM,CAAM,CAAC,CAAG,IAAI,EAC1E,CAAC,EACH,CAAC,cACNxC,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBvL,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,mBAAS,CAAO,CAAC,cACxBvL,KAAA,WAAQoL,SAAS,CAAExI,SAAS,CAACoB,OAAO,CAAG,UAAU,CAAG,EAAG,CAACwC,KAAK,CAAErE,OAAO,CAAC6B,OAAO,EAAI,EAAG,CAACsI,QAAQ,CAAE3G,CAAC,EAAE,CACjG,KAAM,CAAAyD,GAAG,CAAGzD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAGwC,MAAM,CAACrD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAC,CAAG,EAAE,CACxDpE,UAAU,CAAAiC,aAAA,CAAAA,aAAA,IAAMlC,OAAO,MAAE6B,OAAO,CAAEoF,GAAG,CAAE3G,UAAU,CAAE,EAAE,EAAE,CAAC,CACxDoD,UAAU,CAACuD,GAAG,EAAI7F,SAAS,CAAC,CAC5B,GAAIX,SAAS,CAACoB,OAAO,CAAEnB,YAAY,CAAAwB,aAAA,CAAAA,aAAA,IAAMzB,SAAS,MAAEoB,OAAO,CAAET,SAAS,EAAE,CAAC,CAC3E,CAAE,CAAAgI,QAAA,eACAzL,IAAA,WAAQ0G,KAAK,CAAC,EAAE,CAAA+E,QAAA,CAAC,mCAAoB,CAAQ,CAAC,CAC7C9J,MAAM,CAACsD,GAAG,CAACsE,CAAC,eAAIvJ,IAAA,WAAmB0G,KAAK,CAAE6C,CAAC,CAAC/C,EAAG,CAAAiF,QAAA,CAAElC,CAAC,CAACoD,IAAI,EAA1BpD,CAAC,CAAC/C,EAAiC,CAAC,CAAC,EAC7D,CAAC,CACR1D,SAAS,CAACoB,OAAO,cAAGlE,IAAA,QAAKsL,SAAS,CAAC,UAAU,CAAAG,QAAA,CAAE3I,SAAS,CAACoB,OAAO,CAAM,CAAC,CAAG,IAAI,EAC5E,CAAC,cACNhE,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,oBAAU,CAAO,CAAC,cACzBvL,KAAA,WAAQoL,SAAS,CAAExI,SAAS,CAACH,UAAU,CAAG,UAAU,CAAG,EAAG,CAAC+D,KAAK,CAAErE,OAAO,CAACM,UAAW,CAAC6J,QAAQ,CAAE3G,CAAC,EAAE,CAAE,KAAM,CAAAoI,GAAG,CAAGpI,CAAC,CAAC6C,MAAM,CAAChC,KAAK,CAAEpE,UAAU,CAAAiC,aAAA,CAAAA,aAAA,IAAKlC,OAAO,MAAEM,UAAU,CAAEsL,GAAG,CAAG/E,MAAM,CAAC+E,GAAG,CAAC,CAAG,EAAE,EAAC,CAAC,CAAE,GAAInL,SAAS,CAACH,UAAU,CAAEI,YAAY,CAAAwB,aAAA,CAAAA,aAAA,IAAKzB,SAAS,MAAEH,UAAU,CAAEc,SAAS,EAAC,CAAC,CAAE,CAAE,CAAAgI,QAAA,eAC9QzL,IAAA,WAAQ0G,KAAK,CAAC,EAAE,CAAA+E,QAAA,CAAC,oCAAqB,CAAQ,CAAC,CAC9ChK,KAAK,CAACwD,GAAG,CAACmE,CAAC,eAAIpJ,IAAA,WAAmB0G,KAAK,CAAE0C,CAAC,CAAC5C,EAAG,CAAAiF,QAAA,CAAErC,CAAC,CAACuD,IAAI,EAA1BvD,CAAC,CAAC5C,EAAiC,CAAC,CAAC,EAC5D,CAAC,CACR1D,SAAS,CAACH,UAAU,cAAG3C,IAAA,QAAKsL,SAAS,CAAC,UAAU,CAAAG,QAAA,CAAE3I,SAAS,CAACH,UAAU,CAAM,CAAC,CAAG,IAAI,EAClF,CAAC,cACNzC,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,WAAI,CAAO,CAAC,cACnBzL,IAAA,UAAOuM,WAAW,CAAC,qBAAW,CAAC7F,KAAK,CAAErE,OAAO,CAACO,KAAM,CAAC4J,QAAQ,CAAE3G,CAAC,EAAE,CAAEvD,UAAU,CAAAiC,aAAA,CAAAA,aAAA,IAAKlC,OAAO,MAAEO,KAAK,CAAEiD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,EAAC,CAAC,CAAE,GAAI5D,SAAS,CAACF,KAAK,CAAEG,YAAY,CAAAwB,aAAA,CAAAA,aAAA,IAAKzB,SAAS,MAAEF,KAAK,CAAEa,SAAS,EAAC,CAAC,CAAE,CAAE,CAAC6H,SAAS,CAAExI,SAAS,CAACF,KAAK,CAAG,UAAU,CAAG,EAAG,CAAE,CAAC,CAC5OE,SAAS,CAACF,KAAK,cAAG5C,IAAA,QAAKsL,SAAS,CAAC,UAAU,CAAAG,QAAA,CAAE3I,SAAS,CAACF,KAAK,CAAM,CAAC,CAAG,IAAI,EACxE,CAAC,cACN1C,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,eAAK,CAAO,CAAC,cACpBzL,IAAA,aAAUkO,IAAI,CAAE,CAAE,CAAC3B,WAAW,CAAC,iDAA4B,CAAC7F,KAAK,CAAErE,OAAO,CAACQ,WAAY,CAAC2J,QAAQ,CAAE3G,CAAC,EAAEvD,UAAU,CAAAiC,aAAA,CAAAA,aAAA,IAAKlC,OAAO,MAAEQ,WAAW,CAACgD,CAAC,CAAC6C,MAAM,CAAChC,KAAK,EAAC,CAAE,CAAE,CAAC,EAC1J,CAAC,cACNxG,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,mDAAmB,CAAO,CAAC,cAClCzL,IAAA,UAAO0G,KAAK,CAAEuC,YAAY,CAAGA,YAAY,CAACgE,SAAS,CAAG,EAAG,CAACe,QAAQ,MAAE,CAAC,EAClE,CAAC,cACN9N,KAAA,QAAKoL,SAAS,CAAC,UAAU,CAAAG,QAAA,eACvBzL,IAAA,UAAAyL,QAAA,CAAO,sCAAgB,CAAO,CAAC,cAC/BzL,IAAA,UAAO0G,KAAK,CAAEuC,YAAY,CAAGA,YAAY,CAACkF,WAAW,CAAG,EAAG,CAACH,QAAQ,MAAE,CAAC,EACpE,CAAC,EACH,CAAC,EACH,CAAC,cACN9N,KAAA,QAAKqL,KAAK,CAAE,CAAES,SAAS,CAAC,EAAE,CAAEI,OAAO,CAAC,MAAM,CAAEE,GAAG,CAAC,CAAC,CAAE8B,cAAc,CAAC,QAAS,CAAE,CAAA3C,QAAA,eAC3EzL,IAAA,SAAMyM,KAAK,CAAG,CAAC9C,WAAW,EAAI,CAACxH,QAAQ,CAAI2H,WAAW,CAAG,EAAG,CAACyB,KAAK,CAAE,CAAEa,OAAO,CAAC,cAAe,CAAE,CAAAX,QAAA,cAC7FzL,IAAA,WAAQsL,SAAS,CAAC,QAAQ,CAACuB,OAAO,CAAE3C,YAAa,CAAC8D,QAAQ,CAAE7L,QAAQ,EAAI,CAACwH,WAAY,CAACiD,IAAI,CAAC,QAAQ,CAAAnB,QAAA,CAAEtJ,QAAQ,CAAG,aAAa,CAAG,YAAY,CAAS,CAAC,CAClJ,CAAC,cACPnC,IAAA,WAAQsL,SAAS,CAAC,0BAA0B,CAACuB,OAAO,CAAEA,CAAA,GAAI3K,eAAe,CAAC,KAAK,CAAE,CAAC0K,IAAI,CAAC,QAAQ,CAAAnB,QAAA,CAAC,UAAG,CAAQ,CAAC,EACzG,CAAC,EACH,CAAC,CACH,CAAC,CACH,CACN,EACE,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}