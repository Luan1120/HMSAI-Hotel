{"ast":null,"code":"export function getCurrentUser() {\n  try {\n    const raw = localStorage.getItem('hmsUser');\n    return raw ? JSON.parse(raw) : null;\n  } catch {\n    return null;\n  }\n}\nexport function getUserEmail() {\n  const u = getCurrentUser();\n  return u && u.email ? u.email : null;\n}\nexport function getUserRole() {\n  const u = getCurrentUser();\n  const raw = u && u.role ? u.role : 'Customer';\n  const ascii = String(raw || '').normalize('NFD').replace(/[\\u0300-\\u036f]/g, '').toLowerCase();\n  if (ascii === 'admin' || ascii.includes('quan tri')) return 'Admin';\n  if (ascii === 'staff' || ascii.includes('nhan vien') || ascii.includes('nhan-vien')) return 'Staff';\n  return 'Customer';\n}\nexport function hasRole(roles) {\n  const role = getUserRole();\n  return Array.isArray(roles) ? roles.includes(role) : false;\n}\nexport function authHeaders() {\n  const email = getUserEmail();\n  const headers = {};\n  if (email) headers['x-user-email'] = email;\n  return headers;\n}\n\n// Helper: kiểm tra đã đăng nhập chưa\nexport function isLoggedIn() {\n  return !!getCurrentUser();\n}","map":{"version":3,"names":["getCurrentUser","raw","localStorage","getItem","JSON","parse","getUserEmail","u","email","getUserRole","role","ascii","String","normalize","replace","toLowerCase","includes","hasRole","roles","Array","isArray","authHeaders","headers","isLoggedIn"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/auth.js"],"sourcesContent":["export function getCurrentUser() {\r\n  try {\r\n    const raw = localStorage.getItem('hmsUser');\r\n    return raw ? JSON.parse(raw) : null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function getUserEmail() {\r\n  const u = getCurrentUser();\r\n  return (u && u.email) ? u.email : null;\r\n}\r\n\r\nexport function getUserRole() {\r\n  const u = getCurrentUser();\r\n  const raw = (u && u.role) ? u.role : 'Customer';\r\n  const ascii = String(raw || '')\r\n    .normalize('NFD')\r\n    .replace(/[\\u0300-\\u036f]/g, '')\r\n    .toLowerCase();\r\n  if (ascii === 'admin' || ascii.includes('quan tri')) return 'Admin';\r\n  if (ascii === 'staff' || ascii.includes('nhan vien') || ascii.includes('nhan-vien')) return 'Staff';\r\n  return 'Customer';\r\n}\r\n\r\nexport function hasRole(roles) {\r\n  const role = getUserRole();\r\n  return Array.isArray(roles) ? roles.includes(role) : false;\r\n}\r\n\r\nexport function authHeaders() {\r\n  const email = getUserEmail();\r\n  const headers = {};\r\n  if (email) headers['x-user-email'] = email;\r\n  return headers;\r\n}\r\n\r\n// Helper: kiểm tra đã đăng nhập chưa\r\nexport function isLoggedIn() {\r\n  return !!getCurrentUser();\r\n}\r\n"],"mappings":"AAAA,OAAO,SAASA,cAAcA,CAAA,EAAG;EAC/B,IAAI;IACF,MAAMC,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IAC3C,OAAOF,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC,GAAG,IAAI;EACrC,CAAC,CAAC,MAAM;IACN,OAAO,IAAI;EACb;AACF;AAEA,OAAO,SAASK,YAAYA,CAAA,EAAG;EAC7B,MAAMC,CAAC,GAAGP,cAAc,CAAC,CAAC;EAC1B,OAAQO,CAAC,IAAIA,CAAC,CAACC,KAAK,GAAID,CAAC,CAACC,KAAK,GAAG,IAAI;AACxC;AAEA,OAAO,SAASC,WAAWA,CAAA,EAAG;EAC5B,MAAMF,CAAC,GAAGP,cAAc,CAAC,CAAC;EAC1B,MAAMC,GAAG,GAAIM,CAAC,IAAIA,CAAC,CAACG,IAAI,GAAIH,CAAC,CAACG,IAAI,GAAG,UAAU;EAC/C,MAAMC,KAAK,GAAGC,MAAM,CAACX,GAAG,IAAI,EAAE,CAAC,CAC5BY,SAAS,CAAC,KAAK,CAAC,CAChBC,OAAO,CAAC,kBAAkB,EAAE,EAAE,CAAC,CAC/BC,WAAW,CAAC,CAAC;EAChB,IAAIJ,KAAK,KAAK,OAAO,IAAIA,KAAK,CAACK,QAAQ,CAAC,UAAU,CAAC,EAAE,OAAO,OAAO;EACnE,IAAIL,KAAK,KAAK,OAAO,IAAIA,KAAK,CAACK,QAAQ,CAAC,WAAW,CAAC,IAAIL,KAAK,CAACK,QAAQ,CAAC,WAAW,CAAC,EAAE,OAAO,OAAO;EACnG,OAAO,UAAU;AACnB;AAEA,OAAO,SAASC,OAAOA,CAACC,KAAK,EAAE;EAC7B,MAAMR,IAAI,GAAGD,WAAW,CAAC,CAAC;EAC1B,OAAOU,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,GAAGA,KAAK,CAACF,QAAQ,CAACN,IAAI,CAAC,GAAG,KAAK;AAC5D;AAEA,OAAO,SAASW,WAAWA,CAAA,EAAG;EAC5B,MAAMb,KAAK,GAAGF,YAAY,CAAC,CAAC;EAC5B,MAAMgB,OAAO,GAAG,CAAC,CAAC;EAClB,IAAId,KAAK,EAAEc,OAAO,CAAC,cAAc,CAAC,GAAGd,KAAK;EAC1C,OAAOc,OAAO;AAChB;;AAEA;AACA,OAAO,SAASC,UAAUA,CAAA,EAAG;EAC3B,OAAO,CAAC,CAACvB,cAAc,CAAC,CAAC;AAC3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}