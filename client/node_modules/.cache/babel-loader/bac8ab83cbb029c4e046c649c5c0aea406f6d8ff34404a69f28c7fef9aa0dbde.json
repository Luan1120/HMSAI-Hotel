{"ast":null,"code":"var _jsxFileName = \"D:\\\\DA_TichHop\\\\HMS_AI Hotel\\\\client\\\\src\\\\AdminPromotions.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport './HomePage.css';\nimport { authHeaders, getUserRole } from './auth';\n\n/* Quản lý Ưu đãi / Mã khuyến mãi\r\n   - Danh sách + tìm kiếm + lọc trạng thái\r\n   - Tạo mới / Chỉnh sửa / Bật tắt (isActive)\r\n   - Preview tính giảm theo số tiền đơn hàng nhập thử\r\n   Trạng thái hiển thị:\r\n     Active    => isActive=1 && now within [startDate,endDate]\r\n     Scheduled => isActive=1 && now < startDate\r\n     Expired   => now > endDate\r\n     Disabled  => isActive=0\r\n*/\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function AdminPromotions() {\n  _s();\n  const role = getUserRole();\n  const isAdminOrStaff = ['Admin', 'Staff'].includes(role);\n  const isAdmin = role === 'Admin';\n  const [items, setItems] = useState([]); // promotions\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [q, setQ] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [createOpen, setCreateOpen] = useState(false);\n  const [editing, setEditing] = useState(null); // row object being edited inline modal\n  const [saving, setSaving] = useState(false);\n  const [creating, setCreating] = useState(false);\n  const [previewAmount, setPreviewAmount] = useState('');\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n  const debounceRef = useRef(null);\n  const now = useMemo(() => new Date(), []);\n  const emptyForm = {\n    code: '',\n    description: '',\n    discountType: 'PERCENT',\n    discountValue: '',\n    startDate: '',\n    endDate: '',\n    minOrderAmount: '',\n    maxDiscount: '',\n    isActive: true\n  };\n  const [form, setForm] = useState(emptyForm);\n  const statusOf = p => {\n    if (!p) return 'Unknown';\n    const s = new Date(p.startDate);\n    const e = new Date(p.endDate);\n    if (!p.isActive) return 'Disabled';\n    if (now < s) return 'Scheduled';\n    if (now > e) return 'Expired';\n    return 'Active';\n  };\n  const filtered = useMemo(() => {\n    const text = q.trim().toLowerCase();\n    return items.filter(p => {\n      const st = statusOf(p);\n      if (statusFilter !== 'all' && st.toLowerCase() !== statusFilter) return false;\n      if (text && !(`${p.code}`.toLowerCase().includes(text) || (p.description || '').toLowerCase().includes(text))) return false;\n      return true;\n    });\n  }, [items, q, statusFilter]);\n  const paged = useMemo(() => {\n    const start = (page - 1) * pageSize;\n    return filtered.slice(start, start + pageSize);\n  }, [filtered, page]);\n  const pageCount = useMemo(() => Math.max(1, Math.ceil(filtered.length / pageSize)), [filtered.length]);\n  const computeDiscount = (promo, orderAmount) => {\n    const amt = Number(orderAmount || 0);\n    if (!promo || !(amt > 0)) return {\n      discount: 0,\n      final: amt\n    };\n    if (promo.discountType === 'PERCENT') {\n      let raw = amt * (Number(promo.discountValue || 0) / 100);\n      if (promo.maxDiscount) raw = Math.min(raw, Number(promo.maxDiscount));\n      return {\n        discount: raw,\n        final: Math.max(0, amt - raw)\n      };\n    }\n    const raw = Number(promo.discountValue || 0);\n    return {\n      discount: Math.min(raw, amt),\n      final: Math.max(0, amt - raw)\n    };\n  };\n  const load = async () => {\n    if (!isAdminOrStaff) return;\n    setLoading(true);\n    setError('');\n    try {\n      // Tạm thời gọi thử endpoint nếu có, nếu 404 → giả lập mock\n      const res = await fetch('/api/admin/promotions', {\n        headers: authHeaders(),\n        cache: 'no-store'\n      });\n      if (!res.ok) throw new Error('Không tải được danh sách ưu đãi');\n      const j = await res.json();\n      const list = Array.isArray(j.items) ? j.items : Array.isArray(j.promotions) ? j.promotions : [];\n      setItems(list.map(r => ({\n        ...r\n      })));\n    } catch (e) {\n      console.warn('[AdminPromotions] load error:', e.message);\n      setError(e.message || 'Lỗi tải dữ liệu');\n      // Không còn tự động tạo mock để tránh nhầm trạng thái thực tế vs giả lập\n      setItems([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    load();\n  }, []);\n  useEffect(() => {\n    if (debounceRef.current) clearTimeout(debounceRef.current);\n    debounceRef.current = setTimeout(() => setPage(1), 300);\n    return () => debounceRef.current && clearTimeout(debounceRef.current);\n  }, [q, statusFilter]);\n  const openCreate = () => {\n    setForm(emptyForm);\n    setCreateOpen(true);\n  };\n  const validateForm = data => {\n    if (!data.code.trim()) return 'Nhập mã ưu đãi';\n    if (!/^[-A-Z0-9_]+$/i.test(data.code.trim())) return 'Mã chỉ gồm chữ, số, -, _';\n    if (!data.discountType) return 'Chọn loại giảm';\n    const val = Number(data.discountValue);\n    if (!(val > 0)) return 'Giá trị giảm phải > 0';\n    if (data.discountType === 'PERCENT' && val > 100) return 'Phần trăm ≤ 100';\n    // Normalize to date-only for validation (strip any time component)\n    const sDate = data.startDate ? String(data.startDate).slice(0, 10) : '';\n    const eDate = data.endDate ? String(data.endDate).slice(0, 10) : '';\n    if (!sDate || !eDate) return 'Chọn thời gian hiệu lực';\n    if (new Date(eDate) <= new Date(sDate)) return 'Ngày kết thúc phải sau ngày bắt đầu';\n    if (data.minOrderAmount && !(Number(data.minOrderAmount) >= 0)) return 'Đơn tối thiểu không hợp lệ';\n    if (data.discountType === 'PERCENT' && data.maxDiscount && !(Number(data.maxDiscount) > 0)) return 'Giảm tối đa phải > 0';\n    return '';\n  };\n  const submitCreate = async () => {\n    const err = validateForm(form);\n    if (err) {\n      alert(err);\n      return;\n    }\n    setCreating(true);\n    try {\n      // Strip time component: send date-only (YYYY-MM-DD) to server/DB\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0, 10) : null;\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0, 10) : null;\n      const payload = {\n        ...form,\n        discountValue: Number(form.discountValue),\n        minOrderAmount: form.minOrderAmount ? Number(form.minOrderAmount) : null,\n        maxDiscount: form.maxDiscount ? Number(form.maxDiscount) : null,\n        startDate: startDateOnly,\n        endDate: endDateOnly\n      };\n      const res = await fetch('/api/admin/promotions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) throw new Error('Tạo ưu đãi thất bại');\n      setCreateOpen(false);\n      setForm(emptyForm);\n      load();\n    } catch (e) {\n      alert(e.message || 'Lỗi tạo');\n    } finally {\n      setCreating(false);\n    }\n  };\n  const openEdit = row => {\n    var _row$startDate, _row$endDate;\n    setEditing(row);\n    setForm({\n      ...emptyForm,\n      ...row,\n      startDate: ((_row$startDate = row.startDate) === null || _row$startDate === void 0 ? void 0 : _row$startDate.slice(0, 16)) || '',\n      endDate: ((_row$endDate = row.endDate) === null || _row$endDate === void 0 ? void 0 : _row$endDate.slice(0, 16)) || ''\n    });\n    setCreateOpen(true);\n  };\n\n  // Normalize edit values to date-only (YYYY-MM-DD)\n  const openEditNormalized = row => {\n    setEditing(row);\n    setForm({\n      ...emptyForm,\n      ...row,\n      startDate: row.startDate ? String(row.startDate).slice(0, 10) : '',\n      endDate: row.endDate ? String(row.endDate).slice(0, 10) : ''\n    });\n    setCreateOpen(true);\n  };\n  const submitEdit = async () => {\n    if (!editing) return;\n    const err = validateForm(form);\n    if (err) {\n      alert(err);\n      return;\n    }\n    setSaving(true);\n    try {\n      // Send date-only values (YYYY-MM-DD) to avoid time components being stored\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0, 10) : null;\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0, 10) : null;\n      const payload = {\n        description: form.description,\n        discountType: form.discountType,\n        discountValue: Number(form.discountValue),\n        startDate: startDateOnly,\n        endDate: endDateOnly,\n        minOrderAmount: form.minOrderAmount ? Number(form.minOrderAmount) : null,\n        maxDiscount: form.maxDiscount ? Number(form.maxDiscount) : null,\n        isActive: form.isActive\n      };\n      const res = await fetch(`/api/admin/promotions/${editing.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) throw new Error('Cập nhật thất bại');\n      setCreateOpen(false);\n      setEditing(null);\n      load();\n    } catch (e) {\n      alert(e.message || 'Lỗi cập nhật');\n    } finally {\n      setSaving(false);\n    }\n  };\n  const toggleActive = async row => {\n    // Optimistic\n    setItems(prev => prev.map(p => p.id === row.id ? {\n      ...p,\n      isActive: !p.isActive\n    } : p));\n    try {\n      const res = await fetch(`/api/admin/promotions/${row.id}/activate`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeaders()\n        },\n        body: JSON.stringify({\n          isActive: !row.isActive\n        })\n      });\n      if (!res.ok) throw new Error('Cập nhật trạng thái thất bại');\n    } catch (e) {\n      setItems(prev => prev.map(p => p.id === row.id ? {\n        ...p,\n        isActive: row.isActive\n      } : p));\n      alert(e.message || 'Lỗi');\n    }\n  };\n  const del = async row => {\n    if (!window.confirm('Xóa ưu đãi này?')) return;\n    try {\n      const res = await fetch(`/api/admin/promotions/${row.id}`, {\n        method: 'DELETE',\n        headers: authHeaders()\n      });\n      if (!res.ok) throw new Error('Xóa thất bại');\n      load();\n    } catch (e) {\n      alert(e.message || 'Lỗi xóa');\n    }\n  };\n  if (!isAdminOrStaff) return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 16\n    },\n    children: \"Ch\\u1EE9c n\\u0103ng d\\xE0nh cho qu\\u1EA3n tr\\u1ECB / nh\\xE2n vi\\xEAn.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 179,\n    columnNumber: 30\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"af-container amenities-anim-root\",\n    style: {\n      padding: 12\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"home-rooms-title\",\n      style: {\n        textAlign: 'left',\n        marginTop: 0\n      },\n      children: \"Qu\\u1EA3n l\\xFD \\u01B0u \\u0111\\xE3i / m\\xE3 khuy\\u1EBFn m\\xE3i\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reports-toolbar af-toolbar\",\n      style: {\n        marginBottom: 10,\n        flexWrap: 'wrap',\n        gap: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reports-field af-field-grow\",\n        style: {\n          minWidth: 240\n        },\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"reports-input\",\n          placeholder: \"T\\xECm theo m\\xE3 ho\\u1EB7c m\\xF4 t\\u1EA3...\",\n          value: q,\n          onChange: e => setQ(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reports-field\",\n        style: {\n          minWidth: 180\n        },\n        children: /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"reports-select\",\n          value: statusFilter,\n          onChange: e => setStatusFilter(e.target.value),\n          style: {\n            height: 38\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"all\",\n            children: \"T\\u1EA5t c\\u1EA3 tr\\u1EA1ng th\\xE1i\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"active\",\n            children: \"Active\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"scheduled\",\n            children: \"Scheduled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"expired\",\n            children: \"Expired\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"disabled\",\n            children: \"Disabled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reports-field\",\n        style: {\n          display: 'flex',\n          gap: 8\n        },\n        children: isAdmin && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          onClick: openCreate,\n          children: \"+ Th\\xEAm \\u01B0u \\u0111\\xE3i\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: '#666'\n      },\n      children: \"\\u0110ang t\\u1EA3i...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 18\n    }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: '#b42318'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 76\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        overflowX: 'auto'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"ph-table-el af-table\",\n        style: {\n          width: '100%',\n          minWidth: 1080\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"M\\xE3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"M\\xF4 t\\u1EA3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Lo\\u1EA1i\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Gi\\xE1 tr\\u1ECB\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Hi\\u1EC7u l\\u1EF1c\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0110i\\u1EC1u ki\\u1EC7n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Tr\\u1EA1ng th\\xE1i\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"H\\xE0nh \\u0111\\u1ED9ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: paged.length === 0 ? /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 8,\n              style: {\n                textAlign: 'center',\n                color: '#666'\n              },\n              children: \"Kh\\xF4ng c\\xF3 \\u01B0u \\u0111\\xE3i.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 39\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 35\n          }, this) : paged.map(p => {\n            const st = statusOf(p);\n            const amt = Number(previewAmount || 0);\n            const {\n              discount,\n              final\n            } = computeDiscount(p, amt && (!p.minOrderAmount || amt >= Number(p.minOrderAmount)) ? amt : 0);\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: \"amenity-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontWeight: 600\n                },\n                title: `ID: ${p.id}`,\n                children: p.code\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  maxWidth: 220\n                },\n                title: p.description,\n                children: p.description || '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                children: p.discountType === 'PERCENT' ? 'Phần trăm' : 'Cố định'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                children: p.discountType === 'PERCENT' ? `${p.discountValue}%${p.maxDiscount ? ` (tối đa ${Number(p.maxDiscount).toLocaleString('vi-VN')}đ)` : ''}` : `${Number(p.discountValue).toLocaleString('vi-VN')} đ`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontSize: 12\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: p.startDate ? new Date(p.startDate).toLocaleDateString('vi-VN') : '—'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 228,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    opacity: .8\n                  },\n                  children: p.endDate ? new Date(p.endDate).toLocaleDateString('vi-VN') : '—'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 229,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontSize: 12\n                },\n                children: [p.minOrderAmount ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"T\\u1ED1i thi\\u1EC3u: \", Number(p.minOrderAmount).toLocaleString('vi-VN'), \"\\u0111\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 232,\n                  columnNumber: 43\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: \"\\u2014\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 232,\n                  columnNumber: 119\n                }, this), p.discountType === 'PERCENT' && p.maxDiscount && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Gi\\u1EA3m t\\u1ED1i \\u0111a: \", Number(p.maxDiscount).toLocaleString('vi-VN'), \"\\u0111\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 71\n                }, this), previewAmount && discount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginTop: 4,\n                    color: '#047857'\n                  },\n                  children: [\"Gi\\u1EA3m: \", Math.round(discount).toLocaleString('vi-VN'), \"\\u0111\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 234,\n                    columnNumber: 154\n                  }, this), \"C\\xF2n: \", Math.round(final).toLocaleString('vi-VN'), \"\\u0111\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 55\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  fontWeight: 600\n                },\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `promo-badge promo-${st.toLowerCase()}`,\n                  children: st\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"ph-td\",\n                style: {\n                  whiteSpace: 'nowrap'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn ph-btn--success\",\n                  onClick: () => openEditNormalized(p),\n                  children: \"S\\u1EEDa\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn ph-btn--warning\",\n                  onClick: () => toggleActive(p),\n                  children: p.isActive ? 'Tắt' : 'Bật'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 23\n                }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"ph-btn ph-btn--danger\",\n                  onClick: () => del(p),\n                  children: \"X\\xF3a\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 35\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 21\n              }, this)]\n            }, p.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 10,\n        display: 'flex',\n        gap: 12,\n        alignItems: 'center',\n        flexWrap: 'wrap'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 6,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            fontSize: 13\n          },\n          children: \"Xem th\\u1EED \\u0111\\u01A1n h\\xE0ng (VND):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          style: {\n            width: 140\n          },\n          value: previewAmount,\n          onChange: e => setPreviewAmount(e.target.value),\n          placeholder: \"Nh\\u1EADp s\\u1ED1 ti\\u1EC1n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginLeft: 'auto',\n          display: 'flex',\n          gap: 6,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          disabled: page <= 1,\n          onClick: () => setPage(p => Math.max(1, p - 1)),\n          children: \"\\u25C0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: 13\n          },\n          children: [\"Trang \", page, \"/\", pageCount]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ph-btn\",\n          disabled: page >= pageCount,\n          onClick: () => setPage(p => Math.min(pageCount, p + 1)),\n          children: \"\\u25B6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }, this), createOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-overlay\",\n      onMouseDown: e => {\n        if (e.target === e.currentTarget) {\n          setCreateOpen(false);\n          setEditing(null);\n        }\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-modal\",\n        onMouseDown: e => e.stopPropagation(),\n        style: {\n          width: 720,\n          maxWidth: '96%',\n          background: '#fff',\n          borderRadius: 14,\n          padding: 18\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            marginTop: 0,\n            textAlign: 'center'\n          },\n          children: editing ? 'Chỉnh sửa ưu đãi' : 'Tạo ưu đãi mới'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'grid',\n            gridTemplateColumns: 'repeat(auto-fit, minmax(240px,1fr))',\n            gap: 16\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"M\\xE3 \\u01B0u \\u0111\\xE3i\", /*#__PURE__*/_jsxDEV(\"input\", {\n              value: form.code,\n              disabled: !!editing,\n              onChange: e => setForm(f => ({\n                ...f,\n                code: e.target.value.toUpperCase()\n              })),\n              placeholder: \"WELCOME10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"Lo\\u1EA1i gi\\u1EA3m\", /*#__PURE__*/_jsxDEV(\"select\", {\n              value: form.discountType,\n              onChange: e => setForm(f => ({\n                ...f,\n                discountType: e.target.value\n              })),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"PERCENT\",\n                children: \"Ph\\u1EA7n tr\\u0103m\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"FIXED\",\n                children: \"C\\u1ED1 \\u0111\\u1ECBnh\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 273,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"Gi\\xE1 tr\\u1ECB gi\\u1EA3m\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: form.discountValue,\n              onChange: e => setForm(f => ({\n                ...f,\n                discountValue: e.target.value\n              })),\n              placeholder: \"10 ho\\u1EB7c 100000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"Gi\\u1EA3m t\\u1ED1i \\u0111a (n\\u1EBFu %)\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: form.maxDiscount,\n              disabled: form.discountType !== 'PERCENT',\n              onChange: e => setForm(f => ({\n                ...f,\n                maxDiscount: e.target.value\n              })),\n              placeholder: \"200000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"\\u0110\\u01A1n t\\u1ED1i thi\\u1EC3u\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: form.minOrderAmount,\n              onChange: e => setForm(f => ({\n                ...f,\n                minOrderAmount: e.target.value\n              })),\n              placeholder: \"500000\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"Ng\\xE0y b\\u1EAFt \\u0111\\u1EA7u\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              value: form.startDate,\n              onChange: e => setForm(f => ({\n                ...f,\n                startDate: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"Ng\\xE0y k\\u1EBFt th\\xFAc\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              value: form.endDate,\n              onChange: e => setForm(f => ({\n                ...f,\n                endDate: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'row',\n              gap: 8,\n              alignItems: 'center',\n              marginTop: 6\n            },\n            children: [\"K\\xEDch ho\\u1EA1t\", /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: !!form.isActive,\n              onChange: e => setForm(f => ({\n                ...f,\n                isActive: e.target.checked\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              gridColumn: '1 / -1',\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4\n            },\n            children: [\"M\\xF4 t\\u1EA3\", /*#__PURE__*/_jsxDEV(\"textarea\", {\n              rows: 3,\n              value: form.description,\n              onChange: e => setForm(f => ({\n                ...f,\n                description: e.target.value\n              })),\n              placeholder: \"M\\xF4 t\\u1EA3 ng\\u1EAFn...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 12,\n            background: '#f8fafc',\n            padding: '10px 12px',\n            borderRadius: 10,\n            fontSize: 13\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Xem nhanh:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 15\n          }, this), ' ', (() => {\n            const testAmt = Number(previewAmount || 0);\n            if (!(testAmt > 0)) return /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Nh\\u1EADp s\\u1ED1 ti\\u1EC1n \\u0111\\u01A1n h\\xE0ng \\u1EDF d\\u01B0\\u1EDBi danh s\\xE1ch \\u0111\\u1EC3 xem m\\u1EE9c gi\\u1EA3m.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 41\n            }, this);\n            const mockPromo = {\n              ...form,\n              discountValue: Number(form.discountValue || 0),\n              maxDiscount: form.maxDiscount ? Number(form.maxDiscount) : null\n            };\n            const {\n              discount,\n              final\n            } = computeDiscount(mockPromo, testAmt);\n            if (!discount) return /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Kh\\xF4ng \\xE1p d\\u1EE5ng (ch\\u01B0a \\u0111\\u1EE7 \\u0111i\\u1EC1u ki\\u1EC7n ho\\u1EB7c d\\u1EEF li\\u1EC7u thi\\u1EBFu).\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 38\n            }, this);\n            return /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Gi\\u1EA3m \", Math.round(discount).toLocaleString('vi-VN'), \"\\u0111 c\\xF2n \", Math.round(final).toLocaleString('vi-VN'), \"\\u0111.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 24\n            }, this);\n          })()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 18,\n            display: 'flex',\n            gap: 12,\n            justifyContent: 'center'\n          },\n          children: editing ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn\",\n              onClick: submitEdit,\n              disabled: saving,\n              children: saving ? 'Đang lưu...' : 'Lưu thay đổi'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn ph-btn--secondary\",\n              onClick: () => {\n                setCreateOpen(false);\n                setEditing(null);\n              },\n              children: \"H\\u1EE7y\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn\",\n              onClick: submitCreate,\n              disabled: creating,\n              children: creating ? 'Đang tạo...' : 'Tạo mới'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ph-btn ph-btn--secondary\",\n              onClick: () => {\n                setCreateOpen(false);\n                setEditing(null);\n              },\n              children: \"H\\u1EE7y\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        .promo-badge { display:inline-block; padding:4px 8px; font-size:11px; line-height:1; border-radius:20px; letter-spacing:.3px; }\n        .promo-active { background:#e6f7ec; color:#087443; border:1px solid #b2e7c9; }\n        .promo-scheduled { background:#f0f4ff; color:#1d4ed8; border:1px solid #c7d8ff; }\n        .promo-expired { background:#ffe8e6; color:#b42318; border:1px solid #f5b5ae; }\n        .promo-disabled { background:#f1f5f9; color:#475569; border:1px solid #d3dce4; }\n\n        .af-table th, .af-table td { padding:6px 8px; vertical-align:middle; }\n        .af-table input, .af-table select, .af-table textarea { font-size:14px; border:1px solid #d7dbe0; border-radius:6px; background:#fff; }\n        .af-table input, .af-table select { height:32px; line-height:32px; padding:4px 8px; }\n        .af-table textarea { padding:6px 8px; }\n\n        .ph-btn { cursor:pointer; }\n        .profile-overlay { backdrop-filter: blur(2px); }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 182,\n    columnNumber: 5\n  }, this);\n}\n_s(AdminPromotions, \"xeSmrSSCeKfr83Oe06oAhfZcDPI=\");\n_c = AdminPromotions;\nvar _c;\n$RefreshReg$(_c, \"AdminPromotions\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","authHeaders","getUserRole","jsxDEV","_jsxDEV","Fragment","_Fragment","AdminPromotions","_s","role","isAdminOrStaff","includes","isAdmin","items","setItems","loading","setLoading","error","setError","q","setQ","statusFilter","setStatusFilter","createOpen","setCreateOpen","editing","setEditing","saving","setSaving","creating","setCreating","previewAmount","setPreviewAmount","page","setPage","pageSize","debounceRef","now","Date","emptyForm","code","description","discountType","discountValue","startDate","endDate","minOrderAmount","maxDiscount","isActive","form","setForm","statusOf","p","s","e","filtered","text","trim","toLowerCase","filter","st","paged","start","slice","pageCount","Math","max","ceil","length","computeDiscount","promo","orderAmount","amt","Number","discount","final","raw","min","load","res","fetch","headers","cache","ok","Error","j","json","list","Array","isArray","promotions","map","r","console","warn","message","current","clearTimeout","setTimeout","openCreate","validateForm","data","test","val","sDate","String","eDate","submitCreate","err","alert","startDateOnly","endDateOnly","payload","method","body","JSON","stringify","openEdit","row","_row$startDate","_row$endDate","openEditNormalized","submitEdit","id","toggleActive","prev","del","window","confirm","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","className","textAlign","marginTop","marginBottom","flexWrap","gap","minWidth","placeholder","value","onChange","target","height","display","onClick","color","overflowX","width","colSpan","fontWeight","title","maxWidth","toLocaleString","fontSize","toLocaleDateString","opacity","round","whiteSpace","alignItems","type","marginLeft","disabled","onMouseDown","currentTarget","stopPropagation","background","borderRadius","gridTemplateColumns","flexDirection","f","toUpperCase","checked","gridColumn","rows","testAmt","mockPromo","justifyContent","_c","$RefreshReg$"],"sources":["D:/DA_TichHop/HMS_AI Hotel/client/src/AdminPromotions.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport './HomePage.css';\r\nimport { authHeaders, getUserRole } from './auth';\r\n\r\n/* Quản lý Ưu đãi / Mã khuyến mãi\r\n   - Danh sách + tìm kiếm + lọc trạng thái\r\n   - Tạo mới / Chỉnh sửa / Bật tắt (isActive)\r\n   - Preview tính giảm theo số tiền đơn hàng nhập thử\r\n   Trạng thái hiển thị:\r\n     Active    => isActive=1 && now within [startDate,endDate]\r\n     Scheduled => isActive=1 && now < startDate\r\n     Expired   => now > endDate\r\n     Disabled  => isActive=0\r\n*/\r\nexport default function AdminPromotions(){\r\n  const role = getUserRole();\r\n  const isAdminOrStaff = ['Admin','Staff'].includes(role);\r\n  const isAdmin = role === 'Admin';\r\n\r\n  const [items, setItems] = useState([]); // promotions\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [q, setQ] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState('all');\r\n  const [createOpen, setCreateOpen] = useState(false);\r\n  const [editing, setEditing] = useState(null); // row object being edited inline modal\r\n  const [saving, setSaving] = useState(false);\r\n  const [creating, setCreating] = useState(false);\r\n  const [previewAmount, setPreviewAmount] = useState('');\r\n  const [page, setPage] = useState(1);\r\n  const pageSize = 20;\r\n  const debounceRef = useRef(null);\r\n  const now = useMemo(()=> new Date(), []);\r\n\r\n  const emptyForm = {\r\n    code: '',\r\n    description: '',\r\n    discountType: 'PERCENT',\r\n    discountValue: '',\r\n    startDate: '',\r\n    endDate: '',\r\n    minOrderAmount: '',\r\n    maxDiscount: '',\r\n    isActive: true\r\n  };\r\n  const [form, setForm] = useState(emptyForm);\r\n\r\n  const statusOf = (p) => {\r\n    if(!p) return 'Unknown';\r\n    const s = new Date(p.startDate);\r\n    const e = new Date(p.endDate);\r\n    if(!p.isActive) return 'Disabled';\r\n    if(now < s) return 'Scheduled';\r\n    if(now > e) return 'Expired';\r\n    return 'Active';\r\n  };\r\n\r\n  const filtered = useMemo(()=>{\r\n    const text = q.trim().toLowerCase();\r\n    return items.filter(p => {\r\n      const st = statusOf(p);\r\n      if(statusFilter !== 'all' && st.toLowerCase() !== statusFilter) return false;\r\n      if(text && !(`${p.code}`.toLowerCase().includes(text) || (p.description||'').toLowerCase().includes(text))) return false;\r\n      return true;\r\n    });\r\n  }, [items, q, statusFilter]);\r\n\r\n  const paged = useMemo(()=>{\r\n    const start = (page-1)*pageSize;\r\n    return filtered.slice(start, start+pageSize);\r\n  }, [filtered, page]);\r\n\r\n  const pageCount = useMemo(()=> Math.max(1, Math.ceil(filtered.length / pageSize)), [filtered.length]);\r\n\r\n  const computeDiscount = (promo, orderAmount) => {\r\n    const amt = Number(orderAmount||0); if(!promo || !(amt>0)) return { discount:0, final: amt };\r\n    if(promo.discountType === 'PERCENT') {\r\n      let raw = amt * (Number(promo.discountValue||0)/100);\r\n      if(promo.maxDiscount) raw = Math.min(raw, Number(promo.maxDiscount));\r\n      return { discount: raw, final: Math.max(0, amt - raw) };\r\n    }\r\n    const raw = Number(promo.discountValue||0);\r\n    return { discount: Math.min(raw, amt), final: Math.max(0, amt - raw) };\r\n  };\r\n\r\n  const load = async() => {\r\n    if(!isAdminOrStaff) return;\r\n    setLoading(true); setError('');\r\n    try {\r\n      // Tạm thời gọi thử endpoint nếu có, nếu 404 → giả lập mock\r\n      const res = await fetch('/api/admin/promotions', { headers: authHeaders(), cache:'no-store' });\r\n      if(!res.ok) throw new Error('Không tải được danh sách ưu đãi');\r\n      const j = await res.json();\r\n      const list = Array.isArray(j.items)? j.items: Array.isArray(j.promotions)? j.promotions: [];\r\n      setItems(list.map(r=> ({ ...r })));\r\n    } catch(e){\r\n      console.warn('[AdminPromotions] load error:', e.message);\r\n      setError(e.message || 'Lỗi tải dữ liệu');\r\n      // Không còn tự động tạo mock để tránh nhầm trạng thái thực tế vs giả lập\r\n      setItems([]);\r\n    } finally { setLoading(false); }\r\n  };\r\n  useEffect(()=>{ load(); }, []);\r\n\r\n  useEffect(()=>{ if(debounceRef.current) clearTimeout(debounceRef.current); debounceRef.current = setTimeout(()=> setPage(1), 300); return ()=> debounceRef.current && clearTimeout(debounceRef.current); }, [q, statusFilter]);\r\n\r\n  const openCreate = () => { setForm(emptyForm); setCreateOpen(true); };\r\n\r\n  const validateForm = (data) => {\r\n    if(!data.code.trim()) return 'Nhập mã ưu đãi';\r\n    if(!/^[-A-Z0-9_]+$/i.test(data.code.trim())) return 'Mã chỉ gồm chữ, số, -, _';\r\n    if(!data.discountType) return 'Chọn loại giảm';\r\n    const val = Number(data.discountValue); if(!(val>0)) return 'Giá trị giảm phải > 0';\r\n    if(data.discountType==='PERCENT' && val>100) return 'Phần trăm ≤ 100';\r\n    // Normalize to date-only for validation (strip any time component)\r\n    const sDate = data.startDate ? String(data.startDate).slice(0,10) : '';\r\n    const eDate = data.endDate ? String(data.endDate).slice(0,10) : '';\r\n    if(!sDate || !eDate) return 'Chọn thời gian hiệu lực';\r\n    if(new Date(eDate) <= new Date(sDate)) return 'Ngày kết thúc phải sau ngày bắt đầu';\r\n    if(data.minOrderAmount && !(Number(data.minOrderAmount)>=0)) return 'Đơn tối thiểu không hợp lệ';\r\n    if(data.discountType==='PERCENT' && data.maxDiscount && !(Number(data.maxDiscount)>0)) return 'Giảm tối đa phải > 0';\r\n    return '';\r\n  };\r\n\r\n  const submitCreate = async () => {\r\n    const err = validateForm(form); if(err){ alert(err); return; }\r\n    setCreating(true);\r\n    try {\r\n      // Strip time component: send date-only (YYYY-MM-DD) to server/DB\r\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0,10) : null;\r\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0,10) : null;\r\n      const payload = { ...form, discountValue: Number(form.discountValue), minOrderAmount: form.minOrderAmount? Number(form.minOrderAmount): null, maxDiscount: form.maxDiscount? Number(form.maxDiscount): null, startDate: startDateOnly, endDate: endDateOnly };\r\n      const res = await fetch('/api/admin/promotions', { method:'POST', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if(!res.ok) throw new Error('Tạo ưu đãi thất bại');\r\n      setCreateOpen(false); setForm(emptyForm); load();\r\n    } catch(e){ alert(e.message || 'Lỗi tạo'); } finally { setCreating(false); }\r\n  };\r\n\r\n  const openEdit = (row) => { setEditing(row); setForm({ ...emptyForm, ...row, startDate: row.startDate?.slice(0,16) || '', endDate: row.endDate?.slice(0,16) || '' }); setCreateOpen(true); };\r\n  \r\n  // Normalize edit values to date-only (YYYY-MM-DD)\r\n  const openEditNormalized = (row) => { setEditing(row); setForm({ ...emptyForm, ...row, startDate: row.startDate ? String(row.startDate).slice(0,10) : '', endDate: row.endDate ? String(row.endDate).slice(0,10) : '' }); setCreateOpen(true); };\r\n\r\n  const submitEdit = async () => {\r\n    if(!editing) return; const err = validateForm(form); if(err){ alert(err); return; }\r\n    setSaving(true);\r\n    try {\r\n      // Send date-only values (YYYY-MM-DD) to avoid time components being stored\r\n      const startDateOnly = form.startDate ? String(form.startDate).slice(0,10) : null;\r\n      const endDateOnly = form.endDate ? String(form.endDate).slice(0,10) : null;\r\n      const payload = { description: form.description, discountType: form.discountType, discountValue: Number(form.discountValue), startDate: startDateOnly, endDate: endDateOnly, minOrderAmount: form.minOrderAmount? Number(form.minOrderAmount): null, maxDiscount: form.maxDiscount? Number(form.maxDiscount): null, isActive: form.isActive };\r\n      const res = await fetch(`/api/admin/promotions/${editing.id}`, { method:'PUT', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify(payload) });\r\n      if(!res.ok) throw new Error('Cập nhật thất bại');\r\n      setCreateOpen(false); setEditing(null); load();\r\n    } catch(e){ alert(e.message || 'Lỗi cập nhật'); } finally { setSaving(false); }\r\n  };\r\n\r\n  const toggleActive = async (row) => {\r\n    // Optimistic\r\n    setItems(prev => prev.map(p => p.id===row.id? { ...p, isActive: !p.isActive }: p));\r\n    try {\r\n      const res = await fetch(`/api/admin/promotions/${row.id}/activate`, { method:'PATCH', headers:{ 'Content-Type':'application/json', ...authHeaders() }, body: JSON.stringify({ isActive: !row.isActive }) });\r\n      if(!res.ok) throw new Error('Cập nhật trạng thái thất bại');\r\n    } catch(e){\r\n      setItems(prev => prev.map(p => p.id===row.id? { ...p, isActive: row.isActive }: p));\r\n      alert(e.message || 'Lỗi');\r\n    }\r\n  };\r\n\r\n  const del = async (row) => {\r\n    if(!window.confirm('Xóa ưu đãi này?')) return;\r\n    try {\r\n      const res = await fetch(`/api/admin/promotions/${row.id}`, { method:'DELETE', headers: authHeaders() });\r\n      if(!res.ok) throw new Error('Xóa thất bại');\r\n      load();\r\n    } catch(e){ alert(e.message || 'Lỗi xóa'); }\r\n  };\r\n\r\n  if(!isAdminOrStaff) return <div style={{ padding:16 }}>Chức năng dành cho quản trị / nhân viên.</div>;\r\n\r\n  return (\r\n    <div className=\"af-container amenities-anim-root\" style={{ padding:12 }}>\r\n      <h2 className=\"home-rooms-title\" style={{ textAlign:'left', marginTop:0 }}>Quản lý ưu đãi / mã khuyến mãi</h2>\r\n      <div className=\"reports-toolbar af-toolbar\" style={{ marginBottom:10, flexWrap:'wrap', gap:8 }}>\r\n        <div className=\"reports-field af-field-grow\" style={{ minWidth:240 }}>\r\n          <input className=\"reports-input\" placeholder=\"Tìm theo mã hoặc mô tả...\" value={q} onChange={e=>setQ(e.target.value)} />\r\n        </div>\r\n        <div className=\"reports-field\" style={{ minWidth:180 }}>\r\n          <select className=\"reports-select\" value={statusFilter} onChange={e=>setStatusFilter(e.target.value)} style={{ height:38 }}>\r\n            <option value=\"all\">Tất cả trạng thái</option>\r\n            <option value=\"active\">Active</option>\r\n            <option value=\"scheduled\">Scheduled</option>\r\n            <option value=\"expired\">Expired</option>\r\n            <option value=\"disabled\">Disabled</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"reports-field\" style={{ display:'flex', gap:8 }}>\r\n          {isAdmin && <button className=\"ph-btn\" onClick={openCreate}>+ Thêm ưu đãi</button>}\r\n        </div>\r\n      </div>\r\n      {loading ? <div style={{ color:'#666' }}>Đang tải...</div> : error ? <div style={{ color:'#b42318' }}>{error}</div> : (\r\n        <div style={{ overflowX:'auto' }}>\r\n          <table className=\"ph-table-el af-table\" style={{ width:'100%', minWidth:1080 }}>\r\n            <thead>\r\n              <tr>\r\n                <th>Mã</th>\r\n                <th>Mô tả</th>\r\n                <th>Loại</th>\r\n                <th>Giá trị</th>\r\n                <th>Hiệu lực</th>\r\n                <th>Điều kiện</th>\r\n                <th>Trạng thái</th>\r\n                <th>Hành động</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {paged.length===0 ? <tr><td colSpan={8} style={{ textAlign:'center', color:'#666' }}>Không có ưu đãi.</td></tr> : paged.map(p => {\r\n                const st = statusOf(p);\r\n                const amt = Number(previewAmount||0);\r\n                const { discount, final } = computeDiscount(p, (amt && (!p.minOrderAmount || amt >= Number(p.minOrderAmount)))? amt: 0);\r\n                return (\r\n                  <tr key={p.id} className=\"amenity-row\">\r\n                    <td className=\"ph-td\" style={{ fontWeight:600 }} title={`ID: ${p.id}`}>{p.code}</td>\r\n                    <td className=\"ph-td\" style={{ maxWidth:220 }} title={p.description}>{p.description || '—'}</td>\r\n                    <td className=\"ph-td\">{p.discountType === 'PERCENT'? 'Phần trăm':'Cố định'}</td>\r\n                    <td className=\"ph-td\">{p.discountType === 'PERCENT'? `${p.discountValue}%${p.maxDiscount? ` (tối đa ${Number(p.maxDiscount).toLocaleString('vi-VN')}đ)` : ''}` : `${Number(p.discountValue).toLocaleString('vi-VN')} đ`}</td>\r\n                    <td className=\"ph-td\" style={{ fontSize:12 }}>\r\n                      <div>{p.startDate ? new Date(p.startDate).toLocaleDateString('vi-VN') : '—'}</div>\r\n                      <div style={{ opacity:.8 }}>{p.endDate ? new Date(p.endDate).toLocaleDateString('vi-VN') : '—'}</div>\r\n                    </td>\r\n                    <td className=\"ph-td\" style={{ fontSize:12 }}>\r\n                      {p.minOrderAmount ? <div>Tối thiểu: {Number(p.minOrderAmount).toLocaleString('vi-VN')}đ</div> : <div>—</div>}\r\n                      {p.discountType==='PERCENT' && p.maxDiscount && <div>Giảm tối đa: {Number(p.maxDiscount).toLocaleString('vi-VN')}đ</div>}\r\n                      {previewAmount && discount>0 && <div style={{ marginTop:4, color:'#047857' }}>Giảm: {Math.round(discount).toLocaleString('vi-VN')}đ<br/>Còn: {Math.round(final).toLocaleString('vi-VN')}đ</div>}\r\n                    </td>\r\n                    <td className=\"ph-td\" style={{ fontWeight:600 }}>\r\n                      <span className={`promo-badge promo-${st.toLowerCase()}`}>{st}</span>\r\n                    </td>\r\n                    <td className=\"ph-td\" style={{ whiteSpace:'nowrap' }}>\r\n                      <button className=\"ph-btn ph-btn--success\" onClick={()=> openEditNormalized(p)}>Sửa</button>\r\n                      <button className=\"ph-btn ph-btn--warning\" onClick={()=> toggleActive(p)}>{p.isActive? 'Tắt':'Bật'}</button>\r\n                      {isAdmin && <button className=\"ph-btn ph-btn--danger\" onClick={()=> del(p)}>Xóa</button>}\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n\r\n      <div style={{ marginTop:10, display:'flex', gap:12, alignItems:'center', flexWrap:'wrap' }}>\r\n        <div style={{ display:'flex', gap:6, alignItems:'center' }}>\r\n          <label style={{ fontSize:13 }}>Xem thử đơn hàng (VND):</label>\r\n          <input type=\"number\" style={{ width:140 }} value={previewAmount} onChange={e=> setPreviewAmount(e.target.value)} placeholder=\"Nhập số tiền\" />\r\n        </div>\r\n        <div style={{ marginLeft:'auto', display:'flex', gap:6, alignItems:'center' }}>\r\n          <button className=\"ph-btn\" disabled={page<=1} onClick={()=> setPage(p=> Math.max(1,p-1))}>◀</button>\r\n          <span style={{ fontSize:13 }}>Trang {page}/{pageCount}</span>\r\n          <button className=\"ph-btn\" disabled={page>=pageCount} onClick={()=> setPage(p=> Math.min(pageCount,p+1))}>▶</button>\r\n        </div>\r\n      </div>\r\n\r\n      {createOpen && (\r\n        <div className=\"profile-overlay\" onMouseDown={e=>{ if(e.target===e.currentTarget){ setCreateOpen(false); setEditing(null);} }}>\r\n          <div className=\"profile-modal\" onMouseDown={e=> e.stopPropagation()} style={{ width:720, maxWidth:'96%', background:'#fff', borderRadius:14, padding:18 }}>\r\n            <h3 style={{ marginTop:0, textAlign:'center' }}>{editing? 'Chỉnh sửa ưu đãi' : 'Tạo ưu đãi mới'}</h3>\r\n            <div style={{ display:'grid', gridTemplateColumns:'repeat(auto-fit, minmax(240px,1fr))', gap:16 }}>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Mã ưu đãi\r\n                <input value={form.code} disabled={!!editing} onChange={e=> setForm(f=> ({ ...f, code:e.target.value.toUpperCase() }))} placeholder=\"WELCOME10\" />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Loại giảm\r\n                <select value={form.discountType} onChange={e=> setForm(f=> ({ ...f, discountType:e.target.value }))}>\r\n                  <option value=\"PERCENT\">Phần trăm</option>\r\n                  <option value=\"FIXED\">Cố định</option>\r\n                </select>\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Giá trị giảm\r\n                <input type=\"number\" value={form.discountValue} onChange={e=> setForm(f=> ({ ...f, discountValue:e.target.value }))} placeholder=\"10 hoặc 100000\" />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Giảm tối đa (nếu %)\r\n                <input type=\"number\" value={form.maxDiscount} disabled={form.discountType!=='PERCENT'} onChange={e=> setForm(f=> ({ ...f, maxDiscount:e.target.value }))} placeholder=\"200000\" />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Đơn tối thiểu\r\n                <input type=\"number\" value={form.minOrderAmount} onChange={e=> setForm(f=> ({ ...f, minOrderAmount:e.target.value }))} placeholder=\"500000\" />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Ngày bắt đầu\r\n                <input type=\"date\" value={form.startDate} onChange={e=> setForm(f=> ({ ...f, startDate:e.target.value }))} />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'column', gap:4 }}>Ngày kết thúc\r\n                <input type=\"date\" value={form.endDate} onChange={e=> setForm(f=> ({ ...f, endDate:e.target.value }))} />\r\n              </label>\r\n              <label style={{ display:'flex', flexDirection:'row', gap:8, alignItems:'center', marginTop:6 }}>Kích hoạt\r\n                <input type=\"checkbox\" checked={!!form.isActive} onChange={e=> setForm(f=> ({ ...f, isActive:e.target.checked }))} />\r\n              </label>\r\n              <label style={{ gridColumn:'1 / -1', display:'flex', flexDirection:'column', gap:4 }}>Mô tả\r\n                <textarea rows={3} value={form.description} onChange={e=> setForm(f=> ({ ...f, description:e.target.value }))} placeholder=\"Mô tả ngắn...\" />\r\n              </label>\r\n            </div>\r\n            {/* Live preview */}\r\n            <div style={{ marginTop:12, background:'#f8fafc', padding:'10px 12px', borderRadius:10, fontSize:13 }}>\r\n              <strong>Xem nhanh:</strong>{' '}\r\n              {(() => {\r\n                const testAmt = Number(previewAmount||0);\r\n                if(!(testAmt>0)) return <span>Nhập số tiền đơn hàng ở dưới danh sách để xem mức giảm.</span>;\r\n                const mockPromo = { ...form, discountValue: Number(form.discountValue||0), maxDiscount: form.maxDiscount? Number(form.maxDiscount): null };\r\n                const { discount, final } = computeDiscount(mockPromo, testAmt);\r\n                if(!discount) return <span>Không áp dụng (chưa đủ điều kiện hoặc dữ liệu thiếu).</span>;\r\n                return <span>Giảm {Math.round(discount).toLocaleString('vi-VN')}đ còn {Math.round(final).toLocaleString('vi-VN')}đ.</span>;\r\n              })()}\r\n            </div>\r\n            <div style={{ marginTop:18, display:'flex', gap:12, justifyContent:'center' }}>\r\n              {editing ? (\r\n                <>\r\n                  <button className=\"ph-btn\" onClick={submitEdit} disabled={saving}>{saving? 'Đang lưu...':'Lưu thay đổi'}</button>\r\n                  <button className=\"ph-btn ph-btn--secondary\" onClick={()=> { setCreateOpen(false); setEditing(null); }}>Hủy</button>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <button className=\"ph-btn\" onClick={submitCreate} disabled={creating}>{creating? 'Đang tạo...':'Tạo mới'}</button>\r\n                  <button className=\"ph-btn ph-btn--secondary\" onClick={()=> { setCreateOpen(false); setEditing(null); }}>Hủy</button>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <style>{`\r\n        .promo-badge { display:inline-block; padding:4px 8px; font-size:11px; line-height:1; border-radius:20px; letter-spacing:.3px; }\r\n        .promo-active { background:#e6f7ec; color:#087443; border:1px solid #b2e7c9; }\r\n        .promo-scheduled { background:#f0f4ff; color:#1d4ed8; border:1px solid #c7d8ff; }\r\n        .promo-expired { background:#ffe8e6; color:#b42318; border:1px solid #f5b5ae; }\r\n        .promo-disabled { background:#f1f5f9; color:#475569; border:1px solid #d3dce4; }\r\n\r\n        .af-table th, .af-table td { padding:6px 8px; vertical-align:middle; }\r\n        .af-table input, .af-table select, .af-table textarea { font-size:14px; border:1px solid #d7dbe0; border-radius:6px; background:#fff; }\r\n        .af-table input, .af-table select { height:32px; line-height:32px; padding:4px 8px; }\r\n        .af-table textarea { padding:6px 8px; }\r\n\r\n        .ph-btn { cursor:pointer; }\r\n        .profile-overlay { backdrop-filter: blur(2px); }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}