/* ============================================================================
   Notifications Enhanced Styling
   ========================================================================== */

/* Theming tokens */
:root {
  --notif-accent: #2563eb;
  --notif-accent-soft: #3b82f6;
  --notif-accent-glow: 174 197 255; /* r g b */
  --notif-danger: #dc2626;
  --notif-bg: #ffffff;
  --notif-bg-soft: #f8fafc;
  --notif-border: #e2e8f0;
  --notif-radius-panel: 20px;
  --notif-radius-item: 16px;
  --notif-transition: .32s cubic-bezier(.4,.75,.3,1);
}

.notifications-overlay {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at 25% 18%, rgba(37,99,235,.15), transparent 60%), rgba(0,0,0,.48);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  z-index: 5000; /* cao hơn dropdown (4000) và profile overlay (2000) */
  padding: 24px 12px;
  animation: notifOverlayFade .25s ease;
  backdrop-filter: blur(2px) saturate(140%);
}

.notifications-overlay__panel {
  background: linear-gradient(150deg,var(--notif-bg) 0%,var(--notif-bg-soft) 100%);
  border-radius: var(--notif-radius-panel);
  padding: 26px 24px 24px;
  width: min(96vw, 860px);
  max-height: 86vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 4px 8px -2px rgba(15,23,42,.15), 0 12px 42px -6px rgba(15,23,42,.38), 0 0 0 1px rgba(255,255,255,.5) inset;
  border: 1px solid var(--notif-border);
  position: relative;
  animation: notifOverlayPanelIn .42s cubic-bezier(.32,.72,.28,.99);
  backdrop-filter: blur(6px) saturate(160%);
  overflow: hidden;
}
.notifications-overlay__panel::before { content:""; position:absolute; inset:0; pointer-events:none; background:linear-gradient(90deg,rgba(37,99,235,.15),transparent 25%,transparent 75%,rgba(59,130,246,.18)); mix-blend-mode:overlay; opacity:.55; animation: panelSheen 7s linear infinite; }
.notifications-overlay__panel::after { content:""; position:absolute; top:0; left:0; right:0; height:4px; background: linear-gradient(90deg,var(--notif-accent) 0%, var(--notif-accent-soft) 55%, var(--notif-accent) 100%); box-shadow:0 0 0 1px rgba(255,255,255,.4),0 2px 6px -2px rgba(37,99,235,.6); }

.notifications-overlay__closeBtn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: #f3f4f6;
  border: none;
  color: #111827;
  font-weight: 600;
  padding: 6px 10px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 13px;
  transition: background .25s ease, box-shadow .25s ease;
}
.notifications-overlay__closeBtn:hover { background:#e5e7eb; box-shadow:0 2px 6px -1px rgba(0,0,0,.15); }

.notifications-history-list { flex:1; overflow:auto; border:1px solid var(--notif-border); border-radius:18px; background:#fff; box-shadow: inset 0 0 0 1px rgba(255,255,255,.55), 0 1px 3px rgba(15,23,42,.08); backdrop-filter:blur(2px); }

.notifications-history-item { padding:16px 18px 16px 20px; border-bottom:1px solid #eef2f6; background:linear-gradient(95deg,#ffffff 0%,#fdfdfd 60%,#fafafa 100%); position:relative; overflow:hidden; font-size:14px; line-height:1.45; border-left:4px solid transparent; transition: background .35s ease, box-shadow var(--notif-transition), transform var(--notif-transition); }
.notifications-history-item:last-child { border-bottom:none; }
.notifications-history-item::before { content:""; position:absolute; left:0; top:0; bottom:0; width:5px; background:linear-gradient(180deg,var(--notif-accent-soft),var(--notif-accent)); opacity:0; transition:opacity .4s ease; filter:drop-shadow(0 0 4px rgba(var(--notif-accent-glow)/.55)); }
.notifications-history-item.unread::before { opacity:1; }
.notifications-history-item.unread { background:linear-gradient(92deg,#eef6ff 0%,#ffffff 90%); box-shadow:0 4px 14px -4px rgba(var(--notif-accent-glow)/.55), 0 0 0 1px rgba(37,99,235,.22) inset; position:relative; }
.notifications-history-item.unread::after { content:""; position:absolute; inset:0; pointer-events:none; background:radial-gradient(circle at 12% 18%, rgba(37,99,235,.12), transparent 55%); opacity:.85; mix-blend-mode:color-dodge; animation: notifPulse 4s ease-in-out infinite; }
.notifications-history-item:hover { background:linear-gradient(92deg,#f2f8ff 0%,#ffffff 85%); }
.notifications-history-item:hover:not(.dragging) { box-shadow:0 2px 7px -1px rgba(0,0,0,.08),0 3px 10px -2px rgba(15,23,42,.10); transform:translateY(-2px); }
.notifications-history-item[data-deleting="1"] { opacity:.4; pointer-events:none; }

/* Container for content + delete affordance */
.notifications-history-item .notif-row-inner { position:relative; z-index:2; transition: transform .35s cubic-bezier(.4,.75,.3,1); display:block; }
.notifications-history-item .notif-delete-reveal { position:absolute; inset:0; background:rgba(255,0,0,0.06); display:flex; align-items:center; justify-content:flex-end; padding-right:14px; opacity:0; z-index:1; transition: opacity .35s ease; pointer-events:none; }
.notifications-history-item .notif-delete-btn { background:var(--notif-danger); color:#fff; border:none; padding:10px 16px; font-size:12px; letter-spacing:.4px; font-weight:600; border-radius:10px; cursor:pointer; display:flex; align-items:center; gap:6px; box-shadow:0 4px 12px -3px rgba(220,38,38,.55); opacity:0; transform:translateX(16px); transition: all var(--notif-transition); }
.notifications-history-item .notif-delete-btn:hover { background:#b91c1c; }

/* After 3s of continuous hover show reveal layer & slide content */
.notifications-history-item.hover-armed .notif-delete-reveal { opacity:1; pointer-events:auto; }
.notifications-history-item.hover-armed .notif-delete-btn { opacity:1; transform:translateX(0); }
.notifications-history-item.hover-armed .notif-row-inner { transform:translateX(-120px); }

/* Drag interaction (adding class via JS) */
.notifications-history-item.dragging .notif-row-inner { transition:none; cursor:grabbing; }
.notifications-history-item.dragging .notif-delete-reveal { opacity:1; pointer-events:auto; }

/* When threshold passed (ready to delete) */
.notifications-history-item.delete-ready .notif-row-inner { transform:translateX(-140px); }
.notifications-history-item.delete-ready { background:linear-gradient(90deg,#fff5f5 0%,#ffffff 90%); box-shadow:0 0 0 1px rgba(220,38,38,.35) inset, 0 4px 12px -4px rgba(220,38,38,.35); }
.notifications-history-item.delete-ready .notif-delete-btn { background:#b91c1c; opacity:1; }
.notifications-history-item.delete-ready .notif-delete-reveal { pointer-events:auto; }

.notifications-history-actions { display:flex; gap:10px; margin-bottom:14px; flex-wrap:wrap; }
.notifications-history-actions .ph-btn, .notifications-history-actions .ph-btn--secondary { font-size:12px; letter-spacing:.3px; }

/* Inline booking link inside notification entries */
.notif-link-booking { color:#0d6efd; cursor:pointer; text-decoration:none; font-weight:600; font-size:12.5px; position:relative; padding-bottom:1px; }
.notif-link-booking::after { content:""; position:absolute; left:0; bottom:0; height:2px; width:100%; background:linear-gradient(90deg,var(--notif-accent),var(--notif-accent-soft)); transform:scaleX(0); transform-origin:left; transition:transform .35s ease; }
.notif-link-booking:hover::after { transform:scaleX(1); }
.notif-link-booking:hover { color:#0a58ca; }

/* Scrollbar refinement */
.notifications-history-list::-webkit-scrollbar { width:10px; }
.notifications-history-list::-webkit-scrollbar-track { background:transparent; }
.notifications-history-list::-webkit-scrollbar-thumb { background:#cbd5e1; border-radius:20px; border:2px solid #f1f5f9; }
.notifications-history-list:hover::-webkit-scrollbar-thumb { background:#94a3b8; }

/* Snackbar stack (global override if needed) */
.notifications-snackbar { font-family:inherit; border:1px solid #334155; background:linear-gradient(135deg,#1e293b,#1e2f47); box-shadow:0 4px 16px -4px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.08) inset; }

/* ================= Enhanced Snackbar / Toast ================= */
/* Base container (override / extend if existing component library) */
.notifications-snackbar {
  --toast-radius: 14px;
  --toast-border: rgba(148,163,184,.35);
  --toast-bg: linear-gradient(145deg,#0f172a,#1e293b 55%,#223146);
  --toast-fg: #f1f5f9;
  --toast-shadow: 0 6px 20px -6px rgba(0,0,0,.55), 0 2px 6px -2px rgba(15,23,42,.55);
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 14px;
  padding: 12px 18px 12px 16px;
  border-radius: var(--toast-radius);
  background: var(--toast-bg);
  color: var(--toast-fg);
  font-size: 13.5px;
  line-height: 1.35;
  border: 1px solid var(--toast-border);
  box-shadow: var(--toast-shadow);
  -webkit-font-smoothing: antialiased;
  animation: toastIn .45s cubic-bezier(.42,.8,.3,1) forwards;
  overflow:hidden;
}
.notifications-snackbar:not(.is-static) { backdrop-filter: blur(6px) saturate(140%); }

/* Accent bar */
.notifications-snackbar::before {
  content:"";
  position:absolute; left:0; top:0; bottom:0; width:4px;
  background:linear-gradient(180deg,#3b82f6,#2563eb);
  box-shadow:0 0 0 1px rgba(255,255,255,.15) inset,0 0 8px -1px rgba(59,130,246,.8);
  opacity:.95;
}

/* Icon slot (optional) */
.toast-icon { width:30px; height:30px; border-radius:9px; display:flex; align-items:center; justify-content:center; font-size:16px; font-weight:600; background:linear-gradient(145deg,#1e293b,#334155); color:#93c5fd; box-shadow:0 2px 6px -2px rgba(0,0,0,.5), 0 0 0 1px rgba(255,255,255,.08) inset; }

/* Message text */
.toast-msg { flex:1; font-weight:500; }
.toast-msg b, .toast-msg strong { font-weight:600; color:#fff; }

/* Undo / action link */
.toast-action { font-weight:600; font-size:13px; color:#60a5fa; text-decoration:none; position:relative; padding:4px 6px; border-radius:8px; transition: color .25s ease, background .25s ease; }
.toast-action::after { content:""; position:absolute; left:0; bottom:2px; height:2px; width:100%; background:linear-gradient(90deg,#3b82f6,#2563eb); transform:scaleX(.2); transform-origin:left; transition:transform .4s cubic-bezier(.4,.75,.3,1); opacity:.9; }
.toast-action:hover { color:#93c5fd; background:rgba(59,130,246,.08); }
.toast-action:hover::after { transform:scaleX(1); }
.toast-action:active { transform:translateY(1px); }
.toast-action:focus-visible { outline:2px solid #3b82f6; outline-offset:2px; }

/* Close button (if used) */
.toast-close { background:rgba(255,255,255,.08); border:none; width:32px; height:32px; display:grid; place-items:center; color:#cbd5e1; border-radius:10px; cursor:pointer; font-size:16px; line-height:1; transition: background .25s ease,color .25s ease; }
.toast-close:hover { background:rgba(255,255,255,.14); color:#fff; }
.toast-close:active { transform:translateY(1px); }
.toast-close:focus-visible { outline:2px solid #3b82f6; outline-offset:2px; }

/* Variants */
.notifications-snackbar.toast-success { --toast-bg:linear-gradient(145deg,#064e3b,#065f46 55%,#0d7a58); --toast-border:rgba(16,185,129,.45); }
.notifications-snackbar.toast-success::before { background:linear-gradient(180deg,#10b981,#059669); box-shadow:0 0 0 1px rgba(255,255,255,.15) inset,0 0 10px -2px rgba(16,185,129,.9); }
.notifications-snackbar.toast-error { --toast-bg:linear-gradient(145deg,#450a0a,#5f0f0f 55%,#7a1010); --toast-border:rgba(239,68,68,.45); }
.notifications-snackbar.toast-error::before { background:linear-gradient(180deg,#ef4444,#dc2626); box-shadow:0 0 0 1px rgba(255,255,255,.15) inset,0 0 10px -2px rgba(239,68,68,.9); }
.notifications-snackbar.toast-warning { --toast-bg:linear-gradient(145deg,#78350f,#92400e 55%,#b45309); --toast-border:rgba(251,191,36,.45); }
.notifications-snackbar.toast-warning::before { background:linear-gradient(180deg,#f59e0b,#d97706); box-shadow:0 0 0 1px rgba(255,255,255,.15) inset,0 0 10px -2px rgba(245,158,11,.85); }
.notifications-snackbar.toast-info { --toast-bg:linear-gradient(145deg,#0c4a6e,#0d567b 55%,#0f6b8f); --toast-border:rgba(56,189,248,.45); }
.notifications-snackbar.toast-info::before { background:linear-gradient(180deg,#38bdf8,#0ea5e9); box-shadow:0 0 0 1px rgba(255,255,255,.15) inset,0 0 10px -2px rgba(14,165,233,.85); }
.notifications-snackbar.toast-delete { --toast-bg:linear-gradient(145deg,#1e293b,#2a3344 55%,#323e50); --toast-border:rgba(96,165,250,.4); }

/* Slim progress bar (optional) */
.toast-progress { position:absolute; left:0; bottom:0; height:3px; width:100%; background:linear-gradient(90deg,#3b82f6,#2563eb); transform-origin:left; animation: toastProgress linear forwards; }

/* Dimension variants */
.notifications-snackbar.toast-sm { padding:8px 14px 8px 14px; font-size:12.5px; }
.notifications-snackbar.toast-lg { padding:18px 22px 18px 20px; font-size:15px; }

/* Entrance / exit */
@keyframes toastIn { 0% { opacity:0; transform:translateY(12px) scale(.94); } 60% { opacity:1; transform:translateY(-2px) scale(1.01);} 100% { opacity:1; transform:translateY(0) scale(1);} }
@keyframes toastOut { 0% { opacity:1; transform:translateY(0) scale(1);} 100% { opacity:0; transform:translateY(-6px) scale(.9);} }
@keyframes toastProgress { 0% { transform:scaleX(1);} 100% { transform:scaleX(0);} }

/* Utility to trigger exit (add via JS) */
.notifications-snackbar.is-leaving { animation: toastOut .35s ease forwards !important; }

/* Focus visibility */
.notifications-overlay__closeBtn:focus-visible,
.notifications-history-item .notif-delete-btn:focus-visible,
.notifications-history-actions .ph-btn:focus-visible,
.notifications-history-actions .ph-btn--secondary:focus-visible,
.notif-link-booking:focus-visible { outline:3px solid var(--notif-accent); outline-offset:2px; border-radius:10px; box-shadow:0 0 0 4px rgba(var(--notif-accent-glow)/.45); }

@media (max-width: 520px) {
  .notifications-overlay__panel { padding:16px 14px 18px; }
  .notifications-overlay__closeBtn { top:6px; right:6px; }
}

@keyframes notifOverlayFade { 0% { opacity:0; } 100% { opacity:1; } }
@keyframes notifOverlayPanelIn { 0% { opacity:0; transform: translateY(10px) scale(.96); } 100% { opacity:1; transform: translateY(0) scale(1); } }
@keyframes notifPulse { 0%,100% { opacity:.85; filter:brightness(1); } 50% { opacity:.35; filter:brightness(1.05) saturate(115%); } }
@keyframes panelSheen { 0% { opacity:.4; } 50% { opacity:.7; } 100% { opacity:.4; } }

@media (prefers-reduced-motion: reduce) {
  .notifications-overlay, .notifications-overlay__panel { animation: none !important; }
  .notifications-history-item.unread::after { animation:none; }
}
